{"version":3,"file":"dbox.js","sources":["../../../dboxjs/core/lib/carto/carto.js","../../../dboxjs/core/lib/helper.js","../../../dboxjs/core/lib/chart.js","../../../dboxjs/bars/bars.js","../../../dboxjs/distro/distrochart.js","../../../dboxjs/distro/distro.js","../../../dboxjs/heatmap/heatmap.js","../../../dboxjs/leaflet/leaflet.js","../../../dboxjs/map/map.js","../../../dboxjs/radar/radar.js","../../../dboxjs/scatter/scatter.js","../../../dboxjs/spineplot/spineplot.js","../../../dboxjs/timeline/timeline.js","../../../dboxjs/treemap/treemap.js","../../../dboxjs/core/index.dev.js"],"sourcesContent":["/*\n * CartoDB helper function\n */\n\nimport * as cartodb from \"cartodb\";\nexport default function carto() {\n\n  function carto(){\n\n  }\n\n  carto.query = function(config, callback){\n    //Config the cartdb User\n    var sql = new cartodb.SQL({ user: config.cartodb.user });\n    //Execute the query\n    sql.execute(config.cartodb.sql)\n      .done(function(data){\n\n        var result = data.rows;\n        //parse the data\n        if( config.parser ){\n          result = data.rows.map(config.parser)\n        }\n        //execute the callback with no error\n        callback(null, result);\n      })\n      .error(function(error){\n        //Return the error\n        callback(error, null);\n      })\n  }\n\n  return carto;\n}\n","import * as d3 from 'd3';\nimport * as d3Tip from 'd3-tip';\n\n//const tip = d3Tip();\n\nexport default function () {\n\n  var vm = this; // Hard binded to chart\n\n  var Helper = {\n    chart: {\n      config: vm._config,\n      width: vm._width,\n      height: vm._height,\n      style: vm._addStyle,\n      fullSvg: function () {\n        return vm._fullSvg;\n      },\n      svg: function () {\n        return vm._svg;\n      },\n    },\n    utils: {\n      d3: {}\n    }\n  };\n\n  Helper.utils.d3.tip = d3.tip;\n  debugger;\n\n  Helper.utils.generateScale = function (data, config) {\n    var scale = {};\n    var domains;\n    if (!config.range) {\n      throw 'Range is not defined';\n    }\n    // Used in bars.js when we want to create a groupBy or stackBy bar chart\n    if (config.groupBy && config.groupBy == 'parent') {\n      // Axis of type band \n      domains = data.map(function (d) {\n        return d[config.column];\n      });\n    } else if (config.stackBy && config.stackBy == 'parent') {\n      domains = data[0].map(function (d) {\n        return d.data[config.column];\n      });\n    } else if (config.groupBy == 'children') {\n      // GroupBy Columns\n      domains = config.column;\n    } else if (config.groupBy == 'data') {\n      // Considering the highest value on all the columns for each groupBy column\n      domains = [0, d3.max(data, function (d) {\n        return d3.max(config.column, function (column) {\n          return d[column];\n        });\n      })];\n    } else if (config.stackBy == 'data') {\n      // Using a d3.stack() \n      domains = [0, d3.max(data, function (serie) {\n        return d3.max(serie, function (d) {\n          return d[1];\n        });\n      })];\n    } else if (config.groupBy == undefined && config.type == 'band') {\n      // In case the axis is of type band and there is no groupby\n      domains = data.map(function (d) {\n        return d[config.column];\n      });\n    } else if (config.type === 'linear') {\n      // Axis of type numeric\n      domains = d3.extent(data, function (d) {\n        return +d[config.column];\n      });\n    } else {\n      // Axis of type band\n      domains = data.map(function (d) {\n        return d[config.column];\n      });\n    }\n\n    if (config.minZero) {\n      domains = [0, d3.max(data, function (d) {\n        return +d[config.column];\n      })];\n    }\n    if (config.domains && Array.isArray(config.domains)) {\n      domains = config.domains;\n    }\n\n    if (config.type) {\n      switch (config.type) {\n      case 'linear':\n        scale = d3.scaleLinear()\n          .rangeRound(config.range)\n          .domain(domains);\n        break;\n\n      case 'time':\n        scale = d3.scaleTime()\n          .range(config.range);\n        // .domain(domains);\n        break;\n\n      case 'ordinal':\n        scale = d3.scaleBand()\n          .rangeRound(config.range)\n          .padding(0.1)\n          .domain(domains);\n        break;\n\n      case 'band':\n        scale = d3.scaleBand()\n          .rangeRound(config.range)\n          .domain(domains)\n          .padding(0.1);\n        break;\n\n      case 'quantile':\n        scale = d3.scaleBand()\n          .rangeRound(config.range)\n          .padding(0.1)\n          .domain(data.map(function (d) {\n            return d[config.column];\n          }));\n        if (!config.bins) {\n          config.bins = 10;\n        }\n        scale = d3.scaleQuantile()\n          .range(d3.range(config.bins));\n        break;\n\n      default:\n        scale = d3.scaleLinear()\n          .rangeRound(config.range)\n          .domain(domains);\n        break;\n      }\n    } else {\n      scale = d3.scaleLinear()\n        .rangeRound(config.range)\n        .domain(domains);\n    }\n\n    return scale;\n  };\n\n  Helper.utils.format = function (d) {\n    var value = '';\n    if (vm._config.formatPreffix) {\n      value += vm._config.formatPreffix;\n    }\n    if (d === 0 || d % 1 == 0) {\n      value += d3.format(',.0f')(d);\n    } else if (d < 1 && d > 0) {\n      value += d3.format(',.2f')(d);\n    } else {\n      value += d3.format(',.1f')(d);\n    }\n    if (vm._config.formatSuffix) {\n      value += vm._config.formatSuffix;\n    }\n    return value;\n  };\n\n  // wrap function used in x axis labels\n  Helper.utils.wrap = function(text, width, tooltip) {\n    text.each(function () {\n      var text = d3.select(this),\n        words = text.text().split(/\\s+/).reverse(),\n        word,\n        line = [],\n        lineNumber = 0,\n        lineHeight = 1.1, // ems\n        y = text.attr('y'),\n        dy = parseFloat(text.attr('dy')) || 0,\n        tspan = text.text(null).append('tspan').attr('x', 0).attr('y', y).attr('dy', dy + 'em');\n\n      while (word = words.pop()) {\n        line.push(word);\n        tspan.text(line.join(' '));\n        if (tspan.node().getComputedTextLength() > width) {\n          line.pop();\n          tspan.text(line.join(' '));\n          line = [word];\n          tspan = text.append('tspan').attr('x', 0).attr('y', y).attr('dy', ++lineNumber * lineHeight + dy + 'em').text(word);\n\n          if (lineNumber > 0) {\n            if (words.length > 0 && tspan.node().getComputedTextLength() > width) {\n              if (tooltip) {\n                text\n                  .on('mouseover', tooltip.show)\n                  .on('mouseout', tooltip.hide);\n              }\n              let i = 1;\n              while (tspan.node().getComputedTextLength() > width) {\n                tspan.text(function () {\n                  return tspan.text().slice(0, -i) + '...';\n                });\n                ++i;\n              }\n            }\n            words = [];\n          } else {\n            let i = 1;\n            while (tspan.node().getComputedTextLength() > width) {\n              tspan.text(function () {\n                return tspan.text().slice(0, -i) + '...';\n              });\n              ++i;\n            }\n          }\n        }\n      }\n    });\n  };\n\n  Helper.utils.sortAscending = function (a, b) {\n    if (!Number.isNaN(+a) && !Number.isNaN(+b)) {\n      // If both values are numbers use numeric value\n      return Number(a) - Number(b);\n    } else if (!Number.isNaN(+a) && Number.isNaN(+b)) {\n      return -1;\n    } else if (Number.isNaN(+a) && !Number.isNaN(+b)) {\n      return 1;\n    } else if (a <= b) {\n      return -1;\n    } else {\n      return 1;\n    }\n  };\n\n  Helper.utils.sortDescending = function (a, b) {\n    if (!Number.isNaN(+b) && !Number.isNaN(+a)) {\n      // If both values are numbers use numeric value\n      return Number(b) - Number(a);\n    } else if (!Number.isNaN(+b) && Number.isNaN(+a)) {\n      return -1;\n    } else if (Number.isNaN(+b) && !Number.isNaN(+a)) {\n      return 1;\n    } else if (b <= a) {\n      return -1;\n    } else {\n      return 1;\n    }\n  };\n\n  return Helper;\n}\n","import * as d3 from 'd3';\nimport * as _ from 'lodash';\n\nimport carto from './carto/carto';\nimport Helper from './helper';\n\n/**\n * Dbox Chart core\n */\nexport default function (config) {\n\n  const Chart = {};\n\n  Chart.init = function (config) {\n    const vm = this;\n\n    const defaultConfig = {\n      size: {\n        width: 800,\n        height: 600,\n        margin: {\n          left: 0,\n          right: 0,\n          top: 0,\n          bottom: 0,\n        },\n      },\n    };\n\n    const defaultStyle = {\n      chart: {\n        backgroundColor: {\n          color: 'transparent',\n          // linearGradient : { x1: 0, y1: 0, x2: 1, y2: 1 },\n          // stops: [ [0, '#FCFCFC'], [1, '#F3F2F2'] ]\n        },\n      },\n      title: {\n        textColor: '#E6B537',\n        fontSize: '30px',\n        fontWeight: 600,\n        textAlign: 'center',\n        hr: {\n          enabled: true,\n          borderWidth: '1px',\n          borderColor: '#fff',\n        },\n      },\n      legend: {\n        position: 'bottom',\n        figure: 'circle',\n        text: {\n          textColor: '#fff',\n          fontSize: '20px',\n          fontWeight: 600,\n        },\n      },\n      tooltip: {\n        backgroundColor: '#757575',\n        opacity: 0.9,\n        text: {\n          textColor: '#fff',\n          fontSize: '12px',\n          fontWeight: 600,\n          textAlign: 'center',\n          fontFamily: 'sans-serif',\n          padding: '0.8em',\n        },\n        border: {\n          color: '#5A5C5D',\n          radius: '5px',\n          width: '1px',\n        },\n      },\n      yAxis: {\n        enabled: true,\n        axis: {\n          strokeWidth: 3,\n          strokeColor: '#5F6C6C',\n          strokeOpacity: 0,\n          paddingTick: 0,\n        },\n        ticks: {\n          strokeWidth: 3,\n          strokeColor: '#929D9E',\n          grid: 'dashed',\n          gridDashed: '3, 5',\n          opacity: 0.6,\n        },\n        labels: {\n          fontSize: 12,\n          fontWeight: 600,\n          textColor: '#fff',\n          textAnchor: 'end',\n        },\n        title: {\n          fontSize: 17,\n          fontWeight: 600,\n          textColor: '#fff',\n          textAnchor: 'middle',\n          // rotation\n          // text align or position\n        },\n      },\n      xAxis: {\n        enabled: true,\n        axis: {\n          strokeWidth: 3,\n          strokeColor: '#5F6C6C',\n          strokeOpacity: 1,\n          paddingTick: 5,\n        },\n        ticks: {\n          strokeWidth: 1,\n          strokeColor: '#5F6C6C',\n          // ticksize\n        },\n        labels: {\n          fontSize: 12,\n          fontWeight: 400,\n          textColor: '#fff',\n          textAnchor: 'middle',\n        },\n        title: {\n          fontSize: 17,\n          fontWeight: 600,\n          textColor: '#fff',\n          textAnchor: 'middle',\n          // text align\n        },\n      },\n    };\n\n    vm._config = config ? _.cloneDeep(config) : defaultConfig;\n\n\n    vm._data = [];\n    vm._margin = vm._config.size.margin;\n    vm._addStyle = config.addStyle ? config.addStyle : defaultStyle;\n\n    // Define width and height\n    vm._width = vm._config.size.width - vm._margin.left - vm._margin.right;\n    vm._height = vm._config.size.height - vm._margin.top - vm._margin.bottom;\n    vm._svg = '';\n    vm._scales = {};\n    vm._axes = {};\n\n    // Public\n    vm.layers = [];\n\n    // Helper data/functions for layers to use\n    vm.helper = Helper.bind(vm)();\n  };\n\n  //------------------------\n  //User\n  Chart.config = function (config) {\n    const vm = this;\n    vm._config = _.cloneDeep(config);\n    return vm;\n  };\n\n  Chart.size = function (sizeObj) {\n    const vm = this;\n    if (sizeObj) {\n      if (sizeObj.margin) {\n        if (sizeObj.margin.left == Number(sizeObj.margin.left)) {\n          vm._config.size.margin.left = sizeObj.margin.left;\n          vm._margin.left = sizeObj.margin.left;\n        }\n        if (sizeObj.margin.right == Number(sizeObj.margin.right)) {\n          vm._config.size.margin.right = sizeObj.margin.right;\n          vm._margin.right = sizeObj.margin.right;\n        }\n        if (sizeObj.margin.top == Number(sizeObj.margin.top)) {\n          vm._config.size.margin.top = sizeObj.margin.top;\n          vm._margin.top = sizeObj.margin.top;\n        }\n        if (sizeObj.margin.bottom == Number(sizeObj.margin.bottom)) {\n          vm._config.size.margin.bottom = sizeObj.margin.bottom;\n          vm._margin.bottom = sizeObj.margin.bottom;\n        }\n      }\n      if (sizeObj.width == Number(sizeObj.width)) {\n        vm._config.size.width = sizeObj.width;\n        vm._width = sizeObj.width;\n      }\n      if (sizeObj.height == Number(sizeObj.height)) {\n        vm._config.size.height = sizeObj.height;\n        vm._height = sizeObj.height;\n      }\n    }\n    return vm;\n  };\n\n  Chart.addStyle = function (stylesObj) {\n    const vm = this;\n    if (stylesObj) {\n      vm._addStyle = stylesObj;\n    }\n    return vm;\n  };\n\n  Chart.grid = function (bool) {\n    const vm = this;\n    vm._config.grid = bool ? true : false;\n    return vm;\n  };\n\n  Chart.bindTo = function (selector) {\n    const vm = this;\n    vm._config.bindTo = selector;\n    return vm;\n  };\n\n  Chart.data = function (data) {\n    const vm = this;\n    if (vm._config.data !== undefined) {\n      vm._config.data = Object.assign({}, vm._config.data, data);\n    } else {\n      vm._config.data = data;\n    }\n    return vm;\n  };\n\n  Chart.legend = function (legend) {\n    const vm = this;\n    vm._config.legend = legend;\n    return vm;\n  };\n\n  Chart.legendType = function (legendType) {\n    const vm = this;\n    vm._config.legendType = legendType;\n    return vm;\n  };\n\n  Chart.legendTitle = function (legendTitle) {\n    const vm = this;\n    vm._config.legendTitle = legendTitle;\n    return vm;\n  };\n\n  Chart.layer = function (_layer, _config) {\n    const vm = this;\n    var layer;\n    var config = _config ? _config : vm._config;\n    if (_layer === undefined && _layer === null) {\n      //@Todo Throw Error\n    } else {\n      layer = _layer(config, vm.helper);\n      vm.layers.push(layer);\n      return layer;\n    }\n  };\n\n  Chart.getLayer = function (layerIndex) {\n    const vm = this;\n    return vm.layers[layerIndex];\n  };\n\n  Chart.draw = function () {\n    const vm = this;\n    let q;\n\n    vm._scales = vm.scales();\n    //vm._axes   = vm.axes(); CALL THE AXES AFTER DATA LOADING IN ORDER TO UPDATE THE DOMAINS OF THE SCALES\n\n    q = vm.loadData();\n\n    q.awaitAll((error, results) => {\n      if (error) {\n        throw error;\n      }\n\n      if (Array.isArray(results) && results.length == 1) {\n        vm._data = results[0];\n      } else {\n        vm._data = results;\n      }\n\n      vm.initLayers();\n      vm.drawSVG();\n\n      //@TODO, ONE MAIN AXES THEN ADD THE POSSIBILITY FOR THE LAYER TO OVERRIDE \n      vm._axes = vm.axes();\n      vm.drawAxes();\n\n      //Draw layers after axes\n      vm.drawLayers();\n\n      //Trigger load chart event\n      if (vm._config.events && vm._config.events.load) {\n        vm.dispatch.on('load.chart', vm._config.events.load(vm));\n      }\n\n\n    });\n    return vm;\n  };\n\n  Chart.addStyle = function (theme) {\n    const vm = this;\n    vm._addStyle = theme;\n    return vm;\n  };\n\n  //----------------------\n  // Helper functions\n  Chart.scales = function () {\n    const vm = this;\n\n    var scales = {};\n    // xAxis scale\n    if (vm._config.xAxis && vm._config.xAxis.scale) {\n      switch (vm._config.xAxis.scale) {\n      case 'linear':\n        scales.x = d3.scaleLinear()\n            .range([0, vm._width]);\n        break;\n\n      case 'time':\n        scales.x = d3.scaleTime()\n          .range([0, vm._width]);\n        break;\n\n      case 'ordinal':\n        scales.x = d3.scaleOrdinal()\n          .range([0, vm._width], 0.1);\n        break;\n\n      case 'band':\n        scales.x = d3.scaleBand()\n          .rangeRound([0, vm._width])\n          .padding(0.1);\n        break;\n\n      case 'quantile':\n        scales.x = d3.scaleOrdinal()\n          .range([0, vm._width], 0.1);\n\n        scales.q = d3.scaleQuantile()\n          .range(d3.range(vm._config.xAxis.buckets));\n        break;\n\n      default:\n        scales.x = d3.scaleLinear()\n          .range([0, vm._width]);\n        break;\n      }\n    } else {\n      scales.x = d3.scaleLinear()\n        .range([0, vm._width]);\n    }\n\n    //yAxis scale\n    if (vm._config.yAxis && vm._config.yAxis.scale) {\n      switch (vm._config.yAxis.scale) {\n      case 'linear':\n        scales.y = d3.scaleLinear()\n          .range([vm._height, 0]);\n        break;\n\n      case 'time':\n        scales.y = d3.scaleTime()\n          .range([vm._height, 0]);\n        break;\n\n      case 'ordinal':\n        scales.y = d3.scaleOrdinal()\n          .range([vm._height, 0], 0.1);\n        break;\n\n      case 'band':\n        scales.y = d3.scaleBand()\n          .rangeRound([vm._height, 0])\n          .padding(0.1);\n        break;\n\n      case 'quantile':\n        scales.y = d3.scaleOrdinal()\n          .range([0, vm._width], 0.1);\n\n        scales.q = d3.scaleQuantile()\n          .range(d3.range(vm._config.yAxis.buckets));\n        break;\n\n      default:\n        scales.y = d3.scaleLinear()\n          .range([vm._height, 0]);\n        break;\n      }\n    } else {\n      scales.y = d3.scaleLinear()\n        .range([vm._height, 0]);\n    }\n\n\n    scales.color = d3.scaleOrdinal(d3.schemeCategory10);\n\n    return scales;\n  };\n\n  Chart.setScales = function () {\n\n  };\n\n  Chart.axes = function () {\n    const vm = this,\n      axes = {};\n    axes.x = d3.axisBottom(vm._scales.x);\n    axes.y = d3.axisLeft(vm._scales.y);\n\n    //remove corners in axis line\n    axes.x.tickSizeOuter(0);\n    axes.y.tickSizeOuter(0);\n\n    //Replaced with *addStyle -check\n    if (vm._config.xAxis && vm._config.xAxis.ticks &&\n      vm._config.xAxis.ticks.enabled === true && vm._config.xAxis.ticks.style) {\n\n      switch (vm._config.xAxis.ticks.style) {\n      case 'straightLine':\n        axes.x\n          .tickSize(-vm._height, 0);\n        break;\n      case 'dashLine':\n        axes.x\n          .tickSize(-vm._width, 0);\n        break;\n      }\n    }\n    //addStyle\n    if (vm._addStyle.xAxis.ticks.grid) {\n      switch (vm._addStyle.xAxis.ticks.grid) {\n      case 'straight':\n        axes.y\n          .tickSize(-vm._width, 0);\n        break;\n      case 'dashed':\n        axes.y\n          .tickSize(-vm._width, 0);\n        break;\n      }\n    }\n\n    if (vm._config.xAxis && vm._config.xAxis.ticks && vm._config.xAxis.ticks.values) {\n      axes.x.tickValues(vm._config.xAxis.ticks.values);\n    }\n\n    if (vm._config.xAxis && vm._config.xAxis.ticks && vm._config.xAxis.ticks.format) {\n      axes.x.tickFormat(vm._config.xAxis.ticks.format);\n    }\n\n    //Replaced with *addStyle -check\n    if (vm._config.yAxis && vm._config.yAxis.ticks &&\n      vm._config.yAxis.ticks.enabled === true && vm._config.yAxis.ticks.style) {\n\n      switch (vm._config.yAxis.ticks.style) {\n      case 'straightLine':\n        axes.y\n          .tickSize(-vm._width, 0);\n        break;\n      case 'dashLine':\n        axes.y\n          .tickSize(-vm._width, 0);\n        break;\n      }\n    }\n    // addStyle\n    if (vm._addStyle.yAxis.ticks.grid) {\n      switch (vm._addStyle.yAxis.ticks.grid) {\n      case 'straight':\n        axes.y\n          .tickSize(-vm._width, 0);\n        break;\n      case 'dashed':\n        axes.y\n          .tickSize(-vm._width, 0);\n        break;\n      }\n    }\n\n    if (vm._config.yAxis && vm._config.yAxis.ticks && vm._config.yAxis.ticks.format) {\n      axes.y.tickFormat(vm._config.yAxis.ticks.format);\n    }\n    return axes;\n  };\n\n  Chart.loadData = function () {\n    const vm = this;\n    var q;\n\n    if (vm._config.data.tsv) {\n      q = d3.queue()\n        .defer(d3.tsv, vm._config.data.tsv);\n    }\n\n    if (vm._config.data.json) {\n      q = d3.queue()\n        .defer(d3.json, vm._config.data.json);\n    }\n\n    if (vm._config.data.csv) {\n      q = d3.queue()\n        .defer(d3.csv, vm._config.data.csv);\n    }\n\n    if (vm._config.data.raw) {\n      q = d3.queue()\n        .defer(vm.mapData, vm._config.data.raw);\n    }\n\n    if (vm._config.data.cartodb) {\n      q = d3.queue()\n        .defer(carto.query, vm._config.data);\n    }\n\n    if (vm._config.map && vm._config.map.topojson && vm._config.map.topojson.url) {\n      q.defer(d3.json, vm._config.map.topojson.url);\n    }\n\n    if (vm._config.plotOptions && vm._config.plotOptions.bars &&\n      vm._config.plotOptions.bars.averageLines && Array.isArray(vm._config.plotOptions.bars.averageLines) &&\n      vm._config.plotOptions.bars.averageLines.length > 0) {\n\n      vm._config.plotOptions.bars.averageLines.forEach(function (l) {\n        if (l.data.cartodb) {\n          q.defer(carto.query, l.data);\n        }\n      });\n    }\n\n    return q;\n  };\n\n  Chart.initLayers = function () {\n    const vm = this;\n    vm.layers.forEach(function (ly) {\n      ly.data(vm._data)\n        .scales();\n\n      //@TODO validate domains from multiple layers\n      vm._scales = ly._scales;\n    });\n  };\n\n\n  Chart.drawSVG = function () {\n    const vm = this;\n\n    //Remove any previous svg\n    d3.select(vm._config.bindTo).select('svg').remove();\n    d3.select(vm._config.bindTo).html('');\n\n    //Add the css template class\n    if (vm._config.template) {\n      d3.select(vm._config.bindTo).classed(vm._config.template, true);\n    }\n\n    //Add title to the chart\n    if (vm._config && vm._config.title) {\n      d3.select(vm._config.bindTo).append('div')\n        .attr('class', 'chart-title')\n        .html(vm._config.title)\n        .style('display', 'flex')\n        .style('justify-content', 'center')\n        .style('align-items', 'center')\n        .style('font-size', vm._addStyle.title.fontSize)\n        .style('font-weight', vm._addStyle.title.fontWeight)\n        .style('color', vm._addStyle.title.textColor)\n        .style('text-align', vm._addStyle.title.textAlign);\n\n      if (vm._addStyle.title.hr.enabled) {\n        d3.select(vm._config.bindTo).append('hr')\n          .attr('class', 'hr-title')\n          .style('width', '80%')\n          .style('margin-left', '10%')\n          .style('margin-top', '0.5em')\n          .style('border-width', vm._addStyle.title.hr.borderWidth)\n          .style('border-color', vm._addStyle.title.hr.borderColor);\n      }\n    }\n\n    //Add Legend to the chart\n    //@TODO - PASS THE STYLES TO DBOX.CSS\n    //@TODO - ALLOW DIFFERENT POSSITIONS FOR THE LEGEND\n    if (vm._config.legend && vm._config.legend.enabled === true && vm._config.legend.position === 'top') {\n      var legend = d3.select(vm._config.bindTo).append('div')\n        .attr('class', 'chart-legend-top');\n\n      var html = '';\n      html += '<div style=\"background-color:#E2E2E1;text-align:center;height: 40px;margin: 0px 15px\">';\n      vm._config.legend.categories.forEach(function (c) {\n        html += '<div class=\"dbox-legend-category-title\" style=\"margin:0 20px;\"><span class=\"dbox-legend-category-color\" style=\"background-color:' + c.color + ';\"> </span><span style=\"height: 10px;float: left;margin: 10px 5px 5px 5px;border-radius: 50%;\">' + c.title + '</span></div>';\n      });\n      html += '</div>';\n      legend.html(html);\n    }\n\n\n    //Create the svg\n    vm._fullSvg = d3.select(vm._config.bindTo).append('svg')\n      .style('font-size', vm._config.chart ? vm._config.chart['font-size'] ? vm._config.chart['font-size'] : '12px' : '12px')\n      .attr('width', vm._width + vm._margin.left + vm._margin.right)\n      .attr('height', vm._height + vm._margin.top + vm._margin.bottom);\n\n    vm._svg = vm._fullSvg\n      .append('g')\n      .attr('transform', 'translate(' + vm._margin.left + ',' + vm._margin.top + ')');\n\n\n    //Call the tip function\n    /*if(vm._config.data.tip){\n      vm._svg.call(vm._tip);\n    }*/\n\n    //Apply background color\n\n    d3.select(vm._config.bindTo + ' svg').style('background-color', vm._addStyle.chart.backgroundColor.color);\n\n\n\n    //Legend for average lines\n    /*\n    d3.select(vm._config.bindTo).append('div')\n      .attr('class', 'chart-legend-bottom');\n    if(vm._config.plotOptions && vm._config.plotOptions.bars\n      && vm._config.plotOptions.bars.averageLines && Array.isArray(vm._config.plotOptions.bars.averageLines)\n      && vm._config.plotOptions.bars.averageLines.length >0 ){\n\n      d3.select(vm._config.bindTo).append('div')\n        .attr('class', 'container-average-lines')\n        .append('div')\n          .attr('class', 'legend-average-lines')\n        .html('Average Lines Controller')\n    }\n    */\n\n    if (vm._config.hasOwnProperty('legend')) {\n      vm.drawLegend();\n    }\n  };\n\n  Chart.drawLayers = function () {\n    const vm = this;\n    vm.layers.forEach(function (ly) {\n      ly.draw();\n    });\n  };\n\n  Chart.drawLegend = function () {\n    const vm = this;\n\n    const legendTip = vm.helper.utils.d3.tip().html(d => {\n      return '<div class=\"title-tip\">' + (d.name || d) + '</div>';\n    });\n    vm._fullSvg.call(legendTip);\n    var legendBox;\n    // Draw legend, defaults to right\n    if (vm._config.styles && vm._addStyle.legend.position === 'bottom') {\n      legendBox = vm._fullSvg.append('g')\n        .attr('class', 'legendBox')\n        .attr('width', vm._width)\n        .attr('transform', 'translate(' + vm._config.size.margin.left + ',' + (vm._config.size.height - 30) +\n          ')');\n    } else {\n      legendBox = vm._fullSvg.append('g')\n        .attr('class', 'legendBox')\n        .attr('transform', 'translate(' + (vm._config.size.width - vm._config.size.margin.right + 5) + ',' + 1 * 19 + ')');\n    }\n\n    if (vm._config.legendTitle) {\n      legendBox.append('text')\n        .attr('class', 'legend-title')\n        .text(vm._config.legendTitle);\n\n      //wrap legend title if text size exceeds 70% of container\n      let lWidth = vm._config.size.margin.right;\n      var text = d3.selectAll('.legend-title'),\n        words = text.text().split(/\\s+/).reverse(),\n        word,\n        line = [],\n        lineNumber = 1,\n        lineHeight = 1.1, // ems\n        y = text.attr('y'),\n        dy = 0,\n        tspan = text.text(null).append('tspan').attr('x', 0).attr('y', y).attr('dy', dy + 'em');\n      while (word = words.pop()) {\n        line.push(word);\n        tspan.text(line.join(' '));\n        if (tspan.node().getComputedTextLength() > lWidth) {\n          line.pop();\n          tspan.text(line.join(' '));\n          line = [word];\n          ++lineNumber;\n          tspan = text.append('tspan').attr('x', 0).attr('y', y).attr('dy', lineHeight + 'em').text(word);\n        }\n      }\n    }\n\n    let lbWidth = vm._config.size.margin.right * 0.8;\n\n    if (vm._config.legendType === 'checkbox') {\n      let size = 18,\n        x = 0,\n        y = 0,\n        rx = 2,\n        ry = 2,\n        markStrokeWidth = 3;\n\n      vm._scales.color.domain(vm._config.legend.map(o => o.name));\n\n      var legendCheck = legendBox.selectAll('.legend-checkbox')\n        .data(vm._config.legend)\n        .enter().append('g')\n        .attr('class', '.legend-checkbox legend')\n        .attr('transform', function (d, i) {\n          return 'translate(0,' + (vm._config.legendTitle && lineNumber > 1 ? lineNumber * lineHeight + i : 1 + i) * 20 + ')';\n        })\n        .on('click', function (d, i) {\n          // Run the custom function\n          if (typeof vm._config.events.onClickLegend === 'function') {\n            vm._config.events.onClickLegend.call(this, d, i);\n          }\n          d3.event.stopPropagation();\n        });\n\n      legendCheck.append('rect')\n        .attr('width', size)\n        .attr('height', size)\n        .attr('x', x)\n        .attr('rx', rx)\n        .attr('ry', ry)\n        .attr('fill-opacity', 1)\n        .attr('fill', function (d) {\n          return vm._scales.color(d.name);\n        });\n\n\n      let coordinates = [\n        {\n          x: x + (size / 8),\n          y: y + (size / 2)\n        },\n        {\n          x: x + (size / 2.2),\n          y: (y + size) - (size / 4)\n        },\n        {\n          x: (x + size) - (size / 8),\n          y: (y + (size / 10))\n        }\n      ];\n\n      let line = d3.line()\n        .x(function (d) {\n          return d.x;\n        })\n        .y(function (d) {\n          return d.y;\n        });\n\n      // mark\n      legendCheck.append('path')\n        .attr('d', line(coordinates))\n        .attr('stroke-width', markStrokeWidth)\n        .attr('stroke', 'white')\n        .attr('fill', 'none')\n        .attr('class', 'mark')\n        .property('checked', function (d) {\n          // External function call. It must be after all the internal code; allowing the user to overide \n          return d.active;\n        })\n        .attr('opacity', function () {\n          if (d3.select(this).property('checked')) {\n            return 1;\n          } else {\n            return 0;\n          }\n        });\n\n      legendCheck.append('text')\n        .attr('class', 'labelText')\n        .attr('x', 20)\n        .attr('y', 9)\n        .attr('dy', '.35em')\n        .attr('text-anchor', 'start')\n        .text(function (d) {\n          //External function call. It must be after all the internal code; allowing the user to overide \n          return d.name;\n        });\n\n      //cut label text if text size exceeds 80% of container\n      legendCheck.selectAll('text').each(function (d) {\n        if (typeof (d.name) === 'string') {\n          if (this.getComputedTextLength() > lbWidth) {\n            d3.select(this)\n              .attr('title', d.name)\n              .on('mouseover', legendTip.show)\n              .on('mouseout', legendTip.hide);\n            let i = 1;\n            while (this.getComputedTextLength() > lbWidth) {\n              d3.select(this).text(function (d) {\n                return d['name'].slice(0, -i) + '...';\n              });\n              ++i;\n            }\n          } else {\n            return d;\n          }\n        }\n      });\n    } else {\n      var legend;\n      if (vm._config.styles && vm._addStyle.legend.position === 'bottom') {\n        legend = legendBox.selectAll('.legend')\n          .data(vm._config.legend)\n          .enter().append('g')\n          .attr('class', 'legend')\n          .attr('width', vm._width / (vm._config.legend.length + 1))\n          .attr('transform', function (d, i) {\n            //horizontal position \n            //what if there are too many legends?\n            return 'translate(' + vm._width / (vm._config.legend.length + 1) * i + ',' + (vm._config.legendTitle && lineNumber > 1 ? lineNumber * lineHeight : 0) * 19 + ')';\n          });\n\n      } else {\n        legend = legendBox.selectAll('.legend')\n          .data(vm._config.legend)\n          .enter().append('g')\n          .attr('class', 'legend')\n          .attr('transform', function (d, i) {\n            return 'translate(' + 5 + ',' + (vm._config.legendTitle && lineNumber > 1 ? lineNumber * lineHeight + i : 1 + i) * 19 + ')';\n          });\n      }\n\n      if (vm._addStyle.legend.figure === 'circle') {\n        legend.append('circle')\n          .attr('cx', 2)\n          .attr('cy', 9)\n          .attr('r', 7)\n          .attr('stroke-width', 2)\n          .attr('stroke', function (d) {\n            return vm._scales.color(d.name);\n          })\n          .attr('fill', function (d) {\n            return vm._scales.color(d.name);\n          })\n          .attr('fill-opacity', 0.8);\n      } else {\n        legend.append('rect')\n          .attr('x', 0)\n          .attr('width', 18)\n          .attr('height', 18)\n          .attr('fill', function (d) {\n            return vm._scales.color(d.name);\n          });\n      }\n\n      legend.append('text')\n        .attr('x', 20)\n        .attr('y', 9)\n        .attr('dy', '.35em')\n        .attr('text-anchor', 'start')\n        .text(function (d) {\n          //External function call. It must be after all the internal code; allowing the user to overide \n          return d.name;\n        });\n\n      //cut label text if text size exceeds 80% of container\n      let lbWidth = vm._config.size.margin.right - 19;\n      legend.selectAll('text').each(function (d) {\n        if (typeof (d.name) === 'string') {\n          if (this.getComputedTextLength() > lbWidth) {\n            d3.select(this)\n              .attr('title', d.name)\n              .on('mouseover', legendTip.show)\n              .on('mouseout', legendTip.hide);\n            let i = 1;\n            while (this.getComputedTextLength() > lbWidth) {\n              d3.select(this).text(function (d) {\n                return d['name'].slice(0, -i) + '...';\n              });\n              ++i;\n            }\n          } else {\n            return d;\n          }\n        }\n      });\n    }\n\n    /**\n     * Give some extra style\n     */\n\n    legendBox.selectAll('.legend text')\n      .attr('fill', vm._addStyle.legend.text.textColor)\n      .attr('font-size', vm._addStyle.legend.text.fontSize)\n      .attr('font-weight', vm._addStyle.legend.text.fontWeight);\n  };\n\n  Chart.drawGrid = function () {\n    const vm = this;\n    return vm;\n  };\n\n  Chart.drawAxes = function () {\n    const vm = this;\n    var yAxis;\n\n    /**\n     * Draw axes depends on axes config and styles.\n     * Let's start with config.\n     */\n\n\n    //Axes tooltip\n    const axesTip = vm.helper.utils.d3.tip().html(d => {\n      return '<div class=\"title-tip\">' + d + '</div>';\n    });\n\n    if ((!vm._config.yAxis || (vm._config.yAxis && vm._config.yAxis.enabled !== false)) && (!vm._config.xAxis || (vm._config.xAxis && vm._config.xAxis.enabled !== false))) {\n      vm._svg.call(axesTip);\n    }\n\n\n    /**\n     * Config axes\n     */\n\n    // y\n\n    if (!vm._config.yAxis || (vm._config.yAxis && vm._config.yAxis.enabled !== false)) {\n      yAxis = vm._svg.append('g')\n        .attr('class', 'y axis')\n        .call(vm._axes.y);\n\n      if (vm._config.yAxis && vm._config.yAxis.text) {\n        yAxis.append('text')\n          .attr('class', 'axis-title')\n          .attr('y', -vm._margin.left * 0.7)\n          .attr('x', -vm._height / 2)\n          .attr('transform', 'rotate(-90)')\n          .attr('text-anchor', 'middle')\n          .text(vm._config.yAxis.text);\n      }\n    }\n\n    if (vm._config.yAxis.domain && vm._config.yAxis.domain.hasOwnProperty('enabled')) {\n      if (vm._config.yAxis.ticks) {\n        if (vm._config.yAxis.domain.enabled === false && vm._config.yAxis.ticks.enabled === false) {\n          d3.select('g.y.axis .domain').remove();\n          d3.selectAll('g.y.axis .tick').remove();\n        } else if (vm._config.yAxis.domain.enabled === false && vm._config.yAxis.ticks.enabled === true) {\n          d3.select('g.y.axis .domain').remove();\n          //d3.selectAll('g.y.axis .tick text').remove();\n        }\n      } else {\n        if (vm._config.yAxis.domain.enabled === false) {\n          d3.select('g.y.axis .domain').remove();\n          d3.selectAll('g.y.axis .tick').remove();\n        }\n      }\n    }\n\n    if (!vm._config.yAxis || (vm._config.yAxis && vm._config.yAxis.enabled !== false)) {\n      // Add ellipsis to cut label text when too long\n      // for yAxis on the left\n      yAxis.selectAll('text').each(function (d) {\n        let element = this;\n        if (typeof (d) === 'string') {\n          if (this.getComputedTextLength() > 0.8 * vm._margin.left) {\n            d3.select(element)\n              .on('mouseover', axesTip.show)\n              .on('mouseout', axesTip.hide);\n            let i = 1;\n            while (this.getComputedTextLength() > 0.8 * vm._margin.left) {\n              d3.select(this).text(function (d) {\n                return d.slice(0, -i) + '...';\n              }).attr('title', d);\n              ++i;\n            }\n          } else {\n            return d;\n          }\n        }\n      });\n    }\n\n    //Dropdown Y axis\n    if (vm._config.yAxis && vm._config.yAxis.dropdown && vm._config.yAxis.dropdown.enabled === true) {\n      var yAxisDropDown = d3.select(vm._config.bindTo).append('div').attr('class', 'dbox-yAxis-select')\n        .append('select')\n        .on('change', function () {\n          vm.updateAxis('y', this.value);\n        });\n\n      /*\n      .attr('style', function(){\n                              var x = -1*d3.select(vm._config.bindTo).node().getBoundingClientRect().width/2+ vm._chart._margin.left/4;\n                              var y = -1*d3.select(vm._config.bindTo).node().getBoundingClientRect().height/2;\n                              return 'transform: translate('+x+'px,'+y+'px) rotate(-90deg);'\n                            })\n      */\n\n      var x = -1 * d3.select(vm._config.bindTo).node().getBoundingClientRect().width / 2 + vm._margin.left / 2.5;\n      var y = -1 * d3.select(vm._config.bindTo).node().getBoundingClientRect().height / 1.5;\n\n      if (vm._config.yAxis.dropdown.styles) {\n\n        var styles = vm._config.yAxis.dropdown.styles;\n        styles.display = 'block';\n        styles.transform = 'translate(' + x + 'px,' + y + 'px) rotate(-90deg)';\n        styles.margin = 'auto';\n        styles['text-align'] = 'center';\n        styles['text-align-last'] = 'center';\n\n        d3.select('.dbox-yAxis-select select').styles(styles);\n\n        d3.select('.dbox-yAxis-select select option').styles({\n          'text-align': 'left'\n        });\n\n      } else {\n        d3.select('.dbox-yAxis-select select').styles({\n          'display': 'block',\n          'transform': 'translate(' + x + 'px,' + y + 'px) rotate(-90deg)',\n          'margin': 'auto',\n          'text-align': 'center',\n          'text-align-last': 'center'\n        });\n\n        d3.select('.dbox-yAxis-select select option').styles({\n          'text-align': 'left'\n        });\n      }\n\n      if (vm._config.yAxis.dropdown.options) {\n\n        yAxisDropDown.selectAll('option')\n          .data(vm._config.yAxis.dropdown.options)\n          .enter().append('option')\n          .attr('class', function (d) {\n            return d.value;\n          })\n          .attr('value', function (d) {\n            return d.value;\n          })\n          .text(function (d) {\n            return d.title;\n          })\n          .property('selected', function (d) {\n            return d.selected;\n          });\n\n      } else {\n        console.log('No options present in config');\n      }\n    }\n\n    // y\n\n    /////////////////////////////\n\n    // x\n    if (!vm._config.xAxis || (vm._config.xAxis && vm._config.xAxis.enabled !== false)) {\n\n      vm._xAxis = vm._svg.append('g')\n        .attr('class', 'x axis')\n        .attr('transform', 'translate(0,' + vm._height + ')')\n        .call(vm._axes.x);\n\n      //Do not show line if axis is disabled\n      if (vm._config.xAxis.line && vm._config.xAxis.line.enabled == false) {\n        vm._xAxis.selectAll('path')\n          .style('display', 'none');\n      }\n\n      //Set custom position for ticks\n      if (vm._config.xAxis.ticks && vm._config.xAxis.ticks.x) {\n        vm._xAxis.selectAll('text')\n          .attr('dx', vm._config.xAxis.ticks.x);\n      }\n\n      if (vm._config.xAxis.ticks && vm._config.xAxis.ticks.y) {\n        vm._xAxis.selectAll('text')\n          .attr('dy', vm._config.xAxis.ticks.y);\n      }\n\n      //Disable ticks when set to false\n      if (vm._config.xAxis.ticks && vm._config.xAxis.ticks.line && vm._config.xAxis.ticks.line.enabled === false) {\n        vm._xAxis.selectAll('line')\n          .style('display', 'none');\n      }\n    }\n\n    if (vm._config.xAxis && vm._config.xAxis.text) {\n      vm._xAxis.append('text')\n        .attr('class', 'axis-title')\n        .attr('x', vm._width / 2)\n        .attr('y', 40)\n        .style('text-anchor', 'middle')\n        .text(vm._config.xAxis.text);\n    }\n\n    if (vm._config.xAxis.domain !== undefined && vm._config.xAxis.domain.hasOwnProperty('enabled')) {\n      if (vm._config.xAxis.ticks) {\n        if (vm._config.xAxis.domain.enabled === false && vm._config.xAxis.ticks.enabled === false) {\n          d3.select(vm._config.bindTo + ' g.x.axis .domain').remove();\n          d3.selectAll('g.x.axis .tick').remove();\n        } else if (vm._config.xAxis.domain.enabled === false && vm._config.xAxis.ticks.enabled === true) {\n          d3.select(vm._config.bindTo + ' g.x.axis .domain').remove();\n          //d3.selectAll('g.x.axis .tick text').remove();\n        }\n      } else {\n        if (vm._config.xAxis.domain.enabled === false) {\n          d3.select(vm._config.bindTo + ' g.x.axis .domain').remove();\n          d3.selectAll(vm._config.bindTo + ' g.x.axis .tick').remove();\n        }\n      }\n    }\n\n    //Dropdown X axis\n    if (vm._config.xAxis && vm._config.xAxis.dropdown && vm._config.xAxis.dropdown.enabled === true) {\n      var xAxisDropDown = d3.select(vm._config.bindTo).append('div').attr('class', 'dbox-xAxis-select')\n        .append('select')\n        .on('change', function () {\n          vm.updateAxis('x', this.value);\n        });\n\n      if (vm._config.xAxis.dropdown.styles) {\n\n        var styles = vm._config.xAxis.dropdown.styles;\n        styles.display = 'block';\n        styles.margin = 'auto';\n        styles['text-align'] = 'center';\n        styles['text-align-last'] = 'center';\n\n        d3.select('.dbox-xAxis-select select').styles(styles);\n\n        d3.select('.dbox-xAxis-select select option').styles({\n          'text-align': 'left'\n        });\n\n      } else {\n        d3.select('.dbox-xAxis-select select').styles({\n          'display': 'block',\n          'margin': 'auto',\n          'text-align': 'center',\n          'text-align-last': 'center'\n        });\n\n        d3.select('.dbox-xAxis-select select option').styles({\n          'text-align': 'left'\n        });\n      }\n\n      if (vm._config.xAxis.dropdown.options) {\n\n        xAxisDropDown.selectAll('option')\n          .data(vm._config.xAxis.dropdown.options)\n          .enter().append('option')\n          .attr('class', function (d) {\n            return d.value;\n          })\n          .attr('value', function (d) {\n            return d.value;\n          })\n          .text(function (d) {\n            return d.title;\n          })\n          .property('selected', function (d) {\n            return d.selected;\n          });\n\n      } else {\n        console.log('No options present in config');\n      }\n    }\n\n    /**\n     * Let's style axes\n     */\n    //Style Y axis\n    if (vm._config.xAxis.enabled !== false && vm._addStyle.xAxis.enabled) {\n      //axis line\n      yAxis.selectAll('.domain')\n        .attr('stroke-linecap', 'round')\n        .attr('stroke-width', vm._addStyle.yAxis.axis.strokeWidth)\n        .attr('stroke', vm._addStyle.yAxis.axis.strokeColor)\n        .attr('opacity', vm._addStyle.yAxis.axis.strokeOpacity);\n\n      //axis title\n      yAxis.selectAll('.axis-title')\n        .attr('font-size', vm._addStyle.yAxis.title.fontSize)\n        .attr('font-weight', vm._addStyle.yAxis.title.fontWeight)\n        .attr('fill', vm._addStyle.yAxis.title.textColor)\n        .attr('text-anchor', vm._addStyle.yAxis.title.textAnchor);\n\n      //tick lines\n      yAxis.selectAll('.tick line')\n        .attr('stroke-width', vm._addStyle.yAxis.ticks.strokeWidth)\n        .attr('stroke', vm._addStyle.yAxis.ticks.strokeColor)\n        .attr('stroke-opacity', vm._addStyle.yAxis.ticks.opacity)\n        .attr('width', vm._addStyle.yAxis.ticks.tickWidth)\n        //condition gridline\n        .attr('stroke-dasharray', vm._addStyle.yAxis.ticks.gridDashed)\n        .attr('transform', 'translate(-' + vm._addStyle.yAxis.axis.paddingTick + ', 0)');\n      //don't draw first tick when styled as grid\n      if (vm._addStyle.yAxis.ticks.grid) {\n        yAxis.selectAll('.tick:first-of-type line:first-of-type')\n          .attr('stroke', 'none');\n      }\n\n      //tick text\n      yAxis.selectAll('.tick text')\n        .attr('font-size', vm._addStyle.yAxis.labels.fontSize)\n        .attr('font-weight', vm._addStyle.yAxis.labels.fontWeight)\n        .attr('fill', vm._addStyle.yAxis.labels.textColor)\n        .attr('text-anchor', vm._addStyle.yAxis.labels.textAnchor)\n        .attr('transform', 'translate(-' + vm._addStyle.yAxis.axis.paddingTick + ', 0)');\n\n    }\n\n    //Style X axis\n    if (vm._config.xAxis.enabled !== false && vm._addStyle.xAxis.enabled) {\n      //axis line\n      vm._xAxis.selectAll('.domain')\n        .attr('stroke-linecap', 'round')\n        .attr('stroke-width', vm._addStyle.xAxis.axis.strokeWidth)\n        .attr('stroke', vm._addStyle.xAxis.axis.strokeColor)\n        .attr('opacity', vm._addStyle.xAxis.axis.strokeOpacity);\n\n      //axis title\n      vm._xAxis.selectAll('.axis-title')\n        .attr('font-size', vm._addStyle.xAxis.title.fontSize)\n        .attr('font-weight', vm._addStyle.xAxis.title.fontWeight)\n        .attr('fill', vm._addStyle.xAxis.title.textColor)\n        .attr('text-anchor', vm._addStyle.xAxis.title.textAnchor)\n        .attr('transform', 'translate(0, ' + vm._addStyle.xAxis.axis.paddingTick + ')');\n\n      //tick lines\n      vm._xAxis.selectAll('.tick line')\n        .attr('stroke-width', vm._addStyle.xAxis.ticks.strokeWidth)\n        .attr('stroke', vm._addStyle.xAxis.ticks.strokeColor)\n        .attr('transform', 'translate(0, ' + vm._addStyle.xAxis.axis.paddingTick + ')');\n      //don't draw first tick when styled as grid\n      if (vm._addStyle.xAxis.ticks.grid) {\n        vm._xAxis.selectAll('.tick:first-of-type line:first-of-type')\n          .attr('stroke', 'none');\n      }\n\n      //tick text\n      vm._xAxis.selectAll('.tick text')\n        .attr('font-size', vm._addStyle.xAxis.labels.fontSize)\n        .attr('font-weight', vm._addStyle.xAxis.labels.fontWeight)\n        .attr('fill', vm._addStyle.xAxis.labels.textColor)\n        .attr('text-anchor', vm._addStyle.xAxis.labels.textAnchor)\n        .attr('transform', vm._addStyle.xAxis.labels.rotate ? 'translate(0,50) rotate(' + vm._addStyle.xAxis.axis.labels.rotate + ')' : 'translate(0, ' + vm._addStyle.xAxis.axis.paddingTick + ')');\n    }\n\n    if (!vm._config.xAxis || (vm._config.xAxis && vm._config.xAxis.enabled !== false)) {\n      // Add ellipsis to cut label text \n      // when it is too long\n    \n      const biggestLabelWidth = d3.max(d3.select('.x.axis').selectAll('text').nodes().map(o => o.getComputedTextLength())); // Biggest label computed text length\n      let xBandWidth = vm._scales.x.bandwidth ? vm._scales.x.bandwidth() : (vm._config.size.width - (vm._config.size.margin.left + vm._config.size.margin.right)) / vm._scales.x.ticks();\n      if (biggestLabelWidth > xBandWidth) { // Biggest label doesn't fit\n        vm._xAxis.selectAll('text').each(function (d) {\n          if (typeof (d) === 'string') {\n            // Vertical labels\n            d3.select(this)\n                .attr('text-anchor', 'end')\n                .attr('dy', 0)\n                .attr('transform', 'translate(-5,8)rotate(-90)');\n            // Still doesn't fit!\n            if (this.getComputedTextLength() > 0.8 * vm._config.size.margin.bottom) {\n              d3.select(this)\n                .on('mouseover', axesTip.show)\n                .on('mouseout', axesTip.hide);\n              let i = 1;\n              while (this.getComputedTextLength() > 0.8 * vm._config.size.margin.bottom) {\n                d3.select(this).text(function (d) {\n                  return d.slice(0, -i) + '...';\n                }).attr('title', d);\n                ++i;\n              }\n            } else {\n              return d;\n            }\n          }\n        });\n      } \n    }\n\n    /**\n     * Already replaced with addStyle\n     */\n    /*if (vm._config.yAxis && vm._config.yAxis.enabled !== false) {\n\n      if (vm._config.yAxis && vm._config.yAxis.text) {\n        yAxis.append('text')\n          .attr('class', 'label title')\n          .attr('transform', 'rotate(-90)')\n          .attr('y', vm._config.yAxis.y ? vm._config.yAxis.y : -50)\n          .attr('x', -150)\n          .attr('dy', '.71em')\n          .style('text-anchor', 'middle')\n          .style('fill', vm._config.yAxis.fill ? vm._config.yAxis.fill : 'black')\n          .style('font-size', vm._config.yAxis['font-size'] ? vm._config.yAxis['font-size'] : '12px')\n          .style('font-weight', vm._config.xAxis['font-weight'] ? vm._config.xAxis['font-weight'] : '600')\n          .text(vm._config.yAxis.text);\n      }\n    }*/\n\n    //Set ticks straight or dashed, to be replaced with *addStyle -checked\n    if (vm._config.yAxis.ticks && vm._config.yAxis.ticks.enabled && vm._config.yAxis.ticks.style) {\n      switch (vm._config.yAxis.ticks.style) {\n      case 'straightLine':\n        break;\n      case 'dashLine':\n        d3.selectAll('g.y.axis .tick line').attr('stroke-dasharray', '5, 5');\n        break;\n      }\n    }\n    //To be replaced with *addStyle -checked\n    if (vm._config.yAxis.domain && vm._config.yAxis.domain.enabled && vm._config.yAxis.domain.stroke) {\n      d3.select('g.y.axis .domain').attr('stroke', vm._config.yAxis.domain.stroke);\n    }\n\n    //To be replaced with *addStyle -checked\n    if (vm._config.yAxis.domain && vm._config.yAxis.domain.enabled && vm._config.yAxis.domain['stroke-width']) {\n      d3.select('g.y.axis .domain').attr('stroke-width', vm._config.yAxis.domain['stroke-width']);\n    }\n\n    // y\n\n    /////////////////////////////\n\n    // x\n\n    if (!vm._config.xAxis || (vm._config.xAxis && vm._config.xAxis.enabled !== false)) {\n\n      //To be replaced with *addStyle -checked\n      if (vm._config.xAxis.ticks && vm._config.xAxis.ticks.style) {\n        Object.keys(vm._config.xAxis.ticks.style).forEach(function (k) {\n          vm._xAxis.selectAll('text')\n            .style(k, vm._config.xAxis.ticks.style[k]);\n        });\n      }\n\n      //Set rotation for ticks, to be replaced with *addStyle -checked\n      if (vm._config.xAxis.ticks && vm._config.xAxis.ticks.rotate) {\n        vm._xAxis.selectAll('text')\n          .attr('text-anchor', 'end')\n          .attr('transform', 'rotate(' + vm._config.xAxis.ticks.rotate + ')');\n      }\n\n      //Set ticks straight or dashed, to be replaced with *addStyle -checked\n      if (vm._config.xAxis.ticks && vm._config.xAxis.ticks.enabled && vm._config.xAxis.ticks.style) {\n        switch (vm._config.xAxis.ticks.style) {\n        case 'straightLine':\n          break;\n        case 'dashLine':\n          d3.selectAll(vm._config.bindTo + ' g.x.axis .tick line').attr('stroke-dasharray', '5, 5');\n          break;\n        }\n      }\n\n    }\n\n    //to be replaced with *addStyle -checked\n    if (vm._config.xAxis.domain && vm._config.xAxis.domain.enabled && vm._config.xAxis.domain.stroke) {\n      d3.select(vm._config.bindTo + ' g.x.axis .domain').attr('stroke', vm._config.xAxis.domain.stroke);\n    }\n\n    //to be replaced with *addStyle -checked\n    if (vm._config.xAxis.domain && vm._config.xAxis.domain.enabled && vm._config.xAxis.domain['stroke-width']) {\n      d3.select(vm._config.bindTo + ' g.x.axis .domain').attr('stroke-width', vm._config.xAxis.domain['stroke-width']);\n    }\n\n    //to be replaced with *addStyle\n    /*if (vm._config.xAxis && vm._config.xAxis.text) {\n      xAxis.append('text')\n        .attr('class', 'label title')\n        .attr('x', vm._width / 2)\n        .attr('y', vm._config.xAxis.y ? vm._config.xAxis.y : 30)\n        .style('text-anchor', 'middle')\n        .style('fill', vm._config.xAxis.fill ? vm._config.xAxis.fill : 'black')\n        .style('font-size', vm._config.xAxis['font-size'] ? vm._config.xAxis['font-size'] : '12px')\n        .style('font-weight', vm._config.xAxis['font-weight'] ? vm._config.xAxis['font-weight'] : '600')\n        .text(vm._config.xAxis.text);\n    }*/\n  };\n\n  Chart.updateAxis = function (axis, value) {\n    const vm = this;\n\n    if (axis === 'x') {\n      vm._config.xAxis.dropdown.options.map((obj) => {\n        if (obj.value === value) {\n          obj.selected = true;\n        } else {\n          obj.selected = false;\n        }\n      });\n    } else if (axis === 'y') {\n      vm._config.yAxis.dropdown.options.map((obj) => {\n        if (obj.value === value) {\n          obj.selected = true;\n        } else {\n          obj.selected = false;\n        }\n      });\n    }\n\n    vm._config[axis] = value;\n\n    var layer = vm.layers[0];\n\n    layer._config = vm._config;\n\n    vm.draw();\n\n    // Trigger update chart axis\n    if (vm._config.events && vm._config.events.change) {\n      vm.dispatch.on('change.axis', vm._config.events.change(vm));\n    }\n  };\n\n\n\n  Chart.dispatch = d3.dispatch('load', 'change');\n\n  Chart.mapData = function (data, callback) {\n    callback(null, data);\n  };\n\n  Chart.getDomains = function (data) {\n    const vm = this;\n\n    var domains = {};\n    var minMax = [];\n    var sorted = [];\n\n\n    // Default ascending function\n    var sortFunctionY = function (a, b) {\n      return vm.utils.sortAscending(a.y, b.y);\n    };\n    var sortFunctionX = function (a, b) {\n      return vm.utils.sortAscending(a.x, b.x);\n    };\n\n\n    // if applying sort\n    if (vm._config.data.sort && vm._config.data.sort.order) {\n      switch (vm._config.data.sort.order) {\n      case 'asc':\n        sortFunctionY = function (a, b) {\n          return vm.utils.sortAscending(a.y, b.y);\n        };\n        sortFunctionX = function (a, b) {\n          return vm.utils.sortAscending(a.x, b.x);\n        };\n        break;\n\n      case 'desc':\n        sortFunctionY = function (a, b) {\n          return vm.utils.sortDescending(a.y, b.y);\n        };\n        sortFunctionX = function (a, b) {\n          return vm.utils.sortDescending(a.x, b.x);\n        };\n        break;\n      }\n    }\n\n\n    // xAxis\n    if (vm._config.xAxis && vm._config.xAxis.scale) {\n      switch (vm._config.xAxis.scale) {\n      case 'linear':\n        minMax = d3.extent(data, function (d) {\n          return d.x;\n        });\n        domains.x = minMax;\n        break;\n\n      case 'time':\n        minMax = d3.extent(data, function (d) {\n          return d.x;\n        });\n        domains.x = minMax;\n        break;\n\n      case 'ordinal':\n\n        // If the xAxis' order depends on the yAxis values\n        if (vm._config.data.sort && vm._config.data.sort.axis === 'y') {\n          sorted = data.sort(sortFunctionY);\n        } else {\n          sorted = data.sort(sortFunctionX);\n        }\n\n        domains.x = [];\n        sorted.forEach(function (d) {\n          domains.x.push(d.x);\n        });\n\n        break;\n\n      case 'quantile':\n\n        //The xAxis order depends on the yAxis values\n        if (vm._config.data.sort && vm._config.data.sort.axis === 'y') {\n          sorted = data.sort(sortFunctionY);\n        } else {\n          sorted = data.sort(sortFunctionX);\n        }\n\n        domains.q = [];\n        sorted.forEach(function (d) {\n          domains.q.push(d.x);\n        });\n\n        domains.x = d3.range(vm._config.xAxis.buckets);\n\n        break;\n\n\n      default:\n        minMax = d3.extent(data, function (d) {\n          return d.x;\n        });\n        domains.x = minMax;\n        break;\n      }\n    } else {\n      minMax = d3.extent(data, function (d) {\n        return d.x;\n      });\n      domains.x = minMax;\n    }\n\n    //yAxis\n    if (vm._config.yAxis && vm._config.yAxis.scale) {\n      switch (vm._config.yAxis.scale) {\n      case 'linear':\n        minMax = d3.extent(data, function (d) {\n          return d.y;\n        });\n\n        //Adjust for min values greater than zero\n        //set the min value to -10%\n        if (minMax[0] > 0) {\n          minMax[0] = minMax[0] - (minMax[1] - minMax[0]) * .1;\n        }\n        domains.y = minMax;\n        break;\n\n      case 'time':\n        minMax = d3.extent(data, function (d) {\n          return d.y;\n        });\n        domains.y = minMax;\n        break;\n\n      case 'ordinal':\n        if (vm._config.data.sort && vm._config.data.sort.axis === 'y') {\n\n          sorted = data.sort(function (a, b) {\n            return vm.utils.sortAscending(a.y, b.y);\n          });\n          domains.y = [];\n          sorted.forEach(function (d) {\n            domains.y.push(d.x);\n          });\n\n        } else {\n          domains.y = d3.map(data, function (d) {\n            return d.y;\n          }).keys().sort(function (a, b) {\n            return vm.utils.sortAscending(a, b);\n          });\n        }\n\n        break;\n\n      default:\n        minMax = d3.extent(data, function (d) {\n          return d.y;\n        });\n        domains.y = minMax;\n        break;\n      }\n    } else {\n      minMax = d3.extent(data, function (d) {\n        return d.y;\n      });\n      domains.y = minMax;\n    }\n\n\n    return domains;\n  };\n\n  Chart.destroy = function () {\n    const vm = this;\n    d3.select(vm._config.bindTo).html('');\n  };\n\n  Chart.init(config);\n\n  return Chart;\n}\n","import * as d3 from 'd3';\nimport * as _ from 'lodash';\n\n/*\n * Simple Bar chart\n */\nexport default function (config, helper) {\n\n  //Link Bars to the helper object in helper.js\n  var Bars = Object.create(helper);\n\n  Bars.init = function (config) {\n    var vm = this;\n\n    vm._config = config ? config : {};\n    vm._data = [];\n    vm._scales = {};\n    vm._tip = vm.utils.d3.tip()\n      .attr('class', 'd3-tip')\n      .direction('n')\n      .html(vm._config.tip || function (d) {\n        var html = '';\n        html += d[vm._config.x] ? ('<span>' + (Number.isNaN(+d[vm._config.x]) || vm._config.xAxis.scale === 'band' ? d[vm._config.x] : vm.utils.format(d[vm._config.x])) + '</span></br>') : '';\n        html += d[vm._config.y] ? ('<span>' + (Number.isNaN(+d[vm._config.y]) || vm._config.yAxis.scale === 'band' ? d[vm._config.y] : vm.utils.format(d[vm._config.y])) + '</span></br>') : '';\n        return html;\n      });\n  };\n\n\n  //-------------------------------\n  //User config functions\n  Bars.id = function (columnName) {\n    var vm = this;\n    vm._config.id = columnName;\n    return vm;\n  };\n\n  Bars.x = function (columnName) {\n    var vm = this;\n    vm._config.x = columnName;\n    return vm;\n  };\n\n  Bars.y = function (columnName) {\n    var vm = this;\n    vm._config.y = columnName;\n    return vm;\n  };\n\n  /**\n   * Used to draw a bar chart with multiple bars per group\n   * @param {array} columns \n   */\n  Bars.groupBy = function (columns) {\n    var vm = this;\n    vm._config.groupBy = columns;\n    return vm;\n  };\n\n  /**\n   * Used to draw a bar chart stacked with multiple bars per group\n   * @param {array} columns \n   */\n  Bars.stackBy = function (columnName) {\n    var vm = this;\n    vm._config.stackBy = columnName;\n    return vm;\n  };\n\n  /**\n   * column name used for the domain values\n   * @param {string} columnName \n   */\n  Bars.fill = function (columnName) {\n    var vm = this;\n    vm._config.fill = columnName;\n    return vm;\n  };\n\n  /**\n   * array of values used \n   * @param {array or scale} columnName \n   */\n  Bars.colors = function (colors) {\n    var vm = this;\n    if (Array.isArray(colors)) {\n      //Using an array of colors for the range \n      vm._config.colors = colors;\n    } else {\n      //Using a preconfigured d3.scale\n      vm._scales.color = colors;\n    }\n    return vm;\n  };\n\n  Bars.sortBy = function (option) {\n    //option = string [asc,desc] \n    //option = array for groupBy and stackBy\n    var vm = this;\n    vm._config.sortBy = option;\n    return vm;\n  };\n\n  Bars.format = function (format) {\n    var vm = this;\n    if (typeof format == 'function' || format instanceof Function) {\n      vm.utils.format = format;\n    } else {\n      vm.utils.format = d3.format(format);\n    }\n    return vm;\n  };\n\n  Bars.tip = function (tip) {\n    var vm = this;\n    vm._config.tip = tip;\n    return vm;\n  };\n\n  Bars.legend = function (legend) {\n    var vm = this;\n    vm._config.legend = legend;\n    return vm;\n  };\n\n\n  //-------------------------------\n  //Triggered by the chart.js;\n  Bars.data = function (data) {\n    var vm = this;\n\n    if (vm._config.filter) {\n      //In case we want to filter observations\n      data = data.filter(vm._config.filter);\n    }\n\n    if (vm._config.hasOwnProperty('stackBy') && Array.isArray(vm._config.stackBy) && vm._config.stackBy.length > 0) {\n      // Used in a stackbar, transpose the data into layers \n      vm._data = d3.stack().keys(vm._config.stackBy)(data);\n    } else {\n      // Normal bar, save the data as numbers \n      vm._data = data.map(function (d) {\n        if (d[vm._config.x] == Number(d[vm._config.x]))\n          d[vm._config.x] = +d[vm._config.x];\n        if (d[vm._config.y] == Number(d[vm._config.y]))\n          d[vm._config.y] = +d[vm._config.y];\n        return d;\n      });\n    }\n\n    //@TODO - ALLOW MULITPLE SORTS\n    if (vm._config.sortBy) {\n      vm._data = vm._data.sort(function (a, b) {\n        return a[vm._config.sortBy[0]] - b[vm._config.sortBy[0]];\n      });\n    }\n\n    if (vm._config.hasOwnProperty('quantiles')) {\n      vm._quantiles = vm._setQuasecondntile(data);\n      vm._minMax = d3.extent(data, function (d) {\n        return +d[vm._config.fill];\n      });\n    }\n\n    return vm;\n  };\n\n  Bars.scales = function () {\n    var vm = this;\n    var config;\n    //vm._scales = scales;\n    /* Use\n     * vm._config.x\n     * vm._config.xAxis.scale\n     * vm._config.y\n     * vm._config.yAxis.scale\n     * vm._data\n     */\n    //Normal bars \n    if (vm._config.hasOwnProperty('x') && vm._config.hasOwnProperty('y')) {\n      config = {\n        column: vm._config.x,\n        type: vm._config.xAxis.scale,\n        range: [0, vm.chart.width],\n        minZero: vm._config.xAxis.minZero\n      };\n      if (vm._config.xAxis.domains) {\n        config.domains = vm._config.xAxis.domains;\n      }\n      vm._scales.x = vm.utils.generateScale(vm._data, config);\n\n      config = {\n        column: vm._config.y,\n        type: vm._config.yAxis.scale,\n        range: [vm.chart.height, 0],\n        minZero: vm._config.yAxis.minZero\n      };\n      if (vm._config.yAxis.domains) {\n        config.domains = vm._config.yAxis.domains;\n      }\n      vm._scales.y = vm.utils.generateScale(vm._data, config);\n    }\n\n    //GroupBy bars on the xAxis\n    if (vm._config.hasOwnProperty('x') && vm._config.hasOwnProperty('groupBy')) {\n      /* Generate x scale */\n      config = {\n        column: vm._config.x,\n        type: vm._config.xAxis.scale,\n        groupBy: 'parent',\n        range: [0, vm.chart.width],\n        minZero: vm._config.xAxis.minZero\n      };\n      if (vm._config.xAxis.domains) {\n        config.domains = vm._config.xAxis.domains;\n      }\n      vm._scales.x = vm.utils.generateScale(vm._data, config);\n\n      /* Generate groupBy scale */\n      config = {\n        column: vm._config.groupBy,\n        type: 'band',\n        groupBy: 'children',\n        range: [0, vm._scales.x.bandwidth()],\n      };\n      vm._scales.groupBy = vm.utils.generateScale(vm._data, config);\n      //vm.chart.scales.groupBy = vm._scales.groupBy; \n\n      /* Generate y scale */\n      config = {\n        column: vm._config.groupBy,\n        type: vm._config.yAxis.scale,\n        groupBy: 'data',\n        range: [vm.chart.height, 0],\n        minZero: vm._config.yAxis.minZero,\n      };\n      if(vm._config.yAxis.domains) {\n        config.domains = vm._config.yAxis.domains;\n      }\n      vm._scales.y = vm.utils.generateScale(vm._data, config);\n    }\n\n    //GroupBy bars on the yAxis\n    if (vm._config.hasOwnProperty('y') && vm._config.hasOwnProperty('groupBy')) {\n      /* Generate y scale */\n      config = {\n        column: vm._config.y,\n        type: vm._config.yAxis.scale,\n        groupBy: 'parent',\n        range: [0, vm.chart.height],\n        minZero: vm._config.yAxis.minZero\n      };\n      if (vm._config.yAxis.domains) {\n        config.domains = vm._config.yAxis.domains;\n      }\n      vm._scales.y = vm.utils.generateScale(vm._data, config);\n\n      /* Generate groupBy scale */\n      config = {\n        column: vm._config.groupBy,\n        type: 'band',\n        groupBy: 'children',\n        range: [0, vm._scales.y.bandwidth()],\n      };\n      vm._scales.groupBy = vm.utils.generateScale(vm._data, config);\n      //vm.chart.scales.groupBy = vm._scales.groupBy; \n\n      /* Generate x scale */\n      config = {\n        column: vm._config.groupBy,\n        type: vm._config.xAxis.scale,\n        groupBy: 'data',\n        range: [0, vm.chart.width],\n        minZero: vm._config.xAxis.minZero\n      };\n      if (vm._config.xAxis.domains) {\n        config.domains = vm._config.xAxis.domains;\n      }\n      vm._scales.x = vm.utils.generateScale(vm._data, config);\n    }\n\n\n    //Stack bars on the xAxis\n    if (vm._config.hasOwnProperty('x') && vm._config.hasOwnProperty('stackBy')) {\n      /* Generate x scale */\n      config = {\n        column: vm._config.x,\n        type: vm._config.xAxis.scale,\n        stackBy: 'parent',\n        range: [0, vm.chart.width],\n        minZero: vm._config.xAxis.minZero\n      };\n      if (vm._config.xAxis.domains) {\n        config.domains = vm._config.xAxis.domains;\n      }\n      vm._scales.x = vm.utils.generateScale(vm._data, config);\n\n      /* Generate y scale */\n      config = {\n        column: '',\n        stackBy: 'data',\n        type: vm._config.yAxis.scale,\n        range: [vm.chart.height, 0],\n        minZero: vm._config.yAxis.minZero\n      };\n      if (vm._config.yAxis.domains) {\n        config.domains = vm._config.yAxis.domains;\n      }\n      vm._scales.y = vm.utils.generateScale(vm._data, config);\n    }\n\n    // Stack bars on the yAxis\n    if (vm._config.hasOwnProperty('y') && vm._config.hasOwnProperty('stackBy')) {\n      /* Generate x scale */\n      config = {\n        column: '',\n        type: vm._config.xAxis.scale,\n        stackBy: 'data',\n        range: [0, vm.chart.width],\n        minZero: vm._config.xAxis.minZero\n      };\n      if (vm._config.xAxis.domains) {\n        config.domains = vm._config.xAxis.domains;\n      }\n      vm._scales.x = vm.utils.generateScale(vm._data, config);\n\n      /* Generate y scale */\n      config = {\n        column: vm._config.y,\n        stackBy: 'parent',\n        type: vm._config.yAxis.scale,\n        range: [vm.chart.height, 0],\n        minZero: vm._config.yAxis.minZero\n      };\n      if (vm._config.yAxis.domains) {\n        config.domains = vm._config.yAxis.domains;\n      }\n      vm._scales.y = vm.utils.generateScale(vm._data, config);\n    }\n\n\n    //vm.chart.scales.x = vm._scales.x;\n    //vm.chart.scales.y = vm._scales.y;\n\n    if (vm._config.hasOwnProperty('colors'))\n      vm._scales.color = d3.scaleOrdinal(vm._config.colors);\n    else\n      vm._scales.color = d3.scaleOrdinal(d3.schemeCategory10);\n\n    return vm;\n  };\n\n  Bars.drawLabels = function () {\n    var vm = this;\n\n    var charContainer = vm.chart.svg().selectAll('.dbox-label')\n      .data(vm._data);\n\n    charContainer.enter().append('text')\n      .attr('class', 'dbox-label')\n      .attr('x', function (d) {\n        var value = vm._scales.x(d[vm._config.x]);\n        if (vm._config.xAxis.scale == 'linear') {\n          if (d[vm._config.x] > 0) {\n            value = vm._scales.x(0);\n          }\n        }\n        return value;\n      })\n      .attr('y', function (d) {\n        var value =  vm._scales.y(d[vm._config.y]);\n        var barH = vm._scales.y.bandwidth ? vm._scales.y.bandwidth() : Math.abs(vm._scales.y(d[vm._config.y]) - vm._scales.y(0));\n        if (vm._config.yAxis.scale === 'linear') {\n          if (d[vm._config.y] < 0) { \n            value = vm._scales.y(0);\n          }\n        } else if (vm._config.yAxis.scale !== 'linear') {\n          value = value + barH;\n        }\n        /*if (barH < 50) {\n          return value - 30;\n        }*/\n        return value - 7;\n      })\n      .attr('transform', function(d) {\n        var barW = vm._scales.x.bandwidth ? vm._scales.x.bandwidth() : Math.abs(vm._scales.x(d[vm._config.x]) - vm._scales.x(0));\n        if (!isNaN(d[vm._config.y])) {\n          return 'translate(' + barW/2 + ', 0)';\n        } \n        return 'translate(' + (barW + 30) + ', 0)';\n      })\n      .text( function(d) {\n        if (!isNaN(d[vm._config.y])) {\n          return vm.utils.format(d[vm._config.y]) ? vm.utils.format(d[vm._config.y], vm._config.decimals) : '';\n        }\n        return vm.utils.format(d[vm._config.x]) ? vm.utils.format(d[vm._config.x], vm._config.decimals) : '';\n      });\n    \n    charContainer.enter().append('text')\n      .attr('class', 'dbox-label-coefficient')\n      .attr('x', function (d) {\n        var value = vm._scales.x(d[vm._config.x]);\n        if (vm._config.xAxis.scale == 'linear') {\n          if (d[vm._config.x] > 0) {\n            value = vm._scales.x(0);\n          }\n        }\n        return value;\n      })\n      .attr('y', function (d) {\n        var value =  vm._scales.y(d[vm._config.y]);\n        var barH = vm._scales.y.bandwidth ? vm._scales.y.bandwidth() : Math.abs(vm._scales.y(d[vm._config.y]) - vm._scales.y(0));\n        if (vm._config.yAxis.scale === 'linear') {\n          if (d[vm._config.y] < 0) { \n            value = vm._scales.y(0);\n          }\n        }\n        if (barH < 50) {\n          return value - 10;\n        }\n        return value + 40;\n      })\n      .attr('transform', function(d) {\n        var barW = vm._scales.x.bandwidth ? vm._scales.x.bandwidth() : Math.abs(vm._scales.x(d[vm._config.x]) - vm._scales.x(0));\n        if (!isNaN(d[vm._config.y])) {\n          return 'translate(' + barW/2 + ', 0)';\n        } \n        return 'translate(' + (barW + 30) + ', 0)';\n      })\n      .text( function(d) {\n        return (d.coefficient && !Number.isNaN(d.coefficient)) ? '(' + d.coefficient.toFixed(1) + ')' : '(-)';\n      });\n  }\n\n  Bars.draw = function () {\n    var vm = this;\n\n    if (vm._config.hasOwnProperty('groupBy')) {\n      if (vm._config.hasOwnProperty('x')) vm._drawGroupByXAxis();\n      if (vm._config.hasOwnProperty('y')) vm._drawGroupByYAxis();\n      return vm;\n    }\n\n    if (vm._config.hasOwnProperty('stackBy')) {\n      if (vm._config.hasOwnProperty('x')) vm._drawStackByXAxis();\n      if (vm._config.hasOwnProperty('y')) vm._drawStackByYAxis();\n      return vm;\n    }\n\n    vm.chart.svg().call(vm._tip);\n\n    vm.chart.svg().selectAll('.bar')\n      .data(vm._data)\n      .enter().append('rect')\n      .attr('class', 'bar')\n      .attr('id', function (d, i) {\n        var id = 'bars-' + i;\n        if (vm._config.id) {\n          id = 'bars-' + d[vm._config.id];\n        }\n        return id;\n      })\n      .attr('x', function (d) {\n        var value = vm._scales.x(d[vm._config.x]);\n        if (vm._config.xAxis.scale == 'linear') {\n          if (d[vm._config.x] > 0) {\n            value = vm._scales.x(0);\n          }\n        }\n        return value;\n      })\n      .attr('y', function (d) {\n        var value =  vm._scales.y(d[vm._config.y]);\n        if (vm._config.yAxis.scale === 'linear') {\n          if (d[vm._config.y] < 0) { \n            value = vm._scales.y(0);\n          }\n        }\n        return value;\n      })\n      .attr('width', function (d) {\n        return vm._scales.x.bandwidth ? vm._scales.x.bandwidth() : Math.abs(vm._scales.x(d[vm._config.x]) - vm._scales.x(0));\n      })\n      .attr('height', function (d) {\n        return vm._scales.y.bandwidth ? vm._scales.y.bandwidth() : Math.abs(vm._scales.y(d[vm._config.y]) - vm._scales.y(0));\n      })\n      .attr('fill', function (d) {\n        return vm._scales.color !== false ? vm._scales.color(d[vm._config.fill]) : vm._getQuantileColor(d[vm._config.fill], 'default');\n      })\n      .style('opacity', 0.9)\n      .on('mouseover', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover colors\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'onHover');\n          });\n        }\n        vm._tip.show(d, d3.select(this).node());\n\n        if (vm._config.hasOwnProperty('onmouseover')) { //External function call, must be after all the internal code; allowing the user to overide \n          vm._config.onmouseover.call(this, d, i);\n        }\n\n      })\n      .on('mouseout', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover reset default color\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'default');\n          });\n        }\n        vm._tip.hide();\n\n        if (vm._config.hasOwnProperty('onmouseout')) { //External function call, must be after all the internal code; allowing the user to overide \n          vm._config.onmouseout.call(this, d, i);\n        }\n      })\n      .on('click', function (d, i) {\n        if (vm._config.hasOwnProperty('click')) {\n          vm._config.onclick.call(this, d, i);\n        }\n      });\n\n      Bars.drawLabels();\n\n    return vm;\n  };\n\n  /** \n   * Draw bars grouped by \n   */\n\n  Bars.drawGroupLabels = function () {\n    var vm = this;\n\n    vm.chart.svg().selectAll('.grouped').each(function(gr) {\n      var el = this;\n\n      d3.select(this).selectAll('rect').each(function(dat, index) {\n        d3.select(el).append('text')\n          .attr('class', 'dbox-label')\n          .attr('transform', function(d) {\n            var barReference = vm._scales.groupBy.bandwidth();\n            if(vm._config.x) {\n              //if (Math.abs(vm._scales.y(d[vm._config.groupBy[index]]) - vm._scales.y(0)) < 50) {\n              return 'translate(' + (vm._scales.groupBy(vm._config.groupBy[index]) + barReference/2) + ',' + (vm._scales.y(d[vm._config.groupBy[index]]) - 7) + ')';\n              //}\n              //return 'translate(' + (vm._scales.groupBy(vm._config.groupBy[index]) + 30) + ',' + (vm._scales.y(d[vm._config.groupBy[index]]) + 20) + ')';\n            } else {\n              return 'translate(' + ((vm._scales.x(d[vm._config.groupBy[index]]) + 26)) + ',' +  (vm._scales.groupBy(vm._config.groupBy[index]) + barReference) + ')';\n            }\n          })\n          .text( function(d) {\n            return d[vm._config.groupBy[index]] ? vm.utils.format(d[vm._config.groupBy[index]], vm._config.decimals) : '';\n          });\n\n        d3.select(el).append('text')\n          .attr('class', 'dbox-label-coefficient')\n          .attr('transform', function(d) {\n            if(vm._config.x) {\n              if (Math.abs(vm._scales.y(d[vm._config.groupBy[index]]) - vm._scales.y(0)) < 50) {\n                return 'translate(' + (vm._scales.groupBy(vm._config.groupBy[index]) + 30) + ',' + (vm._scales.y(d[vm._config.groupBy[index]])) + ')';\n              }\n              return 'translate(' + (vm._scales.groupBy(vm._config.groupBy[index]) + 30) + ',' + (vm._scales.y(d[vm._config.groupBy[index]]) + 40 ) + ')';\n            } else {\n              return 'translate(' + ((vm._scales.x(d[vm._config.groupBy[index]]) + 26)) + ',' +  (vm._scales.groupBy(vm._config.groupBy[index]) + 30) + ')';\n            }\n          })\n          .text( function(d) {\n            return d[vm._config.groupBy[index] + 'coefficient'] && !Number.isNaN(d[vm._config.groupBy[index] + 'coefficient'])  ? '(' + d[vm._config.groupBy[index] + 'coefficient'].toFixed(1) + ')': '';\n          });\n      });\n    });\n  }\n\n  Bars._drawGroupByXAxis = function () {\n    var vm = this;\n    console.log('_drawGroupByXAxis');\n    vm._tip.html(vm._config.tip || function (d) {\n      let html =  d.key + '<br>';\n      if (d.axis !== d.key) {\n        html += d.axis + '<br>';\n      }\n      html += vm.utils.format(d.value);\n      return html;\n    });\n\n    vm.chart.svg().call(vm._tip);\n\n    vm.chart.svg().append('g')\n      .selectAll('g')\n      .data(vm._data)\n      .enter().append('g')\n      .attr('class', 'grouped')\n      .attr('transform', function (d) {\n        return 'translate(' + vm._scales.x(d[vm._config.x]) + ',0)';\n      })\n      .selectAll('rect')\n      .data(function (d) {\n        return vm._config.groupBy.map(function (key) {\n          return {\n            key: key,\n            value: d[key],\n            axis: d[vm._config.x]\n          };\n        });\n      })\n      .enter().append('rect')\n      .attr('x', function (d) {\n        return vm._scales.groupBy(d.key);\n      })\n      .attr('y', function (d) {\n        if (d.value > 0) {\n          return vm._scales.y(d.value);\n        } else {\n          return vm._scales.y(0);\n        }\n      })\n      .attr('width', vm._scales.groupBy.bandwidth())\n      .attr('height', function (d) {\n        return Math.abs(vm._scales.y(d.value) - vm._scales.y(0));\n      })\n      .attr('fill', function (d) {\n        return vm._scales.color(d.key);\n      })\n      .on('mouseover', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover colors\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'onHover');\n          });\n        }\n        vm._tip.show(d, d3.select(this).node());\n\n        if (vm._config.hasOwnProperty('onmouseover')) {\n          //External function call. It must be after all the internal code; allowing the user to overide \n          vm._config.onmouseover.call(this, d, i);\n        }\n\n      })\n      .on('mouseout', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { // OnHover colors\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'default');\n          });\n        }\n        vm._tip.hide();\n\n        if (vm._config.hasOwnProperty('onmouseout')) { // External function call, must be after all the internal code; allowing the user to overide \n          vm._config.onmouseout.call(this, d, i);\n        }\n      })\n      .on('click', function (d, i) {\n        if (vm._config.hasOwnProperty('click')) {\n          vm._config.onclick.call(this, d, i);\n        }\n      });\n\n      Bars.drawGroupLabels();\n  };\n\n  Bars._drawGroupByYAxis = function () {\n    var vm = this;\n    console.log('_drawGroupByYAxis');\n    vm._tip.html(vm._config.tip || function (d) {\n      let html = d.key + '<br>';\n      if (d.axis !== d.key) {\n        html += d.axis + '<br>';\n      }\n      html += vm.utils.format(d.value);\n      return html;\n    });\n\n    vm.chart.svg().call(vm._tip);\n\n    vm.chart.svg().append('g')\n      .selectAll('g')\n      .data(vm._data)\n      .enter().append('g')\n      .attr('class', 'grouped')\n      .attr('transform', function (d) {\n        return 'translate(0,' + vm._scales.y(d[vm._config.y]) + ' )';\n      })\n      .selectAll('rect')\n      .data(function (d) {\n        return vm._config.groupBy.map(function (key) {\n          return {\n            key: key,\n            value: d[key],\n            axis: d[vm._config.y]\n          };\n        });\n      })\n      .enter().append('rect')\n      .attr('y', function (d) {\n        return vm._scales.groupBy(d.key);\n      })\n      .attr('x', function(d) {\n        if (d < 0) {\n          return vm._scales.x(d.value);\n        } else {\n          return vm._scales.x(0);\n        }\n      })\n      .attr('width', function (d) {\n        return Math.abs(vm._scales.x(d.value) - vm._scales.x(0));\n      })\n      .attr('height', vm._scales.groupBy.bandwidth())\n      .attr('fill', function (d) {\n        return vm._scales.color(d.key);\n      })\n      .on('mouseover', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover colors\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'onHover');\n          });\n        }\n        vm._tip.show(d, d3.select(this).node());\n\n        if (vm._config.hasOwnProperty('onmouseover')) {\n          //External function call. It must be after all the internal code; allowing the user to overide \n          vm._config.onmouseover.call(this, d, i);\n        }\n\n      })\n      .on('mouseout', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover reset default color\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'default');\n          });\n        }\n        vm._tip.hide();\n\n        if (vm._config.hasOwnProperty('onmouseout')) { //External function call, must be after all the internal code; allowing the user to overide \n          vm._config.onmouseout.call(this, d, i);\n        }\n      })\n      .on('click', function (d, i) {\n        if (vm._config.hasOwnProperty('click')) {\n          vm._config.onclick.call(this, d, i);\n        }\n      });\n\n      Bars.drawGroupLabels();\n  };\n\n  Bars.drawStackLabels = function () {\n    var vm = this;\n    console.log('stack labels');\n    vm.chart.svg().selectAll('.division').each(function(dat, index) {\n      d3.select(this).selectAll('.dbox-label').data(dat).enter().append('text')\n        .attr('class', 'dbox-label')\n        .attr('transform', function(d) {\n          var barReference;\n          if(vm._config.x) {\n            barReference = vm._scales.x.bandwidth();\n            return 'translate(' + (vm._scales.x(d.data[vm._config.x]) + barReference/2) + ',' + (vm._scales.y(d[1]) + 20) + ')';\n          }\n          barReference = vm._scales.y.bandwidth();\n          return 'translate(' + (vm._scales.x(d[1]) - 30) + ',' + (vm._scales.y(d.data[vm._config.y]) + barReference/2) + ')';\n        })\n        .text( function(d) {\n          return d.data[dat.key] ? vm.utils.format(d.data[dat.key], vm._config.decimals) : '';\n        });\n\n      d3.select(this).selectAll('.dbox-label-coefficient').data(dat).enter().append('text')\n        .attr('class', 'dbox-label-coefficient')\n        .attr('transform', function(d) {\n          if(vm._config.x) {\n            return 'translate(' + (vm._scales.x(d.data[vm._config.x]) + 50) + ',' + (vm._scales.y(d[1]) + 40) + ')';\n          }\n          return 'translate(' + (vm._scales.x(d[1]) - 60) + ',' + (vm._scales.y(d.data[vm._config.y]) + 50) + ')';\n        })\n        .text( function(d) {\n          return d.data[dat.key + 'coefficient'] && !Number.isNaN(d.data[dat.key + 'coefficient']) ? '(' + d.data[dat.key + 'coefficient'].toFixed(1) + ')' : '';\n        });\n    });\n\n  }\n\n  Bars._drawStackByXAxis = function () {\n    var vm = this;\n    console.log('_drawStackByXAxis');\n    vm._tip.html(vm._config.tip || function (d) {\n      var html = '';\n      for (var k in d.data) {\n        if ((d[1] - d[0]).toFixed(12) === Number(d.data[k]).toFixed(12)) {\n          html += k + '<br>';\n        }\n      }\n      html += d.data[vm._config.x];\n      return html + '<br>' + vm.utils.format((d[1] - d[0]));\n    });\n\n    vm.chart.svg().call(vm._tip);\n\n    vm.chart.svg().append('g')\n      .selectAll('g')\n      .data(vm._data)\n      .enter().append('g')\n      .attr('class', 'division')\n      .attr('fill', function (d) {\n        return vm._scales.color(d.key);\n      })\n      //.attr('transform', function(d) { return 'translate(0,'+ vm._scales.y(d[vm._config.y]) +' )'; })\n      .selectAll('rect')\n      .data(function (d) {\n        return d;\n      })\n      .enter().append('rect')\n      .attr('y', function (d) {\n        return vm._scales.y(d[1]);\n      })\n      .attr('x', function (d) {\n        return vm._scales.x(d.data[vm._config.x]);\n      })\n      .attr('width', function () {\n        return vm._scales.x.bandwidth();\n      })\n      .attr('height', function (d) {\n        return vm._scales.y(d[0]) - vm._scales.y(d[1]);\n      })\n      .on('mouseover', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover colors\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'onHover');\n          });\n        }\n        vm._tip.show(d, d3.select(this).node());\n\n        if (vm._config.hasOwnProperty('onmouseover')) {\n          //External function call. It must be after all the internal code; allowing the user to overide \n          vm._config.onmouseover.call(this, d, i);\n        }\n\n      })\n      .on('mouseout', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover reset default color\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'default');\n          });\n        }\n        vm._tip.hide();\n\n        if (vm._config.hasOwnProperty('onmouseout')) { //External function call, must be after all the internal code; allowing the user to overide \n          vm._config.onmouseout.call(this, d, i);\n        }\n      })\n      .on('click', function (d, i) {\n        if (vm._config.hasOwnProperty('click')) {\n          vm._config.onclick.call(this, d, i);\n        }\n      });\n\n      Bars.drawStackLabels();\n  };\n\n  Bars._drawStackByYAxis = function () {\n    var vm = this;\n    console.log('_drawStackByYAxis');\n    vm._tip.html(vm._config.tip || function (d) {\n      var html = '';\n      for (var k in d.data) {\n        if ((d[1] - d[0]).toFixed(12) === Number(d.data[k]).toFixed(12)) {\n          html += k + '<br>';\n        }\n      }\n      html += d.data[vm._config.y];\n      return html + '<br>' + vm.utils.format((d[1] - d[0]));\n    });\n\n    vm.chart.svg().call(vm._tip);\n\n    vm.chart.svg().append('g')\n      .selectAll('g')\n      .data(vm._data)\n      .enter().append('g')\n      .attr('class', 'division')\n      .attr('fill', function (d) {\n        return vm._scales.color(d.key);\n      })\n      .selectAll('rect')\n      .data(function (d) {\n        return d;\n      })\n      .enter().append('rect')\n      .attr('y', function (d) {\n        return vm._scales.y(d.data[vm._config.y]);\n      })\n      .attr('x', function (d) {\n        return vm._scales.x(d[0]);\n      })\n      .attr('height', function () {\n        return vm._scales.y.bandwidth();\n      })\n      .attr('width', function (d) {\n        return vm._scales.x(d[1]) - vm._scales.x(d[0]);\n      })\n      .on('mouseover', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover colors\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'onHover');\n          });\n        }\n        vm._tip.show(d, d3.select(this).node());\n\n        if (vm._config.hasOwnProperty('onmouseover')) {\n          //External function call. It must be after all the internal code; allowing the user to overide \n          vm._config.onmouseover.call(this, d, i);\n        }\n\n      })\n      .on('mouseout', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover reset default color\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'default');\n          });\n        }\n        vm._tip.hide();\n\n        if (vm._config.hasOwnProperty('onmouseout')) { //External function call, must be after all the internal code; allowing the user to overide \n          vm._config.onmouseout.call(this, d, i);\n        }\n      })\n      .on('click', function (d, i) {\n        if (vm._config.hasOwnProperty('click')) {\n          vm._config.onclick.call(this, d, i);\n        }\n      });\n\n      Bars.drawStackLabels();\n  };\n\n  Bars._setQuantile = function (data) {\n    var vm = this;\n    var values = [];\n    var quantile = [];\n\n    if (vm._config.quantiles && vm._config.quantiles.predefinedQuantiles &&\n      vm._config.quantiles.predefinedQuantiles.length > 0) {\n      return vm._config.quantiles.predefinedQuantiles;\n    }\n\n    data.forEach(function (d) {\n      values.push(+d[vm._config.fill]);\n    });\n\n    values.sort(d3.ascending);\n\n    //@TODO use quantile scale instead of manual calculations \n    if (vm._config && vm._config.quantiles && vm._config.quantiles.buckets) {\n\n      if (vm._config.quantiles.ignoreZeros === true) {\n        var aux = _.dropWhile(values, function (o) {\n          return o <= 0;\n        });\n        //aux.unshift(values[0]);  \n\n        quantile.push(values[0]);\n        quantile.push(0);\n\n        for (var i = 1; i <= vm._config.quantiles.buckets - 1; i++) {\n          quantile.push(d3.quantile(aux, i * 1 / (vm._config.quantiles.buckets - 1)));\n        }\n\n      } else {\n        quantile.push(d3.quantile(values, 0));\n        for (var j = 1; j <= vm._config.quantiles.buckets; j++) {\n          quantile.push(d3.quantile(values, j * 1 / vm._config.quantiles.buckets));\n        }\n      }\n\n    } else {\n      quantile = [d3.quantile(values, 0), d3.quantile(values, 0.2), d3.quantile(values, 0.4), d3.quantile(values, 0.6), d3.quantile(values, 0.8), d3.quantile(values, 1)];\n    }\n\n    //@TODO - VALIDATE WHEN ZEROS NEED TO BE PUT ON QUANTILE 1 AND RECALCULATE NON ZERO VALUES INTO THE REST OF THE BUCKETS\n    if (vm._config.quantiles && vm._config.quantiles.buckets && vm._config.quantiles.buckets === 5) {\n\n      if (quantile[1] === quantile[2] && quantile[2] === quantile[3] && quantile[3] === quantile[4] && quantile[4] === quantile[5]) {\n        quantile = [d3.quantile(values, 0), d3.quantile(values, 0.2)];\n      }\n    }\n\n    return quantile;\n  };\n\n  Bars._getQuantileColor = function (d, type) {\n    var vm = this;\n    var total = parseFloat(d);\n\n    //@TODO use quantile scale instead of manual calculations \n    if (vm._config && vm._config.bars.quantiles && vm._config.bars.quantiles.colors) {\n      if (vm._quantiles.length > 2) {\n\n        if (vm._config && vm._config.bars.min !== undefined && vm._config.bars.max !== undefined) {\n          if (total < vm._config.bars.min || total > vm._config.bars.max) {\n            return vm._config.bars.quantiles.outOfRangeColor;\n          }\n        } else {\n          if (total < vm._minMax[0] || total > vm._minMax[1]) {\n            return vm._config.bars.quantiles.outOfRangeColor;\n          }\n        }\n\n        if (type == 'default') {\n          if (total <= vm._quantiles[1]) {\n            return vm._config.bars.quantiles.colors[0]; //'#f7c7c5';\n          } else if (total <= vm._quantiles[2]) {\n            return vm._config.bars.quantiles.colors[1]; //'#e65158';\n          } else if (total <= vm._quantiles[3]) {\n            return vm._config.bars.quantiles.colors[2]; //'#c20216';\n          } else if (total <= vm._quantiles[4]) {\n            return vm._config.quantiles.colors[3]; //'#750000';\n          } else if (total <= vm._quantiles[5]) {\n            return vm._config.quantiles.colors[4]; //'#480000';\n          }\n        }\n\n        if (type == 'onHover' && vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) {\n          if (total <= vm._quantiles[1]) {\n            return vm._config.quantiles.colorsOnHover[0]; //'#f7c7c5';\n          } else if (total <= vm._quantiles[2]) {\n            return vm._config.quantiles.colorsOnHover[1]; //'#e65158';\n          } else if (total <= vm._quantiles[3]) {\n            return vm._config.quantiles.colorsOnHover[2]; //'#c20216';\n          } else if (total <= vm._quantiles[4]) {\n            return vm._config.quantiles.colorsOnHover[3]; //'#750000';\n          } else if (total <= vm._quantiles[5]) {\n            return vm._config.quantiles.colorsOnHover[4]; //'#480000';\n          }\n        }\n\n      }\n    }\n\n    if (vm._quantiles.length == 2) {\n      /*if(total === 0 ){\n        return d4theme.colors.quantiles[0];//return '#fff';\n      }else if(total <= vm._quantiles[1]){\n        return d4theme.colors.quantiles[1];//return '#f7c7c5';\n      }*/\n      if (total <= vm._quantiles[1]) {\n        return vm._config.quantiles.colors[0]; //'#f7c7c5';\n      }\n    }\n\n  };\n\n  Bars.init(config);\n  return Bars;\n}\n","import * as d3 from 'd3';\n/**\n * @fileOverview A D3 based distribution chart system. Supports: Box plots, Violin plots, Notched box plots, trend lines, beeswarm plot\n * @version 3.0\n */\n\n\n/**\n * Creates a box plot, violin plot, and or notched box plot\n * @param settings Configuration options for the base plot\n * @param settings.data The data for the plot\n * @param settings.xName The name of the column that should be used for the x groups\n * @param settings.yName The name of the column used for the y values\n * @param {string} settings.selector The selector string for the main chart div\n * @param [settings.axisLabels={}] Defaults to the xName and yName\n * @param [settings.yTicks = 1] 1 = default ticks. 2 =  double, 0.5 = half\n * @param [settings.scale='linear'] 'linear' or 'log' - y scale of the chart\n * @param [settings.chartSize={width:800, height:400}] The height and width of the chart itself (doesn't include the container)\n * @param [settings.margin={top: 15, right: 60, bottom: 40, left: 50}] The margins around the chart (inside the main div)\n * @param [settings.constrainExtremes=false] Should the y scale include outliers?\n * @returns {object} chart A chart object\n */\nexport default function makeDistroChart(settings) {\n\n    var chart = {};\n\n    // Defaults\n    chart.settings = {\n      data: null,\n      id: null,\n      idName: null,\n      events: null,\n      xName: null,\n      xSort:null,\n      yName: null,\n      selector: null,\n      axisLables: null,\n      yTicks: 1,\n      scale: 'linear',\n      chartSize: {width: 800, height: 400},\n      margin: {top: 15, right: 60, bottom: 40, left: 50},\n      constrainExtremes: false,\n      color: d3.scaleOrdinal(d3.schemeCategory10)\n    };\n    for (var setting in settings) {\n      chart.settings[setting] = settings[setting]\n    }\n\n\n    function formatAsFloat(d) {\n      if (d % 1 !== 0) {\n        return d3.format(\",.2f\")(d);\n      } else {\n        return d3.format(\",.0f\")(d);\n      }\n    }\n    function formatNumber(d) {\n      var value = '';\n        if (d % 1 == 0) {\n        value = d3.format(',.0f')(d);\n        } else if (d < 1 && d > 0) {\n        value = d3.format(',.2f')(d);\n        } else {\n        value = d3.format(',.1f')(d);\n        }\n        return value;\n    }\n\n    function formatRange(d) {\n        var range = d.split(' - ');\n        var value = '';\n        for(var i = 0; i < range.length; i++){\n          if (range[i] % 1 == 0) {\n            value += d3.format(',.0f')(range[i]);\n          } else if (range[i] < 1 && range[i] > 0) {\n            value += d3.format(',.2f')(range[i]);\n          } else {\n            value += d3.format(',.1f')(range[i]);\n          }\n          if (i === 0) {\n            value += ' - ';\n          }\n        }\n        return value;\n      }\n\n    function logFormatNumber(d) {\n      var x = Math.log(d) / Math.log(10) + 1e-6;\n      return Math.abs(x - Math.floor(x)) < 0.6 ? formatAsFloat(d) : \"\";\n    }\n\n    chart.yFormatter = formatNumber;\n    chart.xFormatter = formatRange;\n\n    chart.data = chart.settings.data;\n\n    chart.groupObjs = {}; //The data organized by grouping and sorted as well as any metadata for the groups\n    chart.objs = {mainDiv: null, chartDiv: null, g: null, xAxis: null, yAxis: null};\n    chart.colorFunct = null;\n\n    /**\n     * Takes an array, function, or object mapping and created a color function from it\n     * @param {function|[]|object} colorOptions\n     * @returns {function} Function to be used to determine chart colors\n     */\n    function getColorFunct(colorOptions) {\n        if (typeof colorOptions == 'function') {\n            return colorOptions\n        } else if (Array.isArray(colorOptions)) {\n            //  If an array is provided, map it to the domain\n            var colorMap = {}, cColor = 0;\n            /* @TODO - REVIEW PREVIOUS CODE \n            for (var cName in chart.groupObjs) {\n                debugger;\n                colorMap[cName] = colorOptions[cColor];\n                cColor = (cColor + 1) % colorOptions.length;\n            }*/\n            if (Array.isArray(chart.settings.xSort)){\n                chart.settings.xSort.forEach(function(key, index){\n                    colorMap[key] = colorOptions[index];\n                })\n            }else{\n                Object.keys(chart.groupObjs).sort(d3.ascending).forEach(function(key, index){\n                    colorMap[key] = colorOptions[index];\n                })\n            }\n            return function (group) {\n                return colorMap[group];\n            }\n        } else if (typeof colorOptions == 'object') {\n            // if an object is provided, assume it maps to  the colors\n            return function (group) {\n                return colorOptions[group];\n            }\n        } else {\n            return d3.scaleOrdinal(d3.schemeCategory10);\n        }\n    }\n\n    /**\n     * Takes a percentage as returns the values that correspond to that percentage of the group range witdh\n     * @param objWidth Percentage of range band\n     * @param gName The bin name to use to get the x shift\n     * @returns {{left: null, right: null, middle: null}}\n     */\n    function getObjWidth(objWidth, gName) {\n        var objSize = {left: null, right: null, middle: null};\n        var width = chart.xScale.bandwidth() * (objWidth / 100);\n        var padding = (chart.xScale.bandwidth() - width) / 2;\n        var gShift = chart.xScale(gName);\n        objSize.middle = chart.xScale.bandwidth() / 2 + gShift;\n        objSize.left = padding + gShift;\n        objSize.right = objSize.left + width;\n        return objSize;\n    }\n\n    /**\n     * Adds jitter to the  scatter point plot\n     * @param doJitter true or false, add jitter to the point\n     * @param width percent of the range band to cover with the jitter\n     * @returns {number}\n     */\n    function addJitter(doJitter, width) {\n        if (doJitter !== true || width == 0) {\n            return 0\n        }\n        return Math.floor(Math.random() * width) - width / 2;\n    }\n\n    function shallowCopy(oldObj) {\n        var newObj = {};\n        for (var i in oldObj) {\n            if (oldObj.hasOwnProperty(i)) {\n                newObj[i] = oldObj[i];\n            }\n        }\n        return newObj;\n    }\n\n    /**\n     * Closure that creates the tooltip hover function\n     * @param groupName Name of the x group\n     * @param metrics Object to use to get values for the group\n     * @returns {Function} A function that provides the values for the tooltip\n     */\n    function tooltipHover(groupName, metrics, pointName = '', pointValue = undefined, boxpart = '') {\n        var tooltipString = pointName;\n        tooltipString += pointValue ? '<br>' + pointValue.toLocaleString() + '<br><hr style=\"height: 1px; background-color: #ADADAE; border: none; margin: 0.5em;\">': '';\n        tooltipString += groupName;\n        tooltipString += boxpart ? '' : \"<br\\>Max: \" + formatAsFloat(metrics.max, 0.1);\n        tooltipString += boxpart ? '' : \"<br\\>Q3: \" + formatAsFloat(metrics.quartile3);\n        tooltipString += boxpart ? boxpart === 'mean' ? \"<br\\>Media: \" + formatAsFloat(metrics.mean) : '' : \"<br\\>Media: \" + formatAsFloat(metrics.mean);\n        tooltipString += boxpart ? boxpart  === 'median' ? \"<br\\>Mediana: \" + formatAsFloat(metrics.median) : '' : \"<br\\>Mediana: \" + formatAsFloat(metrics.median);\n        tooltipString += boxpart ? '' : \"<br\\>Q1: \" + formatAsFloat(metrics.quartile1);\n        tooltipString += boxpart ? '' : \"<br\\>Min: \" + formatAsFloat(metrics.min);\n        return function () {\n            chart.objs.tooltip.transition().duration(200).style(\"opacity\", 0.8);\n            chart.objs.tooltip.html(tooltipString)\n        };\n    }\n\n    function idSelection(id) {\n        console.log('this ', id, 'is selected');\n        chart.objs.mainDiv.select('.point.distro-' + id).attr('class', 'active');\n    };\n\n    //chart.idSelect = idSelection;\n\n    /**\n     * Parse the data and calculates base values for the plots\n     */\n    !function prepareData() {\n        function calcMetrics(values) {\n\n            var metrics = { //These are the original nonscaled values\n                max: null,\n                upperOuterFence: null,\n                upperInnerFence: null,\n                quartile3: null,\n                median: null,\n                mean: null,\n                iqr: null,\n                quartile1: null,\n                lowerInnerFence: null,\n                lowerOuterFence: null,\n                min: null\n            };\n\n            metrics.min = d3.min(values);\n            metrics.quartile1 = d3.quantile(values, 0.25);\n            metrics.median = d3.median(values);\n            metrics.mean = d3.mean(values);\n            metrics.quartile3 = d3.quantile(values, 0.75);\n            metrics.max = d3.max(values);\n            metrics.iqr = metrics.quartile3 - metrics.quartile1;\n\n            //The inner fences are the closest value to the IQR without going past it (assumes sorted lists)\n            var LIF = metrics.quartile1 - (1.5 * metrics.iqr);\n            var UIF = metrics.quartile3 + (1.5 * metrics.iqr);\n            for (var i = 0; i <= values.length; i++) {\n                if (values[i] < LIF) {\n                    continue;\n                }\n                if (!metrics.lowerInnerFence && values[i] >= LIF) {\n                    metrics.lowerInnerFence = values[i];\n                    continue;\n                }\n                if (values[i] > UIF) {\n                    metrics.upperInnerFence = values[i - 1];\n                    break;\n                }\n            }\n\n\n            metrics.lowerOuterFence = metrics.quartile1 - (3 * metrics.iqr);\n            metrics.upperOuterFence = metrics.quartile3 + (3 * metrics.iqr);\n            if (!metrics.lowerInnerFence) {\n                metrics.lowerInnerFence = metrics.min;\n            }\n            if (!metrics.upperInnerFence) {\n                metrics.upperInnerFence = metrics.max;\n            }\n            return metrics\n        }\n\n        var current_x = null;\n        var current_y = null;\n        var current_id = null;\n        var current_idName = null;\n        var current_row;\n\n        // Group the values\n        for (current_row = 0; current_row < chart.data.length; current_row++) {\n            current_x = chart.data[current_row][chart.settings.xName];\n            current_y = chart.data[current_row][chart.settings.yName];\n            current_id = chart.settings.id ? chart.data[current_row][chart.settings.id] : null;\n            current_idName = chart.settings.idName ? chart.data[current_row][chart.settings.idName] : null;\n\n            if (chart.groupObjs.hasOwnProperty(current_x)) {\n                if (chart.settings.id) {\n                    chart.groupObjs[current_x].valuesInfo.push({\n                        value: current_y,\n                        id: current_id,\n                        idName: current_idName\n                    });\n                } else{\n                    chart.groupObjs[current_x].values.push(current_y);\n                }\n            } else {\n                if (chart.settings.id) {\n                    chart.groupObjs[current_x] = {};\n                    chart.groupObjs[current_x].valuesInfo = [{\n                        value: current_y,\n                        id: current_id,\n                        idName: current_idName\n                    }];\n                } else{\n                    chart.groupObjs[current_x] = {};\n                    chart.groupObjs[current_x].values = [current_y];\n                }\n            }\n\n\n            //original\n            /*if (chart.groupObjs.hasOwnProperty(current_x)) {\n                chart.groupObjs[current_x].values.push(current_y);\n            } else {\n                chart.groupObjs[current_x] = {};\n                chart.groupObjs[current_x].values = [current_y];\n            }*/\n        }\n\n        for (var cName in chart.groupObjs) {\n            if (chart.settings.id) {\n                chart.groupObjs[cName].values = [];\n                //in order to keep the array chart.groupObjs[cName].values \n                for (let index = 0; index < chart.groupObjs[cName].valuesInfo.length; index++){\n                    chart.groupObjs[cName].values.push(chart.groupObjs[cName].valuesInfo[index].value);\n                }\n\n                chart.groupObjs[cName].valuesInfo.sort(function(x,y) { return d3.ascending(x.value, y.value) });\n            }\n\n            //original\n            chart.groupObjs[cName].values.sort(d3.ascending);\n            chart.groupObjs[cName].metrics = {};\n            chart.groupObjs[cName].metrics =  calcMetrics(chart.groupObjs[cName].values);\n        }\n    }();\n\n    /**\n     * Prepare the chart settings and chart div and svg\n     */\n    !function prepareSettings() {\n        var domain = ''; \n        //Set base settings\n        chart.margin = chart.settings.margin;\n        chart.divWidth = chart.settings.chartSize.width;\n        chart.divHeight = chart.settings.chartSize.height;\n        chart.width = chart.divWidth - chart.margin.left - chart.margin.right;\n        chart.height = chart.divHeight - chart.margin.top - chart.margin.bottom;\n\n        if (chart.settings.axisLabels) {\n            chart.xAxisLable = chart.settings.axisLabels.xAxis;\n            chart.yAxisLable = chart.settings.axisLabels.yAxis;\n        } else {\n            chart.xAxisLable = chart.settings.xName;\n            chart.yAxisLable = chart.settings.yName;\n        }\n\n        if (chart.settings.scale === 'log') {\n            chart.yScale = d3.scaleLog();\n            chart.yFormatter = logFormatNumber;\n        } else {\n            chart.yScale = d3.scaleLinear();\n        }\n\n        if (chart.settings.constrainExtremes === true) {\n            var fences = [];\n            for (var cName in chart.groupObjs) {\n                fences.push(chart.groupObjs[cName].metrics.lowerInnerFence);\n                fences.push(chart.groupObjs[cName].metrics.upperInnerFence);\n            }\n            chart.range = d3.extent(fences);\n\n        } else {\n            chart.range = d3.extent(chart.data, function (d) {return d[chart.settings.yName];});\n        }\n\n        chart.colorFunct = getColorFunct(chart.settings.colors);\n\n        // Build Scale functions\n        chart.yScale.range([chart.height, 0]).domain(chart.range).nice().clamp(true);\n        \n        if (chart.settings.xSort === null) {\n            domain = Object.keys(chart.groupObjs)\n        } else {\n            domain = Array.isArray(chart.settings.xSort) ? chart.settings.xSort : Object.keys(chart.groupObjs).sort(d3.ascending)\n        }\n        chart.xScale = d3.scaleBand().domain(domain).rangeRound([0, chart.width]);\n\n        //Build Axes Functions\n        chart.objs.yAxis = d3.axisLeft()\n            .scale(chart.yScale)\n            .tickFormat(chart.yFormatter)\n            .tickSizeOuter(0)\n            .tickSizeInner(-chart.width + (chart.margin.right + chart.margin.left));\n        //chart.objs.yAxis.ticks(chart.objs.yAxis.ticks()*chart.settings.yTicks);\n        chart.objs.xAxis = d3.axisBottom()\n            .scale(chart.xScale)\n            //.tickFormat(chart.xFormatter)\n            .tickSizeOuter(0)\n            .tickSize(5); \n    }();\n\n    /**\n     * Updates the chart based on the current settings and window size\n     * @returns {*}\n     */\n    chart.update = function () {\n        // Update chart size based on view port size\n        chart.width = parseInt(chart.objs.chartDiv.style(\"width\"), 10) - (chart.margin.left + chart.margin.right);\n        chart.height = parseInt(chart.objs.chartDiv.style(\"height\"), 10) - (chart.margin.top + chart.margin.bottom);\n        // Update scale functions\n        chart.xScale.rangeRound([0, chart.width]);\n        chart.yScale.range([chart.height, 0]);\n\n        // Update the yDomain if the Violin plot clamp is set to -1 meaning it will extend the violins to make nice points\n        if (chart.violinPlots && chart.violinPlots.options.show == true && chart.violinPlots.options._yDomainVP != null) {\n            chart.yScale.domain(chart.violinPlots.options._yDomainVP).nice().clamp(true);\n        } else {\n            chart.yScale.domain(chart.range).nice().clamp(true);\n        }\n\n        //Update axes\n        chart.objs.g.select('.x.axis').attr(\"transform\", \"translate(0,\" + chart.height + \")\").call(chart.objs.xAxis)\n            .selectAll(\".tick text\")\n            .attr(\"y\", 5)\n            .attr(\"x\", -5)\n            .attr(\"transform\", \"rotate(-40)\")\n            .style(\"text-anchor\", \"end\");\n        chart.objs.g.select('.x.axis .label').attr(\"x\", chart.width / 2);\n        chart.objs.g.select('.y.axis').call(chart.objs.yAxis.tickSizeInner(-chart.width));\n        chart.objs.g.select('.y.axis .label').attr(\"x\", -chart.height / 2);\n        chart.objs.chartDiv.select('svg').attr(\"width\", chart.width + (chart.margin.left + chart.margin.right)).attr(\"height\", chart.height + (chart.margin.top + chart.margin.bottom));\n\n        return chart;\n    };\n\n    /**\n     * Prepare the chart html elements\n     */\n    !function prepareChart() {\n      // Build main div and chart div\n      chart.objs.mainDiv = d3.select(chart.settings.selector)\n        .style(\"width\", chart.divWidth + \"px\")\n        .style(\"height\", chart.divHeight+ \"px\");\n      // Add all the divs to make it centered and responsive\n      chart.objs.mainDiv.append(\"div\")\n        .attr(\"class\", \"inner-wrapper\")\n        .style(\"padding-bottom\", \"5%\")\n        .style(\"height\", chart.divHeight + \"px\")\n        .append(\"div\").attr(\"class\", \"outer-box\")\n        .append(\"div\").attr(\"class\", \"inner-box\");\n      // Capture the inner div for the chart (where the chart actually is)\n      chart.selector = chart.settings.selector + \" .inner-box\";   \n      chart.objs.chartDiv = d3.select(chart.selector);\n      d3.select(window).on('resize.' + chart.selector, chart.update);\n\n      // Create the svg\n      chart.objs.g = chart.objs.chartDiv.append(\"svg\")\n        .attr(\"class\", \"chart-area\")\n        .attr(\"width\", chart.width + (chart.margin.left + chart.margin.right))\n        .attr(\"height\", chart.height + (chart.margin.top + chart.margin.bottom))\n        .append(\"g\")\n        .attr(\"transform\", \"translate(\" + chart.margin.left + \",\" + chart.margin.top + \")\");\n      \n      // Create axes\n      chart.objs.axes = chart.objs.g.append(\"g\").attr(\"class\", \"axis\");\n      chart.objs.axes.append(\"g\")\n          .attr(\"class\", \"x axis\")\n          .attr(\"transform\", \"translate(0,\" + chart.height + \")\")\n          .call(chart.objs.xAxis)\n          .append(\"text\")\n          .attr(\"class\", \"label\")\n          .attr(\"y\", chart.margin.bottom - 20)\n          .attr(\"x\", -chart.width / 2)\n          .attr(\"dy\", \".71em\")\n          .attr('fill', '#fff')\n          .style(\"text-anchor\", \"middle\")\n          .text(chart.xAxisLable);\n\n      chart.objs.axes.append(\"g\")\n          .attr(\"class\", \"y axis\")\n          .call(chart.objs.yAxis)\n          .append(\"text\")\n          .attr(\"class\", \"label\")\n          .attr(\"transform\", \"rotate(-90)\")\n          .attr(\"y\", -chart.margin.left * 0.9)\n          .attr(\"x\", -chart.height / 2)\n          .attr(\"dy\", \".71em\")\n          .attr('fill', '#fff')\n          .style(\"text-anchor\", \"middle\")\n          .text(chart.yAxisLable);\n\n      // Create tooltip div\n      chart.objs.tooltip = chart.objs.mainDiv.append('div').attr('class', 'tooltip').style(\"display\", \"none\");\n      for (var cName in chart.groupObjs) {\n          chart.groupObjs[cName].g = chart.objs.g.append(\"g\").attr(\"class\", \"group\");\n          /*chart.groupObjs[cName].g.on(\"mouseover\", function () {\n              chart.objs.tooltip\n                  .style(\"display\", null)\n                  .style(\"left\", (d3.event.pageX) + \"px\")\n                  .style(\"top\", (d3.event.pageY - 28) + \"px\");\n          }).on(\"mouseout\", function () {\n            chart.objs.tooltip.style(\"display\", \"none\");\n          }).on(\"mousemove\", tooltipHover(cName, chart.groupObjs[cName].metrics));*/\n      }\n      chart.update();\n    }();\n\n    /**\n     * Render a violin plot on the current chart\n     * @param options\n     * @param [options.showViolinPlot=true] True or False, show the violin plot\n     * @param [options.resolution=100 default]\n     * @param [options.bandwidth=10 default] May need higher bandwidth for larger data sets\n     * @param [options.width=50] The max percent of the group rangeBand that the violin can be\n     * @param [options.curve=''] How to render the violin\n     * @param [options.clamp=0 default]\n     *   0 = keep data within chart min and max, clamp once data = 0. May extend beyond data set min and max\n     *   1 = clamp at min and max of data set. Possibly no tails\n     *  -1 = extend chart axis to make room for data to interpolate to 0. May extend axis and data set min and max\n     * @param [options.colors=chart default] The color mapping for the violin plot\n     * @returns {*} The chart object\n     */\n    chart.renderViolinPlot = function (options) {\n        chart.violinPlots = {};\n\n        var defaultOptions = {\n            show: true,\n            showViolinPlot: true,\n            resolution: 100,\n            bandwidth: 20,\n            width: 50,\n            curve: d3.curveCardinal,\n            clamp: 1,\n            colors: chart.colorFunct,\n            _yDomainVP: null // If the Violin plot is set to close all violin plots, it may need to extend the domain, that extended domain is stored here\n        };\n        chart.violinPlots.options = shallowCopy(defaultOptions);\n        for (var option in options) {\n            chart.violinPlots.options[option] = options[option]\n        }\n        var vOpts = chart.violinPlots.options;\n\n        // Create violin plot objects\n        for (var cName in chart.groupObjs) {\n            chart.groupObjs[cName].violin = {};\n            chart.groupObjs[cName].violin.objs = {};\n        }\n\n        /**\n         * Take a new set of options and redraw the violin\n         * @param updateOptions\n         */\n        chart.violinPlots.change = function (updateOptions) {\n            if (updateOptions) {\n                for (var key in updateOptions) {\n                    vOpts[key] = updateOptions[key]\n                }\n            }\n\n            for (var cName in chart.groupObjs) {\n                chart.groupObjs[cName].violin.objs.g.remove()\n            }\n\n            chart.violinPlots.prepareViolin();\n            chart.violinPlots.update();\n        };\n\n        chart.violinPlots.reset = function () {\n            chart.violinPlots.change(defaultOptions)\n        };\n        chart.violinPlots.show = function (opts) {\n            if (opts !== undefined) {\n                opts.show = true;\n                if (opts.reset) {\n                    chart.violinPlots.reset()\n                }\n            } else {\n                opts = {show: true};\n            }\n            chart.violinPlots.change(opts);\n\n        };\n\n        chart.violinPlots.hide = function (opts) {\n            if (opts !== undefined) {\n                opts.show = false;\n                if (opts.reset) {\n                    chart.violinPlots.reset()\n                }\n            } else {\n                opts = {show: false};\n            }\n            chart.violinPlots.change(opts);\n\n        };\n\n        /**\n         * Update the violin obj values\n         */\n        chart.violinPlots.update = function () {\n            var cName, cViolinPlot;\n\n            for (cName in chart.groupObjs) {\n                cViolinPlot = chart.groupObjs[cName].violin;\n\n                // Build the violins sideways, so use the yScale for the xScale and make a new yScale\n                var xVScale = chart.yScale.copy();\n\n\n                // Create the Kernel Density Estimator Function\n                cViolinPlot.kde = kernelDensityEstimator(eKernel(vOpts.bandwidth), xVScale.ticks(vOpts.resolution));\n                cViolinPlot.kdedata = cViolinPlot.kde(chart.groupObjs[cName].values);\n\n                var interpolateMax = chart.groupObjs[cName].metrics.max,\n                    interpolateMin = chart.groupObjs[cName].metrics.min;\n\n                if (vOpts.clamp == 0 || vOpts.clamp == -1) { //\n                    // When clamp is 0, calculate the min and max that is needed to bring the violin plot to a point\n                    // interpolateMax = the Minimum value greater than the max where y = 0\n                    interpolateMax = d3.min(cViolinPlot.kdedata.filter(function (d) {\n                        return (d.x > chart.groupObjs[cName].metrics.max && d.y == 0)\n                    }), function (d) {\n                        return d.x;\n                    });\n                    // interpolateMin = the Maximum value less than the min where y = 0\n                    interpolateMin = d3.max(cViolinPlot.kdedata.filter(function (d) {\n                        return (d.x < chart.groupObjs[cName].metrics.min && d.y == 0)\n                    }), function (d) {\n                        return d.x;\n                    });\n                    // If clamp is -1 we need to extend the axises so that the violins come to a point\n                    if (vOpts.clamp == -1) {\n                        kdeTester = eKernelTest(eKernel(vOpts.bandwidth), chart.groupObjs[cName].values);\n                        if (!interpolateMax) {\n                            var interMaxY = kdeTester(chart.groupObjs[cName].metrics.max);\n                            var interMaxX = chart.groupObjs[cName].metrics.max;\n                            var count = 25; // Arbitrary limit to make sure we don't get an infinite loop\n                            while (count > 0 && interMaxY != 0) {\n                                interMaxY = kdeTester(interMaxX);\n                                interMaxX += 1;\n                                count -= 1;\n                            }\n                            interpolateMax = interMaxX;\n                        }\n                        if (!interpolateMin) {\n                            var interMinY = kdeTester(chart.groupObjs[cName].metrics.min);\n                            var interMinX = chart.groupObjs[cName].metrics.min;\n                            var count = 25;  // Arbitrary limit to make sure we don't get an infinite loop\n                            while (count > 0 && interMinY != 0) {\n                                interMinY = kdeTester(interMinX);\n                                interMinX -= 1;\n                                count -= 1;\n                            }\n                            interpolateMin = interMinX;\n                        }\n\n                    }\n                    // Check to see if the new values are outside the existing chart range\n                    //   If they are assign them to the master _yDomainVP\n                    if (!vOpts._yDomainVP) vOpts._yDomainVP = chart.range.slice(0);\n                    if (interpolateMin && interpolateMin < vOpts._yDomainVP[0]) {\n                        vOpts._yDomainVP[0] = interpolateMin;\n                    }\n                    if (interpolateMax && interpolateMax > vOpts._yDomainVP[1]) {\n                        vOpts._yDomainVP[1] = interpolateMax;\n                    }\n\n\n                }\n\n\n                if (vOpts.showViolinPlot) {\n                    chart.update();\n                    xVScale = chart.yScale.copy();\n\n                    // Need to recalculate the KDE because the xVScale changed\n                    cViolinPlot.kde = kernelDensityEstimator(eKernel(vOpts.bandwidth), xVScale.ticks(vOpts.resolution));\n                    cViolinPlot.kdedata = cViolinPlot.kde(chart.groupObjs[cName].values);\n                }\n\n                cViolinPlot.kdedata = cViolinPlot.kdedata\n                    .filter(function (d) {\n                        return (!interpolateMin || d.x >= interpolateMin)\n                    })\n                    .filter(function (d) {\n                        return (!interpolateMax || d.x <= interpolateMax)\n                    });\n            }\n            for (cName in chart.groupObjs) {\n                cViolinPlot = chart.groupObjs[cName].violin;\n\n                // Get the violin width\n                var objBounds = getObjWidth(vOpts.width, cName);\n                var width = (objBounds.right - objBounds.left) / 2;\n\n                var yVScale = d3.scaleLinear()\n                    .range([width, 0])\n                    .domain([0, d3.max(cViolinPlot.kdedata, function (d) {return d.y;})])\n                    .clamp(true);\n\n                var area = d3.area()\n                    .curve(vOpts.curve)\n                    .x(function (d) {return xVScale(d.x);})\n                    .y0(width)\n                    .y1(function (d) {return yVScale(d.y);});\n\n                var line = d3.line()\n                    .curve(vOpts.curve)\n                    .x(function (d) {return xVScale(d.x);})\n                    .y(function (d) {return yVScale(d.y)});\n\n                if (cViolinPlot.objs.left.area) {\n                    cViolinPlot.objs.left.area\n                        .datum(cViolinPlot.kdedata)\n                        .attr(\"d\", area);\n                    cViolinPlot.objs.left.line\n                        .datum(cViolinPlot.kdedata)\n                        .attr(\"d\", line);\n\n                    cViolinPlot.objs.right.area\n                        .datum(cViolinPlot.kdedata)\n                        .attr(\"d\", area);\n                    cViolinPlot.objs.right.line\n                        .datum(cViolinPlot.kdedata)\n                        .attr(\"d\", line);\n                }\n\n                // Rotate the violins\n                cViolinPlot.objs.left.g.attr(\"transform\", \"rotate(90,0,0)   translate(0,-\" + objBounds.left + \")  scale(1,-1)\");\n                cViolinPlot.objs.right.g.attr(\"transform\", \"rotate(90,0,0)  translate(0,-\" + objBounds.right + \")\");\n            }\n        };\n\n        /**\n         * Create the svg elements for the violin plot\n         */\n        chart.violinPlots.prepareViolin = function () {\n            var cName, cViolinPlot;\n\n            if (vOpts.colors) {\n                chart.violinPlots.color = getColorFunct(vOpts.colors);\n            } else {\n                chart.violinPlots.color = chart.colorFunct\n            }\n\n            if (vOpts.show == false) {return}\n\n            for (cName in chart.groupObjs) {\n                cViolinPlot = chart.groupObjs[cName].violin;\n\n                cViolinPlot.objs.g = chart.groupObjs[cName].g.append(\"g\").attr(\"class\", \"violin-plot\");\n                cViolinPlot.objs.left = {area: null, line: null, g: null};\n                cViolinPlot.objs.right = {area: null, line: null, g: null};\n\n                cViolinPlot.objs.left.g = cViolinPlot.objs.g.append(\"g\");\n                cViolinPlot.objs.right.g = cViolinPlot.objs.g.append(\"g\");\n\n                if (vOpts.showViolinPlot !== false) {\n                    //Area\n                    cViolinPlot.objs.left.area = cViolinPlot.objs.left.g.append(\"path\")\n                        .attr(\"class\", \"area\")\n                        .style(\"fill\", chart.violinPlots.color(cName));\n                    cViolinPlot.objs.right.area = cViolinPlot.objs.right.g.append(\"path\")\n                        .attr(\"class\", \"area\")\n                        .style(\"fill\", chart.violinPlots.color(cName));\n\n                    //Lines\n                    cViolinPlot.objs.left.line = cViolinPlot.objs.left.g.append(\"path\")\n                        .attr(\"class\", \"line\")\n                        .attr(\"fill\", 'none')\n                        .style(\"stroke\", chart.violinPlots.color(cName));\n                    cViolinPlot.objs.right.line = cViolinPlot.objs.right.g.append(\"path\")\n                        .attr(\"class\", \"line\")\n                        .attr(\"fill\", 'none')\n                        .style(\"stroke\", chart.violinPlots.color(cName));\n                }\n\n            }\n\n        };\n\n\n        function kernelDensityEstimator(kernel, x) {\n            return function (sample) {\n                return x.map(function (x) {\n                    return {x:x, y:d3.mean(sample, function (v) {return kernel(x - v);})};\n                });\n            };\n        }\n\n        function eKernel(scale) {\n            return function (u) {\n                return Math.abs(u /= scale) <= 1 ? .75 * (1 - u * u) / scale : 0;\n            };\n        }\n\n        // Used to find the roots for adjusting violin axis\n        // Given an array, find the value for a single point, even if it is not in the domain\n        function eKernelTest(kernel, array) {\n            return function (testX) {\n                return d3.mean(array, function (v) {return kernel(testX - v);})\n            }\n        }\n\n        chart.violinPlots.prepareViolin();\n\n        d3.select(window).on('resize.' + chart.selector + '.violinPlot', chart.violinPlots.update);\n        chart.violinPlots.update();\n        return chart;\n    };\n\n    /**\n     * Render a box plot on the current chart\n     * @param options\n     * @param [options.show=true] Toggle the whole plot on and off\n     * @param [options.showBox=true] Show the box part of the box plot\n     * @param [options.showWhiskers=true] Show the whiskers\n     * @param [options.showMedian=true] Show the median line\n     * @param [options.showMean=false] Show the mean line\n     * @param [options.medianCSize=3] The size of the circle on the median\n     * @param [options.showOutliers=true] Plot outliers\n     * @param [options.boxwidth=30] The max percent of the group rangeBand that the box can be\n     * @param [options.lineWidth=boxWidth] The max percent of the group rangeBand that the line can be\n     * @param [options.outlierScatter=false] Spread out the outliers so they don't all overlap (in development)\n     * @param [options.outlierCSize=2] Size of the outliers\n     * @param [options.colors=chart default] The color mapping for the box plot\n     * @returns {*} The chart object\n     */\n    chart.renderBoxPlot = function (options) {\n        chart.boxPlots = {};\n\n        // Defaults\n        var defaultOptions = {\n            show: true,\n            showBox: true,\n            showWhiskers: true,\n            showMedian: true,\n            showMean: false,\n            medianCSize: 3.5,\n            showOutliers: true,\n            boxWidth: 30,\n            lineWidth: null,\n            scatterOutliers: false,\n            outlierCSize: 2.5,\n            colors: chart.colorFunct\n        };\n        chart.boxPlots.options = shallowCopy(defaultOptions);\n        for (var option in options) {\n            chart.boxPlots.options[option] = options[option]\n        }\n        var bOpts = chart.boxPlots.options;\n\n        //Create box plot objects\n        for (var cName in chart.groupObjs) {\n            chart.groupObjs[cName].boxPlot = {};\n            chart.groupObjs[cName].boxPlot.objs = {};\n        }\n\n\n        /**\n         * Calculates all the outlier points for each group\n         */\n        !function calcAllOutliers() {\n\n            /**\n             * Create lists of the outliers for each content group\n             * @param cGroup The object to modify\n             * @return null Modifies the object in place\n             */\n            function calcOutliers(cGroup) {\n                var cExtremes = [];\n                var cOutliers = [];\n                var cOut, idx;\n                for (idx = 0; idx <= cGroup.values.length; idx++) {\n                    cOut = {value: cGroup.values[idx]};\n\n                    if (cOut.value < cGroup.metrics.lowerInnerFence) {\n                        if (cOut.value < cGroup.metrics.lowerOuterFence) {\n                            cExtremes.push(cOut);\n                        } else {\n                            cOutliers.push(cOut);\n                        }\n                    } else if (cOut.value > cGroup.metrics.upperInnerFence) {\n                        if (cOut.value > cGroup.metrics.upperOuterFence) {\n                            cExtremes.push(cOut);\n                        } else {\n                            cOutliers.push(cOut);\n                        }\n                    }\n                }\n                cGroup.boxPlot.objs.outliers = cOutliers;\n                cGroup.boxPlot.objs.extremes = cExtremes;\n            }\n\n            for (var cName in chart.groupObjs) {\n                calcOutliers(chart.groupObjs[cName]);\n            }\n        }();\n\n        /**\n         * Take updated options and redraw the box plot\n         * @param updateOptions\n         */\n        chart.boxPlots.change = function (updateOptions) {\n            if (updateOptions) {\n                for (var key in updateOptions) {\n                    bOpts[key] = updateOptions[key]\n                }\n            }\n\n            for (var cName in chart.groupObjs) {\n                chart.groupObjs[cName].boxPlot.objs.g.remove()\n            }\n            chart.boxPlots.prepareBoxPlot();\n            chart.boxPlots.update()\n        };\n\n        chart.boxPlots.reset = function () {\n            chart.boxPlots.change(defaultOptions)\n        };\n        chart.boxPlots.show = function (opts) {\n            if (opts !== undefined) {\n                opts.show = true;\n                if (opts.reset) {\n                    chart.boxPlots.reset()\n                }\n            } else {\n                opts = {show: true};\n            }\n            chart.boxPlots.change(opts)\n\n        };\n        chart.boxPlots.hide = function (opts) {\n            if (opts !== undefined) {\n                opts.show = false;\n                if (opts.reset) {\n                    chart.boxPlots.reset()\n                }\n            } else {\n                opts = {show: false};\n            }\n            chart.boxPlots.change(opts)\n        };\n\n        /**\n         * Update the box plot obj values\n         */\n        chart.boxPlots.update = function () {\n            var cName, cBoxPlot;\n\n            for (cName in chart.groupObjs) {\n                cBoxPlot = chart.groupObjs[cName].boxPlot;\n\n                // Get the box width\n                var objBounds = getObjWidth(bOpts.boxWidth, cName);\n                var width = (objBounds.right - objBounds.left);\n\n                var sMetrics = {}; //temp var for scaled (plottable) metric values\n                for (var attr in chart.groupObjs[cName].metrics) {\n                    sMetrics[attr] = null;\n                    sMetrics[attr] = chart.yScale(chart.groupObjs[cName].metrics[attr]);\n                }\n\n                // Box\n                if (cBoxPlot.objs.box) {\n                    cBoxPlot.objs.box\n                        .attr(\"x\", objBounds.left)\n                        .attr('width', width)\n                        .attr(\"y\", sMetrics.quartile3)\n                        .attr(\"rx\", 1)\n                        .attr(\"ry\", 1)\n                        .attr(\"height\", -sMetrics.quartile3 + sMetrics.quartile1)\n                }\n\n                // Lines\n                var lineBounds = null;\n                if (bOpts.lineWidth) {\n                    lineBounds = getObjWidth(bOpts.lineWidth, cName)\n                } else {\n                    lineBounds = objBounds\n                }\n                // --Whiskers\n                if (cBoxPlot.objs.upperWhisker) {\n                    cBoxPlot.objs.upperWhisker.fence\n                        .attr(\"x1\", lineBounds.left)\n                        .attr(\"x2\", lineBounds.right)\n                        .attr('y1', sMetrics.upperInnerFence)\n                        .attr(\"y2\", sMetrics.upperInnerFence);\n                    cBoxPlot.objs.upperWhisker.line\n                        .attr(\"x1\", lineBounds.middle)\n                        .attr(\"x2\", lineBounds.middle)\n                        .attr('y1', sMetrics.quartile3)\n                        .attr(\"y2\", sMetrics.upperInnerFence);\n\n                    cBoxPlot.objs.lowerWhisker.fence\n                        .attr(\"x1\", lineBounds.left)\n                        .attr(\"x2\", lineBounds.right)\n                        .attr('y1', sMetrics.lowerInnerFence)\n                        .attr(\"y2\", sMetrics.lowerInnerFence);\n                    cBoxPlot.objs.lowerWhisker.line\n                        .attr(\"x1\", lineBounds.middle)\n                        .attr(\"x2\", lineBounds.middle)\n                        .attr('y1', sMetrics.quartile1)\n                        .attr(\"y2\", sMetrics.lowerInnerFence);\n                }\n\n                // --Median\n                if (cBoxPlot.objs.median) {\n                    cBoxPlot.objs.median.line\n                        .attr(\"x1\", lineBounds.left)\n                        .attr(\"x2\", lineBounds.right)\n                        .attr('y1', sMetrics.median)\n                        .attr(\"y2\", sMetrics.median);\n                    cBoxPlot.objs.median.circle\n                        .attr(\"cx\", lineBounds.middle)\n                        .attr(\"cy\", sMetrics.median)\n                }\n\n                // --Mean\n                if (cBoxPlot.objs.mean) {\n                    cBoxPlot.objs.mean.line\n                        .attr(\"x1\", lineBounds.left)\n                        .attr(\"x2\", lineBounds.right)\n                        .attr('y1', sMetrics.mean)\n                        .attr(\"y2\", sMetrics.mean);\n                    cBoxPlot.objs.mean.circle\n                        .attr(\"cx\", lineBounds.middle)\n                        .attr(\"cy\", sMetrics.mean);\n                }\n\n                // Outliers\n\n                var pt;\n                if (cBoxPlot.objs.outliers) {\n                    for (pt in cBoxPlot.objs.outliers) {\n                        cBoxPlot.objs.outliers[pt].point\n                            .attr(\"cx\", objBounds.middle + addJitter(bOpts.scatterOutliers, width))\n                            .attr(\"cy\", chart.yScale(cBoxPlot.objs.outliers[pt].value));\n                    }\n                }\n                if (cBoxPlot.objs.extremes) {\n                    for (pt in cBoxPlot.objs.extremes) {\n                        cBoxPlot.objs.extremes[pt].point\n                            .attr(\"cx\", objBounds.middle + addJitter(bOpts.scatterOutliers, width))\n                            .attr(\"cy\", chart.yScale(cBoxPlot.objs.extremes[pt].value));\n                    }\n                }\n            }\n        };\n\n        /**\n         * Create the svg elements for the box plot\n         */\n        chart.boxPlots.prepareBoxPlot = function () {\n            var cName, cBoxPlot;\n\n            if (bOpts.colors) {\n                chart.boxPlots.colorFunct = getColorFunct(bOpts.colors);\n            } else {\n                chart.boxPlots.colorFunct = chart.colorFunct\n            }\n\n            if (bOpts.show == false) {\n                return\n            }\n\n            for (cName in chart.groupObjs) {\n                cBoxPlot = chart.groupObjs[cName].boxPlot;\n\n                cBoxPlot.objs.g = chart.groupObjs[cName].g.append(\"g\").attr(\"class\", \"box-plot\");\n\n                //Plot Box (default show)\n                if (bOpts.showBox) {\n                    cBoxPlot.objs.box = cBoxPlot.objs.g.append(\"rect\")\n                        .attr(\"class\", \"box\")\n                        .style(\"fill\", chart.boxPlots.colorFunct(cName))\n                        .style(\"stroke\", chart.boxPlots.colorFunct(cName));\n                    //A stroke is added to the box with the group color, it is\n                    // hidden by default and can be shown through css with stroke-width\n                }\n\n                //Plot Median (default show)\n                if (bOpts.showMedian) {\n                    cBoxPlot.objs.median = {line: null, circle: null};\n                    cBoxPlot.objs.median.line = cBoxPlot.objs.g.append(\"line\")\n                        .attr(\"class\", \"median\");\n                    cBoxPlot.objs.median.circle = cBoxPlot.objs.g.append(\"circle\")\n                        .attr(\"class\", \"median\")\n                        .attr('r', bOpts.medianCSize)\n                        .style(\"fill\", chart.boxPlots.colorFunct(cName))\n                        .on(\"mouseover\", function () {\n                            chart.objs.tooltip\n                                .style(\"display\", null)\n                                .style(\"left\", (d3.event.pageX) + \"px\")\n                                .style(\"top\", (d3.event.pageY - 28) + \"px\");\n                        }).on(\"mouseout\", function () {\n                          chart.objs.tooltip.style(\"display\", \"none\");\n                        }).on(\"mousemove\", tooltipHover(cName, chart.groupObjs[cName].metrics, '', '', 'median'));\n                }\n\n                // Plot Mean (default no plot)\n                if (bOpts.showMean) {\n                    cBoxPlot.objs.mean = {line: null, circle: null};\n                    cBoxPlot.objs.mean.line = cBoxPlot.objs.g.append(\"line\")\n                        .attr(\"class\", \"mean\");\n                    cBoxPlot.objs.mean.circle = cBoxPlot.objs.g.append(\"circle\")\n                        .attr(\"class\", \"mean\")\n                        .attr('r', bOpts.medianCSize)\n                        .style(\"fill\", chart.boxPlots.colorFunct(cName))\n                        .on(\"mouseover\", function () {\n                            chart.objs.tooltip\n                                .style(\"display\", null)\n                                .style(\"left\", (d3.event.pageX) + \"px\")\n                                .style(\"top\", (d3.event.pageY - 28) + \"px\");\n                        }).on(\"mouseout\", function () {\n                          chart.objs.tooltip.style(\"display\", \"none\");\n                        }).on(\"mousemove\", tooltipHover(cName, chart.groupObjs[cName].metrics, '', '', 'mean'));\n                }\n\n                // Plot Whiskers (default show)\n                if (bOpts.showWhiskers) {\n                    cBoxPlot.objs.upperWhisker = {fence: null, line: null};\n                    cBoxPlot.objs.lowerWhisker = {fence: null, line: null};\n                    cBoxPlot.objs.upperWhisker.fence = cBoxPlot.objs.g.append(\"line\")\n                        .attr(\"class\", \"upper whisker\")\n                        .style(\"stroke\", chart.boxPlots.colorFunct(cName));\n                    cBoxPlot.objs.upperWhisker.line = cBoxPlot.objs.g.append(\"line\")\n                        .attr(\"class\", \"upper whisker\")\n                        .style(\"stroke\", chart.boxPlots.colorFunct(cName));\n\n                    cBoxPlot.objs.lowerWhisker.fence = cBoxPlot.objs.g.append(\"line\")\n                        .attr(\"class\", \"lower whisker\")\n                        .style(\"stroke\", chart.boxPlots.colorFunct(cName));\n                    cBoxPlot.objs.lowerWhisker.line = cBoxPlot.objs.g.append(\"line\")\n                        .attr(\"class\", \"lower whisker\")\n                        .style(\"stroke\", chart.boxPlots.colorFunct(cName));\n                }\n\n                // Plot outliers (default show)\n                if (bOpts.showOutliers) {\n                    if (!cBoxPlot.objs.outliers) calcAllOutliers();\n                    var pt;\n                    if (cBoxPlot.objs.outliers.length) {\n                        var outDiv = cBoxPlot.objs.g.append(\"g\").attr(\"class\", \"boxplot outliers\");\n                        for (pt in cBoxPlot.objs.outliers) {\n                            cBoxPlot.objs.outliers[pt].point = outDiv.append(\"circle\")\n                                .attr(\"class\", \"outlier\")\n                                .attr('r', bOpts.outlierCSize)\n                                .style(\"fill\", chart.boxPlots.colorFunct(cName));\n                        }\n                    }\n\n                    if (cBoxPlot.objs.extremes.length) {\n                        var extDiv = cBoxPlot.objs.g.append(\"g\").attr(\"class\", \"boxplot extremes\");\n                        for (pt in cBoxPlot.objs.extremes) {\n                            cBoxPlot.objs.extremes[pt].point = extDiv.append(\"circle\")\n                                .attr(\"class\", \"extreme\")\n                                .attr('r', bOpts.outlierCSize)\n                                .style(\"stroke\", chart.boxPlots.colorFunct(cName));\n                        }\n                    }\n                }\n\n\n            }\n        };\n        chart.boxPlots.prepareBoxPlot();\n\n        d3.select(window).on('resize.' + chart.selector + '.boxPlot', chart.boxPlots.update);\n        chart.boxPlots.update();\n        return chart;\n\n    };\n\n    /**\n     * Render a notched box on the current chart\n     * @param options\n     * @param [options.show=true] Toggle the whole plot on and off\n     * @param [options.showNotchBox=true] Show the notch box\n     * @param [options.showLines=false] Show lines at the confidence intervals\n     * @param [options.boxWidth=35] The width of the widest part of the box\n     * @param [options.medianWidth=20] The width of the narrowist part of the box\n     * @param [options.lineWidth=50] The width of the confidence interval lines\n     * @param [options.notchStyle=null] null=traditional style, 'box' cuts out the whole notch in right angles\n     * @param [options.colors=chart default] The color mapping for the notch boxes\n     * @returns {*} The chart object\n     */\n    chart.renderNotchBoxes = function (options) {\n        chart.notchBoxes = {};\n\n        //Defaults\n        var defaultOptions = {\n            show: true,\n            showNotchBox: true,\n            showLines: false,\n            boxWidth: 35,\n            medianWidth: 20,\n            lineWidth: 50,\n            notchStyle: null,\n            colors: null\n        };\n        chart.notchBoxes.options = shallowCopy(defaultOptions);\n        for (var option in options) {\n            chart.notchBoxes.options[option] = options[option]\n        }\n        var nOpts = chart.notchBoxes.options;\n\n        //Create notch objects\n        for (var cName in chart.groupObjs) {\n            chart.groupObjs[cName].notchBox = {};\n            chart.groupObjs[cName].notchBox.objs = {};\n        }\n\n        /**\n         * Makes the svg path string for a notched box\n         * @param cNotch Current notch box object\n         * @param notchBounds objBound object\n         * @returns {string} A string in the proper format for a svg polygon\n         */\n        function makeNotchBox(cNotch, notchBounds) {\n            var scaledValues = [];\n            if (nOpts.notchStyle == 'box') {\n                scaledValues = [\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.quartile1)],\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.lowerNotch)],\n                    [notchBounds.medianLeft, chart.yScale(cNotch.metrics.lowerNotch)],\n                    [notchBounds.medianLeft, chart.yScale(cNotch.metrics.median)],\n                    [notchBounds.medianLeft, chart.yScale(cNotch.metrics.upperNotch)],\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.upperNotch)],\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.quartile3)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.quartile3)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.upperNotch)],\n                    [notchBounds.medianRight, chart.yScale(cNotch.metrics.upperNotch)],\n                    [notchBounds.medianRight, chart.yScale(cNotch.metrics.median)],\n                    [notchBounds.medianRight, chart.yScale(cNotch.metrics.lowerNotch)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.lowerNotch)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.quartile1)]\n                ];\n            } else {\n                scaledValues = [\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.quartile1)],\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.lowerNotch)],\n                    [notchBounds.medianLeft, chart.yScale(cNotch.metrics.median)],\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.upperNotch)],\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.quartile3)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.quartile3)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.upperNotch)],\n                    [notchBounds.medianRight, chart.yScale(cNotch.metrics.median)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.lowerNotch)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.quartile1)]\n                ];\n            }\n            return scaledValues.map(function (d) {\n                return [d[0], d[1]].join(\",\");\n            }).join(\" \");\n        }\n\n        /**\n         * Calculate the confidence intervals\n         */\n        !function calcNotches() {\n            var cNotch, modifier;\n            for (var cName in chart.groupObjs) {\n                cNotch = chart.groupObjs[cName];\n                modifier = (1.57 * (cNotch.metrics.iqr / Math.sqrt(cNotch.values.length)));\n                cNotch.metrics.upperNotch = cNotch.metrics.median + modifier;\n                cNotch.metrics.lowerNotch = cNotch.metrics.median - modifier;\n            }\n        }();\n\n        /**\n         * Take a new set of options and redraw the notch boxes\n         * @param updateOptions\n         */\n        chart.notchBoxes.change = function (updateOptions) {\n            if (updateOptions) {\n                for (var key in updateOptions) {\n                    nOpts[key] = updateOptions[key]\n                }\n            }\n\n            for (var cName in chart.groupObjs) {\n                chart.groupObjs[cName].notchBox.objs.g.remove()\n            }\n            chart.notchBoxes.prepareNotchBoxes();\n            chart.notchBoxes.update();\n        };\n\n        chart.notchBoxes.reset = function () {\n            chart.notchBoxes.change(defaultOptions)\n        };\n        chart.notchBoxes.show = function (opts) {\n            if (opts !== undefined) {\n                opts.show = true;\n                if (opts.reset) {\n                    chart.notchBoxes.reset()\n                }\n            } else {\n                opts = {show: true};\n            }\n            chart.notchBoxes.change(opts)\n        };\n        chart.notchBoxes.hide = function (opts) {\n            if (opts !== undefined) {\n                opts.show = false;\n                if (opts.reset) {\n                    chart.notchBoxes.reset()\n                }\n            } else {\n                opts = {show: false};\n            }\n            chart.notchBoxes.change(opts)\n        };\n\n        /**\n         * Update the notch box obj values\n         */\n        chart.notchBoxes.update = function () {\n            var cName, cGroup;\n\n            for (cName in chart.groupObjs) {\n                cGroup = chart.groupObjs[cName];\n\n                // Get the box size\n                var boxBounds = getObjWidth(nOpts.boxWidth, cName);\n                var medianBounds = getObjWidth(nOpts.medianWidth, cName);\n\n                var notchBounds = {\n                    boxLeft: boxBounds.left,\n                    boxRight: boxBounds.right,\n                    middle: boxBounds.middle,\n                    medianLeft: medianBounds.left,\n                    medianRight: medianBounds.right\n                };\n\n                // Notch Box\n                if (cGroup.notchBox.objs.notch) {\n                    cGroup.notchBox.objs.notch\n                        .attr(\"points\", makeNotchBox(cGroup, notchBounds));\n                }\n                if (cGroup.notchBox.objs.upperLine) {\n                    var lineBounds = null;\n                    if (nOpts.lineWidth) {\n                        lineBounds = getObjWidth(nOpts.lineWidth, cName)\n                    } else {\n                        lineBounds = objBounds\n                    }\n\n                    var confidenceLines = {\n                        upper: chart.yScale(cGroup.metrics.upperNotch),\n                        lower: chart.yScale(cGroup.metrics.lowerNotch)\n                    };\n                    cGroup.notchBox.objs.upperLine\n                        .attr(\"x1\", lineBounds.left)\n                        .attr(\"x2\", lineBounds.right)\n                        .attr('y1', confidenceLines.upper)\n                        .attr(\"y2\", confidenceLines.upper);\n                    cGroup.notchBox.objs.lowerLine\n                        .attr(\"x1\", lineBounds.left)\n                        .attr(\"x2\", lineBounds.right)\n                        .attr('y1', confidenceLines.lower)\n                        .attr(\"y2\", confidenceLines.lower);\n                }\n            }\n        };\n\n        /**\n         * Create the svg elements for the notch boxes\n         */\n        chart.notchBoxes.prepareNotchBoxes = function () {\n            var cName, cNotch;\n\n            if (nOpts && nOpts.colors) {\n                chart.notchBoxes.colorFunct = getColorFunct(nOpts.colors);\n            } else {\n                chart.notchBoxes.colorFunct = chart.colorFunct\n            }\n\n            if (nOpts.show == false) {\n                return\n            }\n\n            for (cName in chart.groupObjs) {\n                cNotch = chart.groupObjs[cName].notchBox;\n\n                cNotch.objs.g = chart.groupObjs[cName].g.append(\"g\").attr(\"class\", \"notch-plot\");\n\n                // Plot Box (default show)\n                if (nOpts.showNotchBox) {\n                    cNotch.objs.notch = cNotch.objs.g.append(\"polygon\")\n                        .attr(\"class\", \"notch\")\n                        .style(\"fill\", chart.notchBoxes.colorFunct(cName))\n                        .style(\"stroke\", chart.notchBoxes.colorFunct(cName));\n                    //A stroke is added to the notch with the group color, it is\n                    // hidden by default and can be shown through css with stroke-width\n                }\n\n                //Plot Confidence Lines (default hide)\n                if (nOpts.showLines) {\n                    cNotch.objs.upperLine = cNotch.objs.g.append(\"line\")\n                        .attr(\"class\", \"upper confidence line\")\n                        .style(\"stroke\", chart.notchBoxes.colorFunct(cName));\n\n                    cNotch.objs.lowerLine = cNotch.objs.g.append(\"line\")\n                        .attr(\"class\", \"lower confidence line\")\n                        .style(\"stroke\", chart.notchBoxes.colorFunct(cName));\n                }\n            }\n        };\n        chart.notchBoxes.prepareNotchBoxes();\n\n        d3.select(window).on('resize.' + chart.selector + '.notchBox', chart.notchBoxes.update);\n        chart.notchBoxes.update();\n        return chart;\n    };\n\n    /**\n     * Render a raw data in various forms\n     * @param options\n     * @param [options.show=true] Toggle the whole plot on and off\n     * @param [options.showPlot=false] True or false, show points\n     * @param [options.plotType='none'] Options: no scatter = (false or 'none'); scatter points= (true or [amount=% of width (default=10)]); beeswarm points = ('beeswarm')\n     * @param [options.pointSize=6] Diameter of the circle in pizels (not the radius)\n     * @param [options.showLines=['median']] Can equal any of the metrics lines\n     * @param [options.showbeanLines=false] Options: no lines = false\n     * @param [options.beanWidth=20] % width\n     * @param [options.colors=chart default]\n     * @returns {*} The chart object\n     *\n     */\n    chart.renderDataPlots = function (options) {\n        chart.dataPlots = {};\n\n\n        //Defaults\n        var defaultOptions = {\n            show: true,\n            showPlot: false,\n            plotType: 'none',\n            pointSize: 7,\n            showLines: false,//['median'],\n            showBeanLines: false,\n            beanWidth: 20,\n            colors: null\n        };\n        chart.dataPlots.options = shallowCopy(defaultOptions);\n        for (var option in options) {\n            chart.dataPlots.options[option] = options[option]\n        }\n        var dOpts = chart.dataPlots.options;\n\n        //Create notch objects\n        for (var cName in chart.groupObjs) {\n            chart.groupObjs[cName].dataPlots = {};\n            chart.groupObjs[cName].dataPlots.objs = {};\n        }\n        // The lines don't fit into a group bucket so they live under the dataPlot object\n        chart.dataPlots.objs = {};\n\n        /**\n         * Take updated options and redraw the data plots\n         * @param updateOptions\n         */\n        chart.dataPlots.change = function (updateOptions) {\n            if (updateOptions) {\n                for (var key in updateOptions) {\n                    dOpts[key] = updateOptions[key]\n                }\n            }\n\n            chart.dataPlots.objs.g.remove();\n            for (var cName in chart.groupObjs) {\n                chart.groupObjs[cName].dataPlots.objs.g.remove()\n            }\n            chart.dataPlots.preparePlots();\n            chart.dataPlots.update()\n        };\n\n        chart.dataPlots.reset = function () {\n            chart.dataPlots.change(defaultOptions)\n        };\n        chart.dataPlots.show = function (opts) {\n            if (opts !== undefined) {\n                opts.show = true;\n                if (opts.reset) {\n                    chart.dataPlots.reset()\n                }\n            } else {\n                opts = {show: true};\n            }\n            chart.dataPlots.change(opts)\n        };\n        chart.dataPlots.hide = function (opts) {\n            if (opts !== undefined) {\n                opts.show = false;\n                if (opts.reset) {\n                    chart.dataPlots.reset()\n                }\n            } else {\n                opts = {show: false};\n            }\n            chart.dataPlots.change(opts)\n        };\n\n        /**\n         * Update the data plot obj values\n         */\n        chart.dataPlots.update = function () {\n            var cName, cGroup, cPlot;\n\n            // Metrics lines\n            if (chart.dataPlots.objs.g) {\n                var halfBand = chart.xScale.bandwidth() / 2; // find the middle of each band\n                for (var cMetric in chart.dataPlots.objs.lines) {\n                    chart.dataPlots.objs.lines[cMetric].line\n                        .x(function (d) {\n                            return chart.xScale(d.x) + halfBand\n                        });\n                    chart.dataPlots.objs.lines[cMetric].g\n                        .datum(chart.dataPlots.objs.lines[cMetric].values)\n                        .attr('d', chart.dataPlots.objs.lines[cMetric].line);\n                }\n            }\n\n\n            for (cName in chart.groupObjs) {\n                cGroup = chart.groupObjs[cName];\n                cPlot = cGroup.dataPlots;\n\n                if (cPlot.objs.points) {\n                    if (dOpts.plotType == 'beeswarm') {\n                        var swarmBounds = getObjWidth(100, cName);\n                        var yPtScale = chart.yScale.copy()\n                            .range([Math.floor(chart.yScale.range()[0] / dOpts.pointSize), 0])\n                            .interpolate(d3.interpolateRound)\n                            .domain(chart.yScale.domain());\n                        var maxWidth = Math.floor(chart.xScale.bandwidth() / dOpts.pointSize);\n                        var ptsObj = {};\n                        var cYBucket = null;\n                        //  Bucket points\n                        for (var pt = 0; pt < cGroup.values.length; pt++) {\n                            cYBucket = yPtScale(cGroup.values[pt]);\n                            if (ptsObj.hasOwnProperty(cYBucket) !== true) {\n                                ptsObj[cYBucket] = [];\n                            }\n                            ptsObj[cYBucket].push(cPlot.objs.points.pts[pt]\n                                .attr(\"cx\", swarmBounds.middle)\n                                .attr(\"cy\", yPtScale(cGroup.values[pt]) * dOpts.pointSize));\n                        }\n                        //  Plot buckets\n                        var rightMax = Math.min(swarmBounds.right - dOpts.pointSize);\n                        for (var row in ptsObj) {\n                            var leftMin = swarmBounds.left + (Math.max((maxWidth - ptsObj[row].length) / 2, 0) * dOpts.pointSize);\n                            var col = 0;\n                            for (pt in ptsObj[row]) {\n                                ptsObj[row][pt].attr(\"cx\", Math.min(leftMin + col * dOpts.pointSize, rightMax) + dOpts.pointSize / 2);\n                                col++\n                            }\n                        }\n                    } else { // For scatter points and points with no scatter\n                        var plotBounds = null,\n                            scatterWidth = 0,\n                            width = 0;\n                        if (dOpts.plotType == 'scatter' || typeof dOpts.plotType == 'number') {\n                            //Default scatter percentage is 20% of box width\n                            scatterWidth = typeof dOpts.plotType == 'number' ? dOpts.plotType : 20;\n                        }\n\n                        plotBounds = getObjWidth(scatterWidth, cName);\n                        width = plotBounds.right - plotBounds.left;\n\n                        for (var pt = 0; pt < cGroup.values.length; pt++) {\n                            cPlot.objs.points.pts[pt]\n                                .attr(\"cx\", plotBounds.middle + addJitter(true, width))\n                                .attr(\"cy\", chart.yScale(cGroup.values[pt]));\n                        }\n                    }\n                }\n\n\n                if (cPlot.objs.bean) {\n                    var beanBounds = getObjWidth(dOpts.beanWidth, cName);\n                    for (var pt = 0; pt < cGroup.values.length; pt++) {\n                        cPlot.objs.bean.lines[pt]\n                            .attr(\"x1\", beanBounds.left)\n                            .attr(\"x2\", beanBounds.right)\n                            .attr('y1', chart.yScale(cGroup.values[pt]))\n                            .attr(\"y2\", chart.yScale(cGroup.values[pt]));\n                    }\n                }\n            }\n        };\n\n        /**\n         * Create the svg elements for the data plots\n         */\n        chart.dataPlots.preparePlots = function () {\n            var cName, cPlot;\n            \n            if (dOpts && dOpts.colors) {\n                chart.dataPlots.colorFunct = getColorFunct(dOpts.colors);\n            } else {\n                chart.dataPlots.colorFunct = chart.colorFunct\n            }\n\n            if (dOpts.show == false) {\n                return\n            }\n\n            // Metrics lines\n            chart.dataPlots.objs.g = chart.objs.g.append(\"g\").attr(\"class\", \"metrics-lines\");\n            if (dOpts.showLines && dOpts.showLines.length > 0) {\n                chart.dataPlots.objs.lines = {};\n                var cMetric;\n                for (var line in dOpts.showLines) {\n                    cMetric = dOpts.showLines[line];\n                    chart.dataPlots.objs.lines[cMetric] = {};\n                    chart.dataPlots.objs.lines[cMetric].values = [];\n                    for (var cGroup in chart.groupObjs) {\n                        chart.dataPlots.objs.lines[cMetric].values.push({\n                            x: cGroup,\n                            y: chart.groupObjs[cGroup].metrics[cMetric]\n                        })\n                    }\n                    chart.dataPlots.objs.lines[cMetric].line = d3.line()\n                        .curve(d3.curveCardinal)\n                        .y(function (d) {\n                            return chart.yScale(d.y)\n                        });\n                    chart.dataPlots.objs.lines[cMetric].g = chart.dataPlots.objs.g.append(\"path\")\n                        .attr(\"class\", \"line \" + cMetric)\n                        .attr(\"data-metric\", cMetric)\n                        .style(\"fill\", 'none')\n                        .style(\"stroke\", chart.colorFunct(cMetric));\n                }\n\n            }\n\n\n            for (cName in chart.groupObjs) {\n                cPlot = chart.groupObjs[cName].dataPlots;\n                cPlot.objs.g = chart.groupObjs[cName].g.append(\"g\").attr(\"class\", \"data-plot\");\n                // Points Plot\n                if (dOpts.showPlot) {\n                    cPlot.objs.points = {g: null, pts: []};\n                    cPlot.objs.points.g = cPlot.objs.g.append(\"g\").attr(\"class\", \"points-plot\");\n                    for (var pt = 0; pt < chart.groupObjs[cName].values.length; pt++) {\n                        let val = chart.groupObjs[cName].values[pt];\n                        let valInfo = chart.groupObjs[cName].valuesInfo[pt];\n                        cPlot.objs.points.pts.push(cPlot.objs.points.g.append(\"circle\")\n                            .attr(\"class\", \"point\")\n                            //class id so it can be selected\n                            .attr('class', function() { var id = chart.settings.id ? chart.settings.id : false;\n                            return id ? 'distro-' + valInfo.id : '';})\n                            .attr('r', dOpts.pointSize / 2)// Options is diameter, r takes radius so divide by 2\n                            .style(\"fill\", chart.dataPlots.colorFunct(cName))\n                            .style(\"fill-opacity\", 0.6)\n                            .style(\"stroke\", chart.dataPlots.colorFunct(cName))\n                            .style(\"stroke-width\", \"2px\")\n                            .on('mouseover', ()=>{\n                                chart.objs.tooltip\n                                    .style(\"display\", null)\n                                    .style(\"left\", (d3.event.pageX) + \"px\")\n                                    .style(\"top\", (d3.event.pageY - 28) + \"px\");\n                            }).on(\"mouseout\", function () {\n                                chart.objs.tooltip.style(\"display\", \"none\");\n                            }).on(\"mousemove\", tooltipHover(cName, chart.groupObjs[cName].metrics, valInfo.idName, val))\n                            .on('click', function(){\n                                if (chart.settings.events.onClickElement) {\n                                    chart.settings.events.onClickElement.call(this, valInfo);\n                                }\n                            }));\n                    }\n                }\n\n\n                // Bean lines\n                if (dOpts.showBeanLines) {\n                    cPlot.objs.bean = {g: null, lines: []};\n                    cPlot.objs.bean.g = cPlot.objs.g.append(\"g\").attr(\"class\", \"bean-plot\");\n                    for (var pt = 0; pt < chart.groupObjs[cName].values.length; pt++) {\n                        cPlot.objs.bean.lines.push(cPlot.objs.bean.g.append(\"line\")\n                            .attr(\"class\", \"bean line\")\n                            .style(\"stroke-width\", '1')\n                            .style(\"stroke\", chart.dataPlots.colorFunct(cName)));\n                    }\n                }\n            }\n\n        };\n        chart.dataPlots.preparePlots();\n\n        d3.select(window).on('resize.' + chart.selector + '.dataPlot', chart.dataPlots.update);\n        chart.dataPlots.update();\n        return chart;\n    };\n\n    return chart;\n}","import * as d3 from 'd3';\n\nimport makeDistroChart from './distrochart';\n\n/* Simple Distro example\n * Single and multiline Distros\n */\nexport default function(config, helper) {\n\n  var parseDate = d3.timeParse('%Y-%m-%d');\n\n  var Distro = Object.create(helper);\n\n  Distro.init = function(config){\n    var vm = this;\n    vm._config = config ? config : {};\n    vm._data = [];\n    vm._scales ={};\n    vm._axes = {};\n\n    \n    vm._tip = vm.utils.d3.tip().attr('class', 'd3-tip')\n      .html(vm._config.tip ? vm._config.tip : function(d) {\n        console.log(d);\n        var html ='';\n        //html += d.x ? ('<span>' + (Number.isNaN(+d.x) ? d.x : vm.utils.format(d.x)) + '</span></br>') : '';\n        html += d.y ? ('<span>' + (Number.isNaN(+d.y) ? d.y : vm.utils.format(d.y)) + '</span></br>') : '';\n        /* html += d.magnitude ? ('<span>' + (Number.isNaN(+d.magnitude) ? d.magnitude : vm.utils.format(d.magnitude)) + '</span></br>') : '';\n        html += d.color ? ('<span>' + (Number.isNaN(+d.color) ? d.color : vm.utils.format(d.color)) + '</span>') : ''; */\n        return html;\n      });\n\n  }\n\n  //-------------------------------\n  //User config functions\n  Distro.type = function(type){\n    var vm = this;\n    vm._config.type = type;\n    return vm;\n  }\n\n  Distro.x = function(col){\n    var vm = this;\n    vm._config.x = col;\n    return vm;\n  }\n\n  Distro.y = function(col){\n    var vm = this;\n    vm._config.y = col;\n    return vm;\n  }\n\n  Distro.sortBy = function(opt){\n    var vm = this;\n    vm._config.sortBy = opt;\n    return vm;\n  }\n\n  Distro.fill = function(col){\n    var vm = this;\n    vm._config.fill = col;\n    return vm;\n  }\n\n  Distro.id = function (col) {\n    var vm = this;\n    vm._config.id = col;\n    return vm;\n  };\n\n  Distro.colors = function(colors) {\n    var vm = this;\n    if(Array.isArray(colors)) {\n      //Using an array of colors for the range \n      vm._config.colors = colors;\n    } else {\n      //Using a preconfigured d3.scale\n      vm._scales.color = colors;\n    }\n    return vm;\n  }\n\n  Distro.tip = function (tip) {\n    var vm = this;\n    vm._config.tip = tip;\n    vm._tip.html(vm._config.tip);\n    return vm;\n  };\n\n  //-------------------------------\n  //Triggered by the chart.js;\n  Distro.data = function(data){\n    var vm = this;\n    \n    vm._data = [];\n    data.forEach(function(d){\n      d.x = d[vm._config.x];\n      d.y = +d[vm._config.y];\n      d.color = vm._config.fill ? d[vm._config.fill] : 'red';\n      delete(d[vm._config.x]);\n      delete(d[vm._config.y]);\n      if(vm._config.fill) delete(d[vm._config.x]); \n\n      vm._data.push(d);\n    });\n\n    return vm;\n  }\n\n  Distro.scales = function(){\n    var vm = this;\n\n\n\n    return vm;\n  }\n\n\n  Distro.draw = function(){\n    var vm = this;\n    //Call the tip\n    //vm.chart.svg().call(vm._tip);\n\n    vm.chart.fullSvg().remove()\n\n    var chart1 = makeDistroChart({\n        chart: vm.chart,\n        data: vm._data,\n        id: vm._config.id,\n        idName: vm._config.idName,\n        events: vm._config.events,\n        xName:'x',\n        xSort: typeof vm._config.sortBy === 'object' &&  vm._config.sortBy.x ? vm._config.sortBy.x : null, \n        yName:'y',\n        axisLabels: { xAxis: vm._config.axisLabels.xAxis, yAxis: vm._config.axisLabels.yAxis },\n        selector: \"#distro\",\n        colors: ['#fff5ca', '#fbc43a', '#5cbd00', '#084c1f'],\n        chartSize: { height: vm._config.size.height, width: vm._config.size.width },\n        margin: { top: vm._config.size.margin.top, right: vm._config.size.margin.right, bottom: vm._config.size.margin.bottom, left: vm._config.size.margin.left },\n        constrainExtremes: true});\n\n    if (vm.chart.config.styles) {\n      d3.select('#distro .tooltip')\n        .style('background-color', vm.chart.style.tooltip.backgroundColor)\n        .style('line-height', 1)\n        .style('font-weight', vm.chart.style.tooltip.text.fontWeight)\n        .style('font-size', vm.chart.style.tooltip.text.fontSize) \n        .style('color', vm.chart.style.tooltip.text.textColor)\n        .style('font-family', vm.chart.style.tooltip.text.fontFamily)\n        .style('background-color', vm.chart.style.tooltip.backgroundColor)\n        .style('padding', vm.chart.style.tooltip.text.padding)\n        .style('border', vm.chart.style.tooltip.border.width + ' solid ' + vm.chart.style.tooltip.border.color ) \n        .style('border-radius', vm.chart.style.tooltip.border.radius);\n    }\n\n    chart1.renderBoxPlot();\n    chart1.renderDataPlots();\n    chart1.renderNotchBoxes({showNotchBox:false});\n    chart1.renderViolinPlot({showViolinPlot:false}); \n    \n    chart1.boxPlots.show({reset:true, showWhiskers:false,showOutliers:false, showMean:true, showMedian:true, showBox:false});\n    chart1.dataPlots.change({showPlot:true}); \n    chart1.violinPlots.show({reset:true,clamp:0, width:100});\n    //Box Plot\n    /* chart1.violinPlots.hide();\n    chart1.boxPlots.show({reset:true});\n    chart1.notchBoxes.hide();\n    chart1.dataPlots.change({showPlot:false,showBeanLines:false});  */\n\n    //Notched Box Plot\n   /*  chart1.violinPlots.hide();\n    chart1.notchBoxes.show({reset:true});\n    chart1.boxPlots.show({reset:true, showBox:false,showOutliers:true,boxWidth:20,scatterOutliers:true});\n    chart1.dataPlots.change({showPlot:false,showBeanLines:false}); */\n\n    //Violin Plot Unbound\n    /* chart1.violinPlots.show({reset:true,clamp:0});\n    chart1.boxPlots.show({reset:true, showWhiskers:false,showOutliers:false,boxWidth:10,lineWidth:15,colors:['#555']});\n    chart1.notchBoxes.hide();\n    chart1.dataPlots.change({showPlot:false,showBeanLines:false})  */\n\n    //Violin Plot Clamp to Data\n    if (vm._config.type === 'violin') {\n      chart1.violinPlots.show({reset:true,clamp:1, width:50});\n      chart1.boxPlots.show({reset:true, showWhiskers:false,showOutliers:false,boxWidth:10,lineWidth:15,colors:['#555']});\n      chart1.notchBoxes.hide();\n      chart1.dataPlots.change({showPlot:false,showBeanLines:false}); \n    }\n    \n\n    //Bean Plot\n    /* chart1.violinPlots.show({reset:true, width:75, clamp:0, resolution:30, bandwidth:50});\n    chart1.dataPlots.show({showBeanLines:true,beanWidth:15,showPlot:false,colors:['#555']});\n    chart1.boxPlots.hide();\n    chart1.notchBoxes.hide(); */\n\n    //Beeswarm Plot\n    /* chart1.violinPlots.hide();\n    chart1.dataPlots.show({showPlot:true, plotType:'beeswarm',showBeanLines:false, colors:null});\n    chart1.notchBoxes.hide();\n    chart1.boxPlots.hide(); */\n    \n    //Scatter Plot\n    if (vm._config.type === 'scatter') {\n      chart1.violinPlots.hide();\n      chart1.dataPlots.show({showPlot:true, plotType:40, showBeanLines:false,colors:null});\n      chart1.notchBoxes.hide();\n      //chart1.boxPlots.hide();\n    }\n\n    \n    //Trend Lines\n    /* if(chart1.dataPlots.options.showLines){\n        chart1.dataPlots.change({showLines:false});\n    } else {\n        chart1.dataPlots.change({showLines:['median','quartile1','quartile3']});\n    } */\n\n\n    return vm;\n  }\n\n  Distro.select = function(id) {\n    var vm = this;\n    return d3.select('#distro .distro-' + id);\n  };\n\n  Distro.selectAll = function(id) {\n    var vm = this;\n    return d3.selectAll('#distro '+ id);\n  };\n\n  Distro.init(config);\n  return Distro;\n}\n","import * as d3 from 'd3';\n\n/*\n * Heatmap Chart\n */\nexport default function (config, helper) {\n\n  var Heatmap = Object.create(helper);\n\n  Heatmap.init = function (config) {\n    var vm = this;\n    vm._config = config ? config : {};\n    vm._data = [];\n    vm._scales = {};\n    vm._axes = {};\n\n    vm._legendElementWidth = vm._gridWidth;\n\n    vm._tip = vm.utils.d3.tip()\n      .attr('class', 'd3-tip')\n      .direction('n')\n      .html(vm._config.tip || function (d) {\n        var html = d.x;\n        if (d.x !== d.y) {\n          html += '<br>' + d.y;\n        }\n        html += '<br>' + vm.utils.format(d.value, vm._config.decimals);\n        return html;\n      });\n  };\n\n  //-------------------------------\n  //User config functions\n  Heatmap.x = function (column) {\n    var vm = this;\n    vm._config.x = column;\n    return vm;\n  };\n\n  Heatmap.y = function (column) {\n    var vm = this;\n    vm._config.y = column;\n    return vm;\n  };\n\n  Heatmap.fill = function (column) {\n    var vm = this;\n    vm._config.fill = column;\n    return vm;\n  };\n\n  Heatmap.colors = function (colors) {\n    var vm = this;\n    vm._config.colors = colors;\n    return vm;\n  };\n\n  Heatmap.colorLegend = function (legendTitle) {\n    var vm = this;\n    vm._config.legendTitle = legendTitle;\n    return vm;\n  };\n\n  /**\n   * Personalize border radius (rx, ry) for each rect\n   * @param {number} radius - value to be set, default is 5\n   */\n  Heatmap.borderRadius = function (radius) {\n    var vm = this;\n    vm._config.borderRadius = radius;\n    return vm;\n  };\n\n  Heatmap.sortBy = function (sortBy) {\n    var vm = this;\n    vm._config.sortBy = sortBy;\n    return vm;\n  };\n\n  Heatmap.tip = function (tip) {\n    var vm = this;\n    vm._config.tip = tip;\n    vm._tip.html(vm._config.tip);\n    return vm;\n  };\n\n  //-------------------------------\n  //Triggered by chart.js;\n  Heatmap.data = function (data) {\n    var vm = this;\n    var xSort = vm.utils.sortAscending;\n    var ySort = vm.utils.sortAscending;\n\n    if (typeof vm._config.sortBy === 'string') {\n      if (vm._config.hasOwnProperty('sortBy') && vm._config.sortBy === 'desc') xSort = vm.utils.sortDescending;\n    }\n\n    if (typeof vm._config.sortBy === 'object') {\n      if (vm._config.hasOwnProperty('sortBy') && vm._config.sortBy.hasOwnProperty('x') && vm._config.sortBy.x === 'desc') xSort = vm.utils.sortDescending;\n      if (vm._config.hasOwnProperty('sortBy') && vm._config.sortBy.hasOwnProperty('y') && vm._config.sortBy.y === 'desc') ySort = vm.utils.sortDescending;\n    }\n\n    vm._config.xCategories = d3.nest()\n      .key(function (d) {\n        return d[vm._config.x];\n      }).sortKeys(xSort)\n      .entries(data)\n      .map(function (d) {\n        return d.key;\n      });\n\n    vm._config.yCategories = d3.nest()\n      .key(function (d) {\n        return d[vm._config.y];\n      }).sortKeys(ySort)\n      .entries(data)\n      .map(function (d) {\n        return d.key;\n      });\n\n    vm._config.fillValues = d3.nest()\n      .key(function (d) {\n        return d[vm._config.fill];\n      })\n      .entries(data)\n      .map(function (d) {\n        return Number(d.key);\n      });\n\n    /**\n     * Calculate grid width and height according to chart size\n     */\n    vm._gridWidth = Math.floor((vm._config.size.width - (vm._config.size.margin.left + vm._config.size.margin.right)) / vm._config.xCategories.length);\n\n    vm._gridHeight = Math.floor((vm._config.size.height - (vm._config.size.margin.top + vm._config.size.margin.bottom)) / vm._config.yCategories.length);\n\n    vm._data = data.map(function (d) {\n      var m = {\n        y: d[vm._config.y],\n        x: d[vm._config.x],\n        value: +d[vm._config.fill],\n      };\n      if (d.coefficient) {\n        m.coefficient = d.coefficient.toFixed(2);\n      }\n      return m;\n    });\n\n    return vm;\n  };\n\n  Heatmap.scales = function () {\n    var vm = this;\n    return vm;\n  };\n\n  Heatmap.drawColorLegend = function () {\n    var vm = this;\n\n    var domain = vm._config.colors;\n    var quantilePosition = d3.scaleBand().rangeRound([vm._config.size.height * 0.8, 0]).domain(domain);\n    //Add gradient legend \n    //defaults to right position\n    var legend = d3.select(vm._config.bindTo).select('svg')\n      .append('g')\n      .attr('class', 'legend quantized')\n      .attr('transform', 'translate(' + (vm._config.size.width - 100) + ',' + vm._config.size.height * .1 + ')');\n\n    // legend background\n    legend.append('rect')\n      .attr('x', -50)\n      .attr('y', -35)\n      .attr('width', 100)\n      .attr('height', vm._config.size.height - 10)\n      .attr('rx', 10)\n      .attr('ry', 10)\n      .attr('class', 'legend-background')\n      .attr('fill', 'rgba(255,255,255,0.6)');\n\n    // legend title\n    legend.append('text')\n      .attr('x', 0)\n      .attr('y', -12)\n      .attr('class', 'legend-title')\n      .attr('text-anchor', 'middle')\n      .text(vm._config.legendTitle);\n\n\n    var quantiles = legend.selectAll('.quantile')\n      .data(vm._config.colors)\n      .enter()\n      .append('g')\n      .attr('class', 'quantile')\n      .attr('transform', function (d) {\n        return 'translate(-20, ' + quantilePosition(d) +\n          ')';\n      });\n\n    // Rect\n    quantiles.append('rect')\n      .attr('x', -15)\n      .attr('y', 0)\n      .attr('width', 18)\n      .attr('height', quantilePosition.bandwidth())\n      .attr('fill', function (d) {\n        return d;\n      });\n\n\n    //top text is the max value\n    quantiles.append('text')\n      .attr('x', 17)\n      .attr('y', 5)\n      .attr('class', 'top-label')\n      .attr('text-anchor', 'left')\n      .text(function (d) {\n        let max = (vm._scales.color.invertExtent(d)[1]);\n        if (vm._config.legendTitle === 'Porcentaje' && max > 100) {\n          max = 100;\n        }\n        return vm.utils.format(max, vm._config.decimals);\n      });\n\n    //top text is the min value\n    quantiles.append('text')\n      .attr('x', 17)\n      .attr('y', vm._config.size.height / 5 - 18)\n      .attr('class', 'bottom-label')\n      .attr('text-anchor', 'left')\n      .text(function (d, i) {\n        if (i === 0) {\n          let min = (vm._scales.color.invertExtent(d)[0]);\n          return vm.utils.format(min, vm._config.decimals);\n        } else {\n          return '';\n        }\n      });\n  };\n\n  Heatmap.drawLabels = function () {\n    var vm = this;\n    var cards = vm.chart.svg().selectAll('.dbox-label').data(vm._data, function (d) {\n      return d.y + ':' + d.x;\n    });\n    // AXIS\n    /*cards.enter().append('text')\n      .attr('transform', 'translate(' + (-vm._gridWidth/2) + ', 10)')\n      .attr('dx', function(d){ \n        return (((vm._config.xCategories.indexOf(String(d.x))) + 1) * vm._gridWidth);\n      })\n      .attr('dy', function(d) {\n        return (vm._config.yCategories.indexOf(String(d.y))) * vm._gridHeight;\n      })\n      .attr('class', 'dbox-label')\n      .text( function(d) { return d.x });\n\n    cards.enter().append('text')\n      .attr('transform', 'translate(' + (-vm._gridWidth/2) + ', 30)')\n      .attr(\"dx\", function(d){\n        return (((vm._config.xCategories.indexOf(String(d.x))) + 1) * vm._gridWidth)\n      })\n      .attr('dy', function(d) {\n        return (vm._config.yCategories.indexOf(String(d.y))) * vm._gridHeight;\n      })\n      .attr('class', 'dbox-label')\n      .text( function(d) { return d.y });*/\n\n    cards.enter().append('text')\n      .attr('transform', 'translate(' + (-vm._gridWidth/2) + ', 20)')\n      .attr(\"dx\", function(d){\n        return (((vm._config.xCategories.indexOf(String(d.x))) + 1) * vm._gridWidth)\n      })\n      .attr('dy', function(d) {\n        return (vm._config.yCategories.indexOf(String(d.y))) * vm._gridHeight;\n      })\n      .attr('class', 'dbox-label')\n      .text( function(d) {\n        return d.value ? vm.utils.format(d.value, vm._config.decimals) : '';\n      });\n\n    //COEFFICIENT\n    cards.enter().append('text')\n      .attr('transform', 'translate(' + (-vm._gridWidth/2) + ', 40)')\n      .attr(\"dx\", function(d){\n        return (((vm._config.xCategories.indexOf(String(d.x))) + 1) * vm._gridWidth)\n      })\n      .attr('dy', function(d) {\n        return (vm._config.yCategories.indexOf(String(d.y))) * vm._gridHeight;\n      })\n      .attr('class', 'dbox-label-coefficient')\n      .text( function(d) {\n        return d.coefficient ? '(' + parseFloat(d.coefficient).toFixed(1) + ')' : '';\n      });\n  }\n\n  Heatmap.draw = function () {\n    var vm = this;\n\n    //Call the tip\n    vm.chart.svg().call(vm._tip);\n\n    const axesTip = vm.utils.d3.tip().html(d => {\n      return '<div class=\"title-tip\">' + d + '</div>';\n    });\n    vm.chart.svg().call(axesTip);\n\n    vm._yLabels = vm.chart.svg().append('g')\n      .attr('class', 'y axis')\n      .attr('transform', 'translate(0,0)')\n      .selectAll('.tick')\n      .data(vm._config.yCategories)\n      .enter()\n      .append('g')\n      .attr('class', 'tick')\n      .attr('transform', function(d, i) {\n        return 'translate(0,' + (i * vm._gridHeight) + ')';\n      })\n      .append('text')\n      .attr('text-anchor', 'end')\n      .attr('transform', 'translate(-6,' + vm._gridHeight / 1.5 + ')')\n      .text(function (d) {\n        return d;\n      });\n\n    vm._yLabels.each(function(d) {\n      if (this.getComputedTextLength() > vm._config.size.margin.left * 0.9) {\n        d3.select(this)\n          .on('mouseover', axesTip.show)\n          .on('mouseout', axesTip.hide);\n        let i = 1;\n        while (this.getComputedTextLength() > vm._config.size.margin.left * 0.9) {\n          d3.select(this).text(function (d) {\n            return d.slice(0, -i) + '...';\n          }).attr('title', d);\n          ++i;\n        }\n      }\n    });\n\n    vm._xLabels = vm.chart.svg().append('g')\n      .attr('class', 'x axis')\n      .attr('transform', 'translate(0,0)')\n      .selectAll('.tick')\n      .data(vm._config.xCategories)\n      .enter()\n      .append('g')\n      .attr('class', 'tick')\n      .attr('transform', function (d, i) {\n        return 'translate(' + (i * vm._gridWidth + (vm._gridWidth / 2)) + ',' + (vm._config.yCategories.length * vm._gridHeight + 20 ) + ')';\n      })\n      .append('text')\n      .attr('text-anchor', 'middle')\n      .text(function (d) {\n        return d;\n      });\n\n    const biggestLabelWidth = d3.max(d3.select('.x.axis').selectAll('text').nodes().map(o => o.getComputedTextLength())); // Biggest label computed text length\n    let xBandWidth = vm._gridWidth;\n    let labelMaxWidth = xBandWidth;\n    if (biggestLabelWidth > xBandWidth) { // Biggest label doesn't fit\n      vm._xLabels.each(function (d) {\n        d3.select(this)\n          .attr('text-anchor', 'end')\n          .attr('dy', 0)\n          .attr('transform', 'translate(-5,-10)rotate(-90)');\n        // Still doesn't fit!\n        labelMaxWidth = 0.75 * vm._config.size.margin.bottom;\n        if (this.getComputedTextLength() > labelMaxWidth) {\n          d3.select(this)\n            .on('mouseover', axesTip.show)\n            .on('mouseout', axesTip.hide);\n          let i = 1;\n          while (this.getComputedTextLength() > labelMaxWidth) {\n            d3.select(this).text(function (d) {\n              return d.slice(0, -i) + '...';\n            }).attr('title', d);\n            ++i;\n          }\n        } else {\n          return d;\n        }\n      });\n    }\n\n    vm._scales.color = d3.scaleQuantile()\n      .domain([0, d3.max(vm._data, function (d) {\n        return d.value;\n      })])\n      .range(vm._config.colors);\n\n    var cards = vm.chart.svg().selectAll('.grid-cell')\n      .data(vm._data, function (d) {\n        return d.y + ':' + d.x;\n      });\n\n    cards.enter().append('rect')\n      .attr('x', function (d) {\n        return (vm._config.xCategories.indexOf(String(d.x))) * vm._gridWidth;\n      })\n      .attr('y', function (d) {\n        return (vm._config.yCategories.indexOf(String(d.y))) * vm._gridHeight;\n      })\n      .attr('rx', vm._config.borderRadius || 5)\n      .attr('ry', vm._config.borderRadius || 5)\n\n      .attr('class', 'grid-cell')\n      .attr('stroke', '#fff')\n      .attr('stroke-width', '3px')\n      .attr('id', function (d) {\n        return 'x' + d.x + 'y' + d.y;\n      })\n      .attr('width', vm._gridWidth)\n      .attr('height', vm._gridHeight)\n      .on('mouseover', function (d, i) {\n        vm._tip.show(d, d3.select(this).node());\n        if (vm._config.hasOwnProperty('mouseover')) {\n          vm._config.mouseover.call(vm, d, i);\n        }\n      })\n      .on('mouseout', function (d, i) {\n        vm._tip.hide(d, d3.select(this).node());\n        if (vm._config.hasOwnProperty('mouseout')) {\n          vm._config.mouseout.call(this, d, i);\n        }\n      })\n      .on('click', function (d, i) {\n        if (vm._config.hasOwnProperty('onclick')) {\n          vm._config.onclick.call(this, d, i);\n        }\n      })\n      .attr('fill', vm._config.colors[0])\n      .transition()\n      .duration(3000)\n      .ease(d3.easeLinear)\n      .attr('fill', function (d) {\n        return vm._scales.color(d.value);\n      });\n\n    Heatmap.drawLabels();\n\n    if (vm._config.hasOwnProperty('legendTitle') ) {\n      Heatmap.drawColorLegend();\n    }\n\n    /*\n      var legend = vm.chart.svg().selectAll('.legend')\n          .data([0].concat(colorScale.quantiles()), function(d) { return d; });\n\n      var lgroup = legend.enter().append('g')\n          .attr('class', 'legend');\n\n      lgroup.append('rect')\n          .attr('x', function(d, i) {  return vm._legendElementWidth * i; })\n          .attr('y', vm._config.size.height - vm._config.size.margin.bottom*2)\n          .attr('width', vm._legendElementWidth)\n          .attr('height', vm._gridWidth / 2)\n          .style('fill', function(d, i) { return vm._config.colors[i]; });\n\n      lgroup.append('text')\n          .attr('class', 'mono')\n          .text(function(d) { return ' ' + Math.round(d); })\n          .attr('x', function(d, i) { return vm._legendElementWidth * i; })\n          .attr('y', vm._config.size.height - vm._config.size.margin.bottom*2 + vm._gridWidth);\n\n      legend.exit().remove();*/\n    return vm;\n  };\n\n  Heatmap.init(config);\n\n  return Heatmap;\n}\n","import * as d3 from 'd3';\n/**\n * Leaflet Chart\n */\n\nexport default function (config, helper) {\n\n  var Leaflet = Object.create(helper);\n\n  Leaflet.init = function (config) {\n    const vm = this;\n    vm._config = config ? config : {};\n    vm._scales = {};\n    vm._axes = {};\n    vm._data = [];\n\n    vm._scales.color = d3.scaleQuantize().range([\"#fee5d9\", \"#fcae91\", \"#fb6a4a\", \"#de2d26\", \"#a50f15\"\n    ]);\n  }\n\n  Leaflet.id = function (col) {\n    var vm = this;\n    vm._config.id = col;\n    return vm;\n  }\n\n  Leaflet.fill = function (col) {\n    var vm = this;\n    vm._config.fill = col;\n    return vm\n  }\n\n  Leaflet.opacity = function (value) {\n    var vm = this;\n    vm._config.opacity = value;\n    return vm;\n  }\n\n  Leaflet.colors = function (colors) {\n    var vm = this;\n    vm._config.colors = colors;\n    if (colors && Array.isArray(colors)) {\n      vm._scales.color.range(colors);\n    } else if (typeof colors === 'function') {\n      vm._scales.color = colors;\n    }\n    return vm;\n  }\n\n  Leaflet.colorLegend = function (legendTitle) {\n    var vm = this;\n    vm._config.legendTitle = legendTitle;\n    return vm;\n  };\n\n  // -------------------------------\n  // Triggered by chart.js;\n  Leaflet.data = function (data) {\n    var vm = this;\n    vm._topojson = data[1] ? data[1] : false; //Topojson\n    data = data[0]; //User data\n\n    if (vm._config.data.filter) {\n      data = data.filter(vm._config.data.filter);\n    }\n\n    vm._data = data;\n    //vm._quantiles = vm._setQuantile(data);\n    vm._minMax = d3.extent(data, function(d) { return +d[vm._config.fill]; })\n\n    vm._scales.color.domain(vm._minMax);\n\n    var objects = vm._config.map.topojson.objects;\n\n    vm._nodes = [];\n    if (Array.isArray(objects)) {\n      for (let idx = 0; idx < objects.length; idx++) {\n        const obj = objects[idx];\n        vm._topojson.objects[obj].geometries.forEach(function (geom) {\n          geom.id = vm._config.map.topojson.parser(geom);\n          var found = vm._data.filter(o => o[vm._config.id] == geom.id)[0];\n          if (found) {\n            geom.properties[vm._config.fill] = found[vm._config.fill];\n          }\n          vm._nodes.push(geom);\n        });\n      }\n    } else if (objects) {\n      vm._topojson.objects[objects].geometries.forEach(function (geom) {\n        geom.id = vm._config.map.topojson.parser(geom);\n        var found = vm._data.filter(o => o[vm._config.id] == geom.id)[0];\n        if (found) {\n          geom.properties[vm._config.fill] = found[vm._config.fill];\n        }\n        vm._nodes.push(geom);\n      });\n    }\n\n    // vm._config.map.min = vm._minMax[0];\n    // vm._config.map.max = vm._minMax[1];\n    return vm\n  }\n\n  Leaflet.scales = function () {\n    var vm = this;\n    return vm\n  }\n\n  Leaflet.drawColorLegend = function () {\n    var vm = this;\n    \n    var range = vm._scales.color.range().length;\n    var step = (vm._minMax[1] - vm._minMax[0]) / (range - 1);\n    var domain = vm._config.colors;\n\n    var quantilePosition = d3.scaleBand().rangeRound([vm._config.size.height * 0.8, 0]).domain(domain);\n    //Add gradient legend \n    //defaults to right position\n    var legend = d3.select('#' + vm._config.bindTo)\n      .append('svg')\n        .attr('width', 120)\n        .attr('height', vm._config.size.height)\n        .style('z-index', 401)\n        .style('position', 'absolute')\n        .style('top', '4px')\n        .style('right', '2px')\n      .append('g')\n      .attr('class', 'legend quantized')\n      .attr('transform', 'translate(50,25)');\n    \n    // legend background\n    legend.append('rect')\n      .attr('x', -50)\n      .attr('y', -35)\n      .attr('width', 100)\n      .attr('height', vm._config.size.height - 10)\n      .attr('rx', 10)\n      .attr('ry', 10)\n      .attr('class', 'legend-background')\n      .attr('fill', 'rgba(255,255,255,0.6)');\n    \n      // legend title\n    legend.append('text')\n      .attr('x', 0)\n      .attr('y', -12)\n      .attr('class', 'legend-title')\n      .attr('text-anchor', 'middle')\n      .text(vm._config.legendTitle);\n\n    var quantiles = legend.selectAll('.quantile')\n      .data(vm._config.colors)\n      .enter()\n      .append('g')\n      .attr('class', 'quantile')\n      .attr('transform', function(d) {\n        return 'translate(-20, ' + quantilePosition(d)\n         + ')';\n      })\n\n    // Rect\n    quantiles.append('rect')\n      .attr('x', -10)\n      .attr('y', 0)\n      .attr('width', 18)\n      .attr('height', quantilePosition.bandwidth())\n      .attr('fill', function (d) {\n        return d;\n      });\n    \n\n    //top text is the max value\n    quantiles.append('text')\n      .attr('x', 17)\n      .attr('y', 5)\n      .attr('class', 'top-label')\n      .attr('text-anchor', 'left')\n      .text(function(d){\n        let max = (vm._scales.color.invertExtent(d)[1]);\n        if (vm._config.legendTitle === 'Porcentaje' && max > 100) {\n          max = 100;\n        }\n        if (vm._config.map.formatLegend) {\n          return vm._config.map.formatLegend(max);\n        } else {\n          return vm.utils.format(max);\n        }\n      });\n\n    //bottom text is the min value\n    quantiles.append('text')\n      .attr('x', 17)\n      .attr('y', vm._config.size.height / 5 - 11)\n      .attr('class', 'bottom-label')\n      .attr('text-anchor', 'left')\n      .text(function(d, i){\n        if (i === 0) {\n          let min = (vm._scales.color.invertExtent(d)[0]);\n          if (vm._config.map.formatLegend) {\n            return vm._config.map.formatLegend(min);\n          } else {\n            return vm.utils.format(min);\n          }\n        } else {\n          return '';\n        }\n      });\n  };\n\n  Leaflet.draw = function () {\n    var vm = this;\n\n    var urlTopojson = vm._config.map.topojson.url;\n    var objects = vm._config.map.topojson.objects; //'states'\n    var tran = vm._config.map.topojson.translate; //var tran = [2580, 700];\n    var scale = vm._config.map.topojson.scale; //1300\n    var parser = vm._config.map.topojson.parser;\n    var id = vm._config.map.topojson.id;\n\n    L.TopoJSON = L.GeoJSON.extend({\n      addData: function (jsonData) {\n        var geojson, key;\n        if (jsonData.type === 'Topology') {\n          if (objects) {\n            if (Array.isArray(objects)) {\n              for (let idx = 0; idx < objects.length; idx++) {\n                const obj = objects[idx];\n                geojson = topojson.feature(jsonData, jsonData.objects[obj]);\n                L.GeoJSON.prototype.addData.call(this, geojson);\n              }\n            } else {\n              geojson = topojson.feature(jsonData, jsonData.objects[objects]);\n              L.GeoJSON.prototype.addData.call(this, geojson);\n            }\n          } else {\n            for (key in jsonData.objects) {\n              geojson = topojson.feature(jsonData, jsonData.objects[key]);\n              L.GeoJSON.prototype.addData.call(this, geojson);\n            }\n          }\n        } else {\n          L.GeoJSON.prototype.addData.call(this, jsonData);\n        }\n      }\n    });\n\n    var LatLng = {\n      lat: 25.5629994, \n      lon: -100.6405644\n    }\n    if (vm._config.map.topojson.center && vm._config.map.topojson.center.length === 2) {\n      LatLng.lat = vm._config.map.topojson.center[0]\n      LatLng.lon = vm._config.map.topojson.center[1]\n    }\n\n    var bounds = new L.LatLngBounds(new L.LatLng(LatLng.lat + 5, LatLng.lon - 5), new L.LatLng(LatLng.lat - 5, LatLng.lon + 5));\n\n    vm._map = new L.Map(vm._config.bindTo, {\n        center: bounds.getCenter(),\n        zoom: vm._config.map.topojson.zoom || 7,\n        maxZoom: vm._config.map.topojson.maxZoom || 10,\n        minZoom: vm._config.map.topojson.minZoom ||3,\n        maxBounds: bounds,\n        maxBoundsViscosity: 1.0\n      });\n\n    var mapTiles = L.tileLayer('http://b.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png', {\n        attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>'\n      });\n    var topoLayer = new L.TopoJSON();\n    \n    mapTiles.addTo(vm._map);\n    addTopoData(vm._topojson)\n\n    function addTopoData(topoData) {\n      topoLayer.addData(topoData);\n      topoLayer.addTo(vm._map);\n      topoLayer.eachLayer(handleLayer);\n    }\n\n    var tip = vm.utils.d3.tip().html(vm._config.tip || function(d) {\n      let html = '<div class=\"d3-tip\" style=\"z-index: 99999;\"><span>' + (d.feature.properties.NOM_ENT || d.feature.properties.NOM_MUN) + '</span><br/><span>' +\n        vm.utils.format(d.feature.properties[vm._config.fill]) + '</span></div>';\n      return html;\n    })\n    d3.select('#' + vm._config.bindTo).select('svg.leaflet-zoom-animated').call(tip);\n    function handleLayer(layer) {\n      \n      var value = layer.feature.properties[vm._config.fill];\n      if (!value) {\n        // Remove polygons without data\n        /** @todo validate what to do with NA's */\n        d3.select(layer._path).remove();\n      } else {\n        var fillColor = vm._scales.color(value);\n        \n        layer.setStyle({\n          fillColor: fillColor,\n          fillOpacity: vm._config.opacity ||0.7,\n          color: '#555',\n          weight: 1,\n          opacity: .5\n        });\n\n        layer.on({\n          mouseover: function() {\n            enterLayer(layer)\n          },\n          mouseout: function() {\n            leaveLayer(layer);\n          }\n        });\n      }\n    }\n\n    function enterLayer(layer) {\n      tip.show(layer, d3.select(layer._path).node());\n    }\n\n    function leaveLayer(layer) {\n      tip.hide(layer);\n    }\n\n    /**\n     * Draw Legend\n     */\n    if (typeof vm._config.legend === 'function') {\n      vm._config.legend.call(this, vm._nodes);\n    }\n\n    Leaflet.drawColorLegend();\n    \n    return vm\n  }\n  \n\n  Leaflet.init(config);\n\n  return Leaflet;\n}\n","import * as d3 from 'd3';\n/*\n * Map \n */\n\nexport default function(config) {\n\n  function Map(config) {\n    var vm = this;\n    vm._config = config ? config : {};\n    vm._data = [];\n    vm._scales = {};\n    vm._axes = {};\n    vm._tip = vm.utils.d3.tip().attr('class', 'd3-tip');\n\n    vm._formatWithZeroDecimals  = d3.format(\",.0f\");\n    vm._formatWithOneDecimal    = d3.format(\",.1f\");\n    vm._formatWithTwoDecimals   = d3.format(\",.2f\");\n    vm._formatWithThreeDecimals = d3.format(\",.3f\");\n\n    vm._format = {};\n    vm._format.total = vm._formatWithZeroDecimals;\n    vm._format.percentage = function(d){return d3.format(\",.1f\")(d) + '%';} ;\n    vm._format.change =  d3.format(\",.1f\");\n\n  }\n\n  //-------------------------------\n  //User config functions\n\n  Map.prototype.id = function(col) {\n    var vm = this;\n    vm._config.id = col;\n    return vm;\n  }\n\n  Map.prototype.color = function(col) {\n    var vm = this;\n    vm._config.color = col;\n    return vm;\n  }\n\n  Map.prototype.tip = function(tip){\n    var vm = this;\n    vm._config.tip = tip;\n    vm._tip.html(vm._config.tip);\n    return vm;\n  }\n\n  Map.prototype.onclick = function(onclick){\n    var vm = this;\n    vm._config.onclick = onclick;\n    return vm;\n  }\n\n  Map.prototype.end = function() {\n    var vm = this;\n    return vm._chart;\n  }\n\n  //-------------------------------\n  //Triggered by the chart.js;\n  Map.prototype.chart = function(chart) {\n    var vm = this;\n    vm._chart = chart;\n    return vm;\n  }\n\n \n  Map.prototype.data = function(data) {\n    var vm = this;\n    \n    vm._topojson = data[1]? data[1] : false ; //Topojson\n    var data = data[0]; //User data\n\n    if(vm._config.data.filter){\n      data = data[0].filter(vm._config.data.filter);\n    }\n  \n    vm._data = data;\n    vm._quantiles = vm._setQuantile(data);\n    vm._minMax = d3.extent(data, function(d) { return +d[vm._config.color]; })\n\n    vm._config.map.min = vm._minMax[0];\n    vm._config.map.max = vm._minMax[1];\n\n    return vm;\n  }\n\n  Map.prototype.scales = function(s) {\n    var vm = this;\n    vm._scales = s;\n    return vm;\n  }\n\n  Map.prototype.axes = function(a) {\n    var vm = this;\n    vm._axes = a;\n    return vm;\n  }\n\n  Map.prototype.domains = function() {\n    var vm = this;\n    return vm;\n  };\n\n  Map.prototype.draw  = function(){\n    var vm = this;\n\n    //@config\n    var urlTopojson = vm._config.map.topojson.url;\n    var objects = vm._config.map.topojson.objects; //'states'\n    var tran = vm._config.map.topojson.translate; //var tran = [2580, 700];\n    var scale = vm._config.map.topojson.scale; //1300\n    \n    var parser = vm._config.map.topojson.parser;\n   \n    var id = vm._config.map.topojson.id;\n\n    //Call the tip\n    vm._chart._svg.call(vm._tip)\n\n    vm._projection = d3.geoMercator()\n        .scale(scale)\n        .translate(tran);\n\n    vm.path = d3.geoPath()\n        .projection(vm._projection);\n\n    vm._polygons = vm._chart._svg.append(\"g\")\n        .attr(\"id\", \"dbox-map-polygons\")\n        .style('display', 'true')\n        .attr(\"transform\", function() {\n            return \"translate(\" + (vm._config.size.translateX) + \",100) scale(\" + vm._config.size.scale + \")\"\n        });\n    \n    var features = topojson.feature(vm._topojson, vm._topojson.objects[objects]).features;\n    //console.log('topojson features', features);\n    if (typeof vm._config.map.topojson.filter != 'undefined') {\n      var filter = vm._config.map.topojson.filter;\n      console.log(filter);\n      Object.keys(filter).map(function(key) {\n        features = features.filter(feature => feature.properties[key] === filter[key]);\n      });\n    }\n\n    vm._polygons.selectAll(\"path\")\n        .data(features, parser)\n        .enter().append(\"path\")\n        .attr(\"d\", d3.geoPath().projection(vm._projection))\n        .attr(\"id\", id) \n        .attr(\"data-geotype\", objects)\n        .attr(\"fill\", \"#808080\")\n        .attr('stroke', '#a0a0a0')\n        .style('stroke-width', '1px')\n        .on('mouseover', function(d, i) {\n        \n          if(vm._config.map.quantiles.colorsOnHover){ //OnHover colors\n            d3.select(this).attr('fill', function(d) {\n                return vm._getQuantileColor(d[vm._config.color],'onHover');\n            })\n          }\n\n          //vm._tip.show(d, d3.select(this).node()) //Show TIP\n\n          if (vm._config.data.onmouseover) { //External function call\n            vm._config.data.onmouseover.call(this, d, i);\n          }\n\n        })\n        .on('mouseout', function(d, i) {\n\n            if(vm._config.map.quantiles.colorsOnHover){ //OnHover reset default color\n              d3.select(this).attr('fill', function(d) {\n                  return vm._getQuantileColor(d[vm._config.color],'default');\n              })\n            }\n            //Hide tip\n            //vm._tip.hide(d, d3.select(this).node()) \n\n            if (vm._config.data.onmouseout) { //External function call\n              vm._config.data.onmouseout.call(this, d, i)\n            }\n            \n        })\n        .on(\"click\", function(d, i) {\n            if (vm._config.data.onclick) {\n                vm._config.data.onclick.call(this, d, i)\n            }\n        })\n\n    vm._polygonsDefault = vm._polygons.selectAll(\"path\").data();\n\n    vm._polygons.selectAll(\"path\").attr(\"stroke\", \"#333\").attr('stroke-width', 0.2);\n    vm._polygons.selectAll(\"path\").attr(\"fill\", \"red\");\n    vm._polygons.selectAll(\"path\").attr('data-total', null);\n    vm._polygons.selectAll(\"path\")\n        .data(vm._data, function(d) {\n          //@TODO WHY THE F..K IS D3 ITERATING OVER THE OLD DATA\n          return d.id ? d.id : d[vm._config.id];\n        })\n        .attr('fill', function(d) {\n            return vm._getQuantileColor(d[vm._config.color],'default');\n        })\n        .attr('data-total', function(d) {\n            return +d[vm._config.color];\n        })\n\n    //Resets the map paths data to topojson\n    vm._polygons.selectAll(\"path\").data(vm._polygonsDefault, function(d) {\n        return d.id;\n    });\n\n\n  };\n\n  Map.prototype._setQuantile = function(data){\n    var vm = this; \n    var values = [];\n    var quantile = []; \n\n    if(vm._config.map.quantiles &&  vm._config.map.quantiles.predefinedQuantiles \n        && vm._config.map.quantiles.predefinedQuantiles.length > 0){\n      return vm._config.map.quantiles.predefinedQuantiles;\n    }\n\n    data.forEach(function(d){      \n      values.push(+d[vm._config.color]);\n    });\n\n    values.sort(d3.ascending);\n    \n    //@TODO use quantile scale instead of manual calculations \n    if(vm._config && vm._config.map && vm._config.map.quantiles && vm._config.map.quantiles.buckets){\n\n      if(vm._config.map.quantiles.ignoreZeros === true){\n        var aux = _.dropWhile(values, function(o) { return o <= 0 });\n        //aux.unshift(values[0]);  \n\n        quantile.push(values[0]);\n        quantile.push(0);\n        \n        for(var i = 1; i <= vm._config.map.quantiles.buckets - 1; i++ ){        \n          quantile.push( d3.quantile(aux,  i* 1/(vm._config.map.quantiles.buckets - 1) ) )\n        }\n\n      }else{\n        quantile.push( d3.quantile(values, 0) )\n        for(var i = 1; i <= vm._config.map.quantiles.buckets; i++ ){        \n          quantile.push( d3.quantile(values,  i* 1/vm._config.map.quantiles.buckets ) )\n        }\n      }\n        \n    }else{\n      quantile = [ d3.quantile(values, 0), d3.quantile(values, 0.2), d3.quantile(values, 0.4), d3.quantile(values, 0.6), d3.quantile(values, 0.8), d3.quantile(values,1) ];\n    }\n   \n    //@TODO - VALIDATE WHEN ZEROS NEED TO BE PUT ON QUANTILE 1 AND RECALCULATE NON ZERO VALUES INTO THE REST OF THE BUCKETS\n    if( vm._config.map.quantiles && vm._config.map.quantiles.buckets \n        && vm._config.map.quantiles.buckets === 5){\n\n      if( quantile[1] === quantile[2] && quantile[2] === quantile[3] && quantile[3] === quantile[4] && quantile[4] === quantile[5]){\n        quantile = [ d3.quantile(values, 0), d3.quantile(values, 0.2) ];\n      }\n    }\n   \n    return quantile;\n  }\n\n  Map.prototype._getQuantileColor = function(d,type){\n    var vm = this; \n    var total = parseFloat(d);\n\n    //@TODO use quantile scale instead of manual calculations \n    if(vm._config && vm._config.map && vm._config.map.quantiles && vm._config.map.quantiles.colors){\n      if(vm._quantiles.length > 2){\n\n        if(vm._config && vm._config.map && vm._config.map.min !== undefined && vm._config.map.max !== undefined){\n          if(total < vm._config.map.min || total > vm._config.map.max){\n            console.log('outOfRangeColor', total, vm._config.map.min ,vm._config.map.max)\n            return vm._config.map.quantiles.outOfRangeColor; \n          }\n        }else{\n          if(total < vm._minMax[0] || total > vm._minMax[1]){\n            console.log('outOfRangeColor', total, vm._config.map.min ,vm._config.map.max)\n            return vm._config.map.quantiles.outOfRangeColor; \n          }\n        }\n\n        if(type == 'default'){\n          if(total <= vm._quantiles[1]){\n            return vm._config.map.quantiles.colors[0];//\"#f7c7c5\";\n          }else if(total <= vm._quantiles[2]){\n            return vm._config.map.quantiles.colors[1];//\"#e65158\";\n          }else if(total <= vm._quantiles[3]){\n            return vm._config.map.quantiles.colors[2];//\"#c20216\";\n          }else if(total <= vm._quantiles[4]){\n            return vm._config.map.quantiles.colors[3];//\"#750000\";\n          }else if(total <= vm._quantiles[5]){\n            return vm._config.map.quantiles.colors[4];//\"#480000\";\n          }\n        }\n\n        if(type == 'onHover' && vm._config.map.quantiles.colorsOnHover){\n          if(total <= vm._quantiles[1]){\n            return vm._config.map.quantiles.colorsOnHover[0];//\"#f7c7c5\";\n          }else if(total <= vm._quantiles[2]){\n            return vm._config.map.quantiles.colorsOnHover[1];//\"#e65158\";\n          }else if(total <= vm._quantiles[3]){\n            return vm._config.map.quantiles.colorsOnHover[2];//\"#c20216\";\n          }else if(total <= vm._quantiles[4]){\n            return vm._config.map.quantiles.colorsOnHover[3];//\"#750000\";\n          }else if(total <= vm._quantiles[5]){\n            return vm._config.map.quantiles.colorsOnHover[4];//\"#480000\";\n          }\n        }\n\n      }\n    }\n\n    if(vm._quantiles.length == 2){\n      /*if(total === 0 ){\n        return d4theme.colors.quantiles[0];//return '#fff';\n      }else if(total <= vm._quantiles[1]){\n        return d4theme.colors.quantiles[1];//return \"#f7c7c5\";\n      }*/\n      if(total <= vm._quantiles[1]){\n        return vm._config.map.quantiles.colors[0];//\"#f7c7c5\";\n      }\n    }\n\n  }\n\n\n\n\n\n\n return new Map(config);\n}","import * as d3 from 'd3';\n\n/*\n * Build a radar chart.\n */\nexport default function(config) {\n  function Radar(config) {\n    var vm = this, size;\n\n    vm.CIRCLE_RADIANS = 2 * Math.PI;\n\n    // The first axis must be at the circle's top.\n    vm.RADIANS_TO_ROTATE = vm.CIRCLE_RADIANS / -4;\n\n    vm._config = config ? config : {};\n    vm._data = [];\n    vm._scales = {};\n    vm._axes = {};\n    vm._axesData = {};\n    vm._filter = null;\n    vm._minMax = [0, 0];\n    vm._viewData = [];\n    vm._colorMap = {};\n    vm._ticks = 0;\n    vm._scale = null;\n    vm._excludedPolygons = [];\n\n    // Set defaults.\n    if(!vm._config.ticks) {\n      vm._config.ticks = 10;\n    }\n\n    if(!vm._config.transitionDuration) {\n      vm._config.transitionDuration = 400;\n    }\n\n    if(!vm._config.axisLabelMargin) {\n      vm._config.axisLabelMargin = 24;\n    }\n\n    if(!vm._config.legend) {\n      vm._config.legend = {\n        enable: true\n      };\n    }\n\n    if(!vm._config.legend.at) {\n      vm._config.legend.at = {\n        x: 20,\n        y: 20\n      };\n    }\n\n    if('undefined' == typeof vm._config.styleDefaults) {\n      vm._config.styleDefaults = true;\n    }\n\n    // Calculate basic data.\n    size = vm._config.size;\n\n    vm._center = {\n      x: (size.width / 2) - size.margin.left,\n      y: (size.height / 2) - size.margin.top\n    };\n\n    vm._radius = Math.min(\n      (size.width - size.margin.left - size.margin.right) / 2,\n      (size.height - size.margin.top - size.margin.bottom) / 2\n    );\n  }\n\n  // User API.\n\n  Radar.prototype.polygonsFrom = function(column) {\n    var vm = this;\n    vm._config.polygonsFrom = column;\n    return vm;\n  };\n\n  Radar.prototype.axesFrom = function(column) {\n    var vm = this;\n    vm._config.axesFrom = column;\n    return vm;\n  };\n\n  Radar.prototype.valuesFrom = function(column) {\n    var vm = this;\n    vm._config.valuesFrom = column;\n    return vm;\n  };\n\n  Radar.prototype.ticks = function(ticks) {\n    var vm = this;\n    vm._config.ticks = ticks;\n    return vm;\n  };\n\n  Radar.prototype.colors = function(colors) {\n    var vm = this;\n    vm._config.colors = colors;\n    return vm;\n  };\n\n  Radar.prototype.end = function() {\n    var vm = this;\n    return vm._chart;\n  };\n\n  // Internal helpers.\n\n  Radar.prototype.drawTicks = function() {\n    var vm = this,\n      svg = vm._chart._svg,\n      dur = vm._config.transitionDuration,\n      sel;\n\n    sel = svg.select('g.ticks');\n\n    if(sel.empty()) {\n      sel = svg.append('g').attr('class', 'ticks');\n    }\n\n    sel = sel.selectAll('circle.tick')\n      .data(\n        // Add an explicit index for keying the chart with their original array\n        // indexes, then reverse it so rendering occurs from bigger to smaller\n        // circles, allowing to set a fill color to the concentric cirlces\n        // without getting the more external cirlce capping all the others.\n        vm._ticks.map((val, idx) => [idx, val]).reverse(),\n        d => d[0]);\n\n    sel\n      .transition()\n      .duration(dur)\n      .attr('r', function(d) { return vm._scale(d[1]); });\n\n    sel.enter()\n      .append('circle')\n      .classed('tick', true)\n      .attr('cx', vm._center.x)\n      .attr('cy', vm._center.y)\n      .style('fill', vm._ifStyleDefaults('none'))\n      .style('stroke', vm._ifStyleDefaults('gray'))\n      .attr('r', function(d) { return vm._scale(d[1]); })\n      .attr('opacity', 0)\n      .transition()\n      .duration(dur)\n      .attr('opacity', 1);\n\n    sel.exit()\n      .transition()\n      .duration(dur)\n      .attr('opacity', 0)\n      .remove();\n  };\n\n  Radar.prototype.drawTicksLabels = function() {\n    var vm = this,\n      svg = vm._chart._svg,\n      margin = 2,\n      dur = vm._config.transitionDuration,\n      sel;\n\n    sel = svg.select('g.ticks-labels');\n\n    if(sel.empty()) {\n      sel = svg.append('g').attr('class', 'ticks-labels');\n    }\n\n    sel = sel.selectAll('text.tick-label')\n      .data(vm._ticks);\n\n    sel\n      .transition()\n      .duration(dur)\n      .text(function(d) { return d; })\n      .attr('y', function(d) { return vm._center.y - margin - vm._scale(d); });\n\n    sel.enter()\n      .append('text')\n      .text(function(d) { return d.toFixed(1); })\n      .attr('class', 'tick-label')\n      .attr('x', vm._center.x + margin)\n      .attr('y', function(d) { return vm._center.y - margin - vm._scale(d); })\n      .attr('fill', vm._ifStyleDefaults('gray'))\n      .style('font-family', vm._ifStyleDefaults('sans-serif'))\n      .attr('opacity', 0)\n      .transition()\n      .duration(dur)\n      .attr('opacity', 1);\n\n    sel.exit()\n      .transition()\n      .duration(dur)\n      .attr('opacity', 0)\n      .remove();\n  };\n\n  Radar.prototype.extractAxes = function(data) {\n    var result,\n      vm = this,\n      axes = vm._config.axesFrom,\n      radiansPerAxis;\n\n    result = data.reduce(\n      function(prev, item) {\n        return prev.indexOf(item[axes]) > -1\n          ? prev\n          : prev.concat(item[axes]);\n      }, []);\n\n    radiansPerAxis = (vm.CIRCLE_RADIANS / result.length);\n\n    result = result.map(\n      function(item, idx) {\n        return {\n          axis: item,\n          rads: (idx * radiansPerAxis) + vm.RADIANS_TO_ROTATE\n        };\n      });\n\n    return {\n      list: result,\n      hash: result.reduce(function(hashed, el) {\n        hashed[el.axis] = el;\n        return hashed;\n      }, {})\n    };\n  };\n\n  Radar.prototype.buildColorMap = function(data) {\n    var vm = this,\n      colors = vm._config.colors;\n    return data.reduce(function(cMap, row) {\n      var polyg = row[vm._config.polygonsFrom],\n        cIdx = cMap.index.indexOf(polyg);\n\n      if(cIdx == -1) {\n        cIdx = cMap.index.push(polyg) - 1;\n        cMap.hash[polyg] = colors[cIdx];\n        cMap.list.push({polygon: polyg, color: colors[cIdx]});\n      }\n      return cMap;\n    }, {index: [], hash: {}, list: []});\n  };\n\n  Radar.prototype.drawAxes = function() {\n    var vm = this,\n      svg = vm._chart._svg,\n      duration = vm._config.transitionDuration,\n      selection;\n\n    selection = svg.selectAll('line.axis')\n      .data(vm._axesData.list, function(d) { return d.axis; });\n\n    selection.enter()\n      .append('line')\n      .classed('axis', true)\n      .attr('x1', vm._center.x)\n      .attr('y1', vm._center.y)\n      .style('stroke', vm._ifStyleDefaults('gray'))\n      .attr('x2', vm._center.x)\n      .attr('y2', vm._center.y)\n      .transition()\n      .duration(duration)\n      .attr('x2', function(d) {\n        return vm.xOf(d.rads, vm._radius + 8);\n      })\n      .attr('y2', function(d) {\n        return vm.yOf(d.rads, vm._radius + 8);\n      });\n\n    selection\n      .transition()\n      .duration(duration)\n      .attr('x2', function(d) {\n        return vm.xOf(d.rads, vm._radius + 8);\n      })\n      .attr('y2', function(d) {\n        return vm.yOf(d.rads, vm._radius + 8);\n      });\n\n    selection.exit()\n      .transition()\n      .duration(duration)\n      .attr('x2', vm._center.x)\n      .attr('y2', vm._center.y)\n      .remove();\n  };\n\n  Radar.prototype.drawAxesLabels = function() {\n    var vm = this,\n      svg = vm._chart._svg,\n      duration = vm._config.transitionDuration,\n      fromCenter = vm._radius + vm._config.axisLabelMargin,\n      labels,\n      rects;\n\n\n\n\n    rects = svg.selectAll('rect.axis-label')\n      .data(vm._axesData.list, function(d) { return d.axis; });\n\n    rects.enter()\n      .append('rect')\n      .attr('class', 'axis-label')\n      .attr('x', (d) => vm.xOf(d.rads, fromCenter) - 50)\n      .attr('y', (d) => vm.yOf(d.rads, fromCenter) - 20)\n      .attr('rx', '5px')\n      .attr('ry', '5px')\n      .attr('width', '100px')\n      .attr('height', '40px')\n      .attr('fill', '#A3A3AF')\n      .attr('opacity', 0)\n      .transition()\n      .duration(duration)\n      .attr('opacity', 1);\n\n    rects.exit()\n      .transition()\n      .duration(duration)\n      .attr('opacity', 0)\n      .remove();\n\n\n    labels = svg.selectAll('text.axis-label')\n      .data(vm._axesData.list, function(d) { return d.axis; });\n\n    labels\n      .transition()\n      .duration(duration)\n      .attr('x', (d) => vm.xOf(d.rads, fromCenter+5))\n      .attr('y', (d) => vm.yOf(d.rads, fromCenter+5));\n\n    labels.enter()\n      .append('text')\n      .attr('class', 'axis-label')\n      .attr('text-anchor', 'middle')\n      .attr('fill', 'white')//vm._ifStyleDefaults('gray'))\n      .style('font-family', vm._ifStyleDefaults('sans-serif'))\n      .text(function(d) { return d.axis; })\n      .attr('x', (d) => vm.xOf(d.rads, fromCenter+5))\n      .attr('y', (d) => vm.yOf(d.rads, fromCenter+5))\n      .attr('opacity', 0)\n      .transition()\n      .duration(duration)\n      .attr('opacity', 1);\n\n    labels.exit()\n      .transition()\n      .duration(duration)\n      .attr('opacity', 0)\n      .remove();\n  };\n\n  Radar.prototype.drawPolygons = function() {\n\n\n    var vm = this,\n      data = vm._viewData,\n      svg = vm._chart._svg,\n      duration = vm._config.transitionDuration,\n      groupedData,\n      gs, gsExit, gsEnter;\n\n    // Prepare the data.\n    groupedData = data.reduce(function(bundle, row) {\n      var polygIdx = bundle.keys.indexOf(row.polygon);\n      if(polygIdx == -1) {\n        polygIdx = bundle.keys.push(row.polygon) - 1;\n        bundle.polygons.push({\n          polygon: row.polygon,\n          color: row.color,\n          points: [],\n          values: [],\n          rawData:row.rawData,\n        });\n      }\n      bundle.polygons[polygIdx].values.push(row);\n      bundle.polygons[polygIdx].points.push(row.xy.join(','));\n      return bundle;\n    }, {keys: [], polygons:[]}).polygons;\n\n\n    gs = svg.selectAll('g.polygon-container')\n      .data(groupedData, function(d) { return d.polygon + '-container'; });\n\n    gsEnter = gs.enter()\n      .append('g')\n      .attr('class', 'polygon-container')\n      .attr('id', function(d) {\n        var x= d;\n        return 'radar-id-'+d.rawData.CVE_ENT\n      })\n\n    gsExit = gs.exit();\n    gsExit.transition().duration(duration).remove();\n\n    vm._buildNestedPolygons(gs, gsEnter, gsExit);\n    vm._buildNestedVertexes(gs, gsEnter, gsExit);\n  };\n\n  Radar.prototype._buildNestedVertexes = function(update, enter, exit) {\n    var vm = this,\n      duration = vm._config.transitionDuration,\n      selector = 'circle.vertex',\n      toUpdate;\n\n    function appendHelper(selection) {\n      selection\n        .append('circle')\n        .attr('class', 'vertex')\n        .attr('cx', vm._center.x)\n        .attr('cy', vm._center.y)\n        .attr('r', 4)\n        .attr('fill', d => d.color)\n        .call(updateHelper)\n        .on('mouseover', d => {\n          var x = d.xy[0] + 10,\n            y = d.xy[1] - 10;\n          vm._showTooltip(x, y, d.polygon, d.value);\n        })\n        .on('mouseout', () => {\n          vm._hideTooltip();\n        });\n    }\n\n    function removeHelper(selection) {\n      selection\n        .transition()\n        .duration(duration)\n        .attr('cx', vm._center.x)\n        .attr('cy', vm._center.y)\n        .remove();\n    }\n\n    function updateHelper(selection) {\n      selection\n        .transition()\n        .duration(duration)\n        .attr('cx', function(d) { return d.xy[0]; })\n        .attr('cy', function(d) { return d.xy[1]; });\n    }\n\n    function dataFunc(d) { return d.values; }\n\n    function keyFunc(d) { return d.polygon + '-' + d.axis; }\n\n    toUpdate = update.selectAll(selector)\n      .data(dataFunc, keyFunc);\n\n    toUpdate\n      .call(updateHelper);\n\n    toUpdate.enter()\n      .call(appendHelper);\n\n    toUpdate.exit()\n      .call(removeHelper);\n\n    enter.selectAll(selector)\n      .data(dataFunc, keyFunc)\n      .enter()\n      .call(appendHelper);\n\n    exit.selectAll(selector)\n      .call(removeHelper);\n  };\n\n  /**\n   * Draw a tooltip at the given X, Y possition.\n   * @param  {int} x       The X coordinate\n   * @param  {int} y       The Y coordinate\n   * @param  {string} val1 The value to show as the first line\n   * @param  {string} val2 The value to show in the second line\n   * @return {selection}   Return the created tooltip as a D3 selection\n   */\n  Radar.prototype._showTooltip = function(x, y, val1, val2) {\n    var tt, subtt, bg, bbox,\n      padding = 2,\n      vm = this,\n      svg = vm._chart._svg;\n\n    tt = svg.append('g')\n      .attr('class', 'tooltip')\n      .attr('opacity', 0);\n\n    bg = tt.append('rect').attr('class', 'tooltip-background');\n\n    subtt = tt\n      .append('text')\n      .attr('y', y)\n      .attr('x', x)\n      .style('fill', vm._ifStyleDefaults('white'))\n      .style('font-family', vm._ifStyleDefaults('sans-serif'));\n\n    subtt.append('tspan')\n      .text(Number(val2).toFixed(1));\n\n    subtt.append('tspan')\n      .attr('dy', '-1.2em')\n      .attr('x', x)\n      .text(val1);\n\n    bbox = tt.node().getBBox();\n\n    bg.attr('x', bbox.x - padding)\n      .attr('y', bbox.y - padding)\n      .attr('width', bbox.width + (padding * 2))\n      .attr('height', bbox.height + (padding + 2))\n      .style('fill', vm._ifStyleDefaults('gray'));\n\n    tt.transition()\n      .duration(200)\n      .attr('opacity', .9);\n\n    return tt;\n  };\n\n  /**\n   * Remove the tooltip created by _showTooltip()\n   * @return {undefined}\n   */\n  Radar.prototype._hideTooltip = function() {\n    this._chart._svg.selectAll('g.tooltip')\n      .transition()\n      .duration(200)\n      .attr('opacity', 0)\n      .remove();\n  };\n\n  Radar.prototype._buildNestedPolygons = function(update, enter, exit) {\n    var vm = this,\n      duration = vm._config.transitionDuration,\n      selector = 'polygon.category',\n      toUpdate;\n\n    // Used for the transitions where the polygons expand from\n    // or shrink to the center.\n    function centerPoints(data) {\n      var center = [vm._center.x, vm._center.y].join(',');\n      return data.points.map(function() {\n        // All polygon's points move to the center.\n        return center;\n      }).join(' ');\n    }\n\n    function appendHelper(selection) {\n      selection\n        .append('polygon')\n        .attr('class', 'category')\n        .attr('points', centerPoints)\n        .style('stroke', function(d) { return d.color; })\n        .style('fill', function(d) { return d.color; })\n        .style('fill-opacity', 0.4)\n        .style('stroke-width', vm._ifStyleDefaults('1px'))\n        .call(updateHelper);\n    }\n\n    function removeHelper(selection) {\n      selection\n        .transition()\n        .duration(duration)\n        .attr('points', centerPoints)\n        .remove();\n    }\n\n    function updateHelper(selection) {\n      selection\n        .transition()\n        .duration(duration)\n        .attr('points', function(d) { return d.points.join(' '); });\n    }\n\n    function dataFunc(d) { return [d]; }\n\n    function keyFunc(d) { return d.polygon; }\n\n    toUpdate = update.selectAll(selector)\n      .data(dataFunc, keyFunc);\n\n    toUpdate\n      .call(updateHelper);\n\n    toUpdate.enter()\n      .call(appendHelper);\n\n    toUpdate.exit()\n      .call(removeHelper);\n\n    enter.selectAll(selector)\n      .data(dataFunc, keyFunc)\n      .enter()\n      .call(appendHelper);\n\n    exit.selectAll(selector)\n      .call(removeHelper);\n\n  };\n\n  Radar.prototype.drawLegend = function() {\n    var vm = this,\n      cMap = vm._colorMap.list,\n      svg = vm._chart._svg,\n      at = vm._config.legend.at,\n      side = 14,\n      margin = 4,\n      legend, newLegend;\n\n    legend = svg.selectAll('g.legend-item')\n      .data(cMap, function(d) { return d.polygon; })\n      .attr('opacity', d => {\n        return vm._excludedPolygons.indexOf(d.polygon) > -1 ? .4 : 1;\n      });\n\n    newLegend = legend.enter()\n      .append('g')\n      .on('click', (d) => {\n        vm._excludedPolygons = vm._toggleList(\n          vm._excludedPolygons, [d.polygon]);\n        vm.draw();\n      })\n      .attr('class', 'legend-item');\n\n    newLegend\n      .append('text')\n      .text(d => d.polygon)\n      .attr('x', at.x + side + margin)\n      .attr('y', (d, i) => ((side + margin) * i) + at.y + side)\n      .style('font-family', vm._ifStyleDefaults('sans-serif'));\n\n    newLegend\n      .append('rect')\n      .attr('fill', d => d.color)\n      .attr('width', side)\n      .attr('height', side)\n      .attr('x', at.x)\n      .attr('y', (d, i) => ((side + margin) * i) + at.y);\n  };\n\n  /**\n   * Return value if config styleDefaults is true, else null.\n   * @param  {string} value The value to use as default\n   * @return {string}       The value itself or null\n   */\n  Radar.prototype._ifStyleDefaults = function(value) {\n    return this._config.styleDefaults ? value : null;\n  };\n\n  /**\n   * Append items not present in base from items and pop those which are.\n   * @param  {array} base   Array to append to remove from.\n   * @param  {array} items  Items to be toogled (appended or removed).\n   * @return {array}        A new array.\n   */\n  Radar.prototype._toggleList = (base, items) => {\n    var newItems = items.filter(it => base.indexOf(it) == -1);\n    return base.filter(it => items.indexOf(it) == -1).concat(newItems);\n  };\n\n  Radar.prototype.xOf = function(rads, value) {\n    var vm = this;\n    return vm._center.x + (value * Math.cos(rads));\n  };\n\n  Radar.prototype.yOf = function(rads, value) {\n    var vm = this;\n    return vm._center.y + (value * Math.sin(rads));\n  };\n\n  Radar.prototype.minMax = function(data) {\n    var vm = this;\n    return data.reduce(function(minMax, row) {\n      var val = parseInt(row[vm._config.valuesFrom]);\n      if(minMax.length == 0) {\n        return [val, val];\n      }\n      return [\n        val < minMax[0] ? val : minMax[0],\n        val > minMax[1] ? val : minMax[1]\n      ];\n    }, []);\n  };\n\n  // Build the data with coords.\n  Radar.prototype.dataForVisualization = function(data) {\n    var vm = this,\n      scale = vm._scale,\n      axisKey = vm._config.axesFrom,\n      valKey = vm._config.valuesFrom,\n      polygKey = vm._config.polygonsFrom,\n      axesHash = vm._axesData.hash;\n\n    return data.map(function(row) {\n      var axis = row[axisKey],\n        rads = axesHash[axis].rads,\n        polygon = row[polygKey],\n        val = row[valKey],\n        scVal = scale(val);\n      return {\n        xy: [\n          vm.xOf(rads, scVal),\n          vm.yOf(rads, scVal)\n        ],\n        value: val,\n        polygon: polygon,\n        axis: axis,\n        color: vm._colorMap.hash[polygon],\n        rawData: row\n      };\n    });\n  };\n\n  Radar.prototype.filter = function(fun) {\n    var vm = this;\n    vm._filter = fun;\n    return vm;\n  };\n\n  // DBOX internals.\n\n  Radar.prototype.chart = function(chart) {\n    var vm = this;\n    vm._chart = chart;\n    return vm;\n  };\n\n  Radar.prototype.data = function(data) {\n    var vm = this;\n    //In case we want to filter observations\n    if(vm._config.data.filter){\n      data = data.filter(vm._config.data.filter);\n    }\n\n    vm._data = data;\n    return vm;\n  };\n\n  Radar.prototype.scales = function(scales) {\n    var vm = this;\n    vm._scales = scales;\n    // We only need one scale.\n    vm._scale = vm._scales.x;\n    vm._scale.range([0, vm._radius]);\n    return vm;\n  };\n\n  Radar.prototype.axes = function(axes) {\n    var vm = this;\n    // TODO Do nothing?\n    return vm;\n  };\n\n  Radar.prototype.domains = function() {\n    var vm = this;\n    vm._calcDomains(vm._data);\n    return vm;\n  };\n\n  Radar.prototype._calcDomains = function(data) {\n    var vm = this;\n    vm._minMax = vm.minMax(data);\n    vm._scale.domain(vm._config.scales && vm._config.scales.x && vm._config.scales.x.domain && Array.isArray(vm._config.scales.x.domain) ? vm._config.scales.x.domain : [0, vm._minMax[1]]);\n\n    vm._ticks = vm._scale.ticks(vm._config.ticks);\n    // Exclude 0 from ticks if it is the first element.\n    // We don't need to have the 0 actually rendered.\n    if(vm._ticks.length > 0 && vm._ticks[0] === 0) {\n      vm._ticks = vm._ticks.slice(1);\n    }\n  };\n\n  Radar.prototype.draw = function() {\n    var vm = this,\n      data = vm._data;\n\n    // Build the color map previusly to filtering in order to keep the\n    // association between colors and polygons even when some of them (the\n    // polygons) have been filtered out.\n    vm._colorMap = vm.buildColorMap(data);\n\n    // Apply the filter function, if it's present.\n    if(typeof vm._filter === 'function') {\n      data = data.filter(vm._filter);\n    }\n\n    // Filter out excluded polygons from.\n    if(vm._excludedPolygons.length > 0) {\n      data = data.filter(it => {\n        return vm._excludedPolygons.indexOf(\n          it[vm._config.polygonsFrom]) == -1;\n      });\n    }\n\n    vm._calcDomains(data);\n    vm._axesData = vm.extractAxes(data);\n    vm._viewData = vm.dataForVisualization(data);\n\n    vm.drawTicks();\n    vm.drawAxes();\n    vm.drawAxesLabels();\n    vm.drawTicksLabels();\n    vm.drawPolygons();\n    vm.drawLegend();\n  };\n\n  return new Radar(config);\n\n}\n","import * as d3 from 'd3';\n/*\n * Simple Scatter chart\n */\n\nexport default function (config, helper) {\n\n  var Scatter = Object.create(helper);\n\n  Scatter.init = function (config) {\n    var vm = this;\n    vm._config = config ? config : {};\n    vm._data = [];\n    vm._scales = {};\n    vm._axes = {};\n    \n    vm._tip = this.utils.d3.tip().attr('class', 'd3-tip')\n      .html(vm._config.tip && vm._config.tip.html ? vm._config.tip.html : function(d) {\n        if (vm.chart.config.styles) {\n          var html = `<div style='\n            line-height: 1; \n            opacity: ${vm.chart.style.tooltip.opacity}; \n            font-weight: ${vm.chart.style.tooltip.text.fontWeight}; \n            font-size: ${vm.chart.style.tooltip.text.fontSize}; \n            color: ${vm.chart.style.tooltip.text.textColor};\n            font-family: ${vm.chart.style.tooltip.text.fontFamily};\n            background-color: ${vm.chart.style.tooltip.backgroundColor}; \n            padding: ${vm.chart.style.tooltip.text.padding};   \n            border: ${vm.chart.style.tooltip.border.width} solid ${vm.chart.style.tooltip.border.color};  \n            border-radius:  ${vm.chart.style.tooltip.border.radius};'>`;\n          html += `<strong style='color:${vm.chart.style.tooltip.text.fontColor};'>`;\n        }\n        else { var html = \"<div> <strong>\" }\n        html += vm._config.idName ? d.datum[vm._config.idName] ? d.datum[vm._config.idName] + '<br>' : '' : '';\n        html += d.x ? ('<span>(' + (Number.isNaN(+d.x) || vm._config.xAxis.scale !== 'linear' ? d.x : vm.utils.format(d.x, vm._config.decimals)) + '</span>') : '(NA';\n        html += d.y ? ('<span>, &nbsp;' + (Number.isNaN(+d.y) || vm._config.yAxis.scale !== 'linear' ? d.y : vm.utils.format(d.y, vm._config.decimals)) + ')</span>') : ', NA)';\n        html += ' </strong><br>';\n        if (vm._config.magnitude && d.magnitude !== d.x && d.magnitude !== d.y) {\n          html += d.magnitude ? (`<span>` + (Number.isNaN(+d.magnitude) || (+d.magnitude >= 1993 && +d.magnitude <= 2019)? d.magnitude : vm.utils.format(d.magnitude)) + '</span>') : '';\n        }\n        if (d.color !== d.x && d.color !== d.y && d.color !== d.magnitude) {\n          html += d.color ? ('<span> ' + (Number.isNaN(+d.color) || (+d.color >= 1993 && +d.color <= 2019) ? d.color : vm.utils.format(d.color, vm._config.decimals)) + '</span>') : '';\n        }\n        html += '</div>';\n\n        return html;\n      });\n  };\n\n  //-------------------------------\n  //User config functions\n\n  Scatter.id = function (col) {\n    var vm = this;\n    vm._config.id = col;\n    return vm;\n  };\n\n  Scatter.idName = function (col) {\n    var vm = this;\n    vm._config.idName = col;\n    return vm;\n  };\n\n  Scatter.x = function (col) {\n    var vm = this;\n    vm._config.x = col;\n    return vm;\n  };\n\n  Scatter.y = function (col) {\n    var vm = this;\n    vm._config.y = col;\n    return vm;\n  };\n\n  Scatter.radius = function (radius) {\n    var vm = this;\n    vm._config.radius = radius;\n    return vm;\n  };\n\n  Scatter.magnitude = function (magnitude) {\n    var vm = this;\n    vm._config.magnitude = magnitude;\n    return vm;\n  };\n\n  Scatter.radiusRange = function (radiusRange) {\n    var vm = this;\n    vm._config.radiusRange = radiusRange;\n    return vm;\n  };\n\n  Scatter.magnitudeRange = function (magnitudeRange) {\n    var vm = this;\n    vm._config.magnitudeRange = magnitudeRange;\n    return vm;\n  };\n\n  Scatter.properties = function (properties) {\n    var vm = this;\n    vm._config.properties = properties;\n    return vm;\n  };\n\n  Scatter.figure = function (figureType) {\n    var vm = this;\n    vm._config.figureType = figureType;\n    return vm;\n  };\n\n  Scatter.colors = function(colors) {\n    var vm = this;\n    if (Array.isArray(colors)) {\n      //Using an array of colors for the range \n      vm._config.colors = colors;\n    } else {\n      //Using a preconfigured d3.scale\n      vm._scales.color = colors;\n    }\n    return vm;\n  };\n\n  Scatter.fill = function (col) {\n    var vm = this;\n    vm._config.fill = col;\n    return vm;\n  };\n\n  Scatter.opacity = function (opacity) {\n    var vm = this;\n    vm._config.opacity = opacity;\n    return vm;\n  };\n\n  Scatter.regression = function (regression) {\n    var vm = this;\n    vm._config.regression = regression;\n    return vm;\n  };\n\n  Scatter.tip = function (tip) {\n    var vm = this;\n    vm._config.tip = tip;\n    vm._tip.html(vm._config.tip);\n    return vm;\n  };\n\n  Scatter.data = function (data) {\n    var vm = this;\n    var xr,yr, xMean, yMean, b1, b0, term1, term2;\n    vm._data = [];\n\n    data.forEach(function (d) {\n      var m = {};\n      m.datum = d;\n      m.x = vm._config.xAxis.scale == 'linear' ? +d[vm._config.x] : d[vm._config.x];\n      m.y = vm._config.yAxis.scale == 'linear' ? +d[vm._config.y] : d[vm._config.y];\n      if (vm._config.xAxis.scale == 'linear'\n         && Number.isNaN(m.x)) {\n        m.x = 0;\n      }\n      if (vm._config.yAxis.scale == 'linear'\n         && Number.isNaN(m.y)) {\n        m.y = 0;\n      }\n      m.color = vm._config.fill.slice(0, 1) !== '#' ? d[vm._config.fill] : vm._config.fill;\n      m.radius = vm._config.radius !== undefined ? isNaN(vm._config.radius) ? +d[vm._config.radius] : vm._config.radius : 7;\n\n      //vm._config.magnitude = 'FACTOR_HOG'; For testing\n      \n      m.magnitude = vm._config.magnitude !== undefined ? isNaN(vm._config.magnitude) ? +d[vm._config.magnitude] : vm._config.magnitude : 7;\n\n      if (vm._config.properties !== undefined && Array.isArray(vm._config.properties) && vm._config.properties.length > 0) {\n        vm._config.properties.forEach(function (p) {\n          m[p] = d[p];\n        });\n      }\n\n      vm._data.push(m);\n    });\n    \n    if (vm._config.regression === true \n      && vm._config.yAxis.scale === 'linear' \n      && vm._config.xAxis.scale === 'linear' ) {\n      xMean = d3.mean(data.map(function (d) {\n        return !Number.isNaN(+d[vm._config.x]) ? + d[vm._config.x] : 0;\n      }));\n      yMean = d3.mean(data.map(function (d) {\n        return !Number.isNaN(+d[vm._config.y]) ? + d[vm._config.y] : 0;\n      }));\n      xr = 0;\n      yr = 0;\n      term1 = 0;\n      term2 = 0;\n\n      vm._data.forEach(function(m){\n        xr = Number.isNaN(+m.x) ? -xMean : (+m.x) - xMean;\n        yr = Number.isNaN(+m.y) ? -yMean : (+m.y) - yMean;\n        term1 += xr * yr;\n        term2 += xr * xr;\n      });\n\n      var b1 = term1 / term2;\n      var b0 = yMean - (b1 * xMean);\n\n      vm._data.forEach(function(m){\n        m.yhat = b0 + (Number(m.x) * b1);\n      });\n    }\n\n    if (vm._config.yAxis.scale !== 'linear') {\n      vm._data.sort(function(a, b) {\n        return vm.utils.sortAscending(a.y, b.y);\n      });\n    }\n    if (vm._config.xAxis.scale !== 'linear') {\n      vm._data.sort(function(a, b) {\n        return vm.utils.sortAscending(a.x, b.x);\n      });\n    }    \n    \n    return vm;\n  };\n\n  Scatter.scales = function () {\n    var vm = this;\n\n    if (vm._config.hasOwnProperty('x') && vm._config.hasOwnProperty('y')) {\n      config = {\n        column: 'x',\n        type: vm._config.xAxis.scale,\n        range: [0, vm.chart.width],\n        minZero: vm._config.xAxis.minZero ? vm._config.xAxis.minZero : false\n      };\n      vm._scales.x = vm.utils.generateScale(vm._data, config);\n\n\n      config = {\n        column: 'y',\n        type: vm._config.yAxis.scale,\n        range: [vm.chart.height, 0],\n        minZero: vm._config.yAxis.minZero ? vm._config.yAxis.minZero : false\n      };\n      vm._scales.y = vm.utils.generateScale(vm._data, config);\n    }\n    \n    if (vm._config.hasOwnProperty('colors')) {\n      vm._scales.color = d3.scaleOrdinal(vm._config.colors);\n    } else {\n      vm._scales.color = d3.scaleOrdinal(d3.schemeCategory20c);\n    }\n\n    var radiusMinMax = d3.extent(vm._data, function (d) {\n      return d.radius;\n    });\n\n    var magnitudeMinMax = d3.extent(vm._data, function (d) {\n      return d.magnitude;\n    });\n\n    vm._scales.radius = d3.scaleLinear()\n      .range(vm._config.radiusRange != undefined ? vm._config.radiusRange : [7, 20])\n      .domain(radiusMinMax).nice();\n\n    vm._scales.magnitude = d3.scaleLinear()\n      .range(vm._config.magnitudeRange != undefined ? vm._config.magnitudeRange : [7, 20])\n      .domain(magnitudeMinMax).nice();\n\n    if (vm._config.xAxis.scaleDomain && Array.isArray(vm._config.xAxis.scaleDomain)) {\n      vm._scales.x.domain(vm._config.xAxis.scaleDomain);\n\n    }\n    if (vm._config.yAxis.scaleDomain && Array.isArray(vm._config.yAxis.scaleDomain)) {\n      vm._scales.y.domain(vm._config.yAxis.scaleDomain);\n    }\n    return vm;\n  };\n\n  Scatter.drawLabels = function() {\n    var vm = this;\n    var yCoords = [];\n    var xCoords = [];\n    var repeat = [];\n\n    vm.chart.svg().selectAll('.dbox-label')        \n      .data(vm._data)\n      .enter().append('text')\n      .attr('class', 'dbox-label')\n      .attr('transform', function(d, index) {\n        var xCoord;\n        if (vm._config.xAxis.scale == 'ordinal' || vm._config.xAxis.scale == 'band') {\n          xCoord =  vm._scales.x(d.x) + vm._scales.x.bandwidth() / 2 - vm._scales.magnitude(d.magnitude)/2;\n        } else {\n          xCoord = vm._scales.x(d.x);\n        }\n        xCoords.push(d.datum[vm._config.x]);\n\n        var yCoord;\n        var space = 15;\n        if (vm._config.yAxis.scale == 'ordinal' || vm._config.yAxis.scale == 'band') {\n          yCoord = vm._scales.y(d.y) + vm._scales.y.bandwidth() / 2 - vm._scales.magnitude(d.magnitude)/2;\n          if (yCoords.indexOf(Math.ceil(yCoord)) !== -1) {\n            repeat.push(Math.ceil(yCoord));\n            var current = null;\n            var cnt = 0;\n            for (var i = 0; i < repeat.length; i++) {\n              if (repeat[i] != current) {\n                current = repeat[i];\n                cnt = 1;\n              } else {\n                cnt++;\n              }\n\n              space = space * cnt;\n            }\n            yCoord = yCoord + space;\n          }\n        } else {\n          yCoord = vm._scales.y(d.y);\n          if (yCoords.indexOf(Math.ceil(yCoord)) !== -1) {\n            repeat.push(Math.ceil(yCoord));\n            var current = null;\n            var cnt = 0;\n            for (var i = 0; i < repeat.length; i++) {\n              if (repeat[i] != current) {\n                current = repeat[i];\n                cnt = 1;\n              } else {\n                cnt++;\n              }\n\n              space = space * cnt;\n            }\n            yCoord = yCoord + space;\n          }\n        }\n        yCoords.push(Math.ceil(yCoord));\n\n        if (xCoords[index - 1] !== d.datum[vm._config.x]) {\n          yCoords = [];\n          repeat = [];\n        }\n\n        return 'translate(' + (xCoord + 10) + ',' + (yCoord - 20) + ')';\n      })\n      .text(function(d) {\n        var allText = '';\n        allText += d.color ?  d.color : '(-)';\n        allText += ' : ';\n        allText += d.datum[vm._config.magnitude] ? vm.utils.format(d.datum[vm._config.magnitude], vm._config.decimals) : '(-)'\n        return allText;\n      });\n\n      vm.chart.svg().selectAll('.dbox-label-coefficient')        \n        .data(vm._data)\n        .enter().append('text')\n        .attr('class', 'dbox-label-coefficient')\n        .attr('transform', function(d, index) {\n          var xCoord;\n          if (vm._config.xAxis.scale == 'ordinal' || vm._config.xAxis.scale == 'band') {\n            xCoord =  vm._scales.x(d.x) + vm._scales.x.bandwidth() / 2 - vm._scales.magnitude(d.magnitude)/2;\n          }\n          else {\n            xCoord = vm._scales.x(d.x);\n          }\n          var yCoord;\n          if (vm._config.yAxis.scale == 'ordinal' || vm._config.yAxis.scale == 'band') {\n            yCoord = vm._scales.y(d.y) + vm._scales.y.bandwidth() / 2 - vm._scales.magnitude(d.magnitude)/2;\n            yCoord = index%2 === 0 ? yCoord + 15 : yCoord;\n          }\n          else {\n            yCoord = vm._scales.y(d.y);\n            yCoord = index%2 === 0 ? yCoord + 15 : yCoord;\n          }\n          return 'translate(' + (xCoord + 10) + ',' + (yCoord + 15) + ')';\n        })\n        .text(function(d) {\n          var allText = '';\n          allText += d.color ?  d.color : '(-)';\n          allText += ' : ';\n          allText += d.datum[d.color + 'coefficient']!== undefined ? d.datum[d.color + 'coefficient'].toFixed(1) : '(-)'\n          return allText;\n        });\n      /*vm.chart.svg().selectAll('rect').each(function(dat, index) {\n        if (index%2 === 0) {\n          vm.chart.svg().append('text')\n            .attr('class', 'dbox-label')\n        }\n      })*/\n  }\n\n  Scatter.draw = function () {\n    var vm = this;\n    //Call the tip\n    vm.chart.svg().call(vm._tip);\n\n    // Squares \n    if ( vm._config.figureType === 'square' ) {\n      vm.chart.svg().selectAll('square')\n        .data(vm._data)\n        .enter().append('rect')\n        .attr('class', 'square')\n        .attr('class', function (d, i) {\n          //Backward compability with d.properties\n          var id = (d.properties !== undefined && d.properties.id !== undefined) ? d.properties.id : false;\n          id = vm._config.id ? vm._config.id : false;\n          return id ? 'scatter-' + d.datum[id] : 'scatter-' + i;\n        })\n        .attr('width', function (d) {\n          return vm._scales.magnitude(d.magnitude);\n        })\n        .attr('height', function (d) {\n          return vm._scales.magnitude(d.magnitude);\n        })\n        .attr('x', function (d) {\n          if (vm._config.xAxis.scale == 'ordinal' || vm._config.xAxis.scale == 'band') {\n            return vm._scales.x(d.x) + vm._scales.x.bandwidth() / 2 - vm._scales.magnitude(d.magnitude)/2;\n          }\n          else {\n            return vm._scales.x(d.x);\n          }\n        })\n        .attr('y', function (d) {\n          if (vm._config.yAxis.scale == 'ordinal' || vm._config.yAxis.scale == 'band') {\n            return vm._scales.y(d.y) + vm._scales.y.bandwidth() / 2 - vm._scales.magnitude(d.magnitude)/2;\n          }\n          else {\n            return vm._scales.y(d.y);\n          }\n        })\n        .style('fill', function (d) {\n          return String(d.color).slice(0, 1) !== '#' ? vm._scales.color(d.color) : d.color;\n        })\n        .style('opacity', vm._config.opacity !== undefined ? vm._config.opacity : 1)\n        .on('mouseover', function (d, i) {\n          if (vm._config.events.mouseover) {\n            vm._config.events.mouseover.call(vm, d, i);\n          }\n          vm._tip.show(d, d3.select(this).node());\n        })\n        .on('mouseout', function (d, i) {\n          if (vm._config.events.mouseout) {\n            vm._config.events.mouseout.call(this, d, i);\n          }\n          vm._tip.hide(d, d3.select(this).node());\n        })\n        .on('click', function (d, i) {\n          if (vm._config.events.onClickElement) {\n            vm._config.events.onClickElement.call(this, d, i);\n          }\n        });\n    }\n    // Circles\n    else {\n      vm.chart.svg().selectAll('.dot')\n        .data(vm._data)\n        //.data(vm._data, function(d){ return d.key})\n        .enter().append('circle')\n        .attr('class', 'dot')\n        .attr('class', function (d, i) {\n          //Backward compability with d.properties\n          var id = (d.properties !== undefined && d.properties.id !== undefined) ? d.properties.id : false;\n          id = vm._config.id ? vm._config.id : false;\n          return id ? 'scatter-' + d.datum[id] : 'scatter-' + i;\n        })\n        .attr('r', function (d) {\n          return vm._scales.radius(d.radius);\n        })\n        .attr('cx', function (d) {\n          if (vm._config.xAxis.scale == 'ordinal' || vm._config.xAxis.scale == 'band')\n            return vm._scales.x(d.x) + vm._scales.x.bandwidth() / 2;\n          else\n            return vm._scales.x(d.x);\n\n          /*  if(vm._config.xAxis.scale == 'ordinal' || vm._config.xAxis.scale == 'band')\n            return vm._scales.x(d.x) + (Math.random() * (vm._scales.x.bandwidth() - (d.size * 2)));\n          else \n            return vm._scales.x(d.x); */\n        })\n        .attr('cy', function (d) {\n          if (vm._config.yAxis.scale == 'ordinal' || vm._config.yAxis.scale == 'band')\n            return vm._scales.y(d.y) + vm._scales.y.bandwidth() / 2;\n          else\n            return vm._scales.y(d.y);\n\n          /* if(vm._config.yAxis.scale == 'ordinal' || vm._config.yAxis.scale == 'band')\n            return vm._scales.y(d.y) + (Math.random() * (vm._scales.y.bandwidth() - (d.size * 2)));\n          else \n            return vm._scales.y(d.y); */\n        })\n        .style('fill', function (d) {\n          return String(d.color).slice(0, 1) !== '#' ? vm._scales.color(d.color) : d.color;\n        })\n        .style('opacity', vm._config.opacity !== undefined ? vm._config.opacity : 1)\n        .on('mouseover', function (d, i) {\n          if (vm._config.events.mouseover) {\n            vm._config.events.mouseover.call(vm, d, i);\n          }\n          vm._tip.show(d, d3.select(this).node());\n        })\n        .on('mouseout', function (d, i) {\n          if (vm._config.events.mouseout) {\n            vm._config.events.mouseout.call(this, d, i);\n          }\n          vm._tip.hide(d, d3.select(this).node());\n        })\n        .on('click', function (d, i) {\n          if (vm._config.events.onClickElement) {\n            vm._config.events.onClickElement.call(this, d, i);\n          }\n        });\n    }\n\n    if (vm._config.regression === true) {\n      var line = d3.line()\n        .x(function (d) {\n          return vm._scales.x(d.x);\n        })\n        .y(function (d) {\n          return vm._scales.y(d.yhat);\n        });\n\n      vm.chart.svg().append('path')\n        .datum(vm._data)\n        .attr('class', 'line')\n        .attr('d', line)\n        .style('stroke', 'rgb(251, 196, 58)');\n    }\n\n    Scatter.drawLabels();\n\n    return vm;\n  };\n\n  Scatter.select = function (id) {\n    var vm = this;\n    return vm.chart.svg().select('circle.scatter-' + id);\n  };\n\n  Scatter.selectAll = function (id) {\n    var vm = this;\n    return vm.chart.svg().selectAll('circle');\n  };\n\n  Scatter.init(config);\n  return Scatter;\n}\n","import * as d3 from 'd3';\nimport * as _ from 'lodash';\n\n/*\n * Simple Spineplot\n */\nexport default function (config, helper) {\n\n  //Link Spineplot to the helper object in helper.js\n  var Spineplot = Object.create(helper);\n\n  Spineplot.init = function (config) {\n    var vm = this;\n\n    vm._config = config ? config : {};\n    vm._config.orientation = 'horizontal';\n    vm._data = [];\n    vm._scales = {};\n    vm._tip = vm.utils.d3.tip()\n      .attr('class', 'd3-tip')\n      .direction('n')\n      .html(vm._config.tip || function (d) {\n        var html = '<div>';\n        html += '<span>' + d[vm._config.category] + '</span>';\n        html += '</br><span>' + vm.utils.format(d[vm._config.value], 1) + '</span>';\n        html += '</div>';\n        return html;\n      });\n\n  };\n\n\n  //-------------------------------\n  //User config functions\n  Spineplot.id = function (columnName) {\n    var vm = this;\n    vm._config.id = columnName;\n    return vm;\n  };\n\n  Spineplot.category = function (columnName) {\n    var vm = this;\n    vm._config.category = columnName;\n    return vm;\n  };\n\n  Spineplot.value = function (columnName) {\n    var vm = this;\n    vm._config.value = columnName;\n    return vm;\n  };\n\n  Spineplot.orientation = function (orientation) {\n    var vm = this;\n    vm._config.orientation = orientation;\n    return vm;\n  };\n\n  /**\n   * Used to draw a bar chart stacked with multiple bars per group\n   * @param {array} columns \n   */\n  Spineplot.stackBy = function (columnName) {\n    var vm = this;\n    vm._config.stackBy = columnName;\n    return vm;\n  };\n\n  /**\n   * column name used for the domain values\n   * @param {string} columnName \n   */\n  Spineplot.fill = function (columnName) {\n    var vm = this;\n    vm._config.fill = columnName;\n    return vm;\n  };\n\n  /**\n   * array of values used \n   * @param {array or scale} columnName \n   */\n  Spineplot.colors = function (colors) {\n    var vm = this;\n    if (Array.isArray(colors)) {\n      //Using an array of colors for the range \n      vm._config.colors = colors;\n    } else {\n      //Using a preconfigured d3.scale\n      vm._scales.color = colors;\n    }\n    return vm;\n  };\n\n  Spineplot.sortBy = function (option) {\n    //option = string [asc,desc] \n    //option = array for groupBy and stackBy\n    var vm = this;\n    vm._config.sortBy = option;\n    return vm;\n  };\n\n  Spineplot.format = function (format) {\n    var vm = this;\n    if (typeof format == 'function' || format instanceof Function)\n      vm.utils.format = format;\n    else\n      vm.utils.format = d3.format(format);\n    return vm;\n  };\n\n  Spineplot.tip = function (tip) {\n    var vm = this;\n    vm._config.tip = tip;\n    return vm;\n  };\n\n  Spineplot.legend = function (legend) {\n    var vm = this;\n    vm._config.legend = legend;\n    return vm;\n  };\n\n\n  //-------------------------------\n  //Triggered by the chart.js;\n  Spineplot.data = function (data) {\n    var vm = this;\n\n    if (vm._config.filter) {\n      // In case we want to filter observations\n      data = data.filter(vm._config.filter);\n    }\n    //@TODO - ALLOW MULITPLE SORTS\n    if (vm._config.sortBy) {\n      if (vm._config.sortBy.category) {\n        data = data.sort(function (a, b) {\n          return vm._config.sortBy.category === 'desc' ? vm.utils.sortDescending(a[vm._config.category], b[vm._config.category]) : vm.utils.sortAscending(a[vm._config.category], b[vm._config.category]);\n        });\n      }\n      if (vm._config.sortBy.value) {\n        data = data.sort(function (a, b) {\n          return vm._config.sortBy.value === 'desc' ? vm.utils.sortDescending(a[vm._config.value], b[vm._config.value]) : vm.utils.sortAscending(a[vm._config.value], b[vm._config.value]);\n        });\n      }\n    } else {\n      data = data.sort(function (a, b) {\n        return vm.utils.sortAscending(a[vm._config.category], b[vm._config.category]);\n      });\n    }\n\n    var total = 0;\n    vm._data = data.map(function(d) {\n      d.x0 = total;\n      d.x1 = total + d[vm._config.value];\n      total += +d[vm._config.value];\n      if (vm._config.hasOwnProperty('stackBy') && Array.isArray(vm._config.stackBy) && vm._config.stackBy.length > 0) {\n        d.stackValues = d3.stack().keys(vm._config.stackBy)([d]);\n        d.totalCollapse = d3.sum(d.stackValues, function(stack) {\n          return stack[0][1] - stack[0][0];\n        });\n      }\n      return d;\n    });\n\n    if (vm._config.hasOwnProperty('quantiles')) {\n      vm._quantiles = vm._setQuantile(data);\n      vm._minMax = d3.extent(data, function (d) {\n        return +d[vm._config.fill];\n      });\n    }\n\n    return vm;\n  };\n\n  Spineplot.scales = function () {\n    var vm = this;\n    var config;\n    //vm._scales = s;\n    /* Use\n     * vm._config.category\n     * vm._config.categoryAxis.scale\n     * vm._config.value\n     * vm._config.valueAxis.scale\n     * vm._data\n     */\n    // Normal bars \n    if (vm._config.hasOwnProperty('category') && vm._config.hasOwnProperty('value')) {\n      config = {\n        column: 'x1',\n        type: 'linear',\n        range: [0, vm.chart.width],\n        minZero: true\n      };\n      vm._scales.x = vm.utils.generateScale(vm._data, config);\n\n      config = {\n        column: vm._config.value,\n        type: 'linear',\n        range: [vm.chart.height, 0],\n        minZero: true\n      };\n      vm._scales.y = vm.utils.generateScale(vm._data, config);\n    }\n\n\n    //Stack bars on the xAxis\n    if (vm._config.orientation === 'horizontal' && vm._config.hasOwnProperty('stackBy')) {\n      /* Generate x scale */\n      config = {\n        column: 'x1',\n        type: 'linear',\n        range: [0, vm.chart.width],\n        minZero: true\n      };\n      vm._scales.x = vm.utils.generateScale(vm._data, config);\n\n      /* Generate y scale */\n      config = {\n        column: '',\n        type: 'linear',\n        range: [vm.chart.height, 0],\n        minZero: true\n      };\n      vm._scales.y = d3.scaleLinear().range(config.range).domain([0, 1]);\n    }\n\n    //Stack bars on the yAxis\n    if (vm._config.orientation === 'vertical' && vm._config.hasOwnProperty('stackBy')) {\n      /* Generate x scale */\n      config = {\n        column: '',\n        txpe: 'linear',\n        range: [vm.chart.height, 0],\n        minZero: true\n      };\n      vm._scales.x = d3.scaleLinear().range(config.range).domain([0, 1]);\n\n      /* Generate y scale */\n      config = {\n        column: vm._config.value,\n        type: 'linear',\n        range: [0, vm.chart.width],\n        minZero: true\n      };\n      vm._scales.y = vm.utils.generateScale(vm._data, config);\n      \n    }\n    //vm.chart.scales.x = vm._scales.x;\n    //vm.chart.scales.y = vm._scales.y;\n\n    if (vm._config.hasOwnProperty('colors'))\n      vm._scales.color = d3.scaleOrdinal(vm._config.colors);\n    else\n      vm._scales.color = d3.scaleOrdinal(d3.schemeCategory10);\n\n    return vm;\n  };\n\n  Spineplot.drawLabels = function() {\n    var vm = this;\n\n    var groups = vm.chart.svg().selectAll('.division')\n    groups.each(function(dat) {\n      var el = this;\n      dat.stackValues.forEach(function(sv) {\n\n        var rectW = vm._scales.x(sv[0].data[vm._config.value]);\n        var rectH = vm._scales.y((sv[0][0] / sv[0].data.totalCollapse)) - vm._scales.y(sv[0][1] / sv[0].data.totalCollapse);\n        \n        if (rectH > 40) {\n          d3.select(el).append('text')\n            .attr('class', 'dbox-label')\n            .attr('transform', function() {\n              return 'translate(' + (vm._scales.x(sv[0].data.x0) + rectW/2) + ',' + (sv[0][1] ? vm._scales.y(sv[0][1] / sv[0].data.totalCollapse) + 20 : vm._scales.y(0) + 20) + ')';\n            })\n            .text(function() {\n              return sv.key;\n            });\n\n          /*d3.select(el).append('text')\n            .attr('class', 'dbox-label')\n            .attr('transform', function() {\n              var rectH = vm._scales.x(sv[0].data[vm._config.value]);\n              return 'translate(' + (vm._scales.x(sv[0].data.x0) + rectH/2) + ',' + (sv[0][1] ? vm._scales.y(sv[0][1] / sv[0].data.totalCollapse) + 40 : vm._scales.y(0) + 40) + ')';\n            })\n            .text(function(d) {\n              return d.RANGO_EDAD;\n            });*/\n\n          d3.select(el).append('text')\n            .attr('class', 'dbox-label')\n            .attr('transform', function() {\n              return 'translate(' + (vm._scales.x(sv[0].data.x0) + rectW/2) + ',' + (sv[0][1] ? vm._scales.y(sv[0][1] / sv[0].data.totalCollapse) + 40 : vm._scales.y(0) + 40) + ')';\n            })\n            .text(function(d) {\n              return d[sv.key] ? vm.utils.format(d[sv.key], 1) : '';\n            });\n\n          //COEFFICIENT\n          d3.select(el).append('text')\n            .attr('class', 'dbox-label-coefficient')\n            .attr('transform', function() {\n              return 'translate(' + (vm._scales.x(sv[0].data.x0) + rectW/2) + ',' + (sv[0][1] ? vm._scales.y(sv[0][1] / sv[0].data.totalCollapse) + 60 : vm._scales.y(0) + 60) + ')';\n            })\n            .text(function(d) {\n              return d[sv.key + 'coefficient'] ? '(' + d[sv.key + 'coefficient'].toFixed(1) + ')' : '';\n            });\n        }\n      })\n    });\n  }\n\n  Spineplot.draw = function() {\n    var vm = this;\n    if (vm._config.hasOwnProperty('stackBy')) {\n      if (vm._config.orientation === 'horizontal') vm._drawStackByXAxis();\n      if (vm._config.orientation === 'vertical') vm._drawStackByYAxis();\n      return vm;\n    }\n\n    vm.chart.svg().call(vm._tip);\n\n    const axesTip = vm.utils.d3.tip()\n      .attr('class', 'title-tip')\n      .html(d => {\n        return d[vm._config.category];\n      });\n    vm.chart.svg().call(axesTip);\n\n    if (vm._config.orientation === 'horizontal') {\n\n      /**\n       * x axis tick labels\n       */\n      let posX = [];\n      vm._xLabels = vm.chart.svg().append('g')\n        .attr('class', 'x axis')\n        .attr('transform', 'translate(0,' + (vm.chart.height + 20) + ')')\n        .selectAll('.tick')\n        .data(vm._data)\n        .enter()\n        .append('g')\n        .attr('class', 'tick')\n        .attr('transform', d => {\n          const x = vm._scales.x(d.x0) + (vm._scales.x(d.x1 - d.x0) / 2);\n          posX.push(x);\n          return 'translate(' + x + ', 8)'; \n        })\n        .append('text')\n        .attr('text-anchor', 'middle')\n        .text(function(d) {\n          return d[vm._config.category];\n        });\n\n      let labelMaxWidth = d3.min(vm._data, function (d) {\n        return (vm._scales.x(d.x1) - vm._scales.x(d.x0)) * 0.9;\n      });\n      const largestLabelWidth = d3.max(vm._xLabels.nodes(), function (node) {\n        return node.getComputedTextLength();\n      });\n      let removed = [];\n\n      vm._xLabels.each(function (d, index, el) {\n        //const currentWidth = this.getComputedTextLength();\n        //let labelMaxWidth = (vm._scales.x(d.x1) - vm._scales.x(d.x0)) * 0.9;\n        if (largestLabelWidth < (labelMaxWidth * 2)) {\n          d3.select(this).call(vm.utils.wrap, labelMaxWidth, axesTip);\n        } else {\n          d3.select(this)\n            .attr('text-anchor', 'end')\n            .attr('dy', 0)\n            .attr('transform', 'translate(3,-8)rotate(-90)');\n          let newLabelMaxWidth = vm._config.size.margin.bottom * 0.9;\n          if (this.getComputedTextLength() > newLabelMaxWidth) {\n            d3.select(this)\n              .on('mouseover', axesTip.show)\n              .on('mouseout', axesTip.hide);\n            let i = 1;\n            while (this.getComputedTextLength() > newLabelMaxWidth) {\n              d3.select(this).text(function (d) {\n                return (d[vm._config.category] + '').slice(0, -i) + '...';\n              }).attr('title', d);\n              ++i;\n            }\n          }\n        }\n\n        let textSize = window.getComputedStyle(this, null).getPropertyValue(\"font-size\");\n        let numSize = Number(textSize.replace(/\\D/g,''));\n\n        if (index !== 0 && index !== vm._data.length - 1) {\n          let diffPos1 = posX[index] - posX[index - 1];\n          let diffPos2 = posX[index + 1] - posX[index];\n\n          let lessThanPrev = d.value < vm._data[index - 1].value;\n          let lessThanPost = d.value < vm._data[index + 1].value;\n\n          if (diffPos1 < numSize - 2 || diffPos2 < numSize - 2) {\n            if (lessThanPrev || lessThanPost) {\n              d3.select(this).remove();\n              removed.push(index);\n            }\n          }\n        }\n      });\n      \n\n      vm.chart.svg().selectAll('.bar')\n        .data(vm._data)\n        .enter().append('rect')\n        .attr('class', 'bar')\n        .attr('id', (d, i) => {\n          var id = 'spineplot-' + i;\n          if (vm._config.id) {\n            id = 'spineplot-' + d[vm._config.id];\n          }\n          return id;\n        })\n        .attr('x', (d) => vm._scales.x(d.x0) )\n        .attr('y', 0)\n        .attr('width', d => vm._scales.x(d[vm._config.value]) )\n        .attr('height', vm.chart.height ? vm.chart.height : 100)\n        .attr('fill', (d) => {\n          return vm._scales.color !== false ? vm._scales.color(d[vm._config.fill]) : vm._getQuantileColor(d[vm._config.fill], 'default');\n        })\n        .attr('stroke', 'white')\n        .attr('stroke-width', 1)\n        .style('opacity', 0.9)\n        .on('mouseover', function(d, i) {\n          if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover colors\n            d3.select(this).attr('fill', function (d) {\n              return vm._getQuantileColor(d[vm._config.fill], 'onHover');\n            });\n          }\n          vm._tip.show(d, d3.select(this).node());\n\n          if (vm._config.hasOwnProperty('onmouseover')) { //External function call, must be after all the internal code; allowing the user to overide \n            vm._config.onmouseover.call(this, d, i);\n          }\n\n        })\n        .on('mouseout', function (d, i) {\n          if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover reset default color\n            d3.select(this).attr('fill', function (d) {\n              return vm._getQuantileColor(d[vm._config.fill], 'default');\n            });\n          }\n          vm._tip.hide();\n\n          if (vm._config.hasOwnProperty('onmouseout')) { //External function call, must be after all the internal code; allowing the user to overide \n            vm._config.onmouseout.call(this, d, i);\n          }\n        })\n        .on('click', function (d, i) {\n          if (vm._config.hasOwnProperty('click')) {\n            vm._config.onclick.call(this, d, i);\n          }\n        });\n    }\n    return vm;\n  };\n\n\n  //\n  /** \n   * Draw bars grouped by \n   */\n  Spineplot._drawStackByXAxis = function () {\n    var vm = this;\n    vm._tip.html(vm._config.tip || function (d) {\n      var cat = '';\n      cat += '<span>' + d.key + '</span>';\n      if (d.key !== d[0].data[vm._config.category]) {\n        cat += '<br><span>' + vm.utils.format(d[0].data[d.key], 1) + '</span>';\n        cat += '<br><span>' + d[0].data[vm._config.category] + '</span>';\n        cat += '<br><span>' + vm.utils.format(d[0].data[vm._config.value], 1) + '</span>';\n      } else {\n        cat += '<br><span>' + vm.utils.format(d[0].data[d.key], 1) + '</span>';\n      }\n      return cat;\n    });\n    vm.chart.svg().call(vm._tip);\n\n    const axesTip = vm.utils.d3.tip()\n      .attr('class', 'title-tip')\n      .html(d => {\n        return d[vm._config.category];\n      });\n    vm.chart.svg().call(axesTip);\n\n    /**\n     * x axis labels\n     */\n    vm._xLabels = vm.chart.svg().append('g')\n      .attr('class', 'x axis')\n      .attr('transform', 'translate(0,' + (vm.chart.height + 20) + ')')\n      .selectAll('g')\n      .data(vm._data)\n      .enter()\n      .append('g')\n      .attr('class', 'tick')\n      .attr('transform', d => {\n        const x = vm._scales.x(d.x0) + (vm._scales.x(d.x1 - d.x0) / 2);\n        return 'translate(' + x + ', 0)';\n      })\n      .append('text')\n      .attr('text-anchor', 'middle')\n      .text(d => d[vm._config.category]);\n\n    let labelMaxWidth = d3.min(vm._data, function(d) {\n      return (vm._scales.x(d.x1) - vm._scales.x(d.x0)) * 0.9;\n    });\n    const largestLabelWidth = d3.max(vm._xLabels.nodes(), function (node) {\n      return node.getComputedTextLength();\n    });\n    \n    vm._xLabels.each(function (d) {\n      //const currentWidth = this.getComputedTextLength();\n      //let labelMaxWidth = (vm._scales.x(d.x1) - vm._scales.x(d.x0)) * 0.9;\n      if (largestLabelWidth < (labelMaxWidth * 2)) {\n        d3.select(this).call(vm.utils.wrap, labelMaxWidth, axesTip);\n      } else {\n        d3.select(this)\n          .attr('text-anchor', 'end')\n          .attr('dy', 0)\n          .attr('transform', 'translate(3,-8)rotate(-90)');\n        let newLabelMaxWidth = vm._config.size.margin.bottom * 0.9;\n        if (this.getComputedTextLength() > newLabelMaxWidth) {\n          d3.select(this)\n            .on('mouseover', axesTip.show)\n            .on('mouseout', axesTip.hide);\n          let i = 1;\n          while (this.getComputedTextLength() > newLabelMaxWidth) {\n            d3.select(this).text(function (d) {\n              return (d[vm._config.category] + '').slice(0, -i) + '...';\n            }).attr('title', d);\n            ++i;\n          }\n        }\n      }\n    });\n      \n    var groups = vm.chart.svg().append('g')\n      .selectAll('g')\n      .data(vm._data)\n      .enter().append('g')\n      .attr('class', 'division');\n\n    groups.selectAll('rect')\n      .data(function (d) {\n        return d.stackValues;\n      })\n      .enter().append('rect')\n      .attr('y', function (d) {\n        return d[0][1] ? vm._scales.y(d[0][1] / d[0].data.totalCollapse) : vm._scales.y(0);\n      })\n      .attr('x', function (d) {\n        return vm._scales.x(d[0].data.x0);\n      })\n      .attr('width', function (d) {\n        return vm._scales.x(d[0].data[vm._config.value]);\n      })\n      .attr('height', function (d) {\n        var h = vm._scales.y((d[0][0] / d[0].data.totalCollapse)) - vm._scales.y(d[0][1] / d[0].data.totalCollapse)\n        return h;\n      })\n      .attr('stroke', 'white')\n      .attr('stroke-width', 1)\n      .attr('fill', function (d) {\n        return vm._scales.color(d[vm._config.fill]);\n      })\n      .on('mouseover', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover colors\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'onHover');\n          });\n        }\n        vm._tip.show(d, d3.select(this).node());\n\n        if (vm._config.hasOwnProperty('onmouseover')) {\n          //External function call. It must be after all the internal code; allowing the user to overide \n          vm._config.onmouseover.call(this, d, i);\n        }\n\n      })\n      .on('mouseout', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover reset default color\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'default');\n          });\n        }\n        vm._tip.hide();\n\n        if (vm._config.hasOwnProperty('onmouseout')) { //External function call, must be after all the internal code; allowing the user to overide \n          vm._config.onmouseout.call(this, d, i);\n        }\n      })\n      .on('click', function (d, i) {\n        if (vm._config.hasOwnProperty('click')) {\n          vm._config.onclick.call(this, d, i);\n        }\n      });\n\n      Spineplot.drawLabels();\n  };\n\n  Spineplot._drawStackByYAxis = function () {\n    var vm = this;\n\n    vm._tip.html(vm._config.tip || function (d) {\n      var html = '<div><span>' + d[vm._config.category] + '<span><br>';\n      for (var k in d.data) {\n        if ((d[1] - d[0]) == d.data[k]) {\n          html += '<span>' + k + '</span>';\n        }\n      }\n      html += '<br>' + vm.utils.format(d[1] - d[0]);\n      return html;\n    });\n\n    vm.chart.svg().call(vm._tip);\n\n    vm.chart.svg().append('g')\n      .selectAll('g')\n      .data(vm._data)\n      .enter().append('g')\n      .attr('class', 'division')\n      .attr('fill', function (d) {\n        return vm._scales.color(d.key);\n      })\n      .selectAll('rect')\n      .data(function (d) {\n        return d;\n      })\n      .enter().append('rect')\n      .attr('y', function (d) {\n        return vm._scales.y(d.data[vm._config.value]);\n      })\n      .attr('x', function (d) {\n        return vm._scales.x(d[0]);\n      })\n      .attr('height', vm._scales.y.bandwidth())\n      .attr('width', function (d) {\n        return vm._scales.x(d[1]) - vm._scales.x(d[0]);\n      })\n      .on('mouseover', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover colors\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'onHover');\n          });\n        }\n        vm._tip.show(d, d3.select(this).node());\n\n        if (vm._config.hasOwnProperty('onmouseover')) {\n          //External function call. It must be after all the internal code; allowing the user to overide \n          vm._config.onmouseover.call(this, d, i);\n        }\n\n      })\n      .on('mouseout', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover reset default color\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'default');\n          });\n        }\n        vm._tip.hide();\n\n        if (vm._config.hasOwnProperty('onmouseout')) { //External function call, must be after all the internal code; allowing the user to overide \n          vm._config.onmouseout.call(this, d, i);\n        }\n      })\n      .on('click', function (d, i) {\n        if (vm._config.hasOwnProperty('click')) {\n          vm._config.onclick.call(this, d, i);\n        }\n      });\n\n  };\n\n  Spineplot._setQuantile = function (data) {\n    var vm = this;\n    var values = [];\n    var quantile = [];\n\n    if (vm._config.quantiles && vm._config.quantiles.predefinedQuantiles &&\n      vm._config.quantiles.predefinedQuantiles.length > 0) {\n      return vm._config.quantiles.predefinedQuantiles;\n    }\n\n    data.forEach(function (d) {\n      values.push(+d[vm._config.fill]);\n    });\n\n    values.sort(vm.utils.sortAscending);\n\n    //@TODO use quantile scale instead of manual calculations \n    if (vm._config && vm._config.quantiles && vm._config.quantiles.buckets) {\n\n      if (vm._config.quantiles.ignoreZeros === true) {\n        var aux = _.dropWhile(values, function (o) {\n          return o <= 0;\n        });\n        //aux.unshift(values[0]);  \n\n        quantile.push(values[0]);\n        quantile.push(0);\n\n        for (var i = 1; i <= vm._config.quantiles.buckets - 1; i++) {\n          quantile.push(d3.quantile(aux, i * 1 / (vm._config.quantiles.buckets - 1)));\n        }\n\n      } else {\n        quantile.push(d3.quantile(values, 0));\n        for (var j = 1; j <= vm._config.quantiles.buckets; j++) {\n          quantile.push(d3.quantile(values, j * 1 / vm._config.quantiles.buckets));\n        }\n      }\n\n    } else {\n      quantile = [d3.quantile(values, 0), d3.quantile(values, 0.2), d3.quantile(values, 0.4), d3.quantile(values, 0.6), d3.quantile(values, 0.8), d3.quantile(values, 1)];\n    }\n\n    //@TODO - VALIDATE WHEN ZEROS NEED TO BE PUT ON QUANTILE 1 AND RECALCULATE NON ZERO VALUES INTO THE REST OF THE BUCKETS\n    if (vm._config.quantiles && vm._config.quantiles.buckets && vm._config.quantiles.buckets === 5) {\n\n      if (quantile[1] === quantile[2] && quantile[2] === quantile[3] && quantile[3] === quantile[4] && quantile[4] === quantile[5]) {\n        quantile = [d3.quantile(values, 0), d3.quantile(values, 0.2)];\n      }\n    }\n\n    return quantile;\n  };\n\n  Spineplot._getQuantileColor = function (d, type) {\n    var vm = this;\n    var total = parseFloat(d);\n\n    //@TODO use quantile scale instead of manual calculations \n    if (vm._config && vm._config.bars.quantiles && vm._config.bars.quantiles.colors) {\n      if (vm._quantiles.length > 2) {\n\n        if (vm._config && vm._config.bars.min !== undefined && vm._config.bars.max !== undefined) {\n          if (total < vm._config.bars.min || total > vm._config.bars.max) {\n            return vm._config.bars.quantiles.outOfRangeColor;\n          }\n        } else {\n          if (total < vm._minMax[0] || total > vm._minMax[1]) {\n            return vm._config.bars.quantiles.outOfRangeColor;\n          }\n        }\n\n        if (type == 'default') {\n          if (total <= vm._quantiles[1]) {\n            return vm._config.bars.quantiles.colors[0]; //'#f7c7c5';\n          } else if (total <= vm._quantiles[2]) {\n            return vm._config.bars.quantiles.colors[1]; //'#e65158';\n          } else if (total <= vm._quantiles[3]) {\n            return vm._config.bars.quantiles.colors[2]; //'#c20216';\n          } else if (total <= vm._quantiles[4]) {\n            return vm._config.quantiles.colors[3]; //'#750000';\n          } else if (total <= vm._quantiles[5]) {\n            return vm._config.quantiles.colors[4]; //'#480000';\n          }\n        }\n\n        if (type == 'onHover' && vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) {\n          if (total <= vm._quantiles[1]) {\n            return vm._config.quantiles.colorsOnHover[0]; //'#f7c7c5';\n          } else if (total <= vm._quantiles[2]) {\n            return vm._config.quantiles.colorsOnHover[1]; //'#e65158';\n          } else if (total <= vm._quantiles[3]) {\n            return vm._config.quantiles.colorsOnHover[2]; //'#c20216';\n          } else if (total <= vm._quantiles[4]) {\n            return vm._config.quantiles.colorsOnHover[3]; //'#750000';\n          } else if (total <= vm._quantiles[5]) {\n            return vm._config.quantiles.colorsOnHover[4]; //'#480000';\n          }\n        }\n\n      }\n    }\n\n    if (vm._quantiles.length == 2) {\n      /*if(total === 0 ){\n        return d4theme.colors.quantiles[0];//return '#fff';\n      }else if(total <= vm._quantiles[1]){\n        return d4theme.colors.quantiles[1];//return '#f7c7c5';\n      }*/\n      if (total <= vm._quantiles[1]) {\n        return vm._config.quantiles.colors[0]; //'#f7c7c5';\n      }\n    }\n\n  };\n\n  Spineplot.init(config);\n  return Spineplot;\n}\n","import * as d3 from 'd3';\n\n/* Simple timeline example\n * Single and multiline timelines\n */\nexport default function(config, helper) {\n\n\n  var Timeline = Object.create(helper);\n\n  Timeline.init = function(config){\n    var vm = this;\n    vm._config = config ? config : {};\n    vm._data = [];\n    vm._scales ={};\n    vm._axes = {};\n\n    vm._config.parseDate = d3.timeParse('%Y-%m-%d');\n    vm._config.curve = d3.curveLinear;\n    \n    vm._tip = vm.utils.d3.tip().attr('class', 'd3-tip')\n      .html(vm._config.tip && vm._config.tip.html ? vm._config.tip.html : function(d) {\n\n        let scaleColor = vm._scales.color !== false ? vm._scales.color(d.name): vm._getQuantileColor(d.name,'default');\n        if (vm.chart.config.styles) {\n          var html = `<div style='\n            line-height: 1; \n            opacity: ${vm.chart.style.tooltip.opacity}; \n            font-weight: ${vm.chart.style.tooltip.text.fontWeight}; \n            font-size: ${vm.chart.style.tooltip.text.fontSize}; \n            color: ${vm.chart.style.tooltip.text.textColor};\n            font-family: ${vm.chart.style.tooltip.text.fontFamily};\n            background-color: ${vm.chart.style.tooltip.backgroundColor}; \n            padding: ${vm.chart.style.tooltip.text.padding};   \n            border: ${vm.chart.style.tooltip.border.width} solid ${vm.chart.style.tooltip.border.color};  \n            border-radius:  ${vm.chart.style.tooltip.border.radius};'>`;\n          html += `<strong style='color:${vm.chart.style.tooltip.text.fontColor};'>`;\n        }\n        else { var html = \"<div> <strong>\"; }\n        html += `<strong style='color:${scaleColor}'>` + d.name + \": </strong>\";\n        html += d.y ? (`<span >` + (Number.isNaN(+d.y) ? d.y : vm.utils.format(d.y), 1) + '</span>') : '';\n        html += \"</div>\";\n\n        return html;\n\n        /*var html ='';\n        html += d.name + '<br>';\n        //html += d.x ? ('<span>' + (Number.isNaN(+d.x) ? d.x : vm.utils.format(d.x)) + '</span></br>') : '';\n        html += d.y ? ('<span>' + (Number.isNaN(+d.y) ? d.y : vm.utils.format(d.y)) + '</span></br>') : '';\n        html += d.magnitude ? ('<span>' + (Number.isNaN(+d.magnitude) ? d.magnitude : vm.utils.format(d.magnitude)) + '</span></br>') : '';\n        html += d.color ? ('<span>' + (Number.isNaN(+d.color) ? d.color : vm.utils.format(d.color)) + '</span>') : '';\n        return html;*/\n      });\n\n  }\n\n  //-------------------------------\n  //User config functions\n  Timeline.x = function(col){\n    var vm = this;\n    vm._config.x = col;\n    return vm;\n  }\n\n  Timeline.parseDate = function(format){\n    var vm = this;\n    vm._config.parseDate = d3.timeParse(format);\n    return vm;\n  }\n\n  Timeline.y = function(col){\n    var vm = this;\n    vm._config.y = col;\n    return vm;\n  }\n\n  Timeline.series = function(arr){\n    var vm = this;\n    vm._config.series = arr;\n    return vm;\n  }\n\n  Timeline.curve = function (curve) {\n    var vm = this;\n    vm._config.curve = curve;\n    return vm;\n  }\n\n  Timeline.fill = function(col){\n    var vm = this;\n    vm._config.fill = col;\n    return vm;\n  }\n\n  Timeline.colors = function(colors) {\n    var vm = this;\n    if(Array.isArray(colors)) {\n      //Using an array of colors for the range \n      vm._config.colors = colors;\n    } else {\n      //Using a preconfigured d3.scale\n      vm._scales.color = colors;\n    }\n    return vm;\n  }\n\n  Timeline.tip = function (tip) {\n    var vm = this;\n    vm._config.tip = tip;\n    vm._tip.html(vm._config.tip);\n    return vm;\n  };\n\n  //-------------------------------\n  //Triggered by the chart.js;\n  Timeline.data = function(data){\n    var vm = this;\n\n    vm._data = [];\n    data.forEach(function(d){\n      var tmp = Object.assign({}, d);\n      if (d[vm._config.x]) {\n        try {\n          d[vm._config.x].getTime();\n          if (!Number.isNaN(d[vm._config.x].getTime())) {\n            tmp.x = d[vm._config.x];\n          }\n        } catch (err) {\n          tmp.x = vm._config.parseDate(d[vm._config.x]);\n        }\n      }\n\n      tmp.color = d[vm._config.fill];\n      delete(tmp[vm._config.x]);\n      vm._data.push(tmp);\n    });\n\n    //Sort the data by d.x\n    vm._data = vm._data.sort(function (a, b) {\n      return d3.ascending(a.x, b.x);\n    });\n\n    vm._lines = vm._config.y ? vm._config.y : vm._config.series;\n\n    vm._lines = vm._lines.map(function(name) {\n      return {\n        name: name,\n        values: vm._data.map(function(d) {\n          return {x: d.x, y: +d[name]};\n        })\n      };\n    });\n    \n    vm._lines.forEach((n) => {\n      n.values = n.values.filter((v) => {\n        return !isNaN(v.y)\n      });\n    });\n\n    vm._line = d3.line()\n      .curve(vm._config.curve)\n      .defined(function (d) {\n        return d.y !== undefined;\n      })\n      .x(function (d) {\n        return vm._scales.x(d.x);\n      })\n      .y(function (d) {\n        return vm._scales.y(d.y);\n      });\n\n\n    vm._area = d3.area()\n      .curve(vm._config.curve)\n      .x(function (d) {\n        if (d.alreadyScaled && d.alreadyScaled === true) {\n          return d.x;\n        } else {\n          return vm._scales.x(d.x);\n        }\n      })\n      .y1(function (d) {\n        if (d.alreadyScaled && d.alreadyScaled === true) {\n          return d.y;\n        } else {\n          return vm._scales.y(d.y);\n        }\n      });\n\n    return vm;\n  }\n\n  Timeline.scales = function(){\n    var vm = this;\n\n    vm._xMinMax = d3.extent(vm._data, function(d) { return d.x; });\n\n    vm._yMinMax = [\n      vm._config.yAxis.minZero ? 0 : d3.min(vm._lines, function(c) { return d3.min(c.values, function(v) { return v.y; }); }),\n      d3.max(vm._lines, function(c) { return d3.max(c.values, function(v) { return v.y; }); })\n    ];\n\n    config = {\n      column: vm._config.x,\n      type: vm._config.xAxis.scale,\n      range: [0, vm.chart.width],\n      minZero: false\n    };\n    vm._scales.x = vm.utils.generateScale(vm._data, config);\n\n    config = {\n      column: vm._config.y,\n      type: vm._config.yAxis.scale,\n      range: [vm.chart.height, 0],\n      minZero: vm._config.yAxis.minZero\n    };\n    vm._scales.y = vm.utils.generateScale(vm._data, config);\n\n    vm._scales.x.domain(vm._xMinMax);\n    vm._scales.y.domain(vm._yMinMax).nice();\n\n    if(vm._config.hasOwnProperty('colors'))\n      vm._scales.color = d3.scaleOrdinal(vm._config.colors);\n    else\n      vm._scales.color = d3.scaleOrdinal(d3.schemeCategory10);\n\n    if (vm._scales.x.domain()[0].getTime() == vm._scales.x.domain()[1].getTime()) { // max and min are the same, there's only one datum\n      var oldDomain = vm._scales.x.domain();\n      var oldRange = vm._scales.x.range();\n\n      vm._scales.x\n        .domain([new Date(oldDomain[0].getTime() - 1), oldDomain[0] , oldDomain[1]])\n        .range([0, oldRange[0] + (oldRange[1] - oldRange[0]) / 2, oldRange[1]]);\n    }\n\n    return vm;\n  }\n\n  Timeline.drawLabels = function() {\n    var vm = this;\n    var chartW = vm.chart.width;\n\n    vm.chart.svg().selectAll('.dots').each(function(dat) {\n      var el = this;\n      dat.values.forEach(function(c, index) {\n        d3.select(el).append('text')\n          .attr('class', 'dbox-label')\n          .attr('transform', function(d) {\n            if (vm._scales.x(d.values[index].x) >= chartW) {\n              return 'translate (' + (vm._scales.x(d.values[index].x) - 50) + ',' + (vm._scales.y(d.values[index].y)) + ')';\n            }\n            return 'translate (' + (vm._scales.x(d.values[index].x) + 50) + ',' + (vm._scales.y(d.values[index].y)) + ')';\n          })\n          .text(function() {\n            return c.y ? c.y.toFixed(1) : '';\n          });\n      });\n    });\n  }\n\n  Timeline.draw = function(){\n    var vm = this;\n    //Call the tip\n    vm.chart.svg().call(vm._tip);\n\n    if (vm._scales.x.domain().length === 3) {\n      vm.chart.svg().select('.x.axis .tick').remove();\n    }\n\n    var lines = vm.chart.svg().selectAll(\".lines\")\n      .data(vm._lines)\n    .enter().append(\"g\")\n      .attr(\"class\", \"lines\");\n\n    var path = vm.chart.svg().selectAll(\".lines\").append(\"path\")\n      .attr(\"class\", \"line\")\n      .attr(\"d\", function(d) {\n        return vm._line(d.values);\n      })\n      .attr(\"stroke\", function(d){   \n        return vm._scales.color !== false ? vm._scales.color(d.name): vm._getQuantileColor(d.name,'default');\n      })\n      .attr(\"stroke-width\", 4)\n      .attr('fill','none');\n\n    /**By default it draws dots on data points with 4px radius*/\n    var dots = vm.chart.svg().selectAll('.dots')\n      .data(vm._lines)\n      .enter().append('g')\n        .attr('class', 'dots')\n        .selectAll('.circle')\n        .data( function(d) {\n          d.values.forEach((el) => {el.name = d.name;}); \n          return d.values; \n        })\n        .enter().append('circle')\n          .attr('class', 'dot')\n          .attr(\"cx\", function(d, i) {\n            return vm._scales.x(d.x); \n          })\n          .attr(\"cy\", function(d) {\n            return vm._scales.y(d.y); \n          })\n          .attr(\"r\", 4)\n          .style('stroke', function(d){   \n            return vm._scales.color !== false ? vm._scales.color(d.name): vm._getQuantileColor(d.name,'default');\n          })\n          .style('stroke-width', 2)\n          .style('fill', '#fff')\n          .style('fill-opacity', 0.5)\n          .on('mouseover', function (d, i) {\n            if (vm._config.mouseover) {\n              //vm._config.mouseover.call(vm, d, i);\n            }\n            vm._tip.show(d, d3.select(this).node());\n          })\n          .on('mouseout', function (d, i) {\n            if (vm._config.mouseout) {\n              //vm._config.mouseout.call(this, d, i);\n            }\n            vm._tip.hide(d, d3.select(this).node());\n          })\n\n    Timeline.drawLabels();\n    //var t = textures.lines().thicker();\n\n    //vm.chart.svg().call(t);\n\n\n    /* vm._area.y0(vm._scales.y(vm._yMinMax[0]));\n\n    var areas = vm.chart.svg().selectAll(\".areas\")\n      .data(vm._lines)\n    .enter().append(\"g\")\n      .attr(\"class\", \"areas\");\n\n    var pathArea  = vm.chart.svg().selectAll(\".areas\").append(\"path\")\n      .attr(\"class\", \"area\")\n      .attr(\"d\", function(d) {\n        return vm._area(d.values);\n      }) */\n      //.attr(\"fill\", t.url());\n\n    return vm;\n  }\n\n  Timeline.init(config);\n  return Timeline;\n}\n","import * as d3 from 'd3';\n\n/* \n * Simple SVG Treemap Chart\n */\nexport default function(config, helper) {\n\n  var Treemap = Object.create(helper);\n\n  Treemap.init = function(config) {\n    var vm = this;\n    vm._config = config ? config : {};\n    vm._config._padding = 3;\n    vm._config._labels = false;\n    vm._config.tip = function(d) {\n      console.log(d);\n      var html = '<div>';\n      if (d.parent.data.name && d.parent.data.name !== 'data') {\n\n        html += '<span>' + d.parent.data.name + '</span><br>'; \n      }\n      html += '<span>' + d.data.name + '</span><br>'; \n      html += '<span>' + vm.utils.format(d.value, vm._config.decimals) + '</span>';\n      html += '</div>';\n      return html;\n    };\n    vm._data = [];\n    vm._scales = {\n      color: d3.scaleOrdinal(d3.schemeCategory20c)\n    };\n    vm._axes = {};\n    vm._tip = vm.utils.d3.tip()\n      .attr('class', 'd3-tip tip-treemap')\n      .direction('n')\n      .html(vm._config.tip);\n  }\n\n  Treemap.size = function(col) {\n    var vm = this;\n    vm._config._size = col;\n    return vm;\n  }\n\n  Treemap.colors = function(arrayOfColors, domain) {\n    var vm = this;\n    vm._scales.color = d3.scaleOrdinal(arrayOfColors);\n    if (domain) {\n      vm._scales.color.domain(domain);\n    }\n    return vm;\n  }\n\n  Treemap.padding = function(padding) {\n    var vm = this;\n    vm._config._padding = padding;\n    return vm;\n  }\n\n  Treemap.nestBy = function(keys) {\n    var vm = this;\n    if (Array.isArray(keys)) {\n      if (keys.length == 0)\n        throw \"Error: nestBy() array is empty\";\n      vm._config._keys = keys;\n    } else if (typeof keys === 'string' || keys instanceof String) {\n      vm._config._keys = [keys];\n    } else {\n      if (keys == undefined || keys == null)\n        throw \"Error: nestBy() expects column names to deaggregate data\";\n      vm._config._keys = [keys.toString()];\n      console.warning(\"nestBy() expected name of columns. Argument will be forced to string version .toString()\");\n    }\n    vm._config._labelName = vm._config._keys[vm._config._keys.length - 1]; //label will be last key\n    return vm;\n  }\n\n  Treemap.format = function(format) {\n    var vm = this;\n    if (typeof format == 'function' || format instanceof Function)\n      vm.utils.format = format;\n    else\n      vm.utils.format = d3.format(format, vm._config.decimals);\n    return vm;\n  }\n\n  Treemap.labels = function(bool) {\n    var vm = this;\n    vm._config._labels = Boolean(bool);\n    return vm;\n  };\n\n  Treemap.tip = function(tip) {\n    var vm = this;\n    vm._config.tip = tip;\n    vm._tip.html(vm._config.tip);\n    return vm;\n  }\n\n  Treemap.scales = function (scales) {\n    var vm = this;\n    return vm;\n  }\n\n  Treemap.axes = function() {\n    var vm = this;\n    return vm;\n  }\n\n  Treemap.domains = function() {\n    var vm = this;\n    return vm;\n  }\n\n  Treemap.isValidStructure = function(datum) {\n    var vm = this;\n    if ((typeof datum.name === 'string' || datum.name instanceof String) && Array.isArray(datum.children)) {\n      var res = true;\n      datum.children.forEach(function(child) {\n        res = res && vm.isValidStructure(child);\n      });\n      return res;\n    } else if ((typeof datum.name === 'string' || datum.name instanceof String) && Number(datum[vm._config._size]) == datum[vm._config._size]) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  Treemap.formatNestedData = function(data) {\n    var vm = this;\n    if (data.key) {\n      data.name = data.key;\n      delete data.key;\n    } else {\n      if (!Array.isArray(data.values)) {\n        data.name = data[vm._config._labelName];\n      }\n    }\n    if (Array.isArray(data.values)) {\n      var children = [];\n      data.values.forEach(function(v) {\n        children.push(vm.formatNestedData(v))\n      });\n      data.children = children;\n      delete data.values;\n    }\n    if (!data[vm._config._size] && data.value) {\n      data[vm._config._size] = data.value;\n    }\n    return data;\n  }\n\n  function nestKey(nest, key, callback) {\n    callback(null, nest.key(function(d) {\n      return d[key];\n    }))\n  }\n\n  Treemap.data = function(data) {\n    var vm = this;\n    // Validate structure like [{name: '', children: [{},{}]}]\n    if (data) {\n      if (Array.isArray(data) && data.length > 0) {\n        if (!vm.isValidStructure(data[0])) {\n          data.forEach(function(d) {\n            d[vm._config._size] = +d[vm._config._size];\n          });\n          try {\n            if (!vm._config._keys)\n              throw \"nestBy() in layer was not configured\";\n            var nested = d3.nest();\n            var queue = d3.queue();\n            for (var i = 0; i < vm._config._keys.length; i++)\n              queue.defer(nestKey, nested, vm._config._keys[i])\n            queue.awaitAll(function(error, nested) {\n              var nestedData = nested[0].rollup(function(leaves) {\n                return d3.sum(leaves, function(d) {\n                  return d[vm._config._size];\n                })\n              }).entries(data);\n              var aux = {};\n              aux.key = 'data';\n              aux.values = _.cloneDeep(nestedData); // WARN: Lodash dependency\n              data = vm.formatNestedData(aux);\n              vm._data = data;\n            });\n\n          } catch (err) {\n            console.error(err);\n          }\n        }\n      } else {\n        if (!vm.isValidStructure(data)) {\n          try {\n            if (!data.key)\n              throw \"Property 'key' not found\";\n            if (data[vm._config._size] !== Number(data[vm._config._size]))\n              throw \"Value used for treemap rect size is not a number\";\n            data = vm.formatNestedData(data);\n            vm._data = data;\n          } catch (err) {\n            console.error(err);\n          }\n        }\n      }\n    }\n    return vm;\n  }\n\n  Treemap.draw = function() {\n    var vm = this;\n    vm.chart.svg().call(vm._tip);\n\n    var treemap = d3.treemap()\n      .tile(d3.treemapResquarify)\n      .size([vm.chart.width, vm.chart.height])\n      .round(true)\n      .paddingInner(vm._config._padding);\n\n    var root = d3.hierarchy(vm._data)\n      .eachBefore(function(d) {\n        d.data.id = (d.parent ? d.parent.data.id + \".\" : \"\") + d.data.name;\n      })\n      .sum(function(d) {\n        return d[vm._config._size];\n      })\n      .sort(function(a, b) {\n        return b.height - a.height || b.value - a.value;\n      });\n\n    treemap(root);\n\n    console.log(root.leaves());\n\n    var cell = vm.chart.svg().selectAll(\"g\")\n      .data(root.leaves())\n      .enter().append(\"g\")\n      .attr(\"transform\", function(d) {\n        return \"translate(\" + d.x0 + \",\" + d.y0 + \")\";\n      });\n\n    var rect = cell.append(\"rect\")\n      .attr(\"id\", function(d) {\n        return d.data.id;\n      })\n      .attr(\"width\", function(d) {\n        return d.x1 - d.x0;\n      })\n      .attr(\"height\", function(d) {\n        return d.y1 - d.y0;\n      })\n      .attr(\"fill\", function(d) {\n        console.log('fill', d);\n        console.log(vm._scales.color.range());\n        console.log(vm._scales.color.domain());\n        return vm._scales.color(d.data.name);\n      });\n\n    cell.append(\"clipPath\")\n      .attr(\"id\", function(d) {\n        return \"clip-\" + d.data.id;\n      })\n      .append(\"use\")\n      .attr(\"xlink:href\", function(d) {\n        return \"#\" + d.data.id;\n      });\n\n    if (vm._config._labels) {\n      var text = cell.append(\"text\")\n        .attr(\"clip-path\", function(d) {\n          return \"url(#clip-\" + d.data.id + \")\";\n        })\n      text.append(\"tspan\")\n        .attr('class', 'capitalize')\n        .attr(\"x\", 8)\n        .attr(\"y\", 25)\n        .text(function(d) {\n          if (d.value > 2) {\n            var arr = d.data.id.replace('data.', '').split('.');\n            return arr.length > 1 ? arr.slice(arr.length - 2, arr.length).join(' / ') : arr[arr.length - 1].toString();\n          } else\n            return '';\n        });\n      text.append(\"tspan\")\n        .attr('class', 'capitalize')\n        .attr(\"x\", 8)\n        .attr(\"y\", 45)\n        .text(function(d) {\n          return d.value > 2 ? vm.utils.format(d.value, vm._config.decimals) : '';\n        });\n    }\n\n    rect.on('mouseover', function(d) {\n        /*if(vm._config.data.mouseover){\n          vm._config.data.mouseover.call(vm, d,i);\n        }*/\n        vm._tip.show(d, d3.select(this).node());\n      })\n      .on('mouseout', function(d) {\n        /*if(vm._config.data.mouseout){\n          vm._config.data.mouseout.call(this, d,i);\n        }*/\n        vm._tip.hide(d, d3.select(this).node());\n      })\n\n    return vm;\n  }\n\n  Treemap.init(config);\n  return Treemap;\n}\n","/*\n * Dboxjs\n *\n * You can import other modules here, including external packages. When\n * bundling using rollup you can mark those modules as external and have them\n * excluded or, if they have a jsnext:main entry in their package.json (like\n * this package does), let rollup bundle them into your dist file.\n */\n\n/* Core */\nimport * as _ from 'lodash';\n\nexport {\n  default as chart,\n} from './lib/chart';\n\n/* Chart modules */\nexport {\n  default as bars\n} from '../bars/bars.js';\n\nexport {\n  default as distro\n} from '../distro/distro.js';\n\nexport {\n  default as heatmap,\n} from '../heatmap/heatmap.js';\n\nexport {\n  default as leaflet,\n} from '../leaflet/leaflet.js';\n\nexport {\n  default as map,\n} from '../map/map.js';\n\nexport {\n  default as radar\n} from '../radar/radar.js';\n\nexport {\n  default as scatter,\n} from '../scatter/scatter.js';\n\nexport {\n  default as spineplot\n} from '../spineplot/spineplot.js';\n\nexport {\n  default as timeline,\n} from '../timeline/timeline.js';\n\nexport {\n  default as treemap,\n} from '../treemap/treemap.js';\n\n"],"names":["carto","query","config","callback","sql","cartodb","user","execute","done","data","result","rows","parser","map","error","vm","Helper","chart","_config","width","_width","height","_height","style","_addStyle","fullSvg","_fullSvg","svg","_svg","utils","d3","tip","generateScale","scale","domains","range","groupBy","d","column","stackBy","serie","undefined","type","minZero","Array","isArray","rangeRound","domain","padding","bins","format","value","formatPreffix","formatSuffix","wrap","text","tooltip","each","words","split","reverse","word","line","lineNumber","lineHeight","y","attr","dy","parseFloat","tspan","append","pop","push","join","node","getComputedTextLength","length","on","show","hide","i","slice","sortAscending","a","b","Number","isNaN","sortDescending","Chart","init","defaultConfig","size","margin","left","right","top","bottom","defaultStyle","backgroundColor","color","title","textColor","fontSize","fontWeight","textAlign","hr","enabled","borderWidth","borderColor","legend","position","figure","opacity","fontFamily","border","radius","yAxis","axis","strokeWidth","strokeColor","strokeOpacity","paddingTick","ticks","grid","gridDashed","labels","textAnchor","xAxis","_","_data","_margin","addStyle","_scales","_axes","layers","helper","bind","sizeObj","stylesObj","bool","bindTo","selector","Object","assign","legendType","legendTitle","layer","_layer","getLayer","layerIndex","draw","q","scales","loadData","awaitAll","results","initLayers","drawSVG","axes","drawAxes","drawLayers","events","load","dispatch","theme","x","buckets","setScales","tickSizeOuter","tickSize","values","tickValues","tickFormat","tsv","defer","json","csv","raw","mapData","topojson","url","plotOptions","bars","averageLines","forEach","l","ly","select","remove","html","template","classed","categories","c","hasOwnProperty","drawLegend","legendTip","name","call","legendBox","styles","lWidth","lbWidth","rx","ry","markStrokeWidth","o","legendCheck","selectAll","enter","onClickLegend","stopPropagation","coordinates","property","active","drawGrid","axesTip","element","dropdown","yAxisDropDown","updateAxis","getBoundingClientRect","display","transform","options","selected","console","log","_xAxis","xAxisDropDown","tickWidth","rotate","biggestLabelWidth","nodes","xBandWidth","bandwidth","stroke","keys","k","obj","change","getDomains","minMax","sorted","sortFunctionY","sortFunctionX","sort","order","destroy","Bars","create","_tip","direction","id","columnName","columns","fill","colors","sortBy","option","Function","filter","_quantiles","_setQuasecondntile","_minMax","drawLabels","charContainer","barH","Math","abs","barW","decimals","coefficient","toFixed","_drawGroupByXAxis","_drawGroupByYAxis","_drawStackByXAxis","_drawStackByYAxis","_getQuantileColor","quantiles","onmouseover","onmouseout","onclick","drawGroupLabels","gr","el","dat","index","barReference","key","drawStackLabels","_setQuantile","quantile","predefinedQuantiles","ignoreZeros","aux","j","total","min","max","outOfRangeColor","colorsOnHover","makeDistroChart","settings","idName","xName","xSort","yName","axisLables","yTicks","chartSize","constrainExtremes","setting","formatAsFloat","formatNumber","formatRange","logFormatNumber","floor","yFormatter","xFormatter","groupObjs","objs","mainDiv","chartDiv","g","colorFunct","getColorFunct","colorOptions","colorMap","group","getObjWidth","objWidth","gName","objSize","middle","xScale","gShift","addJitter","doJitter","random","shallowCopy","oldObj","newObj","tooltipHover","groupName","metrics","pointName","pointValue","boxpart","tooltipString","toLocaleString","quartile3","mean","median","quartile1","transition","duration","prepareData","calcMetrics","upperOuterFence","upperInnerFence","iqr","lowerInnerFence","lowerOuterFence","LIF","UIF","current_x","current_y","current_id","current_idName","current_row","valuesInfo","cName","prepareSettings","divWidth","divHeight","axisLabels","xAxisLable","yAxisLable","yScale","fences","nice","clamp","tickSizeInner","update","parseInt","violinPlots","_yDomainVP","prepareChart","window","renderViolinPlot","defaultOptions","showViolinPlot","resolution","curve","vOpts","violin","updateOptions","prepareViolin","reset","opts","cViolinPlot","xVScale","copy","kde","kernelDensityEstimator","eKernel","kdedata","interpolateMax","interpolateMin","kdeTester","eKernelTest","interMaxY","interMaxX","count","interMinY","interMinX","objBounds","yVScale","area","y0","y1","datum","kernel","sample","v","u","array","testX","renderBoxPlot","boxPlots","showBox","showWhiskers","showMedian","showMean","medianCSize","showOutliers","boxWidth","lineWidth","scatterOutliers","outlierCSize","bOpts","boxPlot","calcAllOutliers","calcOutliers","cGroup","cExtremes","cOutliers","cOut","idx","outliers","extremes","prepareBoxPlot","cBoxPlot","sMetrics","box","lineBounds","upperWhisker","fence","lowerWhisker","circle","pt","point","pageX","pageY","outDiv","extDiv","renderNotchBoxes","notchBoxes","showNotchBox","showLines","medianWidth","notchStyle","nOpts","notchBox","makeNotchBox","cNotch","notchBounds","scaledValues","boxLeft","lowerNotch","medianLeft","upperNotch","boxRight","medianRight","calcNotches","modifier","sqrt","prepareNotchBoxes","boxBounds","medianBounds","notch","upperLine","confidenceLines","upper","lower","lowerLine","renderDataPlots","dataPlots","showPlot","plotType","pointSize","showBeanLines","beanWidth","dOpts","preparePlots","cPlot","halfBand","cMetric","lines","points","swarmBounds","yPtScale","interpolate","maxWidth","ptsObj","cYBucket","pts","rightMax","row","leftMin","col","plotBounds","scatterWidth","bean","beanBounds","val","valInfo","onClickElement","parseDate","Distro","opt","chart1","babelHelpers['typeof']","Heatmap","_legendElementWidth","_gridWidth","colorLegend","borderRadius","ySort","xCategories","sortKeys","entries","yCategories","fillValues","_gridHeight","m","drawColorLegend","quantilePosition","invertExtent","cards","indexOf","String","_yLabels","_xLabels","labelMaxWidth","mouseover","mouseout","ease","Leaflet","_topojson","objects","_nodes","geometries","geom","found","properties","step","formatLegend","urlTopojson","tran","translate","L","TopoJSON","GeoJSON","extend","addData","jsonData","geojson","feature","prototype","LatLng","lat","lon","center","bounds","LatLngBounds","_map","Map","getCenter","zoom","maxZoom","minZoom","maxBounds","maxBoundsViscosity","mapTiles","tileLayer","attribution","topoLayer","addTo","addTopoData","topoData","eachLayer","handleLayer","NOM_ENT","NOM_MUN","_path","fillColor","setStyle","fillOpacity","weight","enterLayer","leaveLayer","_formatWithZeroDecimals","_formatWithOneDecimal","_formatWithTwoDecimals","_formatWithThreeDecimals","_format","percentage","end","_chart","s","_projection","path","projection","_polygons","translateX","features","_polygonsDefault","dropWhile","Radar","CIRCLE_RADIANS","PI","RADIANS_TO_ROTATE","_axesData","_filter","_viewData","_colorMap","_ticks","_scale","_excludedPolygons","transitionDuration","axisLabelMargin","enable","at","styleDefaults","_center","_radius","polygonsFrom","axesFrom","valuesFrom","drawTicks","dur","sel","empty","_ifStyleDefaults","exit","drawTicksLabels","extractAxes","radiansPerAxis","reduce","prev","item","concat","rads","list","hash","hashed","buildColorMap","cMap","polyg","cIdx","polygon","selection","xOf","yOf","drawAxesLabels","fromCenter","rects","drawPolygons","groupedData","gs","gsExit","gsEnter","bundle","polygIdx","polygons","rawData","xy","CVE_ENT","_buildNestedPolygons","_buildNestedVertexes","toUpdate","appendHelper","updateHelper","_showTooltip","_hideTooltip","removeHelper","dataFunc","keyFunc","val1","val2","tt","subtt","bg","bbox","getBBox","centerPoints","side","newLegend","_toggleList","base","items","newItems","it","cos","sin","dataForVisualization","axisKey","valKey","polygKey","axesHash","scVal","fun","_calcDomains","Scatter","fontColor","magnitude","radiusRange","magnitudeRange","figureType","regression","xr","yr","xMean","yMean","b1","b0","term1","term2","p","yhat","radiusMinMax","magnitudeMinMax","scaleDomain","yCoords","xCoords","repeat","xCoord","yCoord","space","ceil","current","cnt","allText","Spineplot","orientation","category","x0","x1","stackValues","totalCollapse","stack","txpe","groups","sv","rectW","rectH","posX","largestLabelWidth","newLabelMaxWidth","textSize","getComputedStyle","getPropertyValue","numSize","replace","diffPos1","diffPos2","lessThanPrev","lessThanPost","removed","cat","h","Timeline","scaleColor","series","arr","tmp","getTime","err","_lines","n","_line","defined","_area","alreadyScaled","_xMinMax","_yMinMax","oldDomain","oldRange","Date","chartW","dots","Treemap","_padding","_labels","parent","_size","arrayOfColors","nestBy","_keys","toString","warning","_labelName","Boolean","isValidStructure","children","res","child","formatNestedData","nestKey","nest","nested","queue","nestedData","rollup","leaves","cloneDeep","treemap","tile","round","paddingInner","root","eachBefore","sum","cell","rect"],"mappings":";;;;;;EAAA;;;EAKe,SAASA,KAAT,GAAiB;;EAE9B,WAASA,KAAT,GAAgB;;EAIhBA,QAAMC,KAAN,GAAc,UAASC,MAAT,EAAiBC,QAAjB,EAA0B;EACtC;EACA,QAAIC,MAAM,IAAIC,WAAJ,CAAgB,EAAEC,MAAMJ,OAAOG,OAAP,CAAeC,IAAvB,EAAhB,CAAV;EACA;EACAF,QAAIG,OAAJ,CAAYL,OAAOG,OAAP,CAAeD,GAA3B,EACGI,IADH,CACQ,UAASC,IAAT,EAAc;;EAElB,UAAIC,SAASD,KAAKE,IAAlB;EACA;EACA,UAAIT,OAAOU,MAAX,EAAmB;EACjBF,iBAASD,KAAKE,IAAL,CAAUE,GAAV,CAAcX,OAAOU,MAArB,CAAT;EACD;EACD;EACAT,eAAS,IAAT,EAAeO,MAAf;EACD,KAVH,EAWGI,KAXH,CAWS,UAASA,KAAT,EAAe;EACpB;EACAX,eAASW,KAAT,EAAgB,IAAhB;EACD,KAdH;EAeD,GAnBD;;EAqBA,SAAOd,KAAP;EACD;;EC9BD;;AAEA,EAAe,mBAAY;;EAEzB,MAAIe,KAAK,IAAT,CAFyB;;EAIzB,MAAIC,SAAS;EACXC,WAAO;EACLf,cAAQa,GAAGG,OADN;EAELC,aAAOJ,GAAGK,MAFL;EAGLC,cAAQN,GAAGO,OAHN;EAILC,aAAOR,GAAGS,SAJL;EAKLC;EAAS,2BAAY;EACnB,iBAAOV,GAAGW,QAAV;EACD;;EAFD;EAAA,SALK;EAQLC;EAAK,uBAAY;EACf,iBAAOZ,GAAGa,IAAV;EACD;;EAFD;EAAA;EARK,KADI;EAaXC,WAAO;EACLC,UAAI;EADC;EAbI,GAAb;;EAkBAd,SAAOa,KAAP,CAAaC,EAAb,CAAgBC,GAAhB,GAAsBD,MAAtB;EACA;;EAEAd,SAAOa,KAAP,CAAaG,aAAb,GAA6B,UAAUvB,IAAV,EAAgBP,MAAhB,EAAwB;EACnD,QAAI+B,QAAQ,EAAZ;EACA,QAAIC,OAAJ;EACA,QAAI,CAAChC,OAAOiC,KAAZ,EAAmB;EACjB,YAAM,sBAAN;EACD;EACD;EACA,QAAIjC,OAAOkC,OAAP,IAAkBlC,OAAOkC,OAAP,IAAkB,QAAxC,EAAkD;EAChD;EACAF,gBAAUzB,KAAKI,GAAL,CAAS,UAAUwB,CAAV,EAAa;EAC9B,eAAOA,EAAEnC,OAAOoC,MAAT,CAAP;EACD,OAFS,CAAV;EAGD,KALD,MAKO,IAAIpC,OAAOqC,OAAP,IAAkBrC,OAAOqC,OAAP,IAAkB,QAAxC,EAAkD;EACvDL,gBAAUzB,KAAK,CAAL,EAAQI,GAAR,CAAY,UAAUwB,CAAV,EAAa;EACjC,eAAOA,EAAE5B,IAAF,CAAOP,OAAOoC,MAAd,CAAP;EACD,OAFS,CAAV;EAGD,KAJM,MAIA,IAAIpC,OAAOkC,OAAP,IAAkB,UAAtB,EAAkC;EACvC;EACAF,gBAAUhC,OAAOoC,MAAjB;EACD,KAHM,MAGA,IAAIpC,OAAOkC,OAAP,IAAkB,MAAtB,EAA8B;EACnC;EACAF,gBAAU,CAAC,CAAD,EAAIJ,MAAA,CAAOrB,IAAP,EAAa,UAAU4B,CAAV,EAAa;EACtC,eAAOP,MAAA,CAAO5B,OAAOoC,MAAd,EAAsB,UAAUA,MAAV,EAAkB;EAC7C,iBAAOD,EAAEC,MAAF,CAAP;EACD,SAFM,CAAP;EAGD,OAJa,CAAJ,CAAV;EAKD,KAPM,MAOA,IAAIpC,OAAOqC,OAAP,IAAkB,MAAtB,EAA8B;EACnC;EACAL,gBAAU,CAAC,CAAD,EAAIJ,MAAA,CAAOrB,IAAP,EAAa,UAAU+B,KAAV,EAAiB;EAC1C,eAAOV,MAAA,CAAOU,KAAP,EAAc,UAAUH,CAAV,EAAa;EAChC,iBAAOA,EAAE,CAAF,CAAP;EACD,SAFM,CAAP;EAGD,OAJa,CAAJ,CAAV;EAKD,KAPM,MAOA,IAAInC,OAAOkC,OAAP,IAAkBK,SAAlB,IAA+BvC,OAAOwC,IAAP,IAAe,MAAlD,EAA0D;EAC/D;EACAR,gBAAUzB,KAAKI,GAAL,CAAS,UAAUwB,CAAV,EAAa;EAC9B,eAAOA,EAAEnC,OAAOoC,MAAT,CAAP;EACD,OAFS,CAAV;EAGD,KALM,MAKA,IAAIpC,OAAOwC,IAAP,KAAgB,QAApB,EAA8B;EACnC;EACAR,gBAAUJ,SAAA,CAAUrB,IAAV,EAAgB,UAAU4B,CAAV,EAAa;EACrC,eAAO,CAACA,EAAEnC,OAAOoC,MAAT,CAAR;EACD,OAFS,CAAV;EAGD,KALM,MAKA;EACL;EACAJ,gBAAUzB,KAAKI,GAAL,CAAS,UAAUwB,CAAV,EAAa;EAC9B,eAAOA,EAAEnC,OAAOoC,MAAT,CAAP;EACD,OAFS,CAAV;EAGD;;EAED,QAAIpC,OAAOyC,OAAX,EAAoB;EAClBT,gBAAU,CAAC,CAAD,EAAIJ,MAAA,CAAOrB,IAAP,EAAa,UAAU4B,CAAV,EAAa;EACtC,eAAO,CAACA,EAAEnC,OAAOoC,MAAT,CAAR;EACD,OAFa,CAAJ,CAAV;EAGD;EACD,QAAIpC,OAAOgC,OAAP,IAAkBU,MAAMC,OAAN,CAAc3C,OAAOgC,OAArB,CAAtB,EAAqD;EACnDA,gBAAUhC,OAAOgC,OAAjB;EACD;;EAED,QAAIhC,OAAOwC,IAAX,EAAiB;EACf,cAAQxC,OAAOwC,IAAf;EACA,aAAK,QAAL;EACET,kBAAQH,cAAA,GACLgB,UADK,CACM5C,OAAOiC,KADb,EAELY,MAFK,CAEEb,OAFF,CAAR;EAGA;;EAEF,aAAK,MAAL;EACED,kBAAQH,YAAA,GACLK,KADK,CACCjC,OAAOiC,KADR,CAAR;EAEA;EACA;;EAEF,aAAK,SAAL;EACEF,kBAAQH,YAAA,GACLgB,UADK,CACM5C,OAAOiC,KADb,EAELa,OAFK,CAEG,GAFH,EAGLD,MAHK,CAGEb,OAHF,CAAR;EAIA;;EAEF,aAAK,MAAL;EACED,kBAAQH,YAAA,GACLgB,UADK,CACM5C,OAAOiC,KADb,EAELY,MAFK,CAEEb,OAFF,EAGLc,OAHK,CAGG,GAHH,CAAR;EAIA;;EAEF,aAAK,UAAL;EACEf,kBAAQH,YAAA,GACLgB,UADK,CACM5C,OAAOiC,KADb,EAELa,OAFK,CAEG,GAFH,EAGLD,MAHK,CAGEtC,KAAKI,GAAL,CAAS,UAAUwB,CAAV,EAAa;EAC5B,mBAAOA,EAAEnC,OAAOoC,MAAT,CAAP;EACD,WAFO,CAHF,CAAR;EAMA,cAAI,CAACpC,OAAO+C,IAAZ,EAAkB;EAChB/C,mBAAO+C,IAAP,GAAc,EAAd;EACD;EACDhB,kBAAQH,gBAAA,GACLK,KADK,CACCL,QAAA,CAAS5B,OAAO+C,IAAhB,CADD,CAAR;EAEA;;EAEF;EACEhB,kBAAQH,cAAA,GACLgB,UADK,CACM5C,OAAOiC,KADb,EAELY,MAFK,CAEEb,OAFF,CAAR;EAGA;EA7CF;EA+CD,KAhDD,MAgDO;EACLD,cAAQH,cAAA,GACLgB,UADK,CACM5C,OAAOiC,KADb,EAELY,MAFK,CAEEb,OAFF,CAAR;EAGD;;EAED,WAAOD,KAAP;EACD,GAlHD;;EAoHAjB,SAAOa,KAAP,CAAaqB,MAAb,GAAsB,UAAUb,CAAV,EAAa;EACjC,QAAIc,QAAQ,EAAZ;EACA,QAAIpC,GAAGG,OAAH,CAAWkC,aAAf,EAA8B;EAC5BD,eAASpC,GAAGG,OAAH,CAAWkC,aAApB;EACD;EACD,QAAIf,MAAM,CAAN,IAAWA,IAAI,CAAJ,IAAS,CAAxB,EAA2B;EACzBc,eAASrB,SAAA,CAAU,MAAV,EAAkBO,CAAlB,CAAT;EACD,KAFD,MAEO,IAAIA,IAAI,CAAJ,IAASA,IAAI,CAAjB,EAAoB;EACzBc,eAASrB,SAAA,CAAU,MAAV,EAAkBO,CAAlB,CAAT;EACD,KAFM,MAEA;EACLc,eAASrB,SAAA,CAAU,MAAV,EAAkBO,CAAlB,CAAT;EACD;EACD,QAAItB,GAAGG,OAAH,CAAWmC,YAAf,EAA6B;EAC3BF,eAASpC,GAAGG,OAAH,CAAWmC,YAApB;EACD;EACD,WAAOF,KAAP;EACD,GAhBD;;EAkBA;EACAnC,SAAOa,KAAP,CAAayB,IAAb,GAAoB,UAASC,IAAT,EAAepC,KAAf,EAAsBqC,OAAtB,EAA+B;EACjDD,SAAKE,IAAL,CAAU,YAAY;EACpB,UAAIF,OAAOzB,SAAA,CAAU,IAAV,CAAX;EAAA,UACE4B,QAAQH,KAAKA,IAAL,GAAYI,KAAZ,CAAkB,KAAlB,EAAyBC,OAAzB,EADV;EAAA,UAEEC,IAFF;EAAA,UAGEC,OAAO,EAHT;EAAA,UAIEC,aAAa,CAJf;EAAA,UAKEC,aAAa,GALf;EAAA;EAMEC,UAAIV,KAAKW,IAAL,CAAU,GAAV,CANN;EAAA,UAOEC,KAAKC,WAAWb,KAAKW,IAAL,CAAU,IAAV,CAAX,KAA+B,CAPtC;EAAA,UAQEG,QAAQd,KAAKA,IAAL,CAAU,IAAV,EAAgBe,MAAhB,CAAuB,OAAvB,EAAgCJ,IAAhC,CAAqC,GAArC,EAA0C,CAA1C,EAA6CA,IAA7C,CAAkD,GAAlD,EAAuDD,CAAvD,EAA0DC,IAA1D,CAA+D,IAA/D,EAAqEC,KAAK,IAA1E,CARV;;EAUA,aAAON,OAAOH,MAAMa,GAAN,EAAd,EAA2B;EACzBT,aAAKU,IAAL,CAAUX,IAAV;EACAQ,cAAMd,IAAN,CAAWO,KAAKW,IAAL,CAAU,GAAV,CAAX;EACA,YAAIJ,MAAMK,IAAN,GAAaC,qBAAb,KAAuCxD,KAA3C,EAAkD;EAChD2C,eAAKS,GAAL;EACAF,gBAAMd,IAAN,CAAWO,KAAKW,IAAL,CAAU,GAAV,CAAX;EACAX,iBAAO,CAACD,IAAD,CAAP;EACAQ,kBAAQd,KAAKe,MAAL,CAAY,OAAZ,EAAqBJ,IAArB,CAA0B,GAA1B,EAA+B,CAA/B,EAAkCA,IAAlC,CAAuC,GAAvC,EAA4CD,CAA5C,EAA+CC,IAA/C,CAAoD,IAApD,EAA0D,EAAEH,UAAF,GAAeC,UAAf,GAA4BG,EAA5B,GAAiC,IAA3F,EAAiGZ,IAAjG,CAAsGM,IAAtG,CAAR;;EAEA,cAAIE,aAAa,CAAjB,EAAoB;EAClB,gBAAIL,MAAMkB,MAAN,GAAe,CAAf,IAAoBP,MAAMK,IAAN,GAAaC,qBAAb,KAAuCxD,KAA/D,EAAsE;EAAA;EACpE,oBAAIqC,OAAJ,EAAa;EACXD,uBACGsB,EADH,CACM,WADN,EACmBrB,QAAQsB,IAD3B,EAEGD,EAFH,CAEM,UAFN,EAEkBrB,QAAQuB,IAF1B;EAGD;EACD,oBAAIC,IAAI,CAAR;EACA,uBAAOX,MAAMK,IAAN,GAAaC,qBAAb,KAAuCxD,KAA9C,EAAqD;EACnDkD,wBAAMd,IAAN,CAAW,YAAY;EACrB,2BAAOc,MAAMd,IAAN,GAAa0B,KAAb,CAAmB,CAAnB,EAAsB,CAACD,CAAvB,IAA4B,KAAnC;EACD,mBAFD;EAGA,oBAAEA,CAAF;EACD;EAZmE;EAarE;EACDtB,oBAAQ,EAAR;EACD,WAhBD,MAgBO;EAAA;EACL,kBAAIsB,IAAI,CAAR;EACA,qBAAOX,MAAMK,IAAN,GAAaC,qBAAb,KAAuCxD,KAA9C,EAAqD;EACnDkD,sBAAMd,IAAN,CAAW,YAAY;EACrB,yBAAOc,MAAMd,IAAN,GAAa0B,KAAb,CAAmB,CAAnB,EAAsB,CAACD,CAAvB,IAA4B,KAAnC;EACD,iBAFD;EAGA,kBAAEA,CAAF;EACD;EAPI;EAQN;EACF;EACF;EACF,KA/CD;EAgDD,GAjDD;;EAmDAhE,SAAOa,KAAP,CAAaqD,aAAb,GAA6B,UAAUC,CAAV,EAAaC,CAAb,EAAgB;EAC3C,QAAI,CAACC,OAAOC,KAAP,CAAa,CAACH,CAAd,CAAD,IAAqB,CAACE,OAAOC,KAAP,CAAa,CAACF,CAAd,CAA1B,EAA4C;EAC1C;EACA,aAAOC,OAAOF,CAAP,IAAYE,OAAOD,CAAP,CAAnB;EACD,KAHD,MAGO,IAAI,CAACC,OAAOC,KAAP,CAAa,CAACH,CAAd,CAAD,IAAqBE,OAAOC,KAAP,CAAa,CAACF,CAAd,CAAzB,EAA2C;EAChD,aAAO,CAAC,CAAR;EACD,KAFM,MAEA,IAAIC,OAAOC,KAAP,CAAa,CAACH,CAAd,KAAoB,CAACE,OAAOC,KAAP,CAAa,CAACF,CAAd,CAAzB,EAA2C;EAChD,aAAO,CAAP;EACD,KAFM,MAEA,IAAID,KAAKC,CAAT,EAAY;EACjB,aAAO,CAAC,CAAR;EACD,KAFM,MAEA;EACL,aAAO,CAAP;EACD;EACF,GAbD;;EAeApE,SAAOa,KAAP,CAAa0D,cAAb,GAA8B,UAAUJ,CAAV,EAAaC,CAAb,EAAgB;EAC5C,QAAI,CAACC,OAAOC,KAAP,CAAa,CAACF,CAAd,CAAD,IAAqB,CAACC,OAAOC,KAAP,CAAa,CAACH,CAAd,CAA1B,EAA4C;EAC1C;EACA,aAAOE,OAAOD,CAAP,IAAYC,OAAOF,CAAP,CAAnB;EACD,KAHD,MAGO,IAAI,CAACE,OAAOC,KAAP,CAAa,CAACF,CAAd,CAAD,IAAqBC,OAAOC,KAAP,CAAa,CAACH,CAAd,CAAzB,EAA2C;EAChD,aAAO,CAAC,CAAR;EACD,KAFM,MAEA,IAAIE,OAAOC,KAAP,CAAa,CAACF,CAAd,KAAoB,CAACC,OAAOC,KAAP,CAAa,CAACH,CAAd,CAAzB,EAA2C;EAChD,aAAO,CAAP;EACD,KAFM,MAEA,IAAIC,KAAKD,CAAT,EAAY;EACjB,aAAO,CAAC,CAAR;EACD,KAFM,MAEA;EACL,aAAO,CAAP;EACD;EACF,GAbD;;EAeA,SAAOnE,MAAP;EACD;;ECjPD;;;AAGA,EAAe,gBAAUd,MAAV,EAAkB;;EAE/B,MAAMsF,QAAQ,EAAd;;EAEAA,QAAMC,IAAN,GAAa,UAAUvF,MAAV,EAAkB;EAC7B,QAAMa,KAAK,IAAX;;EAEA,QAAM2E,gBAAgB;EACpBC,YAAM;EACJxE,eAAO,GADH;EAEJE,gBAAQ,GAFJ;EAGJuE,gBAAQ;EACNC,gBAAM,CADA;EAENC,iBAAO,CAFD;EAGNC,eAAK,CAHC;EAINC,kBAAQ;EAJF;EAHJ;EADc,KAAtB;;EAaA,QAAMC,eAAe;EACnBhF,aAAO;EACLiF,yBAAiB;EACfC,iBAAO;EACP;EACA;EAHe;EADZ,OADY;EAQnBC,aAAO;EACLC,mBAAW,SADN;EAELC,kBAAU,MAFL;EAGLC,oBAAY,GAHP;EAILC,mBAAW,QAJN;EAKLC,YAAI;EACFC,mBAAS,IADP;EAEFC,uBAAa,KAFX;EAGFC,uBAAa;EAHX;EALC,OARY;EAmBnBC,cAAQ;EACNC,kBAAU,QADJ;EAENC,gBAAQ,QAFF;EAGNxD,cAAM;EACJ8C,qBAAW,MADP;EAEJC,oBAAU,MAFN;EAGJC,sBAAY;EAHR;EAHA,OAnBW;EA4BnB/C,eAAS;EACP0C,yBAAiB,SADV;EAEPc,iBAAS,GAFF;EAGPzD,cAAM;EACJ8C,qBAAW,MADP;EAEJC,oBAAU,MAFN;EAGJC,sBAAY,GAHR;EAIJC,qBAAW,QAJP;EAKJS,sBAAY,YALR;EAMJjE,mBAAS;EANL,SAHC;EAWPkE,gBAAQ;EACNf,iBAAO,SADD;EAENgB,kBAAQ,KAFF;EAGNhG,iBAAO;EAHD;EAXD,OA5BU;EA6CnBiG,aAAO;EACLV,iBAAS,IADJ;EAELW,cAAM;EACJC,uBAAa,CADT;EAEJC,uBAAa,SAFT;EAGJC,yBAAe,CAHX;EAIJC,uBAAa;EAJT,SAFD;EAQLC,eAAO;EACLJ,uBAAa,CADR;EAELC,uBAAa,SAFR;EAGLI,gBAAM,QAHD;EAILC,sBAAY,MAJP;EAKLZ,mBAAS;EALJ,SARF;EAeLa,gBAAQ;EACNvB,oBAAU,EADJ;EAENC,sBAAY,GAFN;EAGNF,qBAAW,MAHL;EAINyB,sBAAY;EAJN,SAfH;EAqBL1B,eAAO;EACLE,oBAAU,EADL;EAELC,sBAAY,GAFP;EAGLF,qBAAW,MAHN;EAILyB,sBAAY;EACZ;EACA;EANK;EArBF,OA7CY;EA2EnBC,aAAO;EACLrB,iBAAS,IADJ;EAELW,cAAM;EACJC,uBAAa,CADT;EAEJC,uBAAa,SAFT;EAGJC,yBAAe,CAHX;EAIJC,uBAAa;EAJT,SAFD;EAQLC,eAAO;EACLJ,uBAAa,CADR;EAELC,uBAAa;EACb;EAHK,SARF;EAaLM,gBAAQ;EACNvB,oBAAU,EADJ;EAENC,sBAAY,GAFN;EAGNF,qBAAW,MAHL;EAINyB,sBAAY;EAJN,SAbH;EAmBL1B,eAAO;EACLE,oBAAU,EADL;EAELC,sBAAY,GAFP;EAGLF,qBAAW,MAHN;EAILyB,sBAAY;EACZ;EALK;EAnBF;EA3EY,KAArB;;EAwGA/G,OAAGG,OAAH,GAAahB,SAAS8H,aAAA,CAAY9H,MAAZ,CAAT,GAA+BwF,aAA5C;;EAGA3E,OAAGkH,KAAH,GAAW,EAAX;EACAlH,OAAGmH,OAAH,GAAanH,GAAGG,OAAH,CAAWyE,IAAX,CAAgBC,MAA7B;EACA7E,OAAGS,SAAH,GAAetB,OAAOiI,QAAP,GAAkBjI,OAAOiI,QAAzB,GAAoClC,YAAnD;;EAEA;EACAlF,OAAGK,MAAH,GAAYL,GAAGG,OAAH,CAAWyE,IAAX,CAAgBxE,KAAhB,GAAwBJ,GAAGmH,OAAH,CAAWrC,IAAnC,GAA0C9E,GAAGmH,OAAH,CAAWpC,KAAjE;EACA/E,OAAGO,OAAH,GAAaP,GAAGG,OAAH,CAAWyE,IAAX,CAAgBtE,MAAhB,GAAyBN,GAAGmH,OAAH,CAAWnC,GAApC,GAA0ChF,GAAGmH,OAAH,CAAWlC,MAAlE;EACAjF,OAAGa,IAAH,GAAU,EAAV;EACAb,OAAGqH,OAAH,GAAa,EAAb;EACArH,OAAGsH,KAAH,GAAW,EAAX;;EAEA;EACAtH,OAAGuH,MAAH,GAAY,EAAZ;;EAEA;EACAvH,OAAGwH,MAAH,GAAYvH,OAAOwH,IAAP,CAAYzH,EAAZ,GAAZ;EACD,GA3ID;;EA6IA;EACA;EACAyE,QAAMtF,MAAN,GAAe,UAAUA,MAAV,EAAkB;EAC/B,QAAMa,KAAK,IAAX;EACAA,OAAGG,OAAH,GAAa8G,aAAA,CAAY9H,MAAZ,CAAb;EACA,WAAOa,EAAP;EACD,GAJD;;EAMAyE,QAAMG,IAAN,GAAa,UAAU8C,OAAV,EAAmB;EAC9B,QAAM1H,KAAK,IAAX;EACA,QAAI0H,OAAJ,EAAa;EACX,UAAIA,QAAQ7C,MAAZ,EAAoB;EAClB,YAAI6C,QAAQ7C,MAAR,CAAeC,IAAf,IAAuBR,OAAOoD,QAAQ7C,MAAR,CAAeC,IAAtB,CAA3B,EAAwD;EACtD9E,aAAGG,OAAH,CAAWyE,IAAX,CAAgBC,MAAhB,CAAuBC,IAAvB,GAA8B4C,QAAQ7C,MAAR,CAAeC,IAA7C;EACA9E,aAAGmH,OAAH,CAAWrC,IAAX,GAAkB4C,QAAQ7C,MAAR,CAAeC,IAAjC;EACD;EACD,YAAI4C,QAAQ7C,MAAR,CAAeE,KAAf,IAAwBT,OAAOoD,QAAQ7C,MAAR,CAAeE,KAAtB,CAA5B,EAA0D;EACxD/E,aAAGG,OAAH,CAAWyE,IAAX,CAAgBC,MAAhB,CAAuBE,KAAvB,GAA+B2C,QAAQ7C,MAAR,CAAeE,KAA9C;EACA/E,aAAGmH,OAAH,CAAWpC,KAAX,GAAmB2C,QAAQ7C,MAAR,CAAeE,KAAlC;EACD;EACD,YAAI2C,QAAQ7C,MAAR,CAAeG,GAAf,IAAsBV,OAAOoD,QAAQ7C,MAAR,CAAeG,GAAtB,CAA1B,EAAsD;EACpDhF,aAAGG,OAAH,CAAWyE,IAAX,CAAgBC,MAAhB,CAAuBG,GAAvB,GAA6B0C,QAAQ7C,MAAR,CAAeG,GAA5C;EACAhF,aAAGmH,OAAH,CAAWnC,GAAX,GAAiB0C,QAAQ7C,MAAR,CAAeG,GAAhC;EACD;EACD,YAAI0C,QAAQ7C,MAAR,CAAeI,MAAf,IAAyBX,OAAOoD,QAAQ7C,MAAR,CAAeI,MAAtB,CAA7B,EAA4D;EAC1DjF,aAAGG,OAAH,CAAWyE,IAAX,CAAgBC,MAAhB,CAAuBI,MAAvB,GAAgCyC,QAAQ7C,MAAR,CAAeI,MAA/C;EACAjF,aAAGmH,OAAH,CAAWlC,MAAX,GAAoByC,QAAQ7C,MAAR,CAAeI,MAAnC;EACD;EACF;EACD,UAAIyC,QAAQtH,KAAR,IAAiBkE,OAAOoD,QAAQtH,KAAf,CAArB,EAA4C;EAC1CJ,WAAGG,OAAH,CAAWyE,IAAX,CAAgBxE,KAAhB,GAAwBsH,QAAQtH,KAAhC;EACAJ,WAAGK,MAAH,GAAYqH,QAAQtH,KAApB;EACD;EACD,UAAIsH,QAAQpH,MAAR,IAAkBgE,OAAOoD,QAAQpH,MAAf,CAAtB,EAA8C;EAC5CN,WAAGG,OAAH,CAAWyE,IAAX,CAAgBtE,MAAhB,GAAyBoH,QAAQpH,MAAjC;EACAN,WAAGO,OAAH,GAAamH,QAAQpH,MAArB;EACD;EACF;EACD,WAAON,EAAP;EACD,GA/BD;;EAiCAyE,QAAM2C,QAAN,GAAiB,UAAUO,SAAV,EAAqB;EACpC,QAAM3H,KAAK,IAAX;EACA,QAAI2H,SAAJ,EAAe;EACb3H,SAAGS,SAAH,GAAekH,SAAf;EACD;EACD,WAAO3H,EAAP;EACD,GAND;;EAQAyE,QAAMmC,IAAN,GAAa,UAAUgB,IAAV,EAAgB;EAC3B,QAAM5H,KAAK,IAAX;EACAA,OAAGG,OAAH,CAAWyG,IAAX,GAAkBgB,OAAO,IAAP,GAAc,KAAhC;EACA,WAAO5H,EAAP;EACD,GAJD;;EAMAyE,QAAMoD,MAAN,GAAe,UAAUC,QAAV,EAAoB;EACjC,QAAM9H,KAAK,IAAX;EACAA,OAAGG,OAAH,CAAW0H,MAAX,GAAoBC,QAApB;EACA,WAAO9H,EAAP;EACD,GAJD;;EAMAyE,QAAM/E,IAAN,GAAa,UAAUA,IAAV,EAAgB;EAC3B,QAAMM,KAAK,IAAX;EACA,QAAIA,GAAGG,OAAH,CAAWT,IAAX,KAAoBgC,SAAxB,EAAmC;EACjC1B,SAAGG,OAAH,CAAWT,IAAX,GAAkBqI,OAAOC,MAAP,CAAc,EAAd,EAAkBhI,GAAGG,OAAH,CAAWT,IAA7B,EAAmCA,IAAnC,CAAlB;EACD,KAFD,MAEO;EACLM,SAAGG,OAAH,CAAWT,IAAX,GAAkBA,IAAlB;EACD;EACD,WAAOM,EAAP;EACD,GARD;;EAUAyE,QAAMqB,MAAN,GAAe,UAAUA,MAAV,EAAkB;EAC/B,QAAM9F,KAAK,IAAX;EACAA,OAAGG,OAAH,CAAW2F,MAAX,GAAoBA,MAApB;EACA,WAAO9F,EAAP;EACD,GAJD;;EAMAyE,QAAMwD,UAAN,GAAmB,UAAUA,UAAV,EAAsB;EACvC,QAAMjI,KAAK,IAAX;EACAA,OAAGG,OAAH,CAAW8H,UAAX,GAAwBA,UAAxB;EACA,WAAOjI,EAAP;EACD,GAJD;;EAMAyE,QAAMyD,WAAN,GAAoB,UAAUA,WAAV,EAAuB;EACzC,QAAMlI,KAAK,IAAX;EACAA,OAAGG,OAAH,CAAW+H,WAAX,GAAyBA,WAAzB;EACA,WAAOlI,EAAP;EACD,GAJD;;EAMAyE,QAAM0D,KAAN,GAAc,UAAUC,MAAV,EAAkBjI,OAAlB,EAA2B;EACvC,QAAMH,KAAK,IAAX;EACA,QAAImI,KAAJ;EACA,QAAIhJ,SAASgB,UAAUA,OAAV,GAAoBH,GAAGG,OAApC;EACA,QAAIiI,WAAW1G,SAAX,IAAwB0G,WAAW,IAAvC,EAA6C;EAC3C;EACD,KAFD,MAEO;EACLD,cAAQC,OAAOjJ,MAAP,EAAea,GAAGwH,MAAlB,CAAR;EACAxH,SAAGuH,MAAH,CAAU9D,IAAV,CAAe0E,KAAf;EACA,aAAOA,KAAP;EACD;EACF,GAXD;;EAaA1D,QAAM4D,QAAN,GAAiB,UAAUC,UAAV,EAAsB;EACrC,QAAMtI,KAAK,IAAX;EACA,WAAOA,GAAGuH,MAAH,CAAUe,UAAV,CAAP;EACD,GAHD;;EAKA7D,QAAM8D,IAAN,GAAa,YAAY;EACvB,QAAMvI,KAAK,IAAX;EACA,QAAIwI,UAAJ;;EAEAxI,OAAGqH,OAAH,GAAarH,GAAGyI,MAAH,EAAb;EACA;;EAEAD,QAAIxI,GAAG0I,QAAH,EAAJ;;EAEAF,MAAEG,QAAF,CAAW,UAAC5I,KAAD,EAAQ6I,OAAR,EAAoB;EAC7B,UAAI7I,KAAJ,EAAW;EACT,cAAMA,KAAN;EACD;;EAED,UAAI8B,MAAMC,OAAN,CAAc8G,OAAd,KAA0BA,QAAQ/E,MAAR,IAAkB,CAAhD,EAAmD;EACjD7D,WAAGkH,KAAH,GAAW0B,QAAQ,CAAR,CAAX;EACD,OAFD,MAEO;EACL5I,WAAGkH,KAAH,GAAW0B,OAAX;EACD;;EAED5I,SAAG6I,UAAH;EACA7I,SAAG8I,OAAH;;EAEA;EACA9I,SAAGsH,KAAH,GAAWtH,GAAG+I,IAAH,EAAX;EACA/I,SAAGgJ,QAAH;;EAEA;EACAhJ,SAAGiJ,UAAH;;EAEA;EACA,UAAIjJ,GAAGG,OAAH,CAAW+I,MAAX,IAAqBlJ,GAAGG,OAAH,CAAW+I,MAAX,CAAkBC,IAA3C,EAAiD;EAC/CnJ,WAAGoJ,QAAH,CAAYtF,EAAZ,CAAe,YAAf,EAA6B9D,GAAGG,OAAH,CAAW+I,MAAX,CAAkBC,IAAlB,CAAuBnJ,EAAvB,CAA7B;EACD;EAGF,KA3BD;EA4BA,WAAOA,EAAP;EACD,GAtCD;;EAwCAyE,QAAM2C,QAAN,GAAiB,UAAUiC,KAAV,EAAiB;EAChC,QAAMrJ,KAAK,IAAX;EACAA,OAAGS,SAAH,GAAe4I,KAAf;EACA,WAAOrJ,EAAP;EACD,GAJD;;EAMA;EACA;EACAyE,QAAMgE,MAAN,GAAe,YAAY;EACzB,QAAMzI,KAAK,IAAX;;EAEA,QAAIyI,SAAS,EAAb;EACA;EACA,QAAIzI,GAAGG,OAAH,CAAW6G,KAAX,IAAoBhH,GAAGG,OAAH,CAAW6G,KAAX,CAAiB9F,KAAzC,EAAgD;EAC9C,cAAQlB,GAAGG,OAAH,CAAW6G,KAAX,CAAiB9F,KAAzB;EACA,aAAK,QAAL;EACEuH,iBAAOa,CAAP,GAAWvI,cAAA,GACNK,KADM,CACA,CAAC,CAAD,EAAIpB,GAAGK,MAAP,CADA,CAAX;EAEA;;EAEF,aAAK,MAAL;EACEoI,iBAAOa,CAAP,GAAWvI,YAAA,GACRK,KADQ,CACF,CAAC,CAAD,EAAIpB,GAAGK,MAAP,CADE,CAAX;EAEA;;EAEF,aAAK,SAAL;EACEoI,iBAAOa,CAAP,GAAWvI,eAAA,GACRK,KADQ,CACF,CAAC,CAAD,EAAIpB,GAAGK,MAAP,CADE,EACc,GADd,CAAX;EAEA;;EAEF,aAAK,MAAL;EACEoI,iBAAOa,CAAP,GAAWvI,YAAA,GACRgB,UADQ,CACG,CAAC,CAAD,EAAI/B,GAAGK,MAAP,CADH,EAER4B,OAFQ,CAEA,GAFA,CAAX;EAGA;;EAEF,aAAK,UAAL;EACEwG,iBAAOa,CAAP,GAAWvI,eAAA,GACRK,KADQ,CACF,CAAC,CAAD,EAAIpB,GAAGK,MAAP,CADE,EACc,GADd,CAAX;;EAGAoI,iBAAOD,CAAP,GAAWzH,gBAAA,GACRK,KADQ,CACFL,QAAA,CAASf,GAAGG,OAAH,CAAW6G,KAAX,CAAiBuC,OAA1B,CADE,CAAX;EAEA;;EAEF;EACEd,iBAAOa,CAAP,GAAWvI,cAAA,GACRK,KADQ,CACF,CAAC,CAAD,EAAIpB,GAAGK,MAAP,CADE,CAAX;EAEA;EAjCF;EAmCD,KApCD,MAoCO;EACLoI,aAAOa,CAAP,GAAWvI,cAAA,GACRK,KADQ,CACF,CAAC,CAAD,EAAIpB,GAAGK,MAAP,CADE,CAAX;EAED;;EAED;EACA,QAAIL,GAAGG,OAAH,CAAWkG,KAAX,IAAoBrG,GAAGG,OAAH,CAAWkG,KAAX,CAAiBnF,KAAzC,EAAgD;EAC9C,cAAQlB,GAAGG,OAAH,CAAWkG,KAAX,CAAiBnF,KAAzB;EACA,aAAK,QAAL;EACEuH,iBAAOvF,CAAP,GAAWnC,cAAA,GACRK,KADQ,CACF,CAACpB,GAAGO,OAAJ,EAAa,CAAb,CADE,CAAX;EAEA;;EAEF,aAAK,MAAL;EACEkI,iBAAOvF,CAAP,GAAWnC,YAAA,GACRK,KADQ,CACF,CAACpB,GAAGO,OAAJ,EAAa,CAAb,CADE,CAAX;EAEA;;EAEF,aAAK,SAAL;EACEkI,iBAAOvF,CAAP,GAAWnC,eAAA,GACRK,KADQ,CACF,CAACpB,GAAGO,OAAJ,EAAa,CAAb,CADE,EACe,GADf,CAAX;EAEA;;EAEF,aAAK,MAAL;EACEkI,iBAAOvF,CAAP,GAAWnC,YAAA,GACRgB,UADQ,CACG,CAAC/B,GAAGO,OAAJ,EAAa,CAAb,CADH,EAER0B,OAFQ,CAEA,GAFA,CAAX;EAGA;;EAEF,aAAK,UAAL;EACEwG,iBAAOvF,CAAP,GAAWnC,eAAA,GACRK,KADQ,CACF,CAAC,CAAD,EAAIpB,GAAGK,MAAP,CADE,EACc,GADd,CAAX;;EAGAoI,iBAAOD,CAAP,GAAWzH,gBAAA,GACRK,KADQ,CACFL,QAAA,CAASf,GAAGG,OAAH,CAAWkG,KAAX,CAAiBkD,OAA1B,CADE,CAAX;EAEA;;EAEF;EACEd,iBAAOvF,CAAP,GAAWnC,cAAA,GACRK,KADQ,CACF,CAACpB,GAAGO,OAAJ,EAAa,CAAb,CADE,CAAX;EAEA;EAjCF;EAmCD,KApCD,MAoCO;EACLkI,aAAOvF,CAAP,GAAWnC,cAAA,GACRK,KADQ,CACF,CAACpB,GAAGO,OAAJ,EAAa,CAAb,CADE,CAAX;EAED;;EAGDkI,WAAOrD,KAAP,GAAerE,eAAA,CAAgBA,mBAAhB,CAAf;;EAEA,WAAO0H,MAAP;EACD,GA5FD;;EA8FAhE,QAAM+E,SAAN,GAAkB,YAAY,EAA9B;;EAIA/E,QAAMsE,IAAN,GAAa,YAAY;EACvB,QAAM/I,KAAK,IAAX;EAAA,QACE+I,OAAO,EADT;EAEAA,SAAKO,CAAL,GAASvI,aAAA,CAAcf,GAAGqH,OAAH,CAAWiC,CAAzB,CAAT;EACAP,SAAK7F,CAAL,GAASnC,WAAA,CAAYf,GAAGqH,OAAH,CAAWnE,CAAvB,CAAT;;EAEA;EACA6F,SAAKO,CAAL,CAAOG,aAAP,CAAqB,CAArB;EACAV,SAAK7F,CAAL,CAAOuG,aAAP,CAAqB,CAArB;;EAEA;EACA,QAAIzJ,GAAGG,OAAH,CAAW6G,KAAX,IAAoBhH,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAArC,IACF3G,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAAjB,CAAuBhB,OAAvB,KAAmC,IADjC,IACyC3F,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAAjB,CAAuBnG,KADpE,EAC2E;;EAEzE,cAAQR,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAAjB,CAAuBnG,KAA/B;EACA,aAAK,cAAL;EACEuI,eAAKO,CAAL,CACGI,QADH,CACY,CAAC1J,GAAGO,OADhB,EACyB,CADzB;EAEA;EACF,aAAK,UAAL;EACEwI,eAAKO,CAAL,CACGI,QADH,CACY,CAAC1J,GAAGK,MADhB,EACwB,CADxB;EAEA;EARF;EAUD;EACD;EACA,QAAIL,GAAGS,SAAH,CAAauG,KAAb,CAAmBL,KAAnB,CAAyBC,IAA7B,EAAmC;EACjC,cAAQ5G,GAAGS,SAAH,CAAauG,KAAb,CAAmBL,KAAnB,CAAyBC,IAAjC;EACA,aAAK,UAAL;EACEmC,eAAK7F,CAAL,CACGwG,QADH,CACY,CAAC1J,GAAGK,MADhB,EACwB,CADxB;EAEA;EACF,aAAK,QAAL;EACE0I,eAAK7F,CAAL,CACGwG,QADH,CACY,CAAC1J,GAAGK,MADhB,EACwB,CADxB;EAEA;EARF;EAUD;;EAED,QAAIL,GAAGG,OAAH,CAAW6G,KAAX,IAAoBhH,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAArC,IAA8C3G,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAAjB,CAAuBgD,MAAzE,EAAiF;EAC/EZ,WAAKO,CAAL,CAAOM,UAAP,CAAkB5J,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAAjB,CAAuBgD,MAAzC;EACD;;EAED,QAAI3J,GAAGG,OAAH,CAAW6G,KAAX,IAAoBhH,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAArC,IAA8C3G,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAAjB,CAAuBxE,MAAzE,EAAiF;EAC/E4G,WAAKO,CAAL,CAAOO,UAAP,CAAkB7J,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAAjB,CAAuBxE,MAAzC;EACD;;EAED;EACA,QAAInC,GAAGG,OAAH,CAAWkG,KAAX,IAAoBrG,GAAGG,OAAH,CAAWkG,KAAX,CAAiBM,KAArC,IACF3G,GAAGG,OAAH,CAAWkG,KAAX,CAAiBM,KAAjB,CAAuBhB,OAAvB,KAAmC,IADjC,IACyC3F,GAAGG,OAAH,CAAWkG,KAAX,CAAiBM,KAAjB,CAAuBnG,KADpE,EAC2E;;EAEzE,cAAQR,GAAGG,OAAH,CAAWkG,KAAX,CAAiBM,KAAjB,CAAuBnG,KAA/B;EACA,aAAK,cAAL;EACEuI,eAAK7F,CAAL,CACGwG,QADH,CACY,CAAC1J,GAAGK,MADhB,EACwB,CADxB;EAEA;EACF,aAAK,UAAL;EACE0I,eAAK7F,CAAL,CACGwG,QADH,CACY,CAAC1J,GAAGK,MADhB,EACwB,CADxB;EAEA;EARF;EAUD;EACD;EACA,QAAIL,GAAGS,SAAH,CAAa4F,KAAb,CAAmBM,KAAnB,CAAyBC,IAA7B,EAAmC;EACjC,cAAQ5G,GAAGS,SAAH,CAAa4F,KAAb,CAAmBM,KAAnB,CAAyBC,IAAjC;EACA,aAAK,UAAL;EACEmC,eAAK7F,CAAL,CACGwG,QADH,CACY,CAAC1J,GAAGK,MADhB,EACwB,CADxB;EAEA;EACF,aAAK,QAAL;EACE0I,eAAK7F,CAAL,CACGwG,QADH,CACY,CAAC1J,GAAGK,MADhB,EACwB,CADxB;EAEA;EARF;EAUD;;EAED,QAAIL,GAAGG,OAAH,CAAWkG,KAAX,IAAoBrG,GAAGG,OAAH,CAAWkG,KAAX,CAAiBM,KAArC,IAA8C3G,GAAGG,OAAH,CAAWkG,KAAX,CAAiBM,KAAjB,CAAuBxE,MAAzE,EAAiF;EAC/E4G,WAAK7F,CAAL,CAAO2G,UAAP,CAAkB7J,GAAGG,OAAH,CAAWkG,KAAX,CAAiBM,KAAjB,CAAuBxE,MAAzC;EACD;EACD,WAAO4G,IAAP;EACD,GAhFD;;EAkFAtE,QAAMiE,QAAN,GAAiB,YAAY;EAC3B,QAAM1I,KAAK,IAAX;EACA,QAAIwI,CAAJ;;EAEA,QAAIxI,GAAGG,OAAH,CAAWT,IAAX,CAAgBoK,GAApB,EAAyB;EACvBtB,UAAIzH,QAAA,GACDgJ,KADC,CACKhJ,MADL,EACaf,GAAGG,OAAH,CAAWT,IAAX,CAAgBoK,GAD7B,CAAJ;EAED;;EAED,QAAI9J,GAAGG,OAAH,CAAWT,IAAX,CAAgBsK,IAApB,EAA0B;EACxBxB,UAAIzH,QAAA,GACDgJ,KADC,CACKhJ,OADL,EACcf,GAAGG,OAAH,CAAWT,IAAX,CAAgBsK,IAD9B,CAAJ;EAED;;EAED,QAAIhK,GAAGG,OAAH,CAAWT,IAAX,CAAgBuK,GAApB,EAAyB;EACvBzB,UAAIzH,QAAA,GACDgJ,KADC,CACKhJ,MADL,EACaf,GAAGG,OAAH,CAAWT,IAAX,CAAgBuK,GAD7B,CAAJ;EAED;;EAED,QAAIjK,GAAGG,OAAH,CAAWT,IAAX,CAAgBwK,GAApB,EAAyB;EACvB1B,UAAIzH,QAAA,GACDgJ,KADC,CACK/J,GAAGmK,OADR,EACiBnK,GAAGG,OAAH,CAAWT,IAAX,CAAgBwK,GADjC,CAAJ;EAED;;EAED,QAAIlK,GAAGG,OAAH,CAAWT,IAAX,CAAgBJ,OAApB,EAA6B;EAC3BkJ,UAAIzH,QAAA,GACDgJ,KADC,CACK9K,MAAMC,KADX,EACkBc,GAAGG,OAAH,CAAWT,IAD7B,CAAJ;EAED;;EAED,QAAIM,GAAGG,OAAH,CAAWL,GAAX,IAAkBE,GAAGG,OAAH,CAAWL,GAAX,CAAesK,QAAjC,IAA6CpK,GAAGG,OAAH,CAAWL,GAAX,CAAesK,QAAf,CAAwBC,GAAzE,EAA8E;EAC5E7B,QAAEuB,KAAF,CAAQhJ,OAAR,EAAiBf,GAAGG,OAAH,CAAWL,GAAX,CAAesK,QAAf,CAAwBC,GAAzC;EACD;;EAED,QAAIrK,GAAGG,OAAH,CAAWmK,WAAX,IAA0BtK,GAAGG,OAAH,CAAWmK,WAAX,CAAuBC,IAAjD,IACFvK,GAAGG,OAAH,CAAWmK,WAAX,CAAuBC,IAAvB,CAA4BC,YAD1B,IAC0C3I,MAAMC,OAAN,CAAc9B,GAAGG,OAAH,CAAWmK,WAAX,CAAuBC,IAAvB,CAA4BC,YAA1C,CAD1C,IAEFxK,GAAGG,OAAH,CAAWmK,WAAX,CAAuBC,IAAvB,CAA4BC,YAA5B,CAAyC3G,MAAzC,GAAkD,CAFpD,EAEuD;;EAErD7D,SAAGG,OAAH,CAAWmK,WAAX,CAAuBC,IAAvB,CAA4BC,YAA5B,CAAyCC,OAAzC,CAAiD,UAAUC,CAAV,EAAa;EAC5D,YAAIA,EAAEhL,IAAF,CAAOJ,OAAX,EAAoB;EAClBkJ,YAAEuB,KAAF,CAAQ9K,MAAMC,KAAd,EAAqBwL,EAAEhL,IAAvB;EACD;EACF,OAJD;EAKD;;EAED,WAAO8I,CAAP;EACD,GA7CD;;EA+CA/D,QAAMoE,UAAN,GAAmB,YAAY;EAC7B,QAAM7I,KAAK,IAAX;EACAA,OAAGuH,MAAH,CAAUkD,OAAV,CAAkB,UAAUE,EAAV,EAAc;EAC9BA,SAAGjL,IAAH,CAAQM,GAAGkH,KAAX,EACGuB,MADH;;EAGA;EACAzI,SAAGqH,OAAH,GAAasD,GAAGtD,OAAhB;EACD,KAND;EAOD,GATD;;EAYA5C,QAAMqE,OAAN,GAAgB,YAAY;EAC1B,QAAM9I,KAAK,IAAX;;EAEA;EACAe,aAAA,CAAUf,GAAGG,OAAH,CAAW0H,MAArB,EAA6B+C,MAA7B,CAAoC,KAApC,EAA2CC,MAA3C;EACA9J,aAAA,CAAUf,GAAGG,OAAH,CAAW0H,MAArB,EAA6BiD,IAA7B,CAAkC,EAAlC;;EAEA;EACA,QAAI9K,GAAGG,OAAH,CAAW4K,QAAf,EAAyB;EACvBhK,eAAA,CAAUf,GAAGG,OAAH,CAAW0H,MAArB,EAA6BmD,OAA7B,CAAqChL,GAAGG,OAAH,CAAW4K,QAAhD,EAA0D,IAA1D;EACD;;EAED;EACA,QAAI/K,GAAGG,OAAH,IAAcH,GAAGG,OAAH,CAAWkF,KAA7B,EAAoC;EAClCtE,eAAA,CAAUf,GAAGG,OAAH,CAAW0H,MAArB,EAA6BtE,MAA7B,CAAoC,KAApC,EACGJ,IADH,CACQ,OADR,EACiB,aADjB,EAEG2H,IAFH,CAEQ9K,GAAGG,OAAH,CAAWkF,KAFnB,EAGG7E,KAHH,CAGS,SAHT,EAGoB,MAHpB,EAIGA,KAJH,CAIS,iBAJT,EAI4B,QAJ5B,EAKGA,KALH,CAKS,aALT,EAKwB,QALxB,EAMGA,KANH,CAMS,WANT,EAMsBR,GAAGS,SAAH,CAAa4E,KAAb,CAAmBE,QANzC,EAOG/E,KAPH,CAOS,aAPT,EAOwBR,GAAGS,SAAH,CAAa4E,KAAb,CAAmBG,UAP3C,EAQGhF,KARH,CAQS,OART,EAQkBR,GAAGS,SAAH,CAAa4E,KAAb,CAAmBC,SARrC,EASG9E,KATH,CASS,YATT,EASuBR,GAAGS,SAAH,CAAa4E,KAAb,CAAmBI,SAT1C;;EAWA,UAAIzF,GAAGS,SAAH,CAAa4E,KAAb,CAAmBK,EAAnB,CAAsBC,OAA1B,EAAmC;EACjC5E,iBAAA,CAAUf,GAAGG,OAAH,CAAW0H,MAArB,EAA6BtE,MAA7B,CAAoC,IAApC,EACGJ,IADH,CACQ,OADR,EACiB,UADjB,EAEG3C,KAFH,CAES,OAFT,EAEkB,KAFlB,EAGGA,KAHH,CAGS,aAHT,EAGwB,KAHxB,EAIGA,KAJH,CAIS,YAJT,EAIuB,OAJvB,EAKGA,KALH,CAKS,cALT,EAKyBR,GAAGS,SAAH,CAAa4E,KAAb,CAAmBK,EAAnB,CAAsBE,WAL/C,EAMGpF,KANH,CAMS,cANT,EAMyBR,GAAGS,SAAH,CAAa4E,KAAb,CAAmBK,EAAnB,CAAsBG,WAN/C;EAOD;EACF;;EAED;EACA;EACA;EACA,QAAI7F,GAAGG,OAAH,CAAW2F,MAAX,IAAqB9F,GAAGG,OAAH,CAAW2F,MAAX,CAAkBH,OAAlB,KAA8B,IAAnD,IAA2D3F,GAAGG,OAAH,CAAW2F,MAAX,CAAkBC,QAAlB,KAA+B,KAA9F,EAAqG;EACnG,UAAID,SAAS/E,SAAA,CAAUf,GAAGG,OAAH,CAAW0H,MAArB,EAA6BtE,MAA7B,CAAoC,KAApC,EACVJ,IADU,CACL,OADK,EACI,kBADJ,CAAb;;EAGA,UAAI2H,OAAO,EAAX;EACAA,cAAQ,wFAAR;EACA9K,SAAGG,OAAH,CAAW2F,MAAX,CAAkBmF,UAAlB,CAA6BR,OAA7B,CAAqC,UAAUS,CAAV,EAAa;EAChDJ,gBAAQ,qIAAqII,EAAE9F,KAAvI,GAA+I,iGAA/I,GAAmP8F,EAAE7F,KAArP,GAA6P,eAArQ;EACD,OAFD;EAGAyF,cAAQ,QAAR;EACAhF,aAAOgF,IAAP,CAAYA,IAAZ;EACD;;EAGD;EACA9K,OAAGW,QAAH,GAAcI,SAAA,CAAUf,GAAGG,OAAH,CAAW0H,MAArB,EAA6BtE,MAA7B,CAAoC,KAApC,EACX/C,KADW,CACL,WADK,EACQR,GAAGG,OAAH,CAAWD,KAAX,GAAmBF,GAAGG,OAAH,CAAWD,KAAX,CAAiB,WAAjB,IAAgCF,GAAGG,OAAH,CAAWD,KAAX,CAAiB,WAAjB,CAAhC,GAAgE,MAAnF,GAA4F,MADpG,EAEXiD,IAFW,CAEN,OAFM,EAEGnD,GAAGK,MAAH,GAAYL,GAAGmH,OAAH,CAAWrC,IAAvB,GAA8B9E,GAAGmH,OAAH,CAAWpC,KAF5C,EAGX5B,IAHW,CAGN,QAHM,EAGInD,GAAGO,OAAH,GAAaP,GAAGmH,OAAH,CAAWnC,GAAxB,GAA8BhF,GAAGmH,OAAH,CAAWlC,MAH7C,CAAd;;EAKAjF,OAAGa,IAAH,GAAUb,GAAGW,QAAH,CACP4C,MADO,CACA,GADA,EAEPJ,IAFO,CAEF,WAFE,EAEW,eAAenD,GAAGmH,OAAH,CAAWrC,IAA1B,GAAiC,GAAjC,GAAuC9E,GAAGmH,OAAH,CAAWnC,GAAlD,GAAwD,GAFnE,CAAV;;EAKA;EACA;;;;EAIA;;EAEAjE,aAAA,CAAUf,GAAGG,OAAH,CAAW0H,MAAX,GAAoB,MAA9B,EAAsCrH,KAAtC,CAA4C,kBAA5C,EAAgER,GAAGS,SAAH,CAAaP,KAAb,CAAmBiF,eAAnB,CAAmCC,KAAnG;;EAIA;EACA;;;;;;;;;;;;;;EAeA,QAAIpF,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,QAA1B,CAAJ,EAAyC;EACvCnL,SAAGoL,UAAH;EACD;EACF,GA9FD;;EAgGA3G,QAAMwE,UAAN,GAAmB,YAAY;EAC7B,QAAMjJ,KAAK,IAAX;EACAA,OAAGuH,MAAH,CAAUkD,OAAV,CAAkB,UAAUE,EAAV,EAAc;EAC9BA,SAAGpC,IAAH;EACD,KAFD;EAGD,GALD;;EAOA9D,QAAM2G,UAAN,GAAmB,YAAY;EAC7B,QAAMpL,KAAK,IAAX;;EAEA,QAAMqL,YAAYrL,GAAGwH,MAAH,CAAU1G,KAAV,CAAgBC,EAAhB,CAAmBC,GAAnB,GAAyB8J,IAAzB,CAA8B,aAAK;EACnD,aAAO,6BAA6BxJ,EAAEgK,IAAF,IAAUhK,CAAvC,IAA4C,QAAnD;EACD,KAFiB,CAAlB;EAGAtB,OAAGW,QAAH,CAAY4K,IAAZ,CAAiBF,SAAjB;EACA,QAAIG,SAAJ;EACA;EACA,QAAIxL,GAAGG,OAAH,CAAWsL,MAAX,IAAqBzL,GAAGS,SAAH,CAAaqF,MAAb,CAAoBC,QAApB,KAAiC,QAA1D,EAAoE;EAClEyF,kBAAYxL,GAAGW,QAAH,CAAY4C,MAAZ,CAAmB,GAAnB,EACTJ,IADS,CACJ,OADI,EACK,WADL,EAETA,IAFS,CAEJ,OAFI,EAEKnD,GAAGK,MAFR,EAGT8C,IAHS,CAGJ,WAHI,EAGS,eAAenD,GAAGG,OAAH,CAAWyE,IAAX,CAAgBC,MAAhB,CAAuBC,IAAtC,GAA6C,GAA7C,IAAoD9E,GAAGG,OAAH,CAAWyE,IAAX,CAAgBtE,MAAhB,GAAyB,EAA7E,IACjB,GAJQ,CAAZ;EAKD,KAND,MAMO;EACLkL,kBAAYxL,GAAGW,QAAH,CAAY4C,MAAZ,CAAmB,GAAnB,EACTJ,IADS,CACJ,OADI,EACK,WADL,EAETA,IAFS,CAEJ,WAFI,EAES,gBAAgBnD,GAAGG,OAAH,CAAWyE,IAAX,CAAgBxE,KAAhB,GAAwBJ,GAAGG,OAAH,CAAWyE,IAAX,CAAgBC,MAAhB,CAAuBE,KAA/C,GAAuD,CAAvE,IAA4E,GAA5E,GAAkF,IAAI,EAAtF,GAA2F,GAFpG,CAAZ;EAGD;;EAED,QAAI/E,GAAGG,OAAH,CAAW+H,WAAf,EAA4B;EAC1BsD,gBAAUjI,MAAV,CAAiB,MAAjB,EACGJ,IADH,CACQ,OADR,EACiB,cADjB,EAEGX,IAFH,CAEQxC,GAAGG,OAAH,CAAW+H,WAFnB;;EAIA;EACA,UAAIwD,SAAS1L,GAAGG,OAAH,CAAWyE,IAAX,CAAgBC,MAAhB,CAAuBE,KAApC;EACA,UAAIvC,OAAOzB,YAAA,CAAa,eAAb,CAAX;EAAA,UACE4B,QAAQH,KAAKA,IAAL,GAAYI,KAAZ,CAAkB,KAAlB,EAAyBC,OAAzB,EADV;EAAA,UAEEC,IAFF;EAAA,UAGEC,OAAO,EAHT;EAAA,UAIEC,aAAa,CAJf;EAAA,UAKEC,aAAa,GALf;EAAA;EAMEC,UAAIV,KAAKW,IAAL,CAAU,GAAV,CANN;EAAA,UAOEC,KAAK,CAPP;EAAA,UAQEE,QAAQd,KAAKA,IAAL,CAAU,IAAV,EAAgBe,MAAhB,CAAuB,OAAvB,EAAgCJ,IAAhC,CAAqC,GAArC,EAA0C,CAA1C,EAA6CA,IAA7C,CAAkD,GAAlD,EAAuDD,CAAvD,EAA0DC,IAA1D,CAA+D,IAA/D,EAAqEC,KAAK,IAA1E,CARV;EASA,aAAON,OAAOH,MAAMa,GAAN,EAAd,EAA2B;EACzBT,aAAKU,IAAL,CAAUX,IAAV;EACAQ,cAAMd,IAAN,CAAWO,KAAKW,IAAL,CAAU,GAAV,CAAX;EACA,YAAIJ,MAAMK,IAAN,GAAaC,qBAAb,KAAuC8H,MAA3C,EAAmD;EACjD3I,eAAKS,GAAL;EACAF,gBAAMd,IAAN,CAAWO,KAAKW,IAAL,CAAU,GAAV,CAAX;EACAX,iBAAO,CAACD,IAAD,CAAP;EACA,YAAEE,UAAF;EACAM,kBAAQd,KAAKe,MAAL,CAAY,OAAZ,EAAqBJ,IAArB,CAA0B,GAA1B,EAA+B,CAA/B,EAAkCA,IAAlC,CAAuC,GAAvC,EAA4CD,CAA5C,EAA+CC,IAA/C,CAAoD,IAApD,EAA0DF,aAAa,IAAvE,EAA6ET,IAA7E,CAAkFM,IAAlF,CAAR;EACD;EACF;EACF;;EAED,QAAI6I,UAAU3L,GAAGG,OAAH,CAAWyE,IAAX,CAAgBC,MAAhB,CAAuBE,KAAvB,GAA+B,GAA7C;;EAEA,QAAI/E,GAAGG,OAAH,CAAW8H,UAAX,KAA0B,UAA9B,EAA0C;EACxC,UAAIrD,OAAO,EAAX;EAAA,UACE0E,IAAI,CADN;EAAA,UAEEpG,KAAI,CAFN;EAAA,UAGE0I,KAAK,CAHP;EAAA,UAIEC,KAAK,CAJP;EAAA,UAKEC,kBAAkB,CALpB;;EAOA9L,SAAGqH,OAAH,CAAWjC,KAAX,CAAiBpD,MAAjB,CAAwBhC,GAAGG,OAAH,CAAW2F,MAAX,CAAkBhG,GAAlB,CAAsB;EAAA,eAAKiM,EAAET,IAAP;EAAA,OAAtB,CAAxB;;EAEA,UAAIU,cAAcR,UAAUS,SAAV,CAAoB,kBAApB,EACfvM,IADe,CACVM,GAAGG,OAAH,CAAW2F,MADD,EAEfoG,KAFe,GAEP3I,MAFO,CAEA,GAFA,EAGfJ,IAHe,CAGV,OAHU,EAGD,yBAHC,EAIfA,IAJe,CAIV,WAJU,EAIG,UAAU7B,CAAV,EAAa2C,CAAb,EAAgB;EACjC,eAAO,iBAAiB,CAACjE,GAAGG,OAAH,CAAW+H,WAAX,IAA0BlF,aAAa,CAAvC,GAA2CA,aAAaC,UAAb,GAA0BgB,CAArE,GAAyE,IAAIA,CAA9E,IAAmF,EAApG,GAAyG,GAAhH;EACD,OANe,EAOfH,EAPe,CAOZ,OAPY,EAOH,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC3B;EACA,YAAI,OAAOjE,GAAGG,OAAH,CAAW+I,MAAX,CAAkBiD,aAAzB,KAA2C,UAA/C,EAA2D;EACzDnM,aAAGG,OAAH,CAAW+I,MAAX,CAAkBiD,aAAlB,CAAgCZ,IAAhC,CAAqC,IAArC,EAA2CjK,CAA3C,EAA8C2C,CAA9C;EACD;EACDlD,gBAAA,CAASqL,eAAT;EACD,OAbe,CAAlB;;EAeAJ,kBAAYzI,MAAZ,CAAmB,MAAnB,EACGJ,IADH,CACQ,OADR,EACiByB,IADjB,EAEGzB,IAFH,CAEQ,QAFR,EAEkByB,IAFlB,EAGGzB,IAHH,CAGQ,GAHR,EAGamG,CAHb,EAIGnG,IAJH,CAIQ,IAJR,EAIcyI,EAJd,EAKGzI,IALH,CAKQ,IALR,EAKc0I,EALd,EAMG1I,IANH,CAMQ,cANR,EAMwB,CANxB,EAOGA,IAPH,CAOQ,MAPR,EAOgB,UAAU7B,CAAV,EAAa;EACzB,eAAOtB,GAAGqH,OAAH,CAAWjC,KAAX,CAAiB9D,EAAEgK,IAAnB,CAAP;EACD,OATH;;EAYA,UAAIe,cAAc,CAChB;EACE/C,WAAGA,IAAK1E,OAAO,CADjB;EAEE1B,WAAGA,KAAK0B,OAAO;EAFjB,OADgB,EAKhB;EACE0E,WAAGA,IAAK1E,OAAO,GADjB;EAEE1B,WAAIA,KAAI0B,IAAL,GAAcA,OAAO;EAF1B,OALgB,EAShB;EACE0E,WAAIA,IAAI1E,IAAL,GAAcA,OAAO,CAD1B;EAEE1B,WAAIA,KAAK0B,OAAO;EAFlB,OATgB,CAAlB;;EAeA,UAAI7B,QAAOhC,OAAA,GACRuI,CADQ,CACN,UAAUhI,CAAV,EAAa;EACd,eAAOA,EAAEgI,CAAT;EACD,OAHQ,EAIRpG,CAJQ,CAIN,UAAU5B,CAAV,EAAa;EACd,eAAOA,EAAE4B,CAAT;EACD,OANQ,CAAX;;EAQA;EACA8I,kBAAYzI,MAAZ,CAAmB,MAAnB,EACGJ,IADH,CACQ,GADR,EACaJ,MAAKsJ,WAAL,CADb,EAEGlJ,IAFH,CAEQ,cAFR,EAEwB2I,eAFxB,EAGG3I,IAHH,CAGQ,QAHR,EAGkB,OAHlB,EAIGA,IAJH,CAIQ,MAJR,EAIgB,MAJhB,EAKGA,IALH,CAKQ,OALR,EAKiB,MALjB,EAMGmJ,QANH,CAMY,SANZ,EAMuB,UAAUhL,CAAV,EAAa;EAChC;EACA,eAAOA,EAAEiL,MAAT;EACD,OATH,EAUGpJ,IAVH,CAUQ,SAVR,EAUmB,YAAY;EAC3B,YAAIpC,SAAA,CAAU,IAAV,EAAgBuL,QAAhB,CAAyB,SAAzB,CAAJ,EAAyC;EACvC,iBAAO,CAAP;EACD,SAFD,MAEO;EACL,iBAAO,CAAP;EACD;EACF,OAhBH;;EAkBAN,kBAAYzI,MAAZ,CAAmB,MAAnB,EACGJ,IADH,CACQ,OADR,EACiB,WADjB,EAEGA,IAFH,CAEQ,GAFR,EAEa,EAFb,EAGGA,IAHH,CAGQ,GAHR,EAGa,CAHb,EAIGA,IAJH,CAIQ,IAJR,EAIc,OAJd,EAKGA,IALH,CAKQ,aALR,EAKuB,OALvB,EAMGX,IANH,CAMQ,UAAUlB,CAAV,EAAa;EACjB;EACA,eAAOA,EAAEgK,IAAT;EACD,OATH;;EAWA;EACAU,kBAAYC,SAAZ,CAAsB,MAAtB,EAA8BvJ,IAA9B,CAAmC,UAAUpB,CAAV,EAAa;EAAA;;EAC9C,YAAI,OAAQA,EAAEgK,IAAV,KAAoB,QAAxB,EAAkC;EAChC,cAAI,KAAK1H,qBAAL,KAA+B+H,OAAnC,EAA4C;EAAA;EAC1C5K,uBAAA,QACGoC,IADH,CACQ,OADR,EACiB7B,EAAEgK,IADnB,EAEGxH,EAFH,CAEM,WAFN,EAEmBuH,UAAUtH,IAF7B,EAGGD,EAHH,CAGM,UAHN,EAGkBuH,UAAUrH,IAH5B;EAIA,kBAAIC,IAAI,CAAR;EACA,qBAAO,MAAKL,qBAAL,KAA+B+H,OAAtC,EAA+C;EAC7C5K,yBAAA,QAAgByB,IAAhB,CAAqB,UAAUlB,CAAV,EAAa;EAChC,yBAAOA,EAAE,MAAF,EAAU4C,KAAV,CAAgB,CAAhB,EAAmB,CAACD,CAApB,IAAyB,KAAhC;EACD,iBAFD;EAGA,kBAAEA,CAAF;EACD;EAXyC;EAY3C,WAZD,MAYO;EACL,mBAAO3C,CAAP;EACD;EACF;EACF,OAlBD;EAmBD,KA9GD,MA8GO;EACL,UAAIwE,MAAJ;EACA,UAAI9F,GAAGG,OAAH,CAAWsL,MAAX,IAAqBzL,GAAGS,SAAH,CAAaqF,MAAb,CAAoBC,QAApB,KAAiC,QAA1D,EAAoE;EAClED,iBAAS0F,UAAUS,SAAV,CAAoB,SAApB,EACNvM,IADM,CACDM,GAAGG,OAAH,CAAW2F,MADV,EAENoG,KAFM,GAEE3I,MAFF,CAES,GAFT,EAGNJ,IAHM,CAGD,OAHC,EAGQ,QAHR,EAINA,IAJM,CAID,OAJC,EAIQnD,GAAGK,MAAH,IAAaL,GAAGG,OAAH,CAAW2F,MAAX,CAAkBjC,MAAlB,GAA2B,CAAxC,CAJR,EAKNV,IALM,CAKD,WALC,EAKY,UAAU7B,CAAV,EAAa2C,CAAb,EAAgB;EACjC;EACA;EACA,iBAAO,eAAejE,GAAGK,MAAH,IAAaL,GAAGG,OAAH,CAAW2F,MAAX,CAAkBjC,MAAlB,GAA2B,CAAxC,IAA6CI,CAA5D,GAAgE,GAAhE,GAAsE,CAACjE,GAAGG,OAAH,CAAW+H,WAAX,IAA0BlF,aAAa,CAAvC,GAA2CA,aAAaC,UAAxD,GAAqE,CAAtE,IAA2E,EAAjJ,GAAsJ,GAA7J;EACD,SATM,CAAT;EAWD,OAZD,MAYO;EACL6C,iBAAS0F,UAAUS,SAAV,CAAoB,SAApB,EACNvM,IADM,CACDM,GAAGG,OAAH,CAAW2F,MADV,EAENoG,KAFM,GAEE3I,MAFF,CAES,GAFT,EAGNJ,IAHM,CAGD,OAHC,EAGQ,QAHR,EAINA,IAJM,CAID,WAJC,EAIY,UAAU7B,CAAV,EAAa2C,CAAb,EAAgB;EACjC,iBAAO,eAAe,CAAf,GAAmB,GAAnB,GAAyB,CAACjE,GAAGG,OAAH,CAAW+H,WAAX,IAA0BlF,aAAa,CAAvC,GAA2CA,aAAaC,UAAb,GAA0BgB,CAArE,GAAyE,IAAIA,CAA9E,IAAmF,EAA5G,GAAiH,GAAxH;EACD,SANM,CAAT;EAOD;;EAED,UAAIjE,GAAGS,SAAH,CAAaqF,MAAb,CAAoBE,MAApB,KAA+B,QAAnC,EAA6C;EAC3CF,eAAOvC,MAAP,CAAc,QAAd,EACGJ,IADH,CACQ,IADR,EACc,CADd,EAEGA,IAFH,CAEQ,IAFR,EAEc,CAFd,EAGGA,IAHH,CAGQ,GAHR,EAGa,CAHb,EAIGA,IAJH,CAIQ,cAJR,EAIwB,CAJxB,EAKGA,IALH,CAKQ,QALR,EAKkB,UAAU7B,CAAV,EAAa;EAC3B,iBAAOtB,GAAGqH,OAAH,CAAWjC,KAAX,CAAiB9D,EAAEgK,IAAnB,CAAP;EACD,SAPH,EAQGnI,IARH,CAQQ,MARR,EAQgB,UAAU7B,CAAV,EAAa;EACzB,iBAAOtB,GAAGqH,OAAH,CAAWjC,KAAX,CAAiB9D,EAAEgK,IAAnB,CAAP;EACD,SAVH,EAWGnI,IAXH,CAWQ,cAXR,EAWwB,GAXxB;EAYD,OAbD,MAaO;EACL2C,eAAOvC,MAAP,CAAc,MAAd,EACGJ,IADH,CACQ,GADR,EACa,CADb,EAEGA,IAFH,CAEQ,OAFR,EAEiB,EAFjB,EAGGA,IAHH,CAGQ,QAHR,EAGkB,EAHlB,EAIGA,IAJH,CAIQ,MAJR,EAIgB,UAAU7B,CAAV,EAAa;EACzB,iBAAOtB,GAAGqH,OAAH,CAAWjC,KAAX,CAAiB9D,EAAEgK,IAAnB,CAAP;EACD,SANH;EAOD;;EAEDxF,aAAOvC,MAAP,CAAc,MAAd,EACGJ,IADH,CACQ,GADR,EACa,EADb,EAEGA,IAFH,CAEQ,GAFR,EAEa,CAFb,EAGGA,IAHH,CAGQ,IAHR,EAGc,OAHd,EAIGA,IAJH,CAIQ,aAJR,EAIuB,OAJvB,EAKGX,IALH,CAKQ,UAAUlB,CAAV,EAAa;EACjB;EACA,eAAOA,EAAEgK,IAAT;EACD,OARH;;EAUA;EACA,UAAIK,WAAU3L,GAAGG,OAAH,CAAWyE,IAAX,CAAgBC,MAAhB,CAAuBE,KAAvB,GAA+B,EAA7C;EACAe,aAAOmG,SAAP,CAAiB,MAAjB,EAAyBvJ,IAAzB,CAA8B,UAAUpB,CAAV,EAAa;EAAA;;EACzC,YAAI,OAAQA,EAAEgK,IAAV,KAAoB,QAAxB,EAAkC;EAChC,cAAI,KAAK1H,qBAAL,KAA+B+H,QAAnC,EAA4C;EAAA;EAC1C5K,uBAAA,SACGoC,IADH,CACQ,OADR,EACiB7B,EAAEgK,IADnB,EAEGxH,EAFH,CAEM,WAFN,EAEmBuH,UAAUtH,IAF7B,EAGGD,EAHH,CAGM,UAHN,EAGkBuH,UAAUrH,IAH5B;EAIA,kBAAIC,IAAI,CAAR;EACA,qBAAO,OAAKL,qBAAL,KAA+B+H,QAAtC,EAA+C;EAC7C5K,yBAAA,SAAgByB,IAAhB,CAAqB,UAAUlB,CAAV,EAAa;EAChC,yBAAOA,EAAE,MAAF,EAAU4C,KAAV,CAAgB,CAAhB,EAAmB,CAACD,CAApB,IAAyB,KAAhC;EACD,iBAFD;EAGA,kBAAEA,CAAF;EACD;EAXyC;EAY3C,WAZD,MAYO;EACL,mBAAO3C,CAAP;EACD;EACF;EACF,OAlBD;EAmBD;;EAED;;;;EAIAkK,cAAUS,SAAV,CAAoB,cAApB,EACG9I,IADH,CACQ,MADR,EACgBnD,GAAGS,SAAH,CAAaqF,MAAb,CAAoBtD,IAApB,CAAyB8C,SADzC,EAEGnC,IAFH,CAEQ,WAFR,EAEqBnD,GAAGS,SAAH,CAAaqF,MAAb,CAAoBtD,IAApB,CAAyB+C,QAF9C,EAGGpC,IAHH,CAGQ,aAHR,EAGuBnD,GAAGS,SAAH,CAAaqF,MAAb,CAAoBtD,IAApB,CAAyBgD,UAHhD;EAID,GA1PD;;EA4PAf,QAAM+H,QAAN,GAAiB,YAAY;EAC3B,QAAMxM,KAAK,IAAX;EACA,WAAOA,EAAP;EACD,GAHD;;EAKAyE,QAAMuE,QAAN,GAAiB,YAAY;EAC3B,QAAMhJ,KAAK,IAAX;EACA,QAAIqG,KAAJ;;EAEA;;;;;EAMA;EACA,QAAMoG,UAAUzM,GAAGwH,MAAH,CAAU1G,KAAV,CAAgBC,EAAhB,CAAmBC,GAAnB,GAAyB8J,IAAzB,CAA8B,aAAK;EACjD,aAAO,4BAA4BxJ,CAA5B,GAAgC,QAAvC;EACD,KAFe,CAAhB;;EAIA,QAAI,CAAC,CAACtB,GAAGG,OAAH,CAAWkG,KAAZ,IAAsBrG,GAAGG,OAAH,CAAWkG,KAAX,IAAoBrG,GAAGG,OAAH,CAAWkG,KAAX,CAAiBV,OAAjB,KAA6B,KAAxE,MAAoF,CAAC3F,GAAGG,OAAH,CAAW6G,KAAZ,IAAsBhH,GAAGG,OAAH,CAAW6G,KAAX,IAAoBhH,GAAGG,OAAH,CAAW6G,KAAX,CAAiBrB,OAAjB,KAA6B,KAA3J,CAAJ,EAAwK;EACtK3F,SAAGa,IAAH,CAAQ0K,IAAR,CAAakB,OAAb;EACD;;EAGD;;;;EAIA;;EAEA,QAAI,CAACzM,GAAGG,OAAH,CAAWkG,KAAZ,IAAsBrG,GAAGG,OAAH,CAAWkG,KAAX,IAAoBrG,GAAGG,OAAH,CAAWkG,KAAX,CAAiBV,OAAjB,KAA6B,KAA3E,EAAmF;EACjFU,cAAQrG,GAAGa,IAAH,CAAQ0C,MAAR,CAAe,GAAf,EACLJ,IADK,CACA,OADA,EACS,QADT,EAELoI,IAFK,CAEAvL,GAAGsH,KAAH,CAASpE,CAFT,CAAR;;EAIA,UAAIlD,GAAGG,OAAH,CAAWkG,KAAX,IAAoBrG,GAAGG,OAAH,CAAWkG,KAAX,CAAiB7D,IAAzC,EAA+C;EAC7C6D,cAAM9C,MAAN,CAAa,MAAb,EACGJ,IADH,CACQ,OADR,EACiB,YADjB,EAEGA,IAFH,CAEQ,GAFR,EAEa,CAACnD,GAAGmH,OAAH,CAAWrC,IAAZ,GAAmB,GAFhC,EAGG3B,IAHH,CAGQ,GAHR,EAGa,CAACnD,GAAGO,OAAJ,GAAc,CAH3B,EAIG4C,IAJH,CAIQ,WAJR,EAIqB,aAJrB,EAKGA,IALH,CAKQ,aALR,EAKuB,QALvB,EAMGX,IANH,CAMQxC,GAAGG,OAAH,CAAWkG,KAAX,CAAiB7D,IANzB;EAOD;EACF;;EAED,QAAIxC,GAAGG,OAAH,CAAWkG,KAAX,CAAiBrE,MAAjB,IAA2BhC,GAAGG,OAAH,CAAWkG,KAAX,CAAiBrE,MAAjB,CAAwBmJ,cAAxB,CAAuC,SAAvC,CAA/B,EAAkF;EAChF,UAAInL,GAAGG,OAAH,CAAWkG,KAAX,CAAiBM,KAArB,EAA4B;EAC1B,YAAI3G,GAAGG,OAAH,CAAWkG,KAAX,CAAiBrE,MAAjB,CAAwB2D,OAAxB,KAAoC,KAApC,IAA6C3F,GAAGG,OAAH,CAAWkG,KAAX,CAAiBM,KAAjB,CAAuBhB,OAAvB,KAAmC,KAApF,EAA2F;EACzF5E,mBAAA,CAAU,kBAAV,EAA8B8J,MAA9B;EACA9J,sBAAA,CAAa,gBAAb,EAA+B8J,MAA/B;EACD,SAHD,MAGO,IAAI7K,GAAGG,OAAH,CAAWkG,KAAX,CAAiBrE,MAAjB,CAAwB2D,OAAxB,KAAoC,KAApC,IAA6C3F,GAAGG,OAAH,CAAWkG,KAAX,CAAiBM,KAAjB,CAAuBhB,OAAvB,KAAmC,IAApF,EAA0F;EAC/F5E,mBAAA,CAAU,kBAAV,EAA8B8J,MAA9B;EACA;EACD;EACF,OARD,MAQO;EACL,YAAI7K,GAAGG,OAAH,CAAWkG,KAAX,CAAiBrE,MAAjB,CAAwB2D,OAAxB,KAAoC,KAAxC,EAA+C;EAC7C5E,mBAAA,CAAU,kBAAV,EAA8B8J,MAA9B;EACA9J,sBAAA,CAAa,gBAAb,EAA+B8J,MAA/B;EACD;EACF;EACF;;EAED,QAAI,CAAC7K,GAAGG,OAAH,CAAWkG,KAAZ,IAAsBrG,GAAGG,OAAH,CAAWkG,KAAX,IAAoBrG,GAAGG,OAAH,CAAWkG,KAAX,CAAiBV,OAAjB,KAA6B,KAA3E,EAAmF;EACjF;EACA;EACAU,YAAM4F,SAAN,CAAgB,MAAhB,EAAwBvJ,IAAxB,CAA6B,UAAUpB,CAAV,EAAa;EAAA;;EACxC,YAAIoL,UAAU,IAAd;EACA,YAAI,OAAQpL,CAAR,KAAe,QAAnB,EAA6B;EAC3B,cAAI,KAAKsC,qBAAL,KAA+B,MAAM5D,GAAGmH,OAAH,CAAWrC,IAApD,EAA0D;EAAA;EACxD/D,uBAAA,CAAU2L,OAAV,EACG5I,EADH,CACM,WADN,EACmB2I,QAAQ1I,IAD3B,EAEGD,EAFH,CAEM,UAFN,EAEkB2I,QAAQzI,IAF1B;EAGA,kBAAIC,IAAI,CAAR;EACA,qBAAO,OAAKL,qBAAL,KAA+B,MAAM5D,GAAGmH,OAAH,CAAWrC,IAAvD,EAA6D;EAC3D/D,yBAAA,SAAgByB,IAAhB,CAAqB,UAAUlB,CAAV,EAAa;EAChC,yBAAOA,EAAE4C,KAAF,CAAQ,CAAR,EAAW,CAACD,CAAZ,IAAiB,KAAxB;EACD,iBAFD,EAEGd,IAFH,CAEQ,OAFR,EAEiB7B,CAFjB;EAGA,kBAAE2C,CAAF;EACD;EAVuD;EAWzD,WAXD,MAWO;EACL,mBAAO3C,CAAP;EACD;EACF;EACF,OAlBD;EAmBD;;EAED;EACA,QAAItB,GAAGG,OAAH,CAAWkG,KAAX,IAAoBrG,GAAGG,OAAH,CAAWkG,KAAX,CAAiBsG,QAArC,IAAiD3M,GAAGG,OAAH,CAAWkG,KAAX,CAAiBsG,QAAjB,CAA0BhH,OAA1B,KAAsC,IAA3F,EAAiG;EAC/F,UAAIiH,gBAAgB7L,SAAA,CAAUf,GAAGG,OAAH,CAAW0H,MAArB,EAA6BtE,MAA7B,CAAoC,KAApC,EAA2CJ,IAA3C,CAAgD,OAAhD,EAAyD,mBAAzD,EACjBI,MADiB,CACV,QADU,EAEjBO,EAFiB,CAEd,QAFc,EAEJ,YAAY;EACxB9D,WAAG6M,UAAH,CAAc,GAAd,EAAmB,KAAKzK,KAAxB;EACD,OAJiB,CAApB;;EAMA;;;;;;;;EAQA,UAAIkH,IAAI,CAAC,CAAD,GAAKvI,SAAA,CAAUf,GAAGG,OAAH,CAAW0H,MAArB,EAA6BlE,IAA7B,GAAoCmJ,qBAApC,GAA4D1M,KAAjE,GAAyE,CAAzE,GAA6EJ,GAAGmH,OAAH,CAAWrC,IAAX,GAAkB,GAAvG;EACA,UAAI5B,IAAI,CAAC,CAAD,GAAKnC,SAAA,CAAUf,GAAGG,OAAH,CAAW0H,MAArB,EAA6BlE,IAA7B,GAAoCmJ,qBAApC,GAA4DxM,MAAjE,GAA0E,GAAlF;;EAEA,UAAIN,GAAGG,OAAH,CAAWkG,KAAX,CAAiBsG,QAAjB,CAA0BlB,MAA9B,EAAsC;;EAEpC,YAAIA,SAASzL,GAAGG,OAAH,CAAWkG,KAAX,CAAiBsG,QAAjB,CAA0BlB,MAAvC;EACAA,eAAOsB,OAAP,GAAiB,OAAjB;EACAtB,eAAOuB,SAAP,GAAmB,eAAe1D,CAAf,GAAmB,KAAnB,GAA2BpG,CAA3B,GAA+B,oBAAlD;EACAuI,eAAO5G,MAAP,GAAgB,MAAhB;EACA4G,eAAO,YAAP,IAAuB,QAAvB;EACAA,eAAO,iBAAP,IAA4B,QAA5B;;EAEA1K,iBAAA,CAAU,2BAAV,EAAuC0K,MAAvC,CAA8CA,MAA9C;;EAEA1K,iBAAA,CAAU,kCAAV,EAA8C0K,MAA9C,CAAqD;EACnD,wBAAc;EADqC,SAArD;EAID,OAfD,MAeO;EACL1K,iBAAA,CAAU,2BAAV,EAAuC0K,MAAvC,CAA8C;EAC5C,qBAAW,OADiC;EAE5C,uBAAa,eAAenC,CAAf,GAAmB,KAAnB,GAA2BpG,CAA3B,GAA+B,oBAFA;EAG5C,oBAAU,MAHkC;EAI5C,wBAAc,QAJ8B;EAK5C,6BAAmB;EALyB,SAA9C;;EAQAnC,iBAAA,CAAU,kCAAV,EAA8C0K,MAA9C,CAAqD;EACnD,wBAAc;EADqC,SAArD;EAGD;;EAED,UAAIzL,GAAGG,OAAH,CAAWkG,KAAX,CAAiBsG,QAAjB,CAA0BM,OAA9B,EAAuC;;EAErCL,sBAAcX,SAAd,CAAwB,QAAxB,EACGvM,IADH,CACQM,GAAGG,OAAH,CAAWkG,KAAX,CAAiBsG,QAAjB,CAA0BM,OADlC,EAEGf,KAFH,GAEW3I,MAFX,CAEkB,QAFlB,EAGGJ,IAHH,CAGQ,OAHR,EAGiB,UAAU7B,CAAV,EAAa;EAC1B,iBAAOA,EAAEc,KAAT;EACD,SALH,EAMGe,IANH,CAMQ,OANR,EAMiB,UAAU7B,CAAV,EAAa;EAC1B,iBAAOA,EAAEc,KAAT;EACD,SARH,EASGI,IATH,CASQ,UAAUlB,CAAV,EAAa;EACjB,iBAAOA,EAAE+D,KAAT;EACD,SAXH,EAYGiH,QAZH,CAYY,UAZZ,EAYwB,UAAUhL,CAAV,EAAa;EACjC,iBAAOA,EAAE4L,QAAT;EACD,SAdH;EAgBD,OAlBD,MAkBO;EACLC,gBAAQC,GAAR,CAAY,8BAAZ;EACD;EACF;;EAED;;EAEA;;EAEA;EACA,QAAI,CAACpN,GAAGG,OAAH,CAAW6G,KAAZ,IAAsBhH,GAAGG,OAAH,CAAW6G,KAAX,IAAoBhH,GAAGG,OAAH,CAAW6G,KAAX,CAAiBrB,OAAjB,KAA6B,KAA3E,EAAmF;;EAEjF3F,SAAGqN,MAAH,GAAYrN,GAAGa,IAAH,CAAQ0C,MAAR,CAAe,GAAf,EACTJ,IADS,CACJ,OADI,EACK,QADL,EAETA,IAFS,CAEJ,WAFI,EAES,iBAAiBnD,GAAGO,OAApB,GAA8B,GAFvC,EAGTgL,IAHS,CAGJvL,GAAGsH,KAAH,CAASgC,CAHL,CAAZ;;EAKA;EACA,UAAItJ,GAAGG,OAAH,CAAW6G,KAAX,CAAiBjE,IAAjB,IAAyB/C,GAAGG,OAAH,CAAW6G,KAAX,CAAiBjE,IAAjB,CAAsB4C,OAAtB,IAAiC,KAA9D,EAAqE;EACnE3F,WAAGqN,MAAH,CAAUpB,SAAV,CAAoB,MAApB,EACGzL,KADH,CACS,SADT,EACoB,MADpB;EAED;;EAED;EACA,UAAIR,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAAjB,IAA0B3G,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAAjB,CAAuB2C,CAArD,EAAwD;EACtDtJ,WAAGqN,MAAH,CAAUpB,SAAV,CAAoB,MAApB,EACG9I,IADH,CACQ,IADR,EACcnD,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAAjB,CAAuB2C,CADrC;EAED;;EAED,UAAItJ,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAAjB,IAA0B3G,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAAjB,CAAuBzD,CAArD,EAAwD;EACtDlD,WAAGqN,MAAH,CAAUpB,SAAV,CAAoB,MAApB,EACG9I,IADH,CACQ,IADR,EACcnD,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAAjB,CAAuBzD,CADrC;EAED;;EAED;EACA,UAAIlD,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAAjB,IAA0B3G,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAAjB,CAAuB5D,IAAjD,IAAyD/C,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAAjB,CAAuB5D,IAAvB,CAA4B4C,OAA5B,KAAwC,KAArG,EAA4G;EAC1G3F,WAAGqN,MAAH,CAAUpB,SAAV,CAAoB,MAApB,EACGzL,KADH,CACS,SADT,EACoB,MADpB;EAED;EACF;;EAED,QAAIR,GAAGG,OAAH,CAAW6G,KAAX,IAAoBhH,GAAGG,OAAH,CAAW6G,KAAX,CAAiBxE,IAAzC,EAA+C;EAC7CxC,SAAGqN,MAAH,CAAU9J,MAAV,CAAiB,MAAjB,EACGJ,IADH,CACQ,OADR,EACiB,YADjB,EAEGA,IAFH,CAEQ,GAFR,EAEanD,GAAGK,MAAH,GAAY,CAFzB,EAGG8C,IAHH,CAGQ,GAHR,EAGa,EAHb,EAIG3C,KAJH,CAIS,aAJT,EAIwB,QAJxB,EAKGgC,IALH,CAKQxC,GAAGG,OAAH,CAAW6G,KAAX,CAAiBxE,IALzB;EAMD;;EAED,QAAIxC,GAAGG,OAAH,CAAW6G,KAAX,CAAiBhF,MAAjB,KAA4BN,SAA5B,IAAyC1B,GAAGG,OAAH,CAAW6G,KAAX,CAAiBhF,MAAjB,CAAwBmJ,cAAxB,CAAuC,SAAvC,CAA7C,EAAgG;EAC9F,UAAInL,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAArB,EAA4B;EAC1B,YAAI3G,GAAGG,OAAH,CAAW6G,KAAX,CAAiBhF,MAAjB,CAAwB2D,OAAxB,KAAoC,KAApC,IAA6C3F,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAAjB,CAAuBhB,OAAvB,KAAmC,KAApF,EAA2F;EACzF5E,mBAAA,CAAUf,GAAGG,OAAH,CAAW0H,MAAX,GAAoB,mBAA9B,EAAmDgD,MAAnD;EACA9J,sBAAA,CAAa,gBAAb,EAA+B8J,MAA/B;EACD,SAHD,MAGO,IAAI7K,GAAGG,OAAH,CAAW6G,KAAX,CAAiBhF,MAAjB,CAAwB2D,OAAxB,KAAoC,KAApC,IAA6C3F,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAAjB,CAAuBhB,OAAvB,KAAmC,IAApF,EAA0F;EAC/F5E,mBAAA,CAAUf,GAAGG,OAAH,CAAW0H,MAAX,GAAoB,mBAA9B,EAAmDgD,MAAnD;EACA;EACD;EACF,OARD,MAQO;EACL,YAAI7K,GAAGG,OAAH,CAAW6G,KAAX,CAAiBhF,MAAjB,CAAwB2D,OAAxB,KAAoC,KAAxC,EAA+C;EAC7C5E,mBAAA,CAAUf,GAAGG,OAAH,CAAW0H,MAAX,GAAoB,mBAA9B,EAAmDgD,MAAnD;EACA9J,sBAAA,CAAaf,GAAGG,OAAH,CAAW0H,MAAX,GAAoB,iBAAjC,EAAoDgD,MAApD;EACD;EACF;EACF;;EAED;EACA,QAAI7K,GAAGG,OAAH,CAAW6G,KAAX,IAAoBhH,GAAGG,OAAH,CAAW6G,KAAX,CAAiB2F,QAArC,IAAiD3M,GAAGG,OAAH,CAAW6G,KAAX,CAAiB2F,QAAjB,CAA0BhH,OAA1B,KAAsC,IAA3F,EAAiG;EAC/F,UAAI2H,gBAAgBvM,SAAA,CAAUf,GAAGG,OAAH,CAAW0H,MAArB,EAA6BtE,MAA7B,CAAoC,KAApC,EAA2CJ,IAA3C,CAAgD,OAAhD,EAAyD,mBAAzD,EACjBI,MADiB,CACV,QADU,EAEjBO,EAFiB,CAEd,QAFc,EAEJ,YAAY;EACxB9D,WAAG6M,UAAH,CAAc,GAAd,EAAmB,KAAKzK,KAAxB;EACD,OAJiB,CAApB;;EAMA,UAAIpC,GAAGG,OAAH,CAAW6G,KAAX,CAAiB2F,QAAjB,CAA0BlB,MAA9B,EAAsC;;EAEpC,YAAIA,SAASzL,GAAGG,OAAH,CAAW6G,KAAX,CAAiB2F,QAAjB,CAA0BlB,MAAvC;EACAA,eAAOsB,OAAP,GAAiB,OAAjB;EACAtB,eAAO5G,MAAP,GAAgB,MAAhB;EACA4G,eAAO,YAAP,IAAuB,QAAvB;EACAA,eAAO,iBAAP,IAA4B,QAA5B;;EAEA1K,iBAAA,CAAU,2BAAV,EAAuC0K,MAAvC,CAA8CA,MAA9C;;EAEA1K,iBAAA,CAAU,kCAAV,EAA8C0K,MAA9C,CAAqD;EACnD,wBAAc;EADqC,SAArD;EAID,OAdD,MAcO;EACL1K,iBAAA,CAAU,2BAAV,EAAuC0K,MAAvC,CAA8C;EAC5C,qBAAW,OADiC;EAE5C,oBAAU,MAFkC;EAG5C,wBAAc,QAH8B;EAI5C,6BAAmB;EAJyB,SAA9C;;EAOA1K,iBAAA,CAAU,kCAAV,EAA8C0K,MAA9C,CAAqD;EACnD,wBAAc;EADqC,SAArD;EAGD;;EAED,UAAIzL,GAAGG,OAAH,CAAW6G,KAAX,CAAiB2F,QAAjB,CAA0BM,OAA9B,EAAuC;;EAErCK,sBAAcrB,SAAd,CAAwB,QAAxB,EACGvM,IADH,CACQM,GAAGG,OAAH,CAAW6G,KAAX,CAAiB2F,QAAjB,CAA0BM,OADlC,EAEGf,KAFH,GAEW3I,MAFX,CAEkB,QAFlB,EAGGJ,IAHH,CAGQ,OAHR,EAGiB,UAAU7B,CAAV,EAAa;EAC1B,iBAAOA,EAAEc,KAAT;EACD,SALH,EAMGe,IANH,CAMQ,OANR,EAMiB,UAAU7B,CAAV,EAAa;EAC1B,iBAAOA,EAAEc,KAAT;EACD,SARH,EASGI,IATH,CASQ,UAAUlB,CAAV,EAAa;EACjB,iBAAOA,EAAE+D,KAAT;EACD,SAXH,EAYGiH,QAZH,CAYY,UAZZ,EAYwB,UAAUhL,CAAV,EAAa;EACjC,iBAAOA,EAAE4L,QAAT;EACD,SAdH;EAgBD,OAlBD,MAkBO;EACLC,gBAAQC,GAAR,CAAY,8BAAZ;EACD;EACF;;EAED;;;EAGA;EACA,QAAIpN,GAAGG,OAAH,CAAW6G,KAAX,CAAiBrB,OAAjB,KAA6B,KAA7B,IAAsC3F,GAAGS,SAAH,CAAauG,KAAb,CAAmBrB,OAA7D,EAAsE;EACpE;EACAU,YAAM4F,SAAN,CAAgB,SAAhB,EACG9I,IADH,CACQ,gBADR,EAC0B,OAD1B,EAEGA,IAFH,CAEQ,cAFR,EAEwBnD,GAAGS,SAAH,CAAa4F,KAAb,CAAmBC,IAAnB,CAAwBC,WAFhD,EAGGpD,IAHH,CAGQ,QAHR,EAGkBnD,GAAGS,SAAH,CAAa4F,KAAb,CAAmBC,IAAnB,CAAwBE,WAH1C,EAIGrD,IAJH,CAIQ,SAJR,EAImBnD,GAAGS,SAAH,CAAa4F,KAAb,CAAmBC,IAAnB,CAAwBG,aAJ3C;;EAMA;EACAJ,YAAM4F,SAAN,CAAgB,aAAhB,EACG9I,IADH,CACQ,WADR,EACqBnD,GAAGS,SAAH,CAAa4F,KAAb,CAAmBhB,KAAnB,CAAyBE,QAD9C,EAEGpC,IAFH,CAEQ,aAFR,EAEuBnD,GAAGS,SAAH,CAAa4F,KAAb,CAAmBhB,KAAnB,CAAyBG,UAFhD,EAGGrC,IAHH,CAGQ,MAHR,EAGgBnD,GAAGS,SAAH,CAAa4F,KAAb,CAAmBhB,KAAnB,CAAyBC,SAHzC,EAIGnC,IAJH,CAIQ,aAJR,EAIuBnD,GAAGS,SAAH,CAAa4F,KAAb,CAAmBhB,KAAnB,CAAyB0B,UAJhD;;EAMA;EACAV,YAAM4F,SAAN,CAAgB,YAAhB,EACG9I,IADH,CACQ,cADR,EACwBnD,GAAGS,SAAH,CAAa4F,KAAb,CAAmBM,KAAnB,CAAyBJ,WADjD,EAEGpD,IAFH,CAEQ,QAFR,EAEkBnD,GAAGS,SAAH,CAAa4F,KAAb,CAAmBM,KAAnB,CAAyBH,WAF3C,EAGGrD,IAHH,CAGQ,gBAHR,EAG0BnD,GAAGS,SAAH,CAAa4F,KAAb,CAAmBM,KAAnB,CAAyBV,OAHnD,EAIG9C,IAJH,CAIQ,OAJR,EAIiBnD,GAAGS,SAAH,CAAa4F,KAAb,CAAmBM,KAAnB,CAAyB4G,SAJ1C;EAKE;EALF,OAMGpK,IANH,CAMQ,kBANR,EAM4BnD,GAAGS,SAAH,CAAa4F,KAAb,CAAmBM,KAAnB,CAAyBE,UANrD,EAOG1D,IAPH,CAOQ,WAPR,EAOqB,gBAAgBnD,GAAGS,SAAH,CAAa4F,KAAb,CAAmBC,IAAnB,CAAwBI,WAAxC,GAAsD,MAP3E;EAQA;EACA,UAAI1G,GAAGS,SAAH,CAAa4F,KAAb,CAAmBM,KAAnB,CAAyBC,IAA7B,EAAmC;EACjCP,cAAM4F,SAAN,CAAgB,wCAAhB,EACG9I,IADH,CACQ,QADR,EACkB,MADlB;EAED;;EAED;EACAkD,YAAM4F,SAAN,CAAgB,YAAhB,EACG9I,IADH,CACQ,WADR,EACqBnD,GAAGS,SAAH,CAAa4F,KAAb,CAAmBS,MAAnB,CAA0BvB,QAD/C,EAEGpC,IAFH,CAEQ,aAFR,EAEuBnD,GAAGS,SAAH,CAAa4F,KAAb,CAAmBS,MAAnB,CAA0BtB,UAFjD,EAGGrC,IAHH,CAGQ,MAHR,EAGgBnD,GAAGS,SAAH,CAAa4F,KAAb,CAAmBS,MAAnB,CAA0BxB,SAH1C,EAIGnC,IAJH,CAIQ,aAJR,EAIuBnD,GAAGS,SAAH,CAAa4F,KAAb,CAAmBS,MAAnB,CAA0BC,UAJjD,EAKG5D,IALH,CAKQ,WALR,EAKqB,gBAAgBnD,GAAGS,SAAH,CAAa4F,KAAb,CAAmBC,IAAnB,CAAwBI,WAAxC,GAAsD,MAL3E;EAOD;;EAED;EACA,QAAI1G,GAAGG,OAAH,CAAW6G,KAAX,CAAiBrB,OAAjB,KAA6B,KAA7B,IAAsC3F,GAAGS,SAAH,CAAauG,KAAb,CAAmBrB,OAA7D,EAAsE;EACpE;EACA3F,SAAGqN,MAAH,CAAUpB,SAAV,CAAoB,SAApB,EACG9I,IADH,CACQ,gBADR,EAC0B,OAD1B,EAEGA,IAFH,CAEQ,cAFR,EAEwBnD,GAAGS,SAAH,CAAauG,KAAb,CAAmBV,IAAnB,CAAwBC,WAFhD,EAGGpD,IAHH,CAGQ,QAHR,EAGkBnD,GAAGS,SAAH,CAAauG,KAAb,CAAmBV,IAAnB,CAAwBE,WAH1C,EAIGrD,IAJH,CAIQ,SAJR,EAImBnD,GAAGS,SAAH,CAAauG,KAAb,CAAmBV,IAAnB,CAAwBG,aAJ3C;;EAMA;EACAzG,SAAGqN,MAAH,CAAUpB,SAAV,CAAoB,aAApB,EACG9I,IADH,CACQ,WADR,EACqBnD,GAAGS,SAAH,CAAauG,KAAb,CAAmB3B,KAAnB,CAAyBE,QAD9C,EAEGpC,IAFH,CAEQ,aAFR,EAEuBnD,GAAGS,SAAH,CAAauG,KAAb,CAAmB3B,KAAnB,CAAyBG,UAFhD,EAGGrC,IAHH,CAGQ,MAHR,EAGgBnD,GAAGS,SAAH,CAAauG,KAAb,CAAmB3B,KAAnB,CAAyBC,SAHzC,EAIGnC,IAJH,CAIQ,aAJR,EAIuBnD,GAAGS,SAAH,CAAauG,KAAb,CAAmB3B,KAAnB,CAAyB0B,UAJhD,EAKG5D,IALH,CAKQ,WALR,EAKqB,kBAAkBnD,GAAGS,SAAH,CAAauG,KAAb,CAAmBV,IAAnB,CAAwBI,WAA1C,GAAwD,GAL7E;;EAOA;EACA1G,SAAGqN,MAAH,CAAUpB,SAAV,CAAoB,YAApB,EACG9I,IADH,CACQ,cADR,EACwBnD,GAAGS,SAAH,CAAauG,KAAb,CAAmBL,KAAnB,CAAyBJ,WADjD,EAEGpD,IAFH,CAEQ,QAFR,EAEkBnD,GAAGS,SAAH,CAAauG,KAAb,CAAmBL,KAAnB,CAAyBH,WAF3C,EAGGrD,IAHH,CAGQ,WAHR,EAGqB,kBAAkBnD,GAAGS,SAAH,CAAauG,KAAb,CAAmBV,IAAnB,CAAwBI,WAA1C,GAAwD,GAH7E;EAIA;EACA,UAAI1G,GAAGS,SAAH,CAAauG,KAAb,CAAmBL,KAAnB,CAAyBC,IAA7B,EAAmC;EACjC5G,WAAGqN,MAAH,CAAUpB,SAAV,CAAoB,wCAApB,EACG9I,IADH,CACQ,QADR,EACkB,MADlB;EAED;;EAED;EACAnD,SAAGqN,MAAH,CAAUpB,SAAV,CAAoB,YAApB,EACG9I,IADH,CACQ,WADR,EACqBnD,GAAGS,SAAH,CAAauG,KAAb,CAAmBF,MAAnB,CAA0BvB,QAD/C,EAEGpC,IAFH,CAEQ,aAFR,EAEuBnD,GAAGS,SAAH,CAAauG,KAAb,CAAmBF,MAAnB,CAA0BtB,UAFjD,EAGGrC,IAHH,CAGQ,MAHR,EAGgBnD,GAAGS,SAAH,CAAauG,KAAb,CAAmBF,MAAnB,CAA0BxB,SAH1C,EAIGnC,IAJH,CAIQ,aAJR,EAIuBnD,GAAGS,SAAH,CAAauG,KAAb,CAAmBF,MAAnB,CAA0BC,UAJjD,EAKG5D,IALH,CAKQ,WALR,EAKqBnD,GAAGS,SAAH,CAAauG,KAAb,CAAmBF,MAAnB,CAA0B0G,MAA1B,GAAmC,4BAA4BxN,GAAGS,SAAH,CAAauG,KAAb,CAAmBV,IAAnB,CAAwBQ,MAAxB,CAA+B0G,MAA3D,GAAoE,GAAvG,GAA6G,kBAAkBxN,GAAGS,SAAH,CAAauG,KAAb,CAAmBV,IAAnB,CAAwBI,WAA1C,GAAwD,GAL1L;EAMD;;EAED,QAAI,CAAC1G,GAAGG,OAAH,CAAW6G,KAAZ,IAAsBhH,GAAGG,OAAH,CAAW6G,KAAX,IAAoBhH,GAAGG,OAAH,CAAW6G,KAAX,CAAiBrB,OAAjB,KAA6B,KAA3E,EAAmF;EACjF;EACA;;EAEA,UAAM8H,oBAAoB1M,MAAA,CAAOA,SAAA,CAAU,SAAV,EAAqBkL,SAArB,CAA+B,MAA/B,EAAuCyB,KAAvC,GAA+C5N,GAA/C,CAAmD;EAAA,eAAKiM,EAAEnI,qBAAF,EAAL;EAAA,OAAnD,CAAP,CAA1B,CAJiF;EAKjF,UAAI+J,aAAa3N,GAAGqH,OAAH,CAAWiC,CAAX,CAAasE,SAAb,GAAyB5N,GAAGqH,OAAH,CAAWiC,CAAX,CAAasE,SAAb,EAAzB,GAAoD,CAAC5N,GAAGG,OAAH,CAAWyE,IAAX,CAAgBxE,KAAhB,IAAyBJ,GAAGG,OAAH,CAAWyE,IAAX,CAAgBC,MAAhB,CAAuBC,IAAvB,GAA8B9E,GAAGG,OAAH,CAAWyE,IAAX,CAAgBC,MAAhB,CAAuBE,KAA9E,CAAD,IAAyF/E,GAAGqH,OAAH,CAAWiC,CAAX,CAAa3C,KAAb,EAA9J;EACA,UAAI8G,oBAAoBE,UAAxB,EAAoC;EAAE;EACpC3N,WAAGqN,MAAH,CAAUpB,SAAV,CAAoB,MAApB,EAA4BvJ,IAA5B,CAAiC,UAAUpB,CAAV,EAAa;EAAA;;EAC5C,cAAI,OAAQA,CAAR,KAAe,QAAnB,EAA6B;EAC3B;EACAP,qBAAA,CAAU,IAAV,EACKoC,IADL,CACU,aADV,EACyB,KADzB,EAEKA,IAFL,CAEU,IAFV,EAEgB,CAFhB,EAGKA,IAHL,CAGU,WAHV,EAGuB,4BAHvB;EAIA;EACA,gBAAI,KAAKS,qBAAL,KAA+B,MAAM5D,GAAGG,OAAH,CAAWyE,IAAX,CAAgBC,MAAhB,CAAuBI,MAAhE,EAAwE;EAAA;EACtElE,yBAAA,SACG+C,EADH,CACM,WADN,EACmB2I,QAAQ1I,IAD3B,EAEGD,EAFH,CAEM,UAFN,EAEkB2I,QAAQzI,IAF1B;EAGA,oBAAIC,IAAI,CAAR;EACA,uBAAO,OAAKL,qBAAL,KAA+B,MAAM5D,GAAGG,OAAH,CAAWyE,IAAX,CAAgBC,MAAhB,CAAuBI,MAAnE,EAA2E;EACzElE,2BAAA,SAAgByB,IAAhB,CAAqB,UAAUlB,CAAV,EAAa;EAChC,2BAAOA,EAAE4C,KAAF,CAAQ,CAAR,EAAW,CAACD,CAAZ,IAAiB,KAAxB;EACD,mBAFD,EAEGd,IAFH,CAEQ,OAFR,EAEiB7B,CAFjB;EAGA,oBAAE2C,CAAF;EACD;EAVqE;EAWvE,aAXD,MAWO;EACL,qBAAO3C,CAAP;EACD;EACF;EACF,SAvBD;EAwBD;EACF;;EAED;;;EAGA;;;;;;;;;;;;;;;;EAiBA;EACA,QAAItB,GAAGG,OAAH,CAAWkG,KAAX,CAAiBM,KAAjB,IAA0B3G,GAAGG,OAAH,CAAWkG,KAAX,CAAiBM,KAAjB,CAAuBhB,OAAjD,IAA4D3F,GAAGG,OAAH,CAAWkG,KAAX,CAAiBM,KAAjB,CAAuBnG,KAAvF,EAA8F;EAC5F,cAAQR,GAAGG,OAAH,CAAWkG,KAAX,CAAiBM,KAAjB,CAAuBnG,KAA/B;EACA,aAAK,cAAL;EACE;EACF,aAAK,UAAL;EACEO,sBAAA,CAAa,qBAAb,EAAoCoC,IAApC,CAAyC,kBAAzC,EAA6D,MAA7D;EACA;EALF;EAOD;EACD;EACA,QAAInD,GAAGG,OAAH,CAAWkG,KAAX,CAAiBrE,MAAjB,IAA2BhC,GAAGG,OAAH,CAAWkG,KAAX,CAAiBrE,MAAjB,CAAwB2D,OAAnD,IAA8D3F,GAAGG,OAAH,CAAWkG,KAAX,CAAiBrE,MAAjB,CAAwB6L,MAA1F,EAAkG;EAChG9M,eAAA,CAAU,kBAAV,EAA8BoC,IAA9B,CAAmC,QAAnC,EAA6CnD,GAAGG,OAAH,CAAWkG,KAAX,CAAiBrE,MAAjB,CAAwB6L,MAArE;EACD;;EAED;EACA,QAAI7N,GAAGG,OAAH,CAAWkG,KAAX,CAAiBrE,MAAjB,IAA2BhC,GAAGG,OAAH,CAAWkG,KAAX,CAAiBrE,MAAjB,CAAwB2D,OAAnD,IAA8D3F,GAAGG,OAAH,CAAWkG,KAAX,CAAiBrE,MAAjB,CAAwB,cAAxB,CAAlE,EAA2G;EACzGjB,eAAA,CAAU,kBAAV,EAA8BoC,IAA9B,CAAmC,cAAnC,EAAmDnD,GAAGG,OAAH,CAAWkG,KAAX,CAAiBrE,MAAjB,CAAwB,cAAxB,CAAnD;EACD;;EAED;;EAEA;;EAEA;;EAEA,QAAI,CAAChC,GAAGG,OAAH,CAAW6G,KAAZ,IAAsBhH,GAAGG,OAAH,CAAW6G,KAAX,IAAoBhH,GAAGG,OAAH,CAAW6G,KAAX,CAAiBrB,OAAjB,KAA6B,KAA3E,EAAmF;;EAEjF;EACA,UAAI3F,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAAjB,IAA0B3G,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAAjB,CAAuBnG,KAArD,EAA4D;EAC1DuH,eAAO+F,IAAP,CAAY9N,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAAjB,CAAuBnG,KAAnC,EAA0CiK,OAA1C,CAAkD,UAAUsD,CAAV,EAAa;EAC7D/N,aAAGqN,MAAH,CAAUpB,SAAV,CAAoB,MAApB,EACGzL,KADH,CACSuN,CADT,EACY/N,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAAjB,CAAuBnG,KAAvB,CAA6BuN,CAA7B,CADZ;EAED,SAHD;EAID;;EAED;EACA,UAAI/N,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAAjB,IAA0B3G,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAAjB,CAAuB6G,MAArD,EAA6D;EAC3DxN,WAAGqN,MAAH,CAAUpB,SAAV,CAAoB,MAApB,EACG9I,IADH,CACQ,aADR,EACuB,KADvB,EAEGA,IAFH,CAEQ,WAFR,EAEqB,YAAYnD,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAAjB,CAAuB6G,MAAnC,GAA4C,GAFjE;EAGD;;EAED;EACA,UAAIxN,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAAjB,IAA0B3G,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAAjB,CAAuBhB,OAAjD,IAA4D3F,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAAjB,CAAuBnG,KAAvF,EAA8F;EAC5F,gBAAQR,GAAGG,OAAH,CAAW6G,KAAX,CAAiBL,KAAjB,CAAuBnG,KAA/B;EACA,eAAK,cAAL;EACE;EACF,eAAK,UAAL;EACEO,wBAAA,CAAaf,GAAGG,OAAH,CAAW0H,MAAX,GAAoB,sBAAjC,EAAyD1E,IAAzD,CAA8D,kBAA9D,EAAkF,MAAlF;EACA;EALF;EAOD;EAEF;;EAED;EACA,QAAInD,GAAGG,OAAH,CAAW6G,KAAX,CAAiBhF,MAAjB,IAA2BhC,GAAGG,OAAH,CAAW6G,KAAX,CAAiBhF,MAAjB,CAAwB2D,OAAnD,IAA8D3F,GAAGG,OAAH,CAAW6G,KAAX,CAAiBhF,MAAjB,CAAwB6L,MAA1F,EAAkG;EAChG9M,eAAA,CAAUf,GAAGG,OAAH,CAAW0H,MAAX,GAAoB,mBAA9B,EAAmD1E,IAAnD,CAAwD,QAAxD,EAAkEnD,GAAGG,OAAH,CAAW6G,KAAX,CAAiBhF,MAAjB,CAAwB6L,MAA1F;EACD;;EAED;EACA,QAAI7N,GAAGG,OAAH,CAAW6G,KAAX,CAAiBhF,MAAjB,IAA2BhC,GAAGG,OAAH,CAAW6G,KAAX,CAAiBhF,MAAjB,CAAwB2D,OAAnD,IAA8D3F,GAAGG,OAAH,CAAW6G,KAAX,CAAiBhF,MAAjB,CAAwB,cAAxB,CAAlE,EAA2G;EACzGjB,eAAA,CAAUf,GAAGG,OAAH,CAAW0H,MAAX,GAAoB,mBAA9B,EAAmD1E,IAAnD,CAAwD,cAAxD,EAAwEnD,GAAGG,OAAH,CAAW6G,KAAX,CAAiBhF,MAAjB,CAAwB,cAAxB,CAAxE;EACD;;EAED;EACA;;;;;;;;;;;EAWD,GAveD;;EAyeAyC,QAAMoI,UAAN,GAAmB,UAAUvG,IAAV,EAAgBlE,KAAhB,EAAuB;EACxC,QAAMpC,KAAK,IAAX;;EAEA,QAAIsG,SAAS,GAAb,EAAkB;EAChBtG,SAAGG,OAAH,CAAW6G,KAAX,CAAiB2F,QAAjB,CAA0BM,OAA1B,CAAkCnN,GAAlC,CAAsC,UAACkO,GAAD,EAAS;EAC7C,YAAIA,IAAI5L,KAAJ,KAAcA,KAAlB,EAAyB;EACvB4L,cAAId,QAAJ,GAAe,IAAf;EACD,SAFD,MAEO;EACLc,cAAId,QAAJ,GAAe,KAAf;EACD;EACF,OAND;EAOD,KARD,MAQO,IAAI5G,SAAS,GAAb,EAAkB;EACvBtG,SAAGG,OAAH,CAAWkG,KAAX,CAAiBsG,QAAjB,CAA0BM,OAA1B,CAAkCnN,GAAlC,CAAsC,UAACkO,GAAD,EAAS;EAC7C,YAAIA,IAAI5L,KAAJ,KAAcA,KAAlB,EAAyB;EACvB4L,cAAId,QAAJ,GAAe,IAAf;EACD,SAFD,MAEO;EACLc,cAAId,QAAJ,GAAe,KAAf;EACD;EACF,OAND;EAOD;;EAEDlN,OAAGG,OAAH,CAAWmG,IAAX,IAAmBlE,KAAnB;;EAEA,QAAI+F,QAAQnI,GAAGuH,MAAH,CAAU,CAAV,CAAZ;;EAEAY,UAAMhI,OAAN,GAAgBH,GAAGG,OAAnB;;EAEAH,OAAGuI,IAAH;;EAEA;EACA,QAAIvI,GAAGG,OAAH,CAAW+I,MAAX,IAAqBlJ,GAAGG,OAAH,CAAW+I,MAAX,CAAkB+E,MAA3C,EAAmD;EACjDjO,SAAGoJ,QAAH,CAAYtF,EAAZ,CAAe,aAAf,EAA8B9D,GAAGG,OAAH,CAAW+I,MAAX,CAAkB+E,MAAlB,CAAyBjO,EAAzB,CAA9B;EACD;EACF,GAjCD;;EAqCAyE,QAAM2E,QAAN,GAAiBrI,WAAA,CAAY,MAAZ,EAAoB,QAApB,CAAjB;;EAEA0D,QAAM0F,OAAN,GAAgB,UAAUzK,IAAV,EAAgBN,QAAhB,EAA0B;EACxCA,aAAS,IAAT,EAAeM,IAAf;EACD,GAFD;;EAIA+E,QAAMyJ,UAAN,GAAmB,UAAUxO,IAAV,EAAgB;EACjC,QAAMM,KAAK,IAAX;;EAEA,QAAImB,UAAU,EAAd;EACA,QAAIgN,SAAS,EAAb;EACA,QAAIC,SAAS,EAAb;;EAGA;EACA,QAAIC,gBAAgB,uBAAUjK,CAAV,EAAaC,CAAb,EAAgB;EAClC,aAAOrE,GAAGc,KAAH,CAASqD,aAAT,CAAuBC,EAAElB,CAAzB,EAA4BmB,EAAEnB,CAA9B,CAAP;EACD,KAFD;EAGA,QAAIoL,gBAAgB,uBAAUlK,CAAV,EAAaC,CAAb,EAAgB;EAClC,aAAOrE,GAAGc,KAAH,CAASqD,aAAT,CAAuBC,EAAEkF,CAAzB,EAA4BjF,EAAEiF,CAA9B,CAAP;EACD,KAFD;;EAKA;EACA,QAAItJ,GAAGG,OAAH,CAAWT,IAAX,CAAgB6O,IAAhB,IAAwBvO,GAAGG,OAAH,CAAWT,IAAX,CAAgB6O,IAAhB,CAAqBC,KAAjD,EAAwD;EACtD,cAAQxO,GAAGG,OAAH,CAAWT,IAAX,CAAgB6O,IAAhB,CAAqBC,KAA7B;EACA,aAAK,KAAL;EACEH,0BAAgB,uBAAUjK,CAAV,EAAaC,CAAb,EAAgB;EAC9B,mBAAOrE,GAAGc,KAAH,CAASqD,aAAT,CAAuBC,EAAElB,CAAzB,EAA4BmB,EAAEnB,CAA9B,CAAP;EACD,WAFD;EAGAoL,0BAAgB,uBAAUlK,CAAV,EAAaC,CAAb,EAAgB;EAC9B,mBAAOrE,GAAGc,KAAH,CAASqD,aAAT,CAAuBC,EAAEkF,CAAzB,EAA4BjF,EAAEiF,CAA9B,CAAP;EACD,WAFD;EAGA;;EAEF,aAAK,MAAL;EACE+E,0BAAgB,uBAAUjK,CAAV,EAAaC,CAAb,EAAgB;EAC9B,mBAAOrE,GAAGc,KAAH,CAAS0D,cAAT,CAAwBJ,EAAElB,CAA1B,EAA6BmB,EAAEnB,CAA/B,CAAP;EACD,WAFD;EAGAoL,0BAAgB,uBAAUlK,CAAV,EAAaC,CAAb,EAAgB;EAC9B,mBAAOrE,GAAGc,KAAH,CAAS0D,cAAT,CAAwBJ,EAAEkF,CAA1B,EAA6BjF,EAAEiF,CAA/B,CAAP;EACD,WAFD;EAGA;EAjBF;EAmBD;;EAGD;EACA,QAAItJ,GAAGG,OAAH,CAAW6G,KAAX,IAAoBhH,GAAGG,OAAH,CAAW6G,KAAX,CAAiB9F,KAAzC,EAAgD;EAC9C,cAAQlB,GAAGG,OAAH,CAAW6G,KAAX,CAAiB9F,KAAzB;EACA,aAAK,QAAL;EACEiN,mBAASpN,SAAA,CAAUrB,IAAV,EAAgB,UAAU4B,CAAV,EAAa;EACpC,mBAAOA,EAAEgI,CAAT;EACD,WAFQ,CAAT;EAGAnI,kBAAQmI,CAAR,GAAY6E,MAAZ;EACA;;EAEF,aAAK,MAAL;EACEA,mBAASpN,SAAA,CAAUrB,IAAV,EAAgB,UAAU4B,CAAV,EAAa;EACpC,mBAAOA,EAAEgI,CAAT;EACD,WAFQ,CAAT;EAGAnI,kBAAQmI,CAAR,GAAY6E,MAAZ;EACA;;EAEF,aAAK,SAAL;;EAEE;EACA,cAAInO,GAAGG,OAAH,CAAWT,IAAX,CAAgB6O,IAAhB,IAAwBvO,GAAGG,OAAH,CAAWT,IAAX,CAAgB6O,IAAhB,CAAqBjI,IAArB,KAA8B,GAA1D,EAA+D;EAC7D8H,qBAAS1O,KAAK6O,IAAL,CAAUF,aAAV,CAAT;EACD,WAFD,MAEO;EACLD,qBAAS1O,KAAK6O,IAAL,CAAUD,aAAV,CAAT;EACD;;EAEDnN,kBAAQmI,CAAR,GAAY,EAAZ;EACA8E,iBAAO3D,OAAP,CAAe,UAAUnJ,CAAV,EAAa;EAC1BH,oBAAQmI,CAAR,CAAU7F,IAAV,CAAenC,EAAEgI,CAAjB;EACD,WAFD;;EAIA;;EAEF,aAAK,UAAL;;EAEE;EACA,cAAItJ,GAAGG,OAAH,CAAWT,IAAX,CAAgB6O,IAAhB,IAAwBvO,GAAGG,OAAH,CAAWT,IAAX,CAAgB6O,IAAhB,CAAqBjI,IAArB,KAA8B,GAA1D,EAA+D;EAC7D8H,qBAAS1O,KAAK6O,IAAL,CAAUF,aAAV,CAAT;EACD,WAFD,MAEO;EACLD,qBAAS1O,KAAK6O,IAAL,CAAUD,aAAV,CAAT;EACD;;EAEDnN,kBAAQqH,CAAR,GAAY,EAAZ;EACA4F,iBAAO3D,OAAP,CAAe,UAAUnJ,CAAV,EAAa;EAC1BH,oBAAQqH,CAAR,CAAU/E,IAAV,CAAenC,EAAEgI,CAAjB;EACD,WAFD;;EAIAnI,kBAAQmI,CAAR,GAAYvI,QAAA,CAASf,GAAGG,OAAH,CAAW6G,KAAX,CAAiBuC,OAA1B,CAAZ;;EAEA;;EAGF;EACE4E,mBAASpN,SAAA,CAAUrB,IAAV,EAAgB,UAAU4B,CAAV,EAAa;EACpC,mBAAOA,EAAEgI,CAAT;EACD,WAFQ,CAAT;EAGAnI,kBAAQmI,CAAR,GAAY6E,MAAZ;EACA;EAvDF;EAyDD,KA1DD,MA0DO;EACLA,eAASpN,SAAA,CAAUrB,IAAV,EAAgB,UAAU4B,CAAV,EAAa;EACpC,eAAOA,EAAEgI,CAAT;EACD,OAFQ,CAAT;EAGAnI,cAAQmI,CAAR,GAAY6E,MAAZ;EACD;;EAED;EACA,QAAInO,GAAGG,OAAH,CAAWkG,KAAX,IAAoBrG,GAAGG,OAAH,CAAWkG,KAAX,CAAiBnF,KAAzC,EAAgD;EAC9C,cAAQlB,GAAGG,OAAH,CAAWkG,KAAX,CAAiBnF,KAAzB;EACA,aAAK,QAAL;EACEiN,mBAASpN,SAAA,CAAUrB,IAAV,EAAgB,UAAU4B,CAAV,EAAa;EACpC,mBAAOA,EAAE4B,CAAT;EACD,WAFQ,CAAT;;EAIA;EACA;EACA,cAAIiL,OAAO,CAAP,IAAY,CAAhB,EAAmB;EACjBA,mBAAO,CAAP,IAAYA,OAAO,CAAP,IAAY,CAACA,OAAO,CAAP,IAAYA,OAAO,CAAP,CAAb,IAA0B,EAAlD;EACD;EACDhN,kBAAQ+B,CAAR,GAAYiL,MAAZ;EACA;;EAEF,aAAK,MAAL;EACEA,mBAASpN,SAAA,CAAUrB,IAAV,EAAgB,UAAU4B,CAAV,EAAa;EACpC,mBAAOA,EAAE4B,CAAT;EACD,WAFQ,CAAT;EAGA/B,kBAAQ+B,CAAR,GAAYiL,MAAZ;EACA;;EAEF,aAAK,SAAL;EACE,cAAInO,GAAGG,OAAH,CAAWT,IAAX,CAAgB6O,IAAhB,IAAwBvO,GAAGG,OAAH,CAAWT,IAAX,CAAgB6O,IAAhB,CAAqBjI,IAArB,KAA8B,GAA1D,EAA+D;;EAE7D8H,qBAAS1O,KAAK6O,IAAL,CAAU,UAAUnK,CAAV,EAAaC,CAAb,EAAgB;EACjC,qBAAOrE,GAAGc,KAAH,CAASqD,aAAT,CAAuBC,EAAElB,CAAzB,EAA4BmB,EAAEnB,CAA9B,CAAP;EACD,aAFQ,CAAT;EAGA/B,oBAAQ+B,CAAR,GAAY,EAAZ;EACAkL,mBAAO3D,OAAP,CAAe,UAAUnJ,CAAV,EAAa;EAC1BH,sBAAQ+B,CAAR,CAAUO,IAAV,CAAenC,EAAEgI,CAAjB;EACD,aAFD;EAID,WAVD,MAUO;EACLnI,oBAAQ+B,CAAR,GAAYnC,MAAA,CAAOrB,IAAP,EAAa,UAAU4B,CAAV,EAAa;EACpC,qBAAOA,EAAE4B,CAAT;EACD,aAFW,EAET4K,IAFS,GAEFS,IAFE,CAEG,UAAUnK,CAAV,EAAaC,CAAb,EAAgB;EAC7B,qBAAOrE,GAAGc,KAAH,CAASqD,aAAT,CAAuBC,CAAvB,EAA0BC,CAA1B,CAAP;EACD,aAJW,CAAZ;EAKD;;EAED;;EAEF;EACE8J,mBAASpN,SAAA,CAAUrB,IAAV,EAAgB,UAAU4B,CAAV,EAAa;EACpC,mBAAOA,EAAE4B,CAAT;EACD,WAFQ,CAAT;EAGA/B,kBAAQ+B,CAAR,GAAYiL,MAAZ;EACA;EA/CF;EAiDD,KAlDD,MAkDO;EACLA,eAASpN,SAAA,CAAUrB,IAAV,EAAgB,UAAU4B,CAAV,EAAa;EACpC,eAAOA,EAAE4B,CAAT;EACD,OAFQ,CAAT;EAGA/B,cAAQ+B,CAAR,GAAYiL,MAAZ;EACD;;EAGD,WAAOhN,OAAP;EACD,GAvKD;;EAyKAsD,QAAMgK,OAAN,GAAgB,YAAY;EAC1B,QAAMzO,KAAK,IAAX;EACAe,aAAA,CAAUf,GAAGG,OAAH,CAAW0H,MAArB,EAA6BiD,IAA7B,CAAkC,EAAlC;EACD,GAHD;;EAKArG,QAAMC,IAAN,CAAWvF,MAAX;;EAEA,SAAOsF,KAAP;EACD;;EC9kDD;;;AAGA,EAAe,eAAUtF,MAAV,EAAkBqI,MAAlB,EAA0B;;EAEvC;EACA,MAAIkH,OAAO3G,OAAO4G,MAAP,CAAcnH,MAAd,CAAX;;EAEAkH,OAAKhK,IAAL,GAAY,UAAUvF,MAAV,EAAkB;EAC5B,QAAIa,KAAK,IAAT;;EAEAA,OAAGG,OAAH,GAAahB,SAASA,MAAT,GAAkB,EAA/B;EACAa,OAAGkH,KAAH,GAAW,EAAX;EACAlH,OAAGqH,OAAH,GAAa,EAAb;EACArH,OAAG4O,IAAH,GAAU5O,GAAGc,KAAH,CAASC,EAAT,CAAYC,GAAZ,GACPmC,IADO,CACF,OADE,EACO,QADP,EAEP0L,SAFO,CAEG,GAFH,EAGP/D,IAHO,CAGF9K,GAAGG,OAAH,CAAWa,GAAX,IAAkB,UAAUM,CAAV,EAAa;EACnC,UAAIwJ,OAAO,EAAX;EACAA,cAAQxJ,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,IAAmB,YAAYhF,OAAOC,KAAP,CAAa,CAACjD,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,CAAd,KAAkCtJ,GAAGG,OAAH,CAAW6G,KAAX,CAAiB9F,KAAjB,KAA2B,MAA7D,GAAsEI,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,CAAtE,GAAwFtJ,GAAGc,KAAH,CAASqB,MAAT,CAAgBb,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,CAAhB,CAApG,IAAwI,cAA3J,GAA6K,EAArL;EACAwB,cAAQxJ,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,IAAmB,YAAYoB,OAAOC,KAAP,CAAa,CAACjD,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,CAAd,KAAkClD,GAAGG,OAAH,CAAWkG,KAAX,CAAiBnF,KAAjB,KAA2B,MAA7D,GAAsEI,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,CAAtE,GAAwFlD,GAAGc,KAAH,CAASqB,MAAT,CAAgBb,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,CAAhB,CAApG,IAAwI,cAA3J,GAA6K,EAArL;EACA,aAAO4H,IAAP;EACD,KARO,CAAV;EASD,GAfD;;EAkBA;EACA;EACA4D,OAAKI,EAAL,GAAU,UAAUC,UAAV,EAAsB;EAC9B,QAAI/O,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAW2O,EAAX,GAAgBC,UAAhB;EACA,WAAO/O,EAAP;EACD,GAJD;;EAMA0O,OAAKpF,CAAL,GAAS,UAAUyF,UAAV,EAAsB;EAC7B,QAAI/O,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWmJ,CAAX,GAAeyF,UAAf;EACA,WAAO/O,EAAP;EACD,GAJD;;EAMA0O,OAAKxL,CAAL,GAAS,UAAU6L,UAAV,EAAsB;EAC7B,QAAI/O,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAW+C,CAAX,GAAe6L,UAAf;EACA,WAAO/O,EAAP;EACD,GAJD;;EAMA;;;;EAIA0O,OAAKrN,OAAL,GAAe,UAAU2N,OAAV,EAAmB;EAChC,QAAIhP,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWkB,OAAX,GAAqB2N,OAArB;EACA,WAAOhP,EAAP;EACD,GAJD;;EAMA;;;;EAIA0O,OAAKlN,OAAL,GAAe,UAAUuN,UAAV,EAAsB;EACnC,QAAI/O,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWqB,OAAX,GAAqBuN,UAArB;EACA,WAAO/O,EAAP;EACD,GAJD;;EAMA;;;;EAIA0O,OAAKO,IAAL,GAAY,UAAUF,UAAV,EAAsB;EAChC,QAAI/O,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAW8O,IAAX,GAAkBF,UAAlB;EACA,WAAO/O,EAAP;EACD,GAJD;;EAMA;;;;EAIA0O,OAAKQ,MAAL,GAAc,UAAUA,MAAV,EAAkB;EAC9B,QAAIlP,KAAK,IAAT;EACA,QAAI6B,MAAMC,OAAN,CAAcoN,MAAd,CAAJ,EAA2B;EACzB;EACAlP,SAAGG,OAAH,CAAW+O,MAAX,GAAoBA,MAApB;EACD,KAHD,MAGO;EACL;EACAlP,SAAGqH,OAAH,CAAWjC,KAAX,GAAmB8J,MAAnB;EACD;EACD,WAAOlP,EAAP;EACD,GAVD;;EAYA0O,OAAKS,MAAL,GAAc,UAAUC,MAAV,EAAkB;EAC9B;EACA;EACA,QAAIpP,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWgP,MAAX,GAAoBC,MAApB;EACA,WAAOpP,EAAP;EACD,GAND;;EAQA0O,OAAKvM,MAAL,GAAc,UAAUA,MAAV,EAAkB;EAC9B,QAAInC,KAAK,IAAT;EACA,QAAI,OAAOmC,MAAP,IAAiB,UAAjB,IAA+BA,kBAAkBkN,QAArD,EAA+D;EAC7DrP,SAAGc,KAAH,CAASqB,MAAT,GAAkBA,MAAlB;EACD,KAFD,MAEO;EACLnC,SAAGc,KAAH,CAASqB,MAAT,GAAkBpB,SAAA,CAAUoB,MAAV,CAAlB;EACD;EACD,WAAOnC,EAAP;EACD,GARD;;EAUA0O,OAAK1N,GAAL,GAAW,UAAUA,GAAV,EAAe;EACxB,QAAIhB,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWa,GAAX,GAAiBA,GAAjB;EACA,WAAOhB,EAAP;EACD,GAJD;;EAMA0O,OAAK5I,MAAL,GAAc,UAAUA,MAAV,EAAkB;EAC9B,QAAI9F,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAW2F,MAAX,GAAoBA,MAApB;EACA,WAAO9F,EAAP;EACD,GAJD;;EAOA;EACA;EACA0O,OAAKhP,IAAL,GAAY,UAAUA,IAAV,EAAgB;EAC1B,QAAIM,KAAK,IAAT;;EAEA,QAAIA,GAAGG,OAAH,CAAWmP,MAAf,EAAuB;EACrB;EACA5P,aAAOA,KAAK4P,MAAL,CAAYtP,GAAGG,OAAH,CAAWmP,MAAvB,CAAP;EACD;;EAED,QAAItP,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,SAA1B,KAAwCtJ,MAAMC,OAAN,CAAc9B,GAAGG,OAAH,CAAWqB,OAAzB,CAAxC,IAA6ExB,GAAGG,OAAH,CAAWqB,OAAX,CAAmBqC,MAAnB,GAA4B,CAA7G,EAAgH;EAC9G;EACA7D,SAAGkH,KAAH,GAAWnG,QAAA,GAAW+M,IAAX,CAAgB9N,GAAGG,OAAH,CAAWqB,OAA3B,EAAoC9B,IAApC,CAAX;EACD,KAHD,MAGO;EACL;EACAM,SAAGkH,KAAH,GAAWxH,KAAKI,GAAL,CAAS,UAAUwB,CAAV,EAAa;EAC/B,YAAIA,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,KAAmBhF,OAAOhD,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,CAAP,CAAvB,EACEhI,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,IAAkB,CAAChI,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,CAAnB;EACF,YAAIhI,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,KAAmBoB,OAAOhD,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,CAAP,CAAvB,EACE5B,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,IAAkB,CAAC5B,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,CAAnB;EACF,eAAO5B,CAAP;EACD,OANU,CAAX;EAOD;;EAED;EACA,QAAItB,GAAGG,OAAH,CAAWgP,MAAf,EAAuB;EACrBnP,SAAGkH,KAAH,GAAWlH,GAAGkH,KAAH,CAASqH,IAAT,CAAc,UAAUnK,CAAV,EAAaC,CAAb,EAAgB;EACvC,eAAOD,EAAEpE,GAAGG,OAAH,CAAWgP,MAAX,CAAkB,CAAlB,CAAF,IAA0B9K,EAAErE,GAAGG,OAAH,CAAWgP,MAAX,CAAkB,CAAlB,CAAF,CAAjC;EACD,OAFU,CAAX;EAGD;;EAED,QAAInP,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,WAA1B,CAAJ,EAA4C;EAC1CnL,SAAGuP,UAAH,GAAgBvP,GAAGwP,kBAAH,CAAsB9P,IAAtB,CAAhB;EACAM,SAAGyP,OAAH,GAAa1O,SAAA,CAAUrB,IAAV,EAAgB,UAAU4B,CAAV,EAAa;EACxC,eAAO,CAACA,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb,CAAR;EACD,OAFY,CAAb;EAGD;;EAED,WAAOjP,EAAP;EACD,GArCD;;EAuCA0O,OAAKjG,MAAL,GAAc,YAAY;EACxB,QAAIzI,KAAK,IAAT;EACA,QAAIb,MAAJ;EACA;EACA;;;;;;;EAOA;EACA,QAAIa,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,GAA1B,KAAkCnL,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,GAA1B,CAAtC,EAAsE;EACpEhM,eAAS;EACPoC,gBAAQvB,GAAGG,OAAH,CAAWmJ,CADZ;EAEP3H,cAAM3B,GAAGG,OAAH,CAAW6G,KAAX,CAAiB9F,KAFhB;EAGPE,eAAO,CAAC,CAAD,EAAIpB,GAAGE,KAAH,CAASE,KAAb,CAHA;EAIPwB,iBAAS5B,GAAGG,OAAH,CAAW6G,KAAX,CAAiBpF;EAJnB,OAAT;EAMA,UAAI5B,GAAGG,OAAH,CAAW6G,KAAX,CAAiB7F,OAArB,EAA8B;EAC5BhC,eAAOgC,OAAP,GAAiBnB,GAAGG,OAAH,CAAW6G,KAAX,CAAiB7F,OAAlC;EACD;EACDnB,SAAGqH,OAAH,CAAWiC,CAAX,GAAetJ,GAAGc,KAAH,CAASG,aAAT,CAAuBjB,GAAGkH,KAA1B,EAAiC/H,MAAjC,CAAf;;EAEAA,eAAS;EACPoC,gBAAQvB,GAAGG,OAAH,CAAW+C,CADZ;EAEPvB,cAAM3B,GAAGG,OAAH,CAAWkG,KAAX,CAAiBnF,KAFhB;EAGPE,eAAO,CAACpB,GAAGE,KAAH,CAASI,MAAV,EAAkB,CAAlB,CAHA;EAIPsB,iBAAS5B,GAAGG,OAAH,CAAWkG,KAAX,CAAiBzE;EAJnB,OAAT;EAMA,UAAI5B,GAAGG,OAAH,CAAWkG,KAAX,CAAiBlF,OAArB,EAA8B;EAC5BhC,eAAOgC,OAAP,GAAiBnB,GAAGG,OAAH,CAAWkG,KAAX,CAAiBlF,OAAlC;EACD;EACDnB,SAAGqH,OAAH,CAAWnE,CAAX,GAAelD,GAAGc,KAAH,CAASG,aAAT,CAAuBjB,GAAGkH,KAA1B,EAAiC/H,MAAjC,CAAf;EACD;;EAED;EACA,QAAIa,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,GAA1B,KAAkCnL,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,SAA1B,CAAtC,EAA4E;EAC1E;EACAhM,eAAS;EACPoC,gBAAQvB,GAAGG,OAAH,CAAWmJ,CADZ;EAEP3H,cAAM3B,GAAGG,OAAH,CAAW6G,KAAX,CAAiB9F,KAFhB;EAGPG,iBAAS,QAHF;EAIPD,eAAO,CAAC,CAAD,EAAIpB,GAAGE,KAAH,CAASE,KAAb,CAJA;EAKPwB,iBAAS5B,GAAGG,OAAH,CAAW6G,KAAX,CAAiBpF;EALnB,OAAT;EAOA,UAAI5B,GAAGG,OAAH,CAAW6G,KAAX,CAAiB7F,OAArB,EAA8B;EAC5BhC,eAAOgC,OAAP,GAAiBnB,GAAGG,OAAH,CAAW6G,KAAX,CAAiB7F,OAAlC;EACD;EACDnB,SAAGqH,OAAH,CAAWiC,CAAX,GAAetJ,GAAGc,KAAH,CAASG,aAAT,CAAuBjB,GAAGkH,KAA1B,EAAiC/H,MAAjC,CAAf;;EAEA;EACAA,eAAS;EACPoC,gBAAQvB,GAAGG,OAAH,CAAWkB,OADZ;EAEPM,cAAM,MAFC;EAGPN,iBAAS,UAHF;EAIPD,eAAO,CAAC,CAAD,EAAIpB,GAAGqH,OAAH,CAAWiC,CAAX,CAAasE,SAAb,EAAJ;EAJA,OAAT;EAMA5N,SAAGqH,OAAH,CAAWhG,OAAX,GAAqBrB,GAAGc,KAAH,CAASG,aAAT,CAAuBjB,GAAGkH,KAA1B,EAAiC/H,MAAjC,CAArB;EACA;;EAEA;EACAA,eAAS;EACPoC,gBAAQvB,GAAGG,OAAH,CAAWkB,OADZ;EAEPM,cAAM3B,GAAGG,OAAH,CAAWkG,KAAX,CAAiBnF,KAFhB;EAGPG,iBAAS,MAHF;EAIPD,eAAO,CAACpB,GAAGE,KAAH,CAASI,MAAV,EAAkB,CAAlB,CAJA;EAKPsB,iBAAS5B,GAAGG,OAAH,CAAWkG,KAAX,CAAiBzE;EALnB,OAAT;EAOA,UAAG5B,GAAGG,OAAH,CAAWkG,KAAX,CAAiBlF,OAApB,EAA6B;EAC3BhC,eAAOgC,OAAP,GAAiBnB,GAAGG,OAAH,CAAWkG,KAAX,CAAiBlF,OAAlC;EACD;EACDnB,SAAGqH,OAAH,CAAWnE,CAAX,GAAelD,GAAGc,KAAH,CAASG,aAAT,CAAuBjB,GAAGkH,KAA1B,EAAiC/H,MAAjC,CAAf;EACD;;EAED;EACA,QAAIa,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,GAA1B,KAAkCnL,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,SAA1B,CAAtC,EAA4E;EAC1E;EACAhM,eAAS;EACPoC,gBAAQvB,GAAGG,OAAH,CAAW+C,CADZ;EAEPvB,cAAM3B,GAAGG,OAAH,CAAWkG,KAAX,CAAiBnF,KAFhB;EAGPG,iBAAS,QAHF;EAIPD,eAAO,CAAC,CAAD,EAAIpB,GAAGE,KAAH,CAASI,MAAb,CAJA;EAKPsB,iBAAS5B,GAAGG,OAAH,CAAWkG,KAAX,CAAiBzE;EALnB,OAAT;EAOA,UAAI5B,GAAGG,OAAH,CAAWkG,KAAX,CAAiBlF,OAArB,EAA8B;EAC5BhC,eAAOgC,OAAP,GAAiBnB,GAAGG,OAAH,CAAWkG,KAAX,CAAiBlF,OAAlC;EACD;EACDnB,SAAGqH,OAAH,CAAWnE,CAAX,GAAelD,GAAGc,KAAH,CAASG,aAAT,CAAuBjB,GAAGkH,KAA1B,EAAiC/H,MAAjC,CAAf;;EAEA;EACAA,eAAS;EACPoC,gBAAQvB,GAAGG,OAAH,CAAWkB,OADZ;EAEPM,cAAM,MAFC;EAGPN,iBAAS,UAHF;EAIPD,eAAO,CAAC,CAAD,EAAIpB,GAAGqH,OAAH,CAAWnE,CAAX,CAAa0K,SAAb,EAAJ;EAJA,OAAT;EAMA5N,SAAGqH,OAAH,CAAWhG,OAAX,GAAqBrB,GAAGc,KAAH,CAASG,aAAT,CAAuBjB,GAAGkH,KAA1B,EAAiC/H,MAAjC,CAArB;EACA;;EAEA;EACAA,eAAS;EACPoC,gBAAQvB,GAAGG,OAAH,CAAWkB,OADZ;EAEPM,cAAM3B,GAAGG,OAAH,CAAW6G,KAAX,CAAiB9F,KAFhB;EAGPG,iBAAS,MAHF;EAIPD,eAAO,CAAC,CAAD,EAAIpB,GAAGE,KAAH,CAASE,KAAb,CAJA;EAKPwB,iBAAS5B,GAAGG,OAAH,CAAW6G,KAAX,CAAiBpF;EALnB,OAAT;EAOA,UAAI5B,GAAGG,OAAH,CAAW6G,KAAX,CAAiB7F,OAArB,EAA8B;EAC5BhC,eAAOgC,OAAP,GAAiBnB,GAAGG,OAAH,CAAW6G,KAAX,CAAiB7F,OAAlC;EACD;EACDnB,SAAGqH,OAAH,CAAWiC,CAAX,GAAetJ,GAAGc,KAAH,CAASG,aAAT,CAAuBjB,GAAGkH,KAA1B,EAAiC/H,MAAjC,CAAf;EACD;;EAGD;EACA,QAAIa,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,GAA1B,KAAkCnL,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,SAA1B,CAAtC,EAA4E;EAC1E;EACAhM,eAAS;EACPoC,gBAAQvB,GAAGG,OAAH,CAAWmJ,CADZ;EAEP3H,cAAM3B,GAAGG,OAAH,CAAW6G,KAAX,CAAiB9F,KAFhB;EAGPM,iBAAS,QAHF;EAIPJ,eAAO,CAAC,CAAD,EAAIpB,GAAGE,KAAH,CAASE,KAAb,CAJA;EAKPwB,iBAAS5B,GAAGG,OAAH,CAAW6G,KAAX,CAAiBpF;EALnB,OAAT;EAOA,UAAI5B,GAAGG,OAAH,CAAW6G,KAAX,CAAiB7F,OAArB,EAA8B;EAC5BhC,eAAOgC,OAAP,GAAiBnB,GAAGG,OAAH,CAAW6G,KAAX,CAAiB7F,OAAlC;EACD;EACDnB,SAAGqH,OAAH,CAAWiC,CAAX,GAAetJ,GAAGc,KAAH,CAASG,aAAT,CAAuBjB,GAAGkH,KAA1B,EAAiC/H,MAAjC,CAAf;;EAEA;EACAA,eAAS;EACPoC,gBAAQ,EADD;EAEPC,iBAAS,MAFF;EAGPG,cAAM3B,GAAGG,OAAH,CAAWkG,KAAX,CAAiBnF,KAHhB;EAIPE,eAAO,CAACpB,GAAGE,KAAH,CAASI,MAAV,EAAkB,CAAlB,CAJA;EAKPsB,iBAAS5B,GAAGG,OAAH,CAAWkG,KAAX,CAAiBzE;EALnB,OAAT;EAOA,UAAI5B,GAAGG,OAAH,CAAWkG,KAAX,CAAiBlF,OAArB,EAA8B;EAC5BhC,eAAOgC,OAAP,GAAiBnB,GAAGG,OAAH,CAAWkG,KAAX,CAAiBlF,OAAlC;EACD;EACDnB,SAAGqH,OAAH,CAAWnE,CAAX,GAAelD,GAAGc,KAAH,CAASG,aAAT,CAAuBjB,GAAGkH,KAA1B,EAAiC/H,MAAjC,CAAf;EACD;;EAED;EACA,QAAIa,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,GAA1B,KAAkCnL,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,SAA1B,CAAtC,EAA4E;EAC1E;EACAhM,eAAS;EACPoC,gBAAQ,EADD;EAEPI,cAAM3B,GAAGG,OAAH,CAAW6G,KAAX,CAAiB9F,KAFhB;EAGPM,iBAAS,MAHF;EAIPJ,eAAO,CAAC,CAAD,EAAIpB,GAAGE,KAAH,CAASE,KAAb,CAJA;EAKPwB,iBAAS5B,GAAGG,OAAH,CAAW6G,KAAX,CAAiBpF;EALnB,OAAT;EAOA,UAAI5B,GAAGG,OAAH,CAAW6G,KAAX,CAAiB7F,OAArB,EAA8B;EAC5BhC,eAAOgC,OAAP,GAAiBnB,GAAGG,OAAH,CAAW6G,KAAX,CAAiB7F,OAAlC;EACD;EACDnB,SAAGqH,OAAH,CAAWiC,CAAX,GAAetJ,GAAGc,KAAH,CAASG,aAAT,CAAuBjB,GAAGkH,KAA1B,EAAiC/H,MAAjC,CAAf;;EAEA;EACAA,eAAS;EACPoC,gBAAQvB,GAAGG,OAAH,CAAW+C,CADZ;EAEP1B,iBAAS,QAFF;EAGPG,cAAM3B,GAAGG,OAAH,CAAWkG,KAAX,CAAiBnF,KAHhB;EAIPE,eAAO,CAACpB,GAAGE,KAAH,CAASI,MAAV,EAAkB,CAAlB,CAJA;EAKPsB,iBAAS5B,GAAGG,OAAH,CAAWkG,KAAX,CAAiBzE;EALnB,OAAT;EAOA,UAAI5B,GAAGG,OAAH,CAAWkG,KAAX,CAAiBlF,OAArB,EAA8B;EAC5BhC,eAAOgC,OAAP,GAAiBnB,GAAGG,OAAH,CAAWkG,KAAX,CAAiBlF,OAAlC;EACD;EACDnB,SAAGqH,OAAH,CAAWnE,CAAX,GAAelD,GAAGc,KAAH,CAASG,aAAT,CAAuBjB,GAAGkH,KAA1B,EAAiC/H,MAAjC,CAAf;EACD;;EAGD;EACA;;EAEA,QAAIa,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,QAA1B,CAAJ,EACEnL,GAAGqH,OAAH,CAAWjC,KAAX,GAAmBrE,eAAA,CAAgBf,GAAGG,OAAH,CAAW+O,MAA3B,CAAnB,CADF,KAGElP,GAAGqH,OAAH,CAAWjC,KAAX,GAAmBrE,eAAA,CAAgBA,mBAAhB,CAAnB;;EAEF,WAAOf,EAAP;EACD,GAvLD;;EAyLA0O,OAAKgB,UAAL,GAAkB,YAAY;EAC5B,QAAI1P,KAAK,IAAT;;EAEA,QAAI2P,gBAAgB3P,GAAGE,KAAH,CAASU,GAAT,GAAeqL,SAAf,CAAyB,aAAzB,EACjBvM,IADiB,CACZM,GAAGkH,KADS,CAApB;;EAGAyI,kBAAczD,KAAd,GAAsB3I,MAAtB,CAA6B,MAA7B,EACGJ,IADH,CACQ,OADR,EACiB,YADjB,EAEGA,IAFH,CAEQ,GAFR,EAEa,UAAU7B,CAAV,EAAa;EACtB,UAAIc,QAAQpC,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,CAAb,CAAZ;EACA,UAAItJ,GAAGG,OAAH,CAAW6G,KAAX,CAAiB9F,KAAjB,IAA0B,QAA9B,EAAwC;EACtC,YAAII,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,IAAkB,CAAtB,EAAyB;EACvBlH,kBAAQpC,GAAGqH,OAAH,CAAWiC,CAAX,CAAa,CAAb,CAAR;EACD;EACF;EACD,aAAOlH,KAAP;EACD,KAVH,EAWGe,IAXH,CAWQ,GAXR,EAWa,UAAU7B,CAAV,EAAa;EACtB,UAAIc,QAASpC,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,CAAb,CAAb;EACA,UAAI0M,OAAO5P,GAAGqH,OAAH,CAAWnE,CAAX,CAAa0K,SAAb,GAAyB5N,GAAGqH,OAAH,CAAWnE,CAAX,CAAa0K,SAAb,EAAzB,GAAoDiC,KAAKC,GAAL,CAAS9P,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,CAAb,IAAgClD,GAAGqH,OAAH,CAAWnE,CAAX,CAAa,CAAb,CAAzC,CAA/D;EACA,UAAIlD,GAAGG,OAAH,CAAWkG,KAAX,CAAiBnF,KAAjB,KAA2B,QAA/B,EAAyC;EACvC,YAAII,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,IAAkB,CAAtB,EAAyB;EACvBd,kBAAQpC,GAAGqH,OAAH,CAAWnE,CAAX,CAAa,CAAb,CAAR;EACD;EACF,OAJD,MAIO,IAAIlD,GAAGG,OAAH,CAAWkG,KAAX,CAAiBnF,KAAjB,KAA2B,QAA/B,EAAyC;EAC9CkB,gBAAQA,QAAQwN,IAAhB;EACD;EACD;;;EAGA,aAAOxN,QAAQ,CAAf;EACD,KAzBH,EA0BGe,IA1BH,CA0BQ,WA1BR,EA0BqB,UAAS7B,CAAT,EAAY;EAC7B,UAAIyO,OAAO/P,GAAGqH,OAAH,CAAWiC,CAAX,CAAasE,SAAb,GAAyB5N,GAAGqH,OAAH,CAAWiC,CAAX,CAAasE,SAAb,EAAzB,GAAoDiC,KAAKC,GAAL,CAAS9P,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,CAAb,IAAgCtJ,GAAGqH,OAAH,CAAWiC,CAAX,CAAa,CAAb,CAAzC,CAA/D;EACA,UAAI,CAAC/E,MAAMjD,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,CAAN,CAAL,EAA6B;EAC3B,eAAO,eAAe6M,OAAK,CAApB,GAAwB,MAA/B;EACD;EACD,aAAO,gBAAgBA,OAAO,EAAvB,IAA6B,MAApC;EACD,KAhCH,EAiCGvN,IAjCH,CAiCS,UAASlB,CAAT,EAAY;EACjB,UAAI,CAACiD,MAAMjD,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,CAAN,CAAL,EAA6B;EAC3B,eAAOlD,GAAGc,KAAH,CAASqB,MAAT,CAAgBb,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,CAAhB,IAAmClD,GAAGc,KAAH,CAASqB,MAAT,CAAgBb,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,CAAhB,EAAiClD,GAAGG,OAAH,CAAW6P,QAA5C,CAAnC,GAA2F,EAAlG;EACD;EACD,aAAOhQ,GAAGc,KAAH,CAASqB,MAAT,CAAgBb,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,CAAhB,IAAmCtJ,GAAGc,KAAH,CAASqB,MAAT,CAAgBb,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,CAAhB,EAAiCtJ,GAAGG,OAAH,CAAW6P,QAA5C,CAAnC,GAA2F,EAAlG;EACD,KAtCH;;EAwCAL,kBAAczD,KAAd,GAAsB3I,MAAtB,CAA6B,MAA7B,EACGJ,IADH,CACQ,OADR,EACiB,wBADjB,EAEGA,IAFH,CAEQ,GAFR,EAEa,UAAU7B,CAAV,EAAa;EACtB,UAAIc,QAAQpC,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,CAAb,CAAZ;EACA,UAAItJ,GAAGG,OAAH,CAAW6G,KAAX,CAAiB9F,KAAjB,IAA0B,QAA9B,EAAwC;EACtC,YAAII,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,IAAkB,CAAtB,EAAyB;EACvBlH,kBAAQpC,GAAGqH,OAAH,CAAWiC,CAAX,CAAa,CAAb,CAAR;EACD;EACF;EACD,aAAOlH,KAAP;EACD,KAVH,EAWGe,IAXH,CAWQ,GAXR,EAWa,UAAU7B,CAAV,EAAa;EACtB,UAAIc,QAASpC,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,CAAb,CAAb;EACA,UAAI0M,OAAO5P,GAAGqH,OAAH,CAAWnE,CAAX,CAAa0K,SAAb,GAAyB5N,GAAGqH,OAAH,CAAWnE,CAAX,CAAa0K,SAAb,EAAzB,GAAoDiC,KAAKC,GAAL,CAAS9P,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,CAAb,IAAgClD,GAAGqH,OAAH,CAAWnE,CAAX,CAAa,CAAb,CAAzC,CAA/D;EACA,UAAIlD,GAAGG,OAAH,CAAWkG,KAAX,CAAiBnF,KAAjB,KAA2B,QAA/B,EAAyC;EACvC,YAAII,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,IAAkB,CAAtB,EAAyB;EACvBd,kBAAQpC,GAAGqH,OAAH,CAAWnE,CAAX,CAAa,CAAb,CAAR;EACD;EACF;EACD,UAAI0M,OAAO,EAAX,EAAe;EACb,eAAOxN,QAAQ,EAAf;EACD;EACD,aAAOA,QAAQ,EAAf;EACD,KAvBH,EAwBGe,IAxBH,CAwBQ,WAxBR,EAwBqB,UAAS7B,CAAT,EAAY;EAC7B,UAAIyO,OAAO/P,GAAGqH,OAAH,CAAWiC,CAAX,CAAasE,SAAb,GAAyB5N,GAAGqH,OAAH,CAAWiC,CAAX,CAAasE,SAAb,EAAzB,GAAoDiC,KAAKC,GAAL,CAAS9P,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,CAAb,IAAgCtJ,GAAGqH,OAAH,CAAWiC,CAAX,CAAa,CAAb,CAAzC,CAA/D;EACA,UAAI,CAAC/E,MAAMjD,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,CAAN,CAAL,EAA6B;EAC3B,eAAO,eAAe6M,OAAK,CAApB,GAAwB,MAA/B;EACD;EACD,aAAO,gBAAgBA,OAAO,EAAvB,IAA6B,MAApC;EACD,KA9BH,EA+BGvN,IA/BH,CA+BS,UAASlB,CAAT,EAAY;EACjB,aAAQA,EAAE2O,WAAF,IAAiB,CAAC3L,OAAOC,KAAP,CAAajD,EAAE2O,WAAf,CAAnB,GAAkD,MAAM3O,EAAE2O,WAAF,CAAcC,OAAd,CAAsB,CAAtB,CAAN,GAAiC,GAAnF,GAAyF,KAAhG;EACD,KAjCH;EAkCD,GAhFD;;EAkFAxB,OAAKnG,IAAL,GAAY,YAAY;EACtB,QAAIvI,KAAK,IAAT;;EAEA,QAAIA,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,SAA1B,CAAJ,EAA0C;EACxC,UAAInL,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,GAA1B,CAAJ,EAAoCnL,GAAGmQ,iBAAH;EACpC,UAAInQ,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,GAA1B,CAAJ,EAAoCnL,GAAGoQ,iBAAH;EACpC,aAAOpQ,EAAP;EACD;;EAED,QAAIA,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,SAA1B,CAAJ,EAA0C;EACxC,UAAInL,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,GAA1B,CAAJ,EAAoCnL,GAAGqQ,iBAAH;EACpC,UAAIrQ,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,GAA1B,CAAJ,EAAoCnL,GAAGsQ,iBAAH;EACpC,aAAOtQ,EAAP;EACD;;EAEDA,OAAGE,KAAH,CAASU,GAAT,GAAe2K,IAAf,CAAoBvL,GAAG4O,IAAvB;;EAEA5O,OAAGE,KAAH,CAASU,GAAT,GAAeqL,SAAf,CAAyB,MAAzB,EACGvM,IADH,CACQM,GAAGkH,KADX,EAEGgF,KAFH,GAEW3I,MAFX,CAEkB,MAFlB,EAGGJ,IAHH,CAGQ,OAHR,EAGiB,KAHjB,EAIGA,IAJH,CAIQ,IAJR,EAIc,UAAU7B,CAAV,EAAa2C,CAAb,EAAgB;EAC1B,UAAI6K,KAAK,UAAU7K,CAAnB;EACA,UAAIjE,GAAGG,OAAH,CAAW2O,EAAf,EAAmB;EACjBA,aAAK,UAAUxN,EAAEtB,GAAGG,OAAH,CAAW2O,EAAb,CAAf;EACD;EACD,aAAOA,EAAP;EACD,KAVH,EAWG3L,IAXH,CAWQ,GAXR,EAWa,UAAU7B,CAAV,EAAa;EACtB,UAAIc,QAAQpC,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,CAAb,CAAZ;EACA,UAAItJ,GAAGG,OAAH,CAAW6G,KAAX,CAAiB9F,KAAjB,IAA0B,QAA9B,EAAwC;EACtC,YAAII,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,IAAkB,CAAtB,EAAyB;EACvBlH,kBAAQpC,GAAGqH,OAAH,CAAWiC,CAAX,CAAa,CAAb,CAAR;EACD;EACF;EACD,aAAOlH,KAAP;EACD,KAnBH,EAoBGe,IApBH,CAoBQ,GApBR,EAoBa,UAAU7B,CAAV,EAAa;EACtB,UAAIc,QAASpC,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,CAAb,CAAb;EACA,UAAIlD,GAAGG,OAAH,CAAWkG,KAAX,CAAiBnF,KAAjB,KAA2B,QAA/B,EAAyC;EACvC,YAAII,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,IAAkB,CAAtB,EAAyB;EACvBd,kBAAQpC,GAAGqH,OAAH,CAAWnE,CAAX,CAAa,CAAb,CAAR;EACD;EACF;EACD,aAAOd,KAAP;EACD,KA5BH,EA6BGe,IA7BH,CA6BQ,OA7BR,EA6BiB,UAAU7B,CAAV,EAAa;EAC1B,aAAOtB,GAAGqH,OAAH,CAAWiC,CAAX,CAAasE,SAAb,GAAyB5N,GAAGqH,OAAH,CAAWiC,CAAX,CAAasE,SAAb,EAAzB,GAAoDiC,KAAKC,GAAL,CAAS9P,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,CAAb,IAAgCtJ,GAAGqH,OAAH,CAAWiC,CAAX,CAAa,CAAb,CAAzC,CAA3D;EACD,KA/BH,EAgCGnG,IAhCH,CAgCQ,QAhCR,EAgCkB,UAAU7B,CAAV,EAAa;EAC3B,aAAOtB,GAAGqH,OAAH,CAAWnE,CAAX,CAAa0K,SAAb,GAAyB5N,GAAGqH,OAAH,CAAWnE,CAAX,CAAa0K,SAAb,EAAzB,GAAoDiC,KAAKC,GAAL,CAAS9P,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,CAAb,IAAgClD,GAAGqH,OAAH,CAAWnE,CAAX,CAAa,CAAb,CAAzC,CAA3D;EACD,KAlCH,EAmCGC,IAnCH,CAmCQ,MAnCR,EAmCgB,UAAU7B,CAAV,EAAa;EACzB,aAAOtB,GAAGqH,OAAH,CAAWjC,KAAX,KAAqB,KAArB,GAA6BpF,GAAGqH,OAAH,CAAWjC,KAAX,CAAiB9D,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb,CAAjB,CAA7B,GAAoEjP,GAAGuQ,iBAAH,CAAqBjP,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb,CAArB,EAAyC,SAAzC,CAA3E;EACD,KArCH,EAsCGzO,KAtCH,CAsCS,SAtCT,EAsCoB,GAtCpB,EAuCGsD,EAvCH,CAuCM,WAvCN,EAuCmB,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC/B,UAAIjE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,WAA1B,KAA0CnL,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBrF,cAArB,CAAoC,eAApC,CAA9C,EAAoG;EAAE;EACpGpK,iBAAA,CAAU,IAAV,EAAgBoC,IAAhB,CAAqB,MAArB,EAA6B,UAAU7B,CAAV,EAAa;EACxC,iBAAOtB,GAAGuQ,iBAAH,CAAqBjP,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb,CAArB,EAAyC,SAAzC,CAAP;EACD,SAFD;EAGD;EACDjP,SAAG4O,IAAH,CAAQ7K,IAAR,CAAazC,CAAb,EAAgBP,SAAA,CAAU,IAAV,EAAgB4C,IAAhB,EAAhB;;EAEA,UAAI3D,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,aAA1B,CAAJ,EAA8C;EAAE;EAC9CnL,WAAGG,OAAH,CAAWsQ,WAAX,CAAuBlF,IAAvB,CAA4B,IAA5B,EAAkCjK,CAAlC,EAAqC2C,CAArC;EACD;EAEF,KAnDH,EAoDGH,EApDH,CAoDM,UApDN,EAoDkB,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC9B,UAAIjE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,WAA1B,KAA0CnL,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBrF,cAArB,CAAoC,eAApC,CAA9C,EAAoG;EAAE;EACpGpK,iBAAA,CAAU,IAAV,EAAgBoC,IAAhB,CAAqB,MAArB,EAA6B,UAAU7B,CAAV,EAAa;EACxC,iBAAOtB,GAAGuQ,iBAAH,CAAqBjP,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb,CAArB,EAAyC,SAAzC,CAAP;EACD,SAFD;EAGD;EACDjP,SAAG4O,IAAH,CAAQ5K,IAAR;;EAEA,UAAIhE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,YAA1B,CAAJ,EAA6C;EAAE;EAC7CnL,WAAGG,OAAH,CAAWuQ,UAAX,CAAsBnF,IAAtB,CAA2B,IAA3B,EAAiCjK,CAAjC,EAAoC2C,CAApC;EACD;EACF,KA/DH,EAgEGH,EAhEH,CAgEM,OAhEN,EAgEe,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC3B,UAAIjE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,OAA1B,CAAJ,EAAwC;EACtCnL,WAAGG,OAAH,CAAWwQ,OAAX,CAAmBpF,IAAnB,CAAwB,IAAxB,EAA8BjK,CAA9B,EAAiC2C,CAAjC;EACD;EACF,KApEH;;EAsEEyK,SAAKgB,UAAL;;EAEF,WAAO1P,EAAP;EACD,GA1FD;;EA4FA;;;;EAIA0O,OAAKkC,eAAL,GAAuB,YAAY;EACjC,QAAI5Q,KAAK,IAAT;;EAEAA,OAAGE,KAAH,CAASU,GAAT,GAAeqL,SAAf,CAAyB,UAAzB,EAAqCvJ,IAArC,CAA0C,UAASmO,EAAT,EAAa;EACrD,UAAIC,KAAK,IAAT;;EAEA/P,eAAA,CAAU,IAAV,EAAgBkL,SAAhB,CAA0B,MAA1B,EAAkCvJ,IAAlC,CAAuC,UAASqO,GAAT,EAAcC,KAAd,EAAqB;EAC1DjQ,iBAAA,CAAU+P,EAAV,EAAcvN,MAAd,CAAqB,MAArB,EACGJ,IADH,CACQ,OADR,EACiB,YADjB,EAEGA,IAFH,CAEQ,WAFR,EAEqB,UAAS7B,CAAT,EAAY;EAC7B,cAAI2P,eAAejR,GAAGqH,OAAH,CAAWhG,OAAX,CAAmBuM,SAAnB,EAAnB;EACA,cAAG5N,GAAGG,OAAH,CAAWmJ,CAAd,EAAiB;EACf;EACA,mBAAO,gBAAgBtJ,GAAGqH,OAAH,CAAWhG,OAAX,CAAmBrB,GAAGG,OAAH,CAAWkB,OAAX,CAAmB2P,KAAnB,CAAnB,IAAgDC,eAAa,CAA7E,IAAkF,GAAlF,IAAyFjR,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAEtB,GAAGG,OAAH,CAAWkB,OAAX,CAAmB2P,KAAnB,CAAF,CAAb,IAA6C,CAAtI,IAA2I,GAAlJ;EACA;EACA;EACD,WALD,MAKO;EACL,mBAAO,gBAAiBhR,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEtB,GAAGG,OAAH,CAAWkB,OAAX,CAAmB2P,KAAnB,CAAF,CAAb,IAA6C,EAA9D,IAAqE,GAArE,IAA6EhR,GAAGqH,OAAH,CAAWhG,OAAX,CAAmBrB,GAAGG,OAAH,CAAWkB,OAAX,CAAmB2P,KAAnB,CAAnB,IAAgDC,YAA7H,IAA6I,GAApJ;EACD;EACF,SAZH,EAaGzO,IAbH,CAaS,UAASlB,CAAT,EAAY;EACjB,iBAAOA,EAAEtB,GAAGG,OAAH,CAAWkB,OAAX,CAAmB2P,KAAnB,CAAF,IAA+BhR,GAAGc,KAAH,CAASqB,MAAT,CAAgBb,EAAEtB,GAAGG,OAAH,CAAWkB,OAAX,CAAmB2P,KAAnB,CAAF,CAAhB,EAA8ChR,GAAGG,OAAH,CAAW6P,QAAzD,CAA/B,GAAoG,EAA3G;EACD,SAfH;;EAiBAjP,iBAAA,CAAU+P,EAAV,EAAcvN,MAAd,CAAqB,MAArB,EACGJ,IADH,CACQ,OADR,EACiB,wBADjB,EAEGA,IAFH,CAEQ,WAFR,EAEqB,UAAS7B,CAAT,EAAY;EAC7B,cAAGtB,GAAGG,OAAH,CAAWmJ,CAAd,EAAiB;EACf,gBAAIuG,KAAKC,GAAL,CAAS9P,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAEtB,GAAGG,OAAH,CAAWkB,OAAX,CAAmB2P,KAAnB,CAAF,CAAb,IAA6ChR,GAAGqH,OAAH,CAAWnE,CAAX,CAAa,CAAb,CAAtD,IAAyE,EAA7E,EAAiF;EAC/E,qBAAO,gBAAgBlD,GAAGqH,OAAH,CAAWhG,OAAX,CAAmBrB,GAAGG,OAAH,CAAWkB,OAAX,CAAmB2P,KAAnB,CAAnB,IAAgD,EAAhE,IAAsE,GAAtE,GAA6EhR,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAEtB,GAAGG,OAAH,CAAWkB,OAAX,CAAmB2P,KAAnB,CAAF,CAAb,CAA7E,GAA2H,GAAlI;EACD;EACD,mBAAO,gBAAgBhR,GAAGqH,OAAH,CAAWhG,OAAX,CAAmBrB,GAAGG,OAAH,CAAWkB,OAAX,CAAmB2P,KAAnB,CAAnB,IAAgD,EAAhE,IAAsE,GAAtE,IAA6EhR,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAEtB,GAAGG,OAAH,CAAWkB,OAAX,CAAmB2P,KAAnB,CAAF,CAAb,IAA6C,EAA1H,IAAiI,GAAxI;EACD,WALD,MAKO;EACL,mBAAO,gBAAiBhR,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEtB,GAAGG,OAAH,CAAWkB,OAAX,CAAmB2P,KAAnB,CAAF,CAAb,IAA6C,EAA9D,IAAqE,GAArE,IAA6EhR,GAAGqH,OAAH,CAAWhG,OAAX,CAAmBrB,GAAGG,OAAH,CAAWkB,OAAX,CAAmB2P,KAAnB,CAAnB,IAAgD,EAA7H,IAAmI,GAA1I;EACD;EACF,SAXH,EAYGxO,IAZH,CAYS,UAASlB,CAAT,EAAY;EACjB,iBAAOA,EAAEtB,GAAGG,OAAH,CAAWkB,OAAX,CAAmB2P,KAAnB,IAA4B,aAA9B,KAAgD,CAAC1M,OAAOC,KAAP,CAAajD,EAAEtB,GAAGG,OAAH,CAAWkB,OAAX,CAAmB2P,KAAnB,IAA4B,aAA9B,CAAb,CAAjD,GAA+G,MAAM1P,EAAEtB,GAAGG,OAAH,CAAWkB,OAAX,CAAmB2P,KAAnB,IAA4B,aAA9B,EAA6Cd,OAA7C,CAAqD,CAArD,CAAN,GAAgE,GAA/K,GAAoL,EAA3L;EACD,SAdH;EAeD,OAjCD;EAkCD,KArCD;EAsCD,GAzCD;;EA2CAxB,OAAKyB,iBAAL,GAAyB,YAAY;EACnC,QAAInQ,KAAK,IAAT;EACAmN,YAAQC,GAAR,CAAY,mBAAZ;EACApN,OAAG4O,IAAH,CAAQ9D,IAAR,CAAa9K,GAAGG,OAAH,CAAWa,GAAX,IAAkB,UAAUM,CAAV,EAAa;EAC1C,UAAIwJ,OAAQxJ,EAAE4P,GAAF,GAAQ,MAApB;EACA,UAAI5P,EAAEgF,IAAF,KAAWhF,EAAE4P,GAAjB,EAAsB;EACpBpG,gBAAQxJ,EAAEgF,IAAF,GAAS,MAAjB;EACD;EACDwE,cAAQ9K,GAAGc,KAAH,CAASqB,MAAT,CAAgBb,EAAEc,KAAlB,CAAR;EACA,aAAO0I,IAAP;EACD,KAPD;;EASA9K,OAAGE,KAAH,CAASU,GAAT,GAAe2K,IAAf,CAAoBvL,GAAG4O,IAAvB;;EAEA5O,OAAGE,KAAH,CAASU,GAAT,GAAe2C,MAAf,CAAsB,GAAtB,EACG0I,SADH,CACa,GADb,EAEGvM,IAFH,CAEQM,GAAGkH,KAFX,EAGGgF,KAHH,GAGW3I,MAHX,CAGkB,GAHlB,EAIGJ,IAJH,CAIQ,OAJR,EAIiB,SAJjB,EAKGA,IALH,CAKQ,WALR,EAKqB,UAAU7B,CAAV,EAAa;EAC9B,aAAO,eAAetB,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,CAAb,CAAf,GAA+C,KAAtD;EACD,KAPH,EAQG2C,SARH,CAQa,MARb,EASGvM,IATH,CASQ,UAAU4B,CAAV,EAAa;EACjB,aAAOtB,GAAGG,OAAH,CAAWkB,OAAX,CAAmBvB,GAAnB,CAAuB,UAAUoR,GAAV,EAAe;EAC3C,eAAO;EACLA,eAAKA,GADA;EAEL9O,iBAAOd,EAAE4P,GAAF,CAFF;EAGL5K,gBAAMhF,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb;EAHD,SAAP;EAKD,OANM,CAAP;EAOD,KAjBH,EAkBG4C,KAlBH,GAkBW3I,MAlBX,CAkBkB,MAlBlB,EAmBGJ,IAnBH,CAmBQ,GAnBR,EAmBa,UAAU7B,CAAV,EAAa;EACtB,aAAOtB,GAAGqH,OAAH,CAAWhG,OAAX,CAAmBC,EAAE4P,GAArB,CAAP;EACD,KArBH,EAsBG/N,IAtBH,CAsBQ,GAtBR,EAsBa,UAAU7B,CAAV,EAAa;EACtB,UAAIA,EAAEc,KAAF,GAAU,CAAd,EAAiB;EACf,eAAOpC,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAEc,KAAf,CAAP;EACD,OAFD,MAEO;EACL,eAAOpC,GAAGqH,OAAH,CAAWnE,CAAX,CAAa,CAAb,CAAP;EACD;EACF,KA5BH,EA6BGC,IA7BH,CA6BQ,OA7BR,EA6BiBnD,GAAGqH,OAAH,CAAWhG,OAAX,CAAmBuM,SAAnB,EA7BjB,EA8BGzK,IA9BH,CA8BQ,QA9BR,EA8BkB,UAAU7B,CAAV,EAAa;EAC3B,aAAOuO,KAAKC,GAAL,CAAS9P,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAEc,KAAf,IAAwBpC,GAAGqH,OAAH,CAAWnE,CAAX,CAAa,CAAb,CAAjC,CAAP;EACD,KAhCH,EAiCGC,IAjCH,CAiCQ,MAjCR,EAiCgB,UAAU7B,CAAV,EAAa;EACzB,aAAOtB,GAAGqH,OAAH,CAAWjC,KAAX,CAAiB9D,EAAE4P,GAAnB,CAAP;EACD,KAnCH,EAoCGpN,EApCH,CAoCM,WApCN,EAoCmB,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC/B,UAAIjE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,WAA1B,KAA0CnL,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBrF,cAArB,CAAoC,eAApC,CAA9C,EAAoG;EAAE;EACpGpK,iBAAA,CAAU,IAAV,EAAgBoC,IAAhB,CAAqB,MAArB,EAA6B,UAAU7B,CAAV,EAAa;EACxC,iBAAOtB,GAAGuQ,iBAAH,CAAqBjP,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb,CAArB,EAAyC,SAAzC,CAAP;EACD,SAFD;EAGD;EACDjP,SAAG4O,IAAH,CAAQ7K,IAAR,CAAazC,CAAb,EAAgBP,SAAA,CAAU,IAAV,EAAgB4C,IAAhB,EAAhB;;EAEA,UAAI3D,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,aAA1B,CAAJ,EAA8C;EAC5C;EACAnL,WAAGG,OAAH,CAAWsQ,WAAX,CAAuBlF,IAAvB,CAA4B,IAA5B,EAAkCjK,CAAlC,EAAqC2C,CAArC;EACD;EAEF,KAjDH,EAkDGH,EAlDH,CAkDM,UAlDN,EAkDkB,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC9B,UAAIjE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,WAA1B,KAA0CnL,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBrF,cAArB,CAAoC,eAApC,CAA9C,EAAoG;EAAE;EACpGpK,iBAAA,CAAU,IAAV,EAAgBoC,IAAhB,CAAqB,MAArB,EAA6B,UAAU7B,CAAV,EAAa;EACxC,iBAAOtB,GAAGuQ,iBAAH,CAAqBjP,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb,CAArB,EAAyC,SAAzC,CAAP;EACD,SAFD;EAGD;EACDjP,SAAG4O,IAAH,CAAQ5K,IAAR;;EAEA,UAAIhE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,YAA1B,CAAJ,EAA6C;EAAE;EAC7CnL,WAAGG,OAAH,CAAWuQ,UAAX,CAAsBnF,IAAtB,CAA2B,IAA3B,EAAiCjK,CAAjC,EAAoC2C,CAApC;EACD;EACF,KA7DH,EA8DGH,EA9DH,CA8DM,OA9DN,EA8De,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC3B,UAAIjE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,OAA1B,CAAJ,EAAwC;EACtCnL,WAAGG,OAAH,CAAWwQ,OAAX,CAAmBpF,IAAnB,CAAwB,IAAxB,EAA8BjK,CAA9B,EAAiC2C,CAAjC;EACD;EACF,KAlEH;;EAoEEyK,SAAKkC,eAAL;EACH,GAnFD;;EAqFAlC,OAAK0B,iBAAL,GAAyB,YAAY;EACnC,QAAIpQ,KAAK,IAAT;EACAmN,YAAQC,GAAR,CAAY,mBAAZ;EACApN,OAAG4O,IAAH,CAAQ9D,IAAR,CAAa9K,GAAGG,OAAH,CAAWa,GAAX,IAAkB,UAAUM,CAAV,EAAa;EAC1C,UAAIwJ,OAAOxJ,EAAE4P,GAAF,GAAQ,MAAnB;EACA,UAAI5P,EAAEgF,IAAF,KAAWhF,EAAE4P,GAAjB,EAAsB;EACpBpG,gBAAQxJ,EAAEgF,IAAF,GAAS,MAAjB;EACD;EACDwE,cAAQ9K,GAAGc,KAAH,CAASqB,MAAT,CAAgBb,EAAEc,KAAlB,CAAR;EACA,aAAO0I,IAAP;EACD,KAPD;;EASA9K,OAAGE,KAAH,CAASU,GAAT,GAAe2K,IAAf,CAAoBvL,GAAG4O,IAAvB;;EAEA5O,OAAGE,KAAH,CAASU,GAAT,GAAe2C,MAAf,CAAsB,GAAtB,EACG0I,SADH,CACa,GADb,EAEGvM,IAFH,CAEQM,GAAGkH,KAFX,EAGGgF,KAHH,GAGW3I,MAHX,CAGkB,GAHlB,EAIGJ,IAJH,CAIQ,OAJR,EAIiB,SAJjB,EAKGA,IALH,CAKQ,WALR,EAKqB,UAAU7B,CAAV,EAAa;EAC9B,aAAO,iBAAiBtB,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,CAAb,CAAjB,GAAiD,IAAxD;EACD,KAPH,EAQG+I,SARH,CAQa,MARb,EASGvM,IATH,CASQ,UAAU4B,CAAV,EAAa;EACjB,aAAOtB,GAAGG,OAAH,CAAWkB,OAAX,CAAmBvB,GAAnB,CAAuB,UAAUoR,GAAV,EAAe;EAC3C,eAAO;EACLA,eAAKA,GADA;EAEL9O,iBAAOd,EAAE4P,GAAF,CAFF;EAGL5K,gBAAMhF,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb;EAHD,SAAP;EAKD,OANM,CAAP;EAOD,KAjBH,EAkBGgJ,KAlBH,GAkBW3I,MAlBX,CAkBkB,MAlBlB,EAmBGJ,IAnBH,CAmBQ,GAnBR,EAmBa,UAAU7B,CAAV,EAAa;EACtB,aAAOtB,GAAGqH,OAAH,CAAWhG,OAAX,CAAmBC,EAAE4P,GAArB,CAAP;EACD,KArBH,EAsBG/N,IAtBH,CAsBQ,GAtBR,EAsBa,UAAS7B,CAAT,EAAY;EACrB,UAAIA,IAAI,CAAR,EAAW;EACT,eAAOtB,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEc,KAAf,CAAP;EACD,OAFD,MAEO;EACL,eAAOpC,GAAGqH,OAAH,CAAWiC,CAAX,CAAa,CAAb,CAAP;EACD;EACF,KA5BH,EA6BGnG,IA7BH,CA6BQ,OA7BR,EA6BiB,UAAU7B,CAAV,EAAa;EAC1B,aAAOuO,KAAKC,GAAL,CAAS9P,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEc,KAAf,IAAwBpC,GAAGqH,OAAH,CAAWiC,CAAX,CAAa,CAAb,CAAjC,CAAP;EACD,KA/BH,EAgCGnG,IAhCH,CAgCQ,QAhCR,EAgCkBnD,GAAGqH,OAAH,CAAWhG,OAAX,CAAmBuM,SAAnB,EAhClB,EAiCGzK,IAjCH,CAiCQ,MAjCR,EAiCgB,UAAU7B,CAAV,EAAa;EACzB,aAAOtB,GAAGqH,OAAH,CAAWjC,KAAX,CAAiB9D,EAAE4P,GAAnB,CAAP;EACD,KAnCH,EAoCGpN,EApCH,CAoCM,WApCN,EAoCmB,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC/B,UAAIjE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,WAA1B,KAA0CnL,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBrF,cAArB,CAAoC,eAApC,CAA9C,EAAoG;EAAE;EACpGpK,iBAAA,CAAU,IAAV,EAAgBoC,IAAhB,CAAqB,MAArB,EAA6B,UAAU7B,CAAV,EAAa;EACxC,iBAAOtB,GAAGuQ,iBAAH,CAAqBjP,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb,CAArB,EAAyC,SAAzC,CAAP;EACD,SAFD;EAGD;EACDjP,SAAG4O,IAAH,CAAQ7K,IAAR,CAAazC,CAAb,EAAgBP,SAAA,CAAU,IAAV,EAAgB4C,IAAhB,EAAhB;;EAEA,UAAI3D,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,aAA1B,CAAJ,EAA8C;EAC5C;EACAnL,WAAGG,OAAH,CAAWsQ,WAAX,CAAuBlF,IAAvB,CAA4B,IAA5B,EAAkCjK,CAAlC,EAAqC2C,CAArC;EACD;EAEF,KAjDH,EAkDGH,EAlDH,CAkDM,UAlDN,EAkDkB,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC9B,UAAIjE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,WAA1B,KAA0CnL,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBrF,cAArB,CAAoC,eAApC,CAA9C,EAAoG;EAAE;EACpGpK,iBAAA,CAAU,IAAV,EAAgBoC,IAAhB,CAAqB,MAArB,EAA6B,UAAU7B,CAAV,EAAa;EACxC,iBAAOtB,GAAGuQ,iBAAH,CAAqBjP,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb,CAArB,EAAyC,SAAzC,CAAP;EACD,SAFD;EAGD;EACDjP,SAAG4O,IAAH,CAAQ5K,IAAR;;EAEA,UAAIhE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,YAA1B,CAAJ,EAA6C;EAAE;EAC7CnL,WAAGG,OAAH,CAAWuQ,UAAX,CAAsBnF,IAAtB,CAA2B,IAA3B,EAAiCjK,CAAjC,EAAoC2C,CAApC;EACD;EACF,KA7DH,EA8DGH,EA9DH,CA8DM,OA9DN,EA8De,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC3B,UAAIjE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,OAA1B,CAAJ,EAAwC;EACtCnL,WAAGG,OAAH,CAAWwQ,OAAX,CAAmBpF,IAAnB,CAAwB,IAAxB,EAA8BjK,CAA9B,EAAiC2C,CAAjC;EACD;EACF,KAlEH;;EAoEEyK,SAAKkC,eAAL;EACH,GAnFD;;EAqFAlC,OAAKyC,eAAL,GAAuB,YAAY;EACjC,QAAInR,KAAK,IAAT;EACAmN,YAAQC,GAAR,CAAY,cAAZ;EACApN,OAAGE,KAAH,CAASU,GAAT,GAAeqL,SAAf,CAAyB,WAAzB,EAAsCvJ,IAAtC,CAA2C,UAASqO,GAAT,EAAcC,KAAd,EAAqB;EAC9DjQ,eAAA,CAAU,IAAV,EAAgBkL,SAAhB,CAA0B,aAA1B,EAAyCvM,IAAzC,CAA8CqR,GAA9C,EAAmD7E,KAAnD,GAA2D3I,MAA3D,CAAkE,MAAlE,EACGJ,IADH,CACQ,OADR,EACiB,YADjB,EAEGA,IAFH,CAEQ,WAFR,EAEqB,UAAS7B,CAAT,EAAY;EAC7B,YAAI2P,YAAJ;EACA,YAAGjR,GAAGG,OAAH,CAAWmJ,CAAd,EAAiB;EACf2H,yBAAejR,GAAGqH,OAAH,CAAWiC,CAAX,CAAasE,SAAb,EAAf;EACA,iBAAO,gBAAgB5N,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAE5B,IAAF,CAAOM,GAAGG,OAAH,CAAWmJ,CAAlB,CAAb,IAAqC2H,eAAa,CAAlE,IAAuE,GAAvE,IAA8EjR,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAE,CAAF,CAAb,IAAqB,EAAnG,IAAyG,GAAhH;EACD;EACD2P,uBAAejR,GAAGqH,OAAH,CAAWnE,CAAX,CAAa0K,SAAb,EAAf;EACA,eAAO,gBAAgB5N,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAE,CAAF,CAAb,IAAqB,EAArC,IAA2C,GAA3C,IAAkDtB,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAE5B,IAAF,CAAOM,GAAGG,OAAH,CAAW+C,CAAlB,CAAb,IAAqC+N,eAAa,CAApG,IAAyG,GAAhH;EACD,OAVH,EAWGzO,IAXH,CAWS,UAASlB,CAAT,EAAY;EACjB,eAAOA,EAAE5B,IAAF,CAAOqR,IAAIG,GAAX,IAAkBlR,GAAGc,KAAH,CAASqB,MAAT,CAAgBb,EAAE5B,IAAF,CAAOqR,IAAIG,GAAX,CAAhB,EAAiClR,GAAGG,OAAH,CAAW6P,QAA5C,CAAlB,GAA0E,EAAjF;EACD,OAbH;;EAeAjP,eAAA,CAAU,IAAV,EAAgBkL,SAAhB,CAA0B,yBAA1B,EAAqDvM,IAArD,CAA0DqR,GAA1D,EAA+D7E,KAA/D,GAAuE3I,MAAvE,CAA8E,MAA9E,EACGJ,IADH,CACQ,OADR,EACiB,wBADjB,EAEGA,IAFH,CAEQ,WAFR,EAEqB,UAAS7B,CAAT,EAAY;EAC7B,YAAGtB,GAAGG,OAAH,CAAWmJ,CAAd,EAAiB;EACf,iBAAO,gBAAgBtJ,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAE5B,IAAF,CAAOM,GAAGG,OAAH,CAAWmJ,CAAlB,CAAb,IAAqC,EAArD,IAA2D,GAA3D,IAAkEtJ,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAE,CAAF,CAAb,IAAqB,EAAvF,IAA6F,GAApG;EACD;EACD,eAAO,gBAAgBtB,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAE,CAAF,CAAb,IAAqB,EAArC,IAA2C,GAA3C,IAAkDtB,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAE5B,IAAF,CAAOM,GAAGG,OAAH,CAAW+C,CAAlB,CAAb,IAAqC,EAAvF,IAA6F,GAApG;EACD,OAPH,EAQGV,IARH,CAQS,UAASlB,CAAT,EAAY;EACjB,eAAOA,EAAE5B,IAAF,CAAOqR,IAAIG,GAAJ,GAAU,aAAjB,KAAmC,CAAC5M,OAAOC,KAAP,CAAajD,EAAE5B,IAAF,CAAOqR,IAAIG,GAAJ,GAAU,aAAjB,CAAb,CAApC,GAAoF,MAAM5P,EAAE5B,IAAF,CAAOqR,IAAIG,GAAJ,GAAU,aAAjB,EAAgChB,OAAhC,CAAwC,CAAxC,CAAN,GAAmD,GAAvI,GAA6I,EAApJ;EACD,OAVH;EAWD,KA3BD;EA6BD,GAhCD;;EAkCAxB,OAAK2B,iBAAL,GAAyB,YAAY;EACnC,QAAIrQ,KAAK,IAAT;EACAmN,YAAQC,GAAR,CAAY,mBAAZ;EACApN,OAAG4O,IAAH,CAAQ9D,IAAR,CAAa9K,GAAGG,OAAH,CAAWa,GAAX,IAAkB,UAAUM,CAAV,EAAa;EAC1C,UAAIwJ,OAAO,EAAX;EACA,WAAK,IAAIiD,CAAT,IAAczM,EAAE5B,IAAhB,EAAsB;EACpB,YAAI,CAAC4B,EAAE,CAAF,IAAOA,EAAE,CAAF,CAAR,EAAc4O,OAAd,CAAsB,EAAtB,MAA8B5L,OAAOhD,EAAE5B,IAAF,CAAOqO,CAAP,CAAP,EAAkBmC,OAAlB,CAA0B,EAA1B,CAAlC,EAAiE;EAC/DpF,kBAAQiD,IAAI,MAAZ;EACD;EACF;EACDjD,cAAQxJ,EAAE5B,IAAF,CAAOM,GAAGG,OAAH,CAAWmJ,CAAlB,CAAR;EACA,aAAOwB,OAAO,MAAP,GAAgB9K,GAAGc,KAAH,CAASqB,MAAT,CAAiBb,EAAE,CAAF,IAAOA,EAAE,CAAF,CAAxB,CAAvB;EACD,KATD;;EAWAtB,OAAGE,KAAH,CAASU,GAAT,GAAe2K,IAAf,CAAoBvL,GAAG4O,IAAvB;;EAEA5O,OAAGE,KAAH,CAASU,GAAT,GAAe2C,MAAf,CAAsB,GAAtB,EACG0I,SADH,CACa,GADb,EAEGvM,IAFH,CAEQM,GAAGkH,KAFX,EAGGgF,KAHH,GAGW3I,MAHX,CAGkB,GAHlB,EAIGJ,IAJH,CAIQ,OAJR,EAIiB,UAJjB,EAKGA,IALH,CAKQ,MALR,EAKgB,UAAU7B,CAAV,EAAa;EACzB,aAAOtB,GAAGqH,OAAH,CAAWjC,KAAX,CAAiB9D,EAAE4P,GAAnB,CAAP;EACD,KAPH;EAQE;EARF,KASGjF,SATH,CASa,MATb,EAUGvM,IAVH,CAUQ,UAAU4B,CAAV,EAAa;EACjB,aAAOA,CAAP;EACD,KAZH,EAaG4K,KAbH,GAaW3I,MAbX,CAakB,MAblB,EAcGJ,IAdH,CAcQ,GAdR,EAca,UAAU7B,CAAV,EAAa;EACtB,aAAOtB,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAE,CAAF,CAAb,CAAP;EACD,KAhBH,EAiBG6B,IAjBH,CAiBQ,GAjBR,EAiBa,UAAU7B,CAAV,EAAa;EACtB,aAAOtB,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAE5B,IAAF,CAAOM,GAAGG,OAAH,CAAWmJ,CAAlB,CAAb,CAAP;EACD,KAnBH,EAoBGnG,IApBH,CAoBQ,OApBR,EAoBiB,YAAY;EACzB,aAAOnD,GAAGqH,OAAH,CAAWiC,CAAX,CAAasE,SAAb,EAAP;EACD,KAtBH,EAuBGzK,IAvBH,CAuBQ,QAvBR,EAuBkB,UAAU7B,CAAV,EAAa;EAC3B,aAAOtB,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAE,CAAF,CAAb,IAAqBtB,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAE,CAAF,CAAb,CAA5B;EACD,KAzBH,EA0BGwC,EA1BH,CA0BM,WA1BN,EA0BmB,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC/B,UAAIjE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,WAA1B,KAA0CnL,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBrF,cAArB,CAAoC,eAApC,CAA9C,EAAoG;EAAE;EACpGpK,iBAAA,CAAU,IAAV,EAAgBoC,IAAhB,CAAqB,MAArB,EAA6B,UAAU7B,CAAV,EAAa;EACxC,iBAAOtB,GAAGuQ,iBAAH,CAAqBjP,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb,CAArB,EAAyC,SAAzC,CAAP;EACD,SAFD;EAGD;EACDjP,SAAG4O,IAAH,CAAQ7K,IAAR,CAAazC,CAAb,EAAgBP,SAAA,CAAU,IAAV,EAAgB4C,IAAhB,EAAhB;;EAEA,UAAI3D,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,aAA1B,CAAJ,EAA8C;EAC5C;EACAnL,WAAGG,OAAH,CAAWsQ,WAAX,CAAuBlF,IAAvB,CAA4B,IAA5B,EAAkCjK,CAAlC,EAAqC2C,CAArC;EACD;EAEF,KAvCH,EAwCGH,EAxCH,CAwCM,UAxCN,EAwCkB,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC9B,UAAIjE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,WAA1B,KAA0CnL,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBrF,cAArB,CAAoC,eAApC,CAA9C,EAAoG;EAAE;EACpGpK,iBAAA,CAAU,IAAV,EAAgBoC,IAAhB,CAAqB,MAArB,EAA6B,UAAU7B,CAAV,EAAa;EACxC,iBAAOtB,GAAGuQ,iBAAH,CAAqBjP,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb,CAArB,EAAyC,SAAzC,CAAP;EACD,SAFD;EAGD;EACDjP,SAAG4O,IAAH,CAAQ5K,IAAR;;EAEA,UAAIhE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,YAA1B,CAAJ,EAA6C;EAAE;EAC7CnL,WAAGG,OAAH,CAAWuQ,UAAX,CAAsBnF,IAAtB,CAA2B,IAA3B,EAAiCjK,CAAjC,EAAoC2C,CAApC;EACD;EACF,KAnDH,EAoDGH,EApDH,CAoDM,OApDN,EAoDe,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC3B,UAAIjE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,OAA1B,CAAJ,EAAwC;EACtCnL,WAAGG,OAAH,CAAWwQ,OAAX,CAAmBpF,IAAnB,CAAwB,IAAxB,EAA8BjK,CAA9B,EAAiC2C,CAAjC;EACD;EACF,KAxDH;;EA0DEyK,SAAKyC,eAAL;EACH,GA3ED;;EA6EAzC,OAAK4B,iBAAL,GAAyB,YAAY;EACnC,QAAItQ,KAAK,IAAT;EACAmN,YAAQC,GAAR,CAAY,mBAAZ;EACApN,OAAG4O,IAAH,CAAQ9D,IAAR,CAAa9K,GAAGG,OAAH,CAAWa,GAAX,IAAkB,UAAUM,CAAV,EAAa;EAC1C,UAAIwJ,OAAO,EAAX;EACA,WAAK,IAAIiD,CAAT,IAAczM,EAAE5B,IAAhB,EAAsB;EACpB,YAAI,CAAC4B,EAAE,CAAF,IAAOA,EAAE,CAAF,CAAR,EAAc4O,OAAd,CAAsB,EAAtB,MAA8B5L,OAAOhD,EAAE5B,IAAF,CAAOqO,CAAP,CAAP,EAAkBmC,OAAlB,CAA0B,EAA1B,CAAlC,EAAiE;EAC/DpF,kBAAQiD,IAAI,MAAZ;EACD;EACF;EACDjD,cAAQxJ,EAAE5B,IAAF,CAAOM,GAAGG,OAAH,CAAW+C,CAAlB,CAAR;EACA,aAAO4H,OAAO,MAAP,GAAgB9K,GAAGc,KAAH,CAASqB,MAAT,CAAiBb,EAAE,CAAF,IAAOA,EAAE,CAAF,CAAxB,CAAvB;EACD,KATD;;EAWAtB,OAAGE,KAAH,CAASU,GAAT,GAAe2K,IAAf,CAAoBvL,GAAG4O,IAAvB;;EAEA5O,OAAGE,KAAH,CAASU,GAAT,GAAe2C,MAAf,CAAsB,GAAtB,EACG0I,SADH,CACa,GADb,EAEGvM,IAFH,CAEQM,GAAGkH,KAFX,EAGGgF,KAHH,GAGW3I,MAHX,CAGkB,GAHlB,EAIGJ,IAJH,CAIQ,OAJR,EAIiB,UAJjB,EAKGA,IALH,CAKQ,MALR,EAKgB,UAAU7B,CAAV,EAAa;EACzB,aAAOtB,GAAGqH,OAAH,CAAWjC,KAAX,CAAiB9D,EAAE4P,GAAnB,CAAP;EACD,KAPH,EAQGjF,SARH,CAQa,MARb,EASGvM,IATH,CASQ,UAAU4B,CAAV,EAAa;EACjB,aAAOA,CAAP;EACD,KAXH,EAYG4K,KAZH,GAYW3I,MAZX,CAYkB,MAZlB,EAaGJ,IAbH,CAaQ,GAbR,EAaa,UAAU7B,CAAV,EAAa;EACtB,aAAOtB,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAE5B,IAAF,CAAOM,GAAGG,OAAH,CAAW+C,CAAlB,CAAb,CAAP;EACD,KAfH,EAgBGC,IAhBH,CAgBQ,GAhBR,EAgBa,UAAU7B,CAAV,EAAa;EACtB,aAAOtB,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAE,CAAF,CAAb,CAAP;EACD,KAlBH,EAmBG6B,IAnBH,CAmBQ,QAnBR,EAmBkB,YAAY;EAC1B,aAAOnD,GAAGqH,OAAH,CAAWnE,CAAX,CAAa0K,SAAb,EAAP;EACD,KArBH,EAsBGzK,IAtBH,CAsBQ,OAtBR,EAsBiB,UAAU7B,CAAV,EAAa;EAC1B,aAAOtB,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAE,CAAF,CAAb,IAAqBtB,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAE,CAAF,CAAb,CAA5B;EACD,KAxBH,EAyBGwC,EAzBH,CAyBM,WAzBN,EAyBmB,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC/B,UAAIjE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,WAA1B,KAA0CnL,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBrF,cAArB,CAAoC,eAApC,CAA9C,EAAoG;EAAE;EACpGpK,iBAAA,CAAU,IAAV,EAAgBoC,IAAhB,CAAqB,MAArB,EAA6B,UAAU7B,CAAV,EAAa;EACxC,iBAAOtB,GAAGuQ,iBAAH,CAAqBjP,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb,CAArB,EAAyC,SAAzC,CAAP;EACD,SAFD;EAGD;EACDjP,SAAG4O,IAAH,CAAQ7K,IAAR,CAAazC,CAAb,EAAgBP,SAAA,CAAU,IAAV,EAAgB4C,IAAhB,EAAhB;;EAEA,UAAI3D,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,aAA1B,CAAJ,EAA8C;EAC5C;EACAnL,WAAGG,OAAH,CAAWsQ,WAAX,CAAuBlF,IAAvB,CAA4B,IAA5B,EAAkCjK,CAAlC,EAAqC2C,CAArC;EACD;EAEF,KAtCH,EAuCGH,EAvCH,CAuCM,UAvCN,EAuCkB,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC9B,UAAIjE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,WAA1B,KAA0CnL,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBrF,cAArB,CAAoC,eAApC,CAA9C,EAAoG;EAAE;EACpGpK,iBAAA,CAAU,IAAV,EAAgBoC,IAAhB,CAAqB,MAArB,EAA6B,UAAU7B,CAAV,EAAa;EACxC,iBAAOtB,GAAGuQ,iBAAH,CAAqBjP,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb,CAArB,EAAyC,SAAzC,CAAP;EACD,SAFD;EAGD;EACDjP,SAAG4O,IAAH,CAAQ5K,IAAR;;EAEA,UAAIhE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,YAA1B,CAAJ,EAA6C;EAAE;EAC7CnL,WAAGG,OAAH,CAAWuQ,UAAX,CAAsBnF,IAAtB,CAA2B,IAA3B,EAAiCjK,CAAjC,EAAoC2C,CAApC;EACD;EACF,KAlDH,EAmDGH,EAnDH,CAmDM,OAnDN,EAmDe,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC3B,UAAIjE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,OAA1B,CAAJ,EAAwC;EACtCnL,WAAGG,OAAH,CAAWwQ,OAAX,CAAmBpF,IAAnB,CAAwB,IAAxB,EAA8BjK,CAA9B,EAAiC2C,CAAjC;EACD;EACF,KAvDH;;EAyDEyK,SAAKyC,eAAL;EACH,GA1ED;;EA4EAzC,OAAK0C,YAAL,GAAoB,UAAU1R,IAAV,EAAgB;EAClC,QAAIM,KAAK,IAAT;EACA,QAAI2J,SAAS,EAAb;EACA,QAAI0H,WAAW,EAAf;;EAEA,QAAIrR,GAAGG,OAAH,CAAWqQ,SAAX,IAAwBxQ,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBc,mBAA7C,IACFtR,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBc,mBAArB,CAAyCzN,MAAzC,GAAkD,CADpD,EACuD;EACrD,aAAO7D,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBc,mBAA5B;EACD;;EAED5R,SAAK+K,OAAL,CAAa,UAAUnJ,CAAV,EAAa;EACxBqI,aAAOlG,IAAP,CAAY,CAACnC,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb,CAAb;EACD,KAFD;;EAIAtF,WAAO4E,IAAP,CAAYxN,YAAZ;;EAEA;EACA,QAAIf,GAAGG,OAAH,IAAcH,GAAGG,OAAH,CAAWqQ,SAAzB,IAAsCxQ,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBjH,OAA/D,EAAwE;;EAEtE,UAAIvJ,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBe,WAArB,KAAqC,IAAzC,EAA+C;EAC7C,YAAIC,MAAMvK,aAAA,CAAY0C,MAAZ,EAAoB,UAAUoC,CAAV,EAAa;EACzC,iBAAOA,KAAK,CAAZ;EACD,SAFS,CAAV;EAGA;;EAEAsF,iBAAS5N,IAAT,CAAckG,OAAO,CAAP,CAAd;EACA0H,iBAAS5N,IAAT,CAAc,CAAd;;EAEA,aAAK,IAAIQ,IAAI,CAAb,EAAgBA,KAAKjE,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBjH,OAArB,GAA+B,CAApD,EAAuDtF,GAAvD,EAA4D;EAC1DoN,mBAAS5N,IAAT,CAAc1C,WAAA,CAAYyQ,GAAZ,EAAiBvN,IAAI,CAAJ,IAASjE,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBjH,OAArB,GAA+B,CAAxC,CAAjB,CAAd;EACD;EAEF,OAbD,MAaO;EACL8H,iBAAS5N,IAAT,CAAc1C,WAAA,CAAY4I,MAAZ,EAAoB,CAApB,CAAd;EACA,aAAK,IAAI8H,IAAI,CAAb,EAAgBA,KAAKzR,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBjH,OAA1C,EAAmDkI,GAAnD,EAAwD;EACtDJ,mBAAS5N,IAAT,CAAc1C,WAAA,CAAY4I,MAAZ,EAAoB8H,IAAI,CAAJ,GAAQzR,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBjH,OAAjD,CAAd;EACD;EACF;EAEF,KAtBD,MAsBO;EACL8H,iBAAW,CAACtQ,WAAA,CAAY4I,MAAZ,EAAoB,CAApB,CAAD,EAAyB5I,WAAA,CAAY4I,MAAZ,EAAoB,GAApB,CAAzB,EAAmD5I,WAAA,CAAY4I,MAAZ,EAAoB,GAApB,CAAnD,EAA6E5I,WAAA,CAAY4I,MAAZ,EAAoB,GAApB,CAA7E,EAAuG5I,WAAA,CAAY4I,MAAZ,EAAoB,GAApB,CAAvG,EAAiI5I,WAAA,CAAY4I,MAAZ,EAAoB,CAApB,CAAjI,CAAX;EACD;;EAED;EACA,QAAI3J,GAAGG,OAAH,CAAWqQ,SAAX,IAAwBxQ,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBjH,OAA7C,IAAwDvJ,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBjH,OAArB,KAAiC,CAA7F,EAAgG;;EAE9F,UAAI8H,SAAS,CAAT,MAAgBA,SAAS,CAAT,CAAhB,IAA+BA,SAAS,CAAT,MAAgBA,SAAS,CAAT,CAA/C,IAA8DA,SAAS,CAAT,MAAgBA,SAAS,CAAT,CAA9E,IAA6FA,SAAS,CAAT,MAAgBA,SAAS,CAAT,CAAjH,EAA8H;EAC5HA,mBAAW,CAACtQ,WAAA,CAAY4I,MAAZ,EAAoB,CAApB,CAAD,EAAyB5I,WAAA,CAAY4I,MAAZ,EAAoB,GAApB,CAAzB,CAAX;EACD;EACF;;EAED,WAAO0H,QAAP;EACD,GApDD;;EAsDA3C,OAAK6B,iBAAL,GAAyB,UAAUjP,CAAV,EAAaK,IAAb,EAAmB;EAC1C,QAAI3B,KAAK,IAAT;EACA,QAAI0R,QAAQrO,WAAW/B,CAAX,CAAZ;;EAEA;EACA,QAAItB,GAAGG,OAAH,IAAcH,GAAGG,OAAH,CAAWoK,IAAX,CAAgBiG,SAA9B,IAA2CxQ,GAAGG,OAAH,CAAWoK,IAAX,CAAgBiG,SAAhB,CAA0BtB,MAAzE,EAAiF;EAC/E,UAAIlP,GAAGuP,UAAH,CAAc1L,MAAd,GAAuB,CAA3B,EAA8B;;EAE5B,YAAI7D,GAAGG,OAAH,IAAcH,GAAGG,OAAH,CAAWoK,IAAX,CAAgBoH,GAAhB,KAAwBjQ,SAAtC,IAAmD1B,GAAGG,OAAH,CAAWoK,IAAX,CAAgBqH,GAAhB,KAAwBlQ,SAA/E,EAA0F;EACxF,cAAIgQ,QAAQ1R,GAAGG,OAAH,CAAWoK,IAAX,CAAgBoH,GAAxB,IAA+BD,QAAQ1R,GAAGG,OAAH,CAAWoK,IAAX,CAAgBqH,GAA3D,EAAgE;EAC9D,mBAAO5R,GAAGG,OAAH,CAAWoK,IAAX,CAAgBiG,SAAhB,CAA0BqB,eAAjC;EACD;EACF,SAJD,MAIO;EACL,cAAIH,QAAQ1R,GAAGyP,OAAH,CAAW,CAAX,CAAR,IAAyBiC,QAAQ1R,GAAGyP,OAAH,CAAW,CAAX,CAArC,EAAoD;EAClD,mBAAOzP,GAAGG,OAAH,CAAWoK,IAAX,CAAgBiG,SAAhB,CAA0BqB,eAAjC;EACD;EACF;;EAED,YAAIlQ,QAAQ,SAAZ,EAAuB;EACrB,cAAI+P,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAb,EAA+B;EAC7B,mBAAOvP,GAAGG,OAAH,CAAWoK,IAAX,CAAgBiG,SAAhB,CAA0BtB,MAA1B,CAAiC,CAAjC,CAAP,CAD6B;EAE9B,WAFD,MAEO,IAAIwC,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAb,EAA+B;EACpC,mBAAOvP,GAAGG,OAAH,CAAWoK,IAAX,CAAgBiG,SAAhB,CAA0BtB,MAA1B,CAAiC,CAAjC,CAAP,CADoC;EAErC,WAFM,MAEA,IAAIwC,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAb,EAA+B;EACpC,mBAAOvP,GAAGG,OAAH,CAAWoK,IAAX,CAAgBiG,SAAhB,CAA0BtB,MAA1B,CAAiC,CAAjC,CAAP,CADoC;EAErC,WAFM,MAEA,IAAIwC,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAb,EAA+B;EACpC,mBAAOvP,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBtB,MAArB,CAA4B,CAA5B,CAAP,CADoC;EAErC,WAFM,MAEA,IAAIwC,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAb,EAA+B;EACpC,mBAAOvP,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBtB,MAArB,CAA4B,CAA5B,CAAP,CADoC;EAErC;EACF;;EAED,YAAIvN,QAAQ,SAAR,IAAqB3B,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,WAA1B,CAArB,IAA+DnL,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBrF,cAArB,CAAoC,eAApC,CAAnE,EAAyH;EACvH,cAAIuG,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAb,EAA+B;EAC7B,mBAAOvP,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBsB,aAArB,CAAmC,CAAnC,CAAP,CAD6B;EAE9B,WAFD,MAEO,IAAIJ,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAb,EAA+B;EACpC,mBAAOvP,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBsB,aAArB,CAAmC,CAAnC,CAAP,CADoC;EAErC,WAFM,MAEA,IAAIJ,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAb,EAA+B;EACpC,mBAAOvP,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBsB,aAArB,CAAmC,CAAnC,CAAP,CADoC;EAErC,WAFM,MAEA,IAAIJ,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAb,EAA+B;EACpC,mBAAOvP,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBsB,aAArB,CAAmC,CAAnC,CAAP,CADoC;EAErC,WAFM,MAEA,IAAIJ,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAb,EAA+B;EACpC,mBAAOvP,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBsB,aAArB,CAAmC,CAAnC,CAAP,CADoC;EAErC;EACF;EAEF;EACF;;EAED,QAAI9R,GAAGuP,UAAH,CAAc1L,MAAd,IAAwB,CAA5B,EAA+B;EAC7B;;;;;EAKA,UAAI6N,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAb,EAA+B;EAC7B,eAAOvP,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBtB,MAArB,CAA4B,CAA5B,CAAP,CAD6B;EAE9B;EACF;EAEF,GA5DD;;EA8DAR,OAAKhK,IAAL,CAAUvF,MAAV;EACA,SAAOuP,IAAP;EACD;;;;;;;;ECvhCD;;;;;EAMA;;;;;;;;;;;;;;;AAeA,EAAe,SAASqD,eAAT,CAAyBC,QAAzB,EAAmC;;EAE9C,QAAI9R,QAAQ,EAAZ;;EAEA;EACAA,UAAM8R,QAAN,GAAiB;EACftS,cAAM,IADS;EAEfoP,YAAI,IAFW;EAGfmD,gBAAQ,IAHO;EAIf/I,gBAAQ,IAJO;EAKfgJ,eAAO,IALQ;EAMfC,eAAM,IANS;EAOfC,eAAO,IAPQ;EAQftK,kBAAU,IARK;EASfuK,oBAAY,IATG;EAUfC,gBAAQ,CAVO;EAWfpR,eAAO,QAXQ;EAYfqR,mBAAW,EAACnS,OAAO,GAAR,EAAaE,QAAQ,GAArB,EAZI;EAafuE,gBAAQ,EAACG,KAAK,EAAN,EAAUD,OAAO,EAAjB,EAAqBE,QAAQ,EAA7B,EAAiCH,MAAM,EAAvC,EAbO;EAcf0N,2BAAmB,KAdJ;EAefpN,eAAOrE,eAAA,CAAgBA,mBAAhB;EAfQ,KAAjB;EAiBA,SAAK,IAAI0R,OAAT,IAAoBT,QAApB,EAA8B;EAC5B9R,cAAM8R,QAAN,CAAeS,OAAf,IAA0BT,SAASS,OAAT,CAA1B;EACD;;EAGD,aAASC,aAAT,CAAuBpR,CAAvB,EAA0B;EACxB,YAAIA,IAAI,CAAJ,KAAU,CAAd,EAAiB;EACf,mBAAOP,SAAA,CAAU,MAAV,EAAkBO,CAAlB,CAAP;EACD,SAFD,MAEO;EACL,mBAAOP,SAAA,CAAU,MAAV,EAAkBO,CAAlB,CAAP;EACD;EACF;EACD,aAASqR,YAAT,CAAsBrR,CAAtB,EAAyB;EACvB,YAAIc,QAAQ,EAAZ;EACE,YAAId,IAAI,CAAJ,IAAS,CAAb,EAAgB;EAChBc,oBAAQrB,SAAA,CAAU,MAAV,EAAkBO,CAAlB,CAAR;EACC,SAFD,MAEO,IAAIA,IAAI,CAAJ,IAASA,IAAI,CAAjB,EAAoB;EAC3Bc,oBAAQrB,SAAA,CAAU,MAAV,EAAkBO,CAAlB,CAAR;EACC,SAFM,MAEA;EACPc,oBAAQrB,SAAA,CAAU,MAAV,EAAkBO,CAAlB,CAAR;EACC;EACD,eAAOc,KAAP;EACH;;EAED,aAASwQ,WAAT,CAAqBtR,CAArB,EAAwB;EACpB,YAAIF,QAAQE,EAAEsB,KAAF,CAAQ,KAAR,CAAZ;EACA,YAAIR,QAAQ,EAAZ;EACA,aAAI,IAAI6B,IAAI,CAAZ,EAAeA,IAAI7C,MAAMyC,MAAzB,EAAiCI,GAAjC,EAAqC;EACnC,gBAAI7C,MAAM6C,CAAN,IAAW,CAAX,IAAgB,CAApB,EAAuB;EACrB7B,yBAASrB,SAAA,CAAU,MAAV,EAAkBK,MAAM6C,CAAN,CAAlB,CAAT;EACD,aAFD,MAEO,IAAI7C,MAAM6C,CAAN,IAAW,CAAX,IAAgB7C,MAAM6C,CAAN,IAAW,CAA/B,EAAkC;EACvC7B,yBAASrB,SAAA,CAAU,MAAV,EAAkBK,MAAM6C,CAAN,CAAlB,CAAT;EACD,aAFM,MAEA;EACL7B,yBAASrB,SAAA,CAAU,MAAV,EAAkBK,MAAM6C,CAAN,CAAlB,CAAT;EACD;EACD,gBAAIA,MAAM,CAAV,EAAa;EACX7B,yBAAS,KAAT;EACD;EACF;EACD,eAAOA,KAAP;EACD;;EAEH,aAASyQ,eAAT,CAAyBvR,CAAzB,EAA4B;EAC1B,YAAIgI,IAAIuG,KAAKzC,GAAL,CAAS9L,CAAT,IAAcuO,KAAKzC,GAAL,CAAS,EAAT,CAAd,GAA6B,IAArC;EACA,eAAOyC,KAAKC,GAAL,CAASxG,IAAIuG,KAAKiD,KAAL,CAAWxJ,CAAX,CAAb,IAA8B,GAA9B,GAAoCoJ,cAAcpR,CAAd,CAApC,GAAuD,EAA9D;EACD;;EAEDpB,UAAM6S,UAAN,GAAmBJ,YAAnB;EACAzS,UAAM8S,UAAN,GAAmBJ,WAAnB;;EAEA1S,UAAMR,IAAN,GAAaQ,MAAM8R,QAAN,CAAetS,IAA5B;;EAEAQ,UAAM+S,SAAN,GAAkB,EAAlB,CA1E8C;EA2E9C/S,UAAMgT,IAAN,GAAa,EAACC,SAAS,IAAV,EAAgBC,UAAU,IAA1B,EAAgCC,GAAG,IAAnC,EAAyCrM,OAAO,IAAhD,EAAsDX,OAAO,IAA7D,EAAb;EACAnG,UAAMoT,UAAN,GAAmB,IAAnB;;EAEA;;;;;EAKA,aAASC,aAAT,CAAuBC,YAAvB,EAAqC;EACjC,YAAI,OAAOA,YAAP,IAAuB,UAA3B,EAAuC;EACnC,mBAAOA,YAAP;EACH,SAFD,MAEO,IAAI3R,MAAMC,OAAN,CAAc0R,YAAd,CAAJ,EAAiC;EACpC;EACA,gBAAIC,WAAW,EAAf;EACA;;;;;;EAMA,gBAAI5R,MAAMC,OAAN,CAAc5B,MAAM8R,QAAN,CAAeG,KAA7B,CAAJ,EAAwC;EACpCjS,sBAAM8R,QAAN,CAAeG,KAAf,CAAqB1H,OAArB,CAA6B,UAASyG,GAAT,EAAcF,KAAd,EAAoB;EAC7CyC,6BAASvC,GAAT,IAAgBsC,aAAaxC,KAAb,CAAhB;EACH,iBAFD;EAGH,aAJD,MAIK;EACDjJ,uBAAO+F,IAAP,CAAY5N,MAAM+S,SAAlB,EAA6B1E,IAA7B,CAAkCxN,YAAlC,EAAgD0J,OAAhD,CAAwD,UAASyG,GAAT,EAAcF,KAAd,EAAoB;EACxEyC,6BAASvC,GAAT,IAAgBsC,aAAaxC,KAAb,CAAhB;EACH,iBAFD;EAGH;EACD,mBAAO,UAAU0C,KAAV,EAAiB;EACpB,uBAAOD,SAASC,KAAT,CAAP;EACH,aAFD;EAGH,SArBM,MAqBA,IAAI,QAAOF,YAAP,yCAAOA,YAAP,MAAuB,QAA3B,EAAqC;EACxC;EACA,mBAAO,UAAUE,KAAV,EAAiB;EACpB,uBAAOF,aAAaE,KAAb,CAAP;EACH,aAFD;EAGH,SALM,MAKA;EACH,mBAAO3S,eAAA,CAAgBA,mBAAhB,CAAP;EACH;EACJ;;EAED;;;;;;EAMA,aAAS4S,WAAT,CAAqBC,QAArB,EAA+BC,KAA/B,EAAsC;EAClC,YAAIC,UAAU,EAAChP,MAAM,IAAP,EAAaC,OAAO,IAApB,EAA0BgP,QAAQ,IAAlC,EAAd;EACA,YAAI3T,QAAQF,MAAM8T,MAAN,CAAapG,SAAb,MAA4BgG,WAAW,GAAvC,CAAZ;EACA,YAAI3R,UAAU,CAAC/B,MAAM8T,MAAN,CAAapG,SAAb,KAA2BxN,KAA5B,IAAqC,CAAnD;EACA,YAAI6T,SAAS/T,MAAM8T,MAAN,CAAaH,KAAb,CAAb;EACAC,gBAAQC,MAAR,GAAiB7T,MAAM8T,MAAN,CAAapG,SAAb,KAA2B,CAA3B,GAA+BqG,MAAhD;EACAH,gBAAQhP,IAAR,GAAe7C,UAAUgS,MAAzB;EACAH,gBAAQ/O,KAAR,GAAgB+O,QAAQhP,IAAR,GAAe1E,KAA/B;EACA,eAAO0T,OAAP;EACH;;EAED;;;;;;EAMA,aAASI,SAAT,CAAmBC,QAAnB,EAA6B/T,KAA7B,EAAoC;EAChC,YAAI+T,aAAa,IAAb,IAAqB/T,SAAS,CAAlC,EAAqC;EACjC,mBAAO,CAAP;EACH;EACD,eAAOyP,KAAKiD,KAAL,CAAWjD,KAAKuE,MAAL,KAAgBhU,KAA3B,IAAoCA,QAAQ,CAAnD;EACH;;EAED,aAASiU,WAAT,CAAqBC,MAArB,EAA6B;EACzB,YAAIC,SAAS,EAAb;EACA,aAAK,IAAItQ,CAAT,IAAcqQ,MAAd,EAAsB;EAClB,gBAAIA,OAAOnJ,cAAP,CAAsBlH,CAAtB,CAAJ,EAA8B;EAC1BsQ,uBAAOtQ,CAAP,IAAYqQ,OAAOrQ,CAAP,CAAZ;EACH;EACJ;EACD,eAAOsQ,MAAP;EACH;;EAED;;;;;;EAMA,aAASC,YAAT,CAAsBC,SAAtB,EAAiCC,OAAjC,EAAgG;EAAA,YAAtDC,SAAsD,uEAA1C,EAA0C;EAAA,YAAtCC,UAAsC,uEAAzBlT,SAAyB;EAAA,YAAdmT,OAAc,uEAAJ,EAAI;;EAC5F,YAAIC,gBAAgBH,SAApB;EACAG,yBAAiBF,aAAa,SAASA,WAAWG,cAAX,EAAT,GAAuC,uFAApD,GAA6I,EAA9J;EACAD,yBAAiBL,SAAjB;EACAK,yBAAiBD,UAAU,EAAV,GAAe,eAAenC,cAAcgC,QAAQ9C,GAAtB,EAA2B,GAA3B,CAA/C;EACAkD,yBAAiBD,UAAU,EAAV,GAAe,cAAcnC,cAAcgC,QAAQM,SAAtB,CAA9C;EACAF,yBAAiBD,UAAUA,YAAY,MAAZ,GAAqB,iBAAiBnC,cAAcgC,QAAQO,IAAtB,CAAtC,GAAoE,EAA9E,GAAmF,iBAAiBvC,cAAcgC,QAAQO,IAAtB,CAArH;EACAH,yBAAiBD,UAAUA,YAAa,QAAb,GAAwB,mBAAmBnC,cAAcgC,QAAQQ,MAAtB,CAA3C,GAA2E,EAArF,GAA0F,mBAAmBxC,cAAcgC,QAAQQ,MAAtB,CAA9H;EACAJ,yBAAiBD,UAAU,EAAV,GAAe,cAAcnC,cAAcgC,QAAQS,SAAtB,CAA9C;EACAL,yBAAiBD,UAAU,EAAV,GAAe,eAAenC,cAAcgC,QAAQ/C,GAAtB,CAA/C;EACA,eAAO,YAAY;EACfzR,kBAAMgT,IAAN,CAAWzQ,OAAX,CAAmB2S,UAAnB,GAAgCC,QAAhC,CAAyC,GAAzC,EAA8C7U,KAA9C,CAAoD,SAApD,EAA+D,GAA/D;EACAN,kBAAMgT,IAAN,CAAWzQ,OAAX,CAAmBqI,IAAnB,CAAwBgK,aAAxB;EACH,SAHD;EAIH;;EAOD;;EAEA;;;EAGA,KAAC;EAAA,iBAASQ,WAAT,GAAuB;EACpB,qBAASC,WAAT,CAAqB5L,MAArB,EAA6B;;EAEzB,oBAAI+K,UAAU;EACV9C,yBAAK,IADK;EAEV4D,qCAAiB,IAFP;EAGVC,qCAAiB,IAHP;EAIVT,+BAAW,IAJD;EAKVE,4BAAQ,IALE;EAMVD,0BAAM,IANI;EAOVS,yBAAK,IAPK;EAQVP,+BAAW,IARD;EASVQ,qCAAiB,IATP;EAUVC,qCAAiB,IAVP;EAWVjE,yBAAK;EAXK,iBAAd;;EAcA+C,wBAAQ/C,GAAR,GAAc5Q,MAAA,CAAO4I,MAAP,CAAd;EACA+K,wBAAQS,SAAR,GAAoBpU,WAAA,CAAY4I,MAAZ,EAAoB,IAApB,CAApB;EACA+K,wBAAQQ,MAAR,GAAiBnU,SAAA,CAAU4I,MAAV,CAAjB;EACA+K,wBAAQO,IAAR,GAAelU,OAAA,CAAQ4I,MAAR,CAAf;EACA+K,wBAAQM,SAAR,GAAoBjU,WAAA,CAAY4I,MAAZ,EAAoB,IAApB,CAApB;EACA+K,wBAAQ9C,GAAR,GAAc7Q,MAAA,CAAO4I,MAAP,CAAd;EACA+K,wBAAQgB,GAAR,GAAchB,QAAQM,SAAR,GAAoBN,QAAQS,SAA1C;;EAEA;EACA,oBAAIU,MAAMnB,QAAQS,SAAR,GAAqB,MAAMT,QAAQgB,GAA7C;EACA,oBAAII,MAAMpB,QAAQM,SAAR,GAAqB,MAAMN,QAAQgB,GAA7C;EACA,qBAAK,IAAIzR,IAAI,CAAb,EAAgBA,KAAK0F,OAAO9F,MAA5B,EAAoCI,GAApC,EAAyC;EACrC,wBAAI0F,OAAO1F,CAAP,IAAY4R,GAAhB,EAAqB;EACjB;EACH;EACD,wBAAI,CAACnB,QAAQiB,eAAT,IAA4BhM,OAAO1F,CAAP,KAAa4R,GAA7C,EAAkD;EAC9CnB,gCAAQiB,eAAR,GAA0BhM,OAAO1F,CAAP,CAA1B;EACA;EACH;EACD,wBAAI0F,OAAO1F,CAAP,IAAY6R,GAAhB,EAAqB;EACjBpB,gCAAQe,eAAR,GAA0B9L,OAAO1F,IAAI,CAAX,CAA1B;EACA;EACH;EACJ;;EAGDyQ,wBAAQkB,eAAR,GAA0BlB,QAAQS,SAAR,GAAqB,IAAIT,QAAQgB,GAA3D;EACAhB,wBAAQc,eAAR,GAA0Bd,QAAQM,SAAR,GAAqB,IAAIN,QAAQgB,GAA3D;EACA,oBAAI,CAAChB,QAAQiB,eAAb,EAA8B;EAC1BjB,4BAAQiB,eAAR,GAA0BjB,QAAQ/C,GAAlC;EACH;EACD,oBAAI,CAAC+C,QAAQe,eAAb,EAA8B;EAC1Bf,4BAAQe,eAAR,GAA0Bf,QAAQ9C,GAAlC;EACH;EACD,uBAAO8C,OAAP;EACH;;EAED,gBAAIqB,YAAY,IAAhB;EACA,gBAAIC,YAAY,IAAhB;EACA,gBAAIC,aAAa,IAAjB;EACA,gBAAIC,iBAAiB,IAArB;EACA,gBAAIC,WAAJ;;EAEA;EACA,iBAAKA,cAAc,CAAnB,EAAsBA,cAAcjW,MAAMR,IAAN,CAAWmE,MAA/C,EAAuDsS,aAAvD,EAAsE;EAClEJ,4BAAY7V,MAAMR,IAAN,CAAWyW,WAAX,EAAwBjW,MAAM8R,QAAN,CAAeE,KAAvC,CAAZ;EACA8D,4BAAY9V,MAAMR,IAAN,CAAWyW,WAAX,EAAwBjW,MAAM8R,QAAN,CAAeI,KAAvC,CAAZ;EACA6D,6BAAa/V,MAAM8R,QAAN,CAAelD,EAAf,GAAoB5O,MAAMR,IAAN,CAAWyW,WAAX,EAAwBjW,MAAM8R,QAAN,CAAelD,EAAvC,CAApB,GAAiE,IAA9E;EACAoH,iCAAiBhW,MAAM8R,QAAN,CAAeC,MAAf,GAAwB/R,MAAMR,IAAN,CAAWyW,WAAX,EAAwBjW,MAAM8R,QAAN,CAAeC,MAAvC,CAAxB,GAAyE,IAA1F;;EAEA,oBAAI/R,MAAM+S,SAAN,CAAgB9H,cAAhB,CAA+B4K,SAA/B,CAAJ,EAA+C;EAC3C,wBAAI7V,MAAM8R,QAAN,CAAelD,EAAnB,EAAuB;EACnB5O,8BAAM+S,SAAN,CAAgB8C,SAAhB,EAA2BK,UAA3B,CAAsC3S,IAAtC,CAA2C;EACvCrB,mCAAO4T,SADgC;EAEvClH,gCAAImH,UAFmC;EAGvChE,oCAAQiE;EAH+B,yBAA3C;EAKH,qBAND,MAMM;EACFhW,8BAAM+S,SAAN,CAAgB8C,SAAhB,EAA2BpM,MAA3B,CAAkClG,IAAlC,CAAuCuS,SAAvC;EACH;EACJ,iBAVD,MAUO;EACH,wBAAI9V,MAAM8R,QAAN,CAAelD,EAAnB,EAAuB;EACnB5O,8BAAM+S,SAAN,CAAgB8C,SAAhB,IAA6B,EAA7B;EACA7V,8BAAM+S,SAAN,CAAgB8C,SAAhB,EAA2BK,UAA3B,GAAwC,CAAC;EACrChU,mCAAO4T,SAD8B;EAErClH,gCAAImH,UAFiC;EAGrChE,oCAAQiE;EAH6B,yBAAD,CAAxC;EAKH,qBAPD,MAOM;EACFhW,8BAAM+S,SAAN,CAAgB8C,SAAhB,IAA6B,EAA7B;EACA7V,8BAAM+S,SAAN,CAAgB8C,SAAhB,EAA2BpM,MAA3B,GAAoC,CAACqM,SAAD,CAApC;EACH;EACJ;;EAGD;EACA;;;;;;EAMH;;EAED,iBAAK,IAAIK,KAAT,IAAkBnW,MAAM+S,SAAxB,EAAmC;EAC/B,oBAAI/S,MAAM8R,QAAN,CAAelD,EAAnB,EAAuB;EACnB5O,0BAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB1M,MAAvB,GAAgC,EAAhC;EACA;EACA,yBAAK,IAAIqH,QAAQ,CAAjB,EAAoBA,QAAQ9Q,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuBD,UAAvB,CAAkCvS,MAA9D,EAAsEmN,OAAtE,EAA8E;EAC1E9Q,8BAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB1M,MAAvB,CAA8BlG,IAA9B,CAAmCvD,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuBD,UAAvB,CAAkCpF,KAAlC,EAAyC5O,KAA5E;EACH;;EAEDlC,0BAAM+S,SAAN,CAAgBoD,KAAhB,EAAuBD,UAAvB,CAAkC7H,IAAlC,CAAuC,UAASjF,CAAT,EAAWpG,CAAX,EAAc;EAAE,+BAAOnC,YAAA,CAAauI,EAAElH,KAAf,EAAsBc,EAAEd,KAAxB,CAAP;EAAuC,qBAA9F;EACH;;EAED;EACAlC,sBAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB1M,MAAvB,CAA8B4E,IAA9B,CAAmCxN,YAAnC;EACAb,sBAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB3B,OAAvB,GAAiC,EAAjC;EACAxU,sBAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB3B,OAAvB,GAAkCa,YAAYrV,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB1M,MAAnC,CAAlC;EACH;EACJ;;EArHA,eAAS2L,WAAT;EAAA,SAAD;;EAuHA;;;EAGA,KAAC;EAAA,iBAASgB,eAAT,GAA2B;EACxB,gBAAItU,SAAS,EAAb;EACA;EACA9B,kBAAM2E,MAAN,GAAe3E,MAAM8R,QAAN,CAAenN,MAA9B;EACA3E,kBAAMqW,QAAN,GAAiBrW,MAAM8R,QAAN,CAAeO,SAAf,CAAyBnS,KAA1C;EACAF,kBAAMsW,SAAN,GAAkBtW,MAAM8R,QAAN,CAAeO,SAAf,CAAyBjS,MAA3C;EACAJ,kBAAME,KAAN,GAAcF,MAAMqW,QAAN,GAAiBrW,MAAM2E,MAAN,CAAaC,IAA9B,GAAqC5E,MAAM2E,MAAN,CAAaE,KAAhE;EACA7E,kBAAMI,MAAN,GAAeJ,MAAMsW,SAAN,GAAkBtW,MAAM2E,MAAN,CAAaG,GAA/B,GAAqC9E,MAAM2E,MAAN,CAAaI,MAAjE;;EAEA,gBAAI/E,MAAM8R,QAAN,CAAeyE,UAAnB,EAA+B;EAC3BvW,sBAAMwW,UAAN,GAAmBxW,MAAM8R,QAAN,CAAeyE,UAAf,CAA0BzP,KAA7C;EACA9G,sBAAMyW,UAAN,GAAmBzW,MAAM8R,QAAN,CAAeyE,UAAf,CAA0BpQ,KAA7C;EACH,aAHD,MAGO;EACHnG,sBAAMwW,UAAN,GAAmBxW,MAAM8R,QAAN,CAAeE,KAAlC;EACAhS,sBAAMyW,UAAN,GAAmBzW,MAAM8R,QAAN,CAAeI,KAAlC;EACH;;EAED,gBAAIlS,MAAM8R,QAAN,CAAe9Q,KAAf,KAAyB,KAA7B,EAAoC;EAChChB,sBAAM0W,MAAN,GAAe7V,WAAA,EAAf;EACAb,sBAAM6S,UAAN,GAAmBF,eAAnB;EACH,aAHD,MAGO;EACH3S,sBAAM0W,MAAN,GAAe7V,cAAA,EAAf;EACH;;EAED,gBAAIb,MAAM8R,QAAN,CAAeQ,iBAAf,KAAqC,IAAzC,EAA+C;EAC3C,oBAAIqE,SAAS,EAAb;EACA,qBAAK,IAAIR,KAAT,IAAkBnW,MAAM+S,SAAxB,EAAmC;EAC/B4D,2BAAOpT,IAAP,CAAYvD,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB3B,OAAvB,CAA+BiB,eAA3C;EACAkB,2BAAOpT,IAAP,CAAYvD,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB3B,OAAvB,CAA+Be,eAA3C;EACH;EACDvV,sBAAMkB,KAAN,GAAcL,SAAA,CAAU8V,MAAV,CAAd;EAEH,aARD,MAQO;EACH3W,sBAAMkB,KAAN,GAAcL,SAAA,CAAUb,MAAMR,IAAhB,EAAsB,UAAU4B,CAAV,EAAa;EAAC,2BAAOA,EAAEpB,MAAM8R,QAAN,CAAeI,KAAjB,CAAP;EAAgC,iBAApE,CAAd;EACH;;EAEDlS,kBAAMoT,UAAN,GAAmBC,cAAcrT,MAAM8R,QAAN,CAAe9C,MAA7B,CAAnB;;EAEA;EACAhP,kBAAM0W,MAAN,CAAaxV,KAAb,CAAmB,CAAClB,MAAMI,MAAP,EAAe,CAAf,CAAnB,EAAsC0B,MAAtC,CAA6C9B,MAAMkB,KAAnD,EAA0D0V,IAA1D,GAAiEC,KAAjE,CAAuE,IAAvE;;EAEA,gBAAI7W,MAAM8R,QAAN,CAAeG,KAAf,KAAyB,IAA7B,EAAmC;EAC/BnQ,yBAAS+F,OAAO+F,IAAP,CAAY5N,MAAM+S,SAAlB,CAAT;EACH,aAFD,MAEO;EACHjR,yBAASH,MAAMC,OAAN,CAAc5B,MAAM8R,QAAN,CAAeG,KAA7B,IAAsCjS,MAAM8R,QAAN,CAAeG,KAArD,GAA6DpK,OAAO+F,IAAP,CAAY5N,MAAM+S,SAAlB,EAA6B1E,IAA7B,CAAkCxN,YAAlC,CAAtE;EACH;EACDb,kBAAM8T,MAAN,GAAejT,YAAA,GAAeiB,MAAf,CAAsBA,MAAtB,EAA8BD,UAA9B,CAAyC,CAAC,CAAD,EAAI7B,MAAME,KAAV,CAAzC,CAAf;;EAEA;EACAF,kBAAMgT,IAAN,CAAW7M,KAAX,GAAmBtF,WAAA,GACdG,KADc,CACRhB,MAAM0W,MADE,EAEd/M,UAFc,CAEH3J,MAAM6S,UAFH,EAGdtJ,aAHc,CAGA,CAHA,EAIduN,aAJc,CAIA,CAAC9W,MAAME,KAAP,IAAgBF,MAAM2E,MAAN,CAAaE,KAAb,GAAqB7E,MAAM2E,MAAN,CAAaC,IAAlD,CAJA,CAAnB;EAKA;EACA5E,kBAAMgT,IAAN,CAAWlM,KAAX,GAAmBjG,aAAA,GACdG,KADc,CACRhB,MAAM8T,MADE;EAEf;EAFe,aAGdvK,aAHc,CAGA,CAHA,EAIdC,QAJc,CAIL,CAJK,CAAnB;EAKH;;EA5DA,eAAS4M,eAAT;EAAA,SAAD;;EA8DA;;;;EAIApW,UAAM+W,MAAN,GAAe,YAAY;EACvB;EACA/W,cAAME,KAAN,GAAc8W,SAAShX,MAAMgT,IAAN,CAAWE,QAAX,CAAoB5S,KAApB,CAA0B,OAA1B,CAAT,EAA6C,EAA7C,KAAoDN,MAAM2E,MAAN,CAAaC,IAAb,GAAoB5E,MAAM2E,MAAN,CAAaE,KAArF,CAAd;EACA7E,cAAMI,MAAN,GAAe4W,SAAShX,MAAMgT,IAAN,CAAWE,QAAX,CAAoB5S,KAApB,CAA0B,QAA1B,CAAT,EAA8C,EAA9C,KAAqDN,MAAM2E,MAAN,CAAaG,GAAb,GAAmB9E,MAAM2E,MAAN,CAAaI,MAArF,CAAf;EACA;EACA/E,cAAM8T,MAAN,CAAajS,UAAb,CAAwB,CAAC,CAAD,EAAI7B,MAAME,KAAV,CAAxB;EACAF,cAAM0W,MAAN,CAAaxV,KAAb,CAAmB,CAAClB,MAAMI,MAAP,EAAe,CAAf,CAAnB;;EAEA;EACA,YAAIJ,MAAMiX,WAAN,IAAqBjX,MAAMiX,WAAN,CAAkBlK,OAAlB,CAA0BlJ,IAA1B,IAAkC,IAAvD,IAA+D7D,MAAMiX,WAAN,CAAkBlK,OAAlB,CAA0BmK,UAA1B,IAAwC,IAA3G,EAAiH;EAC7GlX,kBAAM0W,MAAN,CAAa5U,MAAb,CAAoB9B,MAAMiX,WAAN,CAAkBlK,OAAlB,CAA0BmK,UAA9C,EAA0DN,IAA1D,GAAiEC,KAAjE,CAAuE,IAAvE;EACH,SAFD,MAEO;EACH7W,kBAAM0W,MAAN,CAAa5U,MAAb,CAAoB9B,MAAMkB,KAA1B,EAAiC0V,IAAjC,GAAwCC,KAAxC,CAA8C,IAA9C;EACH;;EAED;EACA7W,cAAMgT,IAAN,CAAWG,CAAX,CAAazI,MAAb,CAAoB,SAApB,EAA+BzH,IAA/B,CAAoC,WAApC,EAAiD,iBAAiBjD,MAAMI,MAAvB,GAAgC,GAAjF,EAAsFiL,IAAtF,CAA2FrL,MAAMgT,IAAN,CAAWlM,KAAtG,EACKiF,SADL,CACe,YADf,EAEK9I,IAFL,CAEU,GAFV,EAEe,CAFf,EAGKA,IAHL,CAGU,GAHV,EAGe,CAAC,CAHhB,EAIKA,IAJL,CAIU,WAJV,EAIuB,aAJvB,EAKK3C,KALL,CAKW,aALX,EAK0B,KAL1B;EAMAN,cAAMgT,IAAN,CAAWG,CAAX,CAAazI,MAAb,CAAoB,gBAApB,EAAsCzH,IAAtC,CAA2C,GAA3C,EAAgDjD,MAAME,KAAN,GAAc,CAA9D;EACAF,cAAMgT,IAAN,CAAWG,CAAX,CAAazI,MAAb,CAAoB,SAApB,EAA+BW,IAA/B,CAAoCrL,MAAMgT,IAAN,CAAW7M,KAAX,CAAiB2Q,aAAjB,CAA+B,CAAC9W,MAAME,KAAtC,CAApC;EACAF,cAAMgT,IAAN,CAAWG,CAAX,CAAazI,MAAb,CAAoB,gBAApB,EAAsCzH,IAAtC,CAA2C,GAA3C,EAAgD,CAACjD,MAAMI,MAAP,GAAgB,CAAhE;EACAJ,cAAMgT,IAAN,CAAWE,QAAX,CAAoBxI,MAApB,CAA2B,KAA3B,EAAkCzH,IAAlC,CAAuC,OAAvC,EAAgDjD,MAAME,KAAN,IAAeF,MAAM2E,MAAN,CAAaC,IAAb,GAAoB5E,MAAM2E,MAAN,CAAaE,KAAhD,CAAhD,EAAwG5B,IAAxG,CAA6G,QAA7G,EAAuHjD,MAAMI,MAAN,IAAgBJ,MAAM2E,MAAN,CAAaG,GAAb,GAAmB9E,MAAM2E,MAAN,CAAaI,MAAhD,CAAvH;;EAEA,eAAO/E,KAAP;EACH,KA5BD;;EA8BA;;;EAGA,KAAC;EAAA,iBAASmX,YAAT,GAAwB;EACvB;EACAnX,kBAAMgT,IAAN,CAAWC,OAAX,GAAqBpS,SAAA,CAAUb,MAAM8R,QAAN,CAAelK,QAAzB,EAClBtH,KADkB,CACZ,OADY,EACHN,MAAMqW,QAAN,GAAiB,IADd,EAElB/V,KAFkB,CAEZ,QAFY,EAEFN,MAAMsW,SAAN,GAAiB,IAFf,CAArB;EAGA;EACAtW,kBAAMgT,IAAN,CAAWC,OAAX,CAAmB5P,MAAnB,CAA0B,KAA1B,EACGJ,IADH,CACQ,OADR,EACiB,eADjB,EAEG3C,KAFH,CAES,gBAFT,EAE2B,IAF3B,EAGGA,KAHH,CAGS,QAHT,EAGmBN,MAAMsW,SAAN,GAAkB,IAHrC,EAIGjT,MAJH,CAIU,KAJV,EAIiBJ,IAJjB,CAIsB,OAJtB,EAI+B,WAJ/B,EAKGI,MALH,CAKU,KALV,EAKiBJ,IALjB,CAKsB,OALtB,EAK+B,WAL/B;EAMA;EACAjD,kBAAM4H,QAAN,GAAiB5H,MAAM8R,QAAN,CAAelK,QAAf,GAA0B,aAA3C;EACA5H,kBAAMgT,IAAN,CAAWE,QAAX,GAAsBrS,SAAA,CAAUb,MAAM4H,QAAhB,CAAtB;EACA/G,qBAAA,CAAUuW,MAAV,EAAkBxT,EAAlB,CAAqB,YAAY5D,MAAM4H,QAAvC,EAAiD5H,MAAM+W,MAAvD;;EAEA;EACA/W,kBAAMgT,IAAN,CAAWG,CAAX,GAAenT,MAAMgT,IAAN,CAAWE,QAAX,CAAoB7P,MAApB,CAA2B,KAA3B,EACZJ,IADY,CACP,OADO,EACE,YADF,EAEZA,IAFY,CAEP,OAFO,EAEEjD,MAAME,KAAN,IAAeF,MAAM2E,MAAN,CAAaC,IAAb,GAAoB5E,MAAM2E,MAAN,CAAaE,KAAhD,CAFF,EAGZ5B,IAHY,CAGP,QAHO,EAGGjD,MAAMI,MAAN,IAAgBJ,MAAM2E,MAAN,CAAaG,GAAb,GAAmB9E,MAAM2E,MAAN,CAAaI,MAAhD,CAHH,EAIZ1B,MAJY,CAIL,GAJK,EAKZJ,IALY,CAKP,WALO,EAKM,eAAejD,MAAM2E,MAAN,CAAaC,IAA5B,GAAmC,GAAnC,GAAyC5E,MAAM2E,MAAN,CAAaG,GAAtD,GAA4D,GALlE,CAAf;;EAOA;EACA9E,kBAAMgT,IAAN,CAAWnK,IAAX,GAAkB7I,MAAMgT,IAAN,CAAWG,CAAX,CAAa9P,MAAb,CAAoB,GAApB,EAAyBJ,IAAzB,CAA8B,OAA9B,EAAuC,MAAvC,CAAlB;EACAjD,kBAAMgT,IAAN,CAAWnK,IAAX,CAAgBxF,MAAhB,CAAuB,GAAvB,EACKJ,IADL,CACU,OADV,EACmB,QADnB,EAEKA,IAFL,CAEU,WAFV,EAEuB,iBAAiBjD,MAAMI,MAAvB,GAAgC,GAFvD,EAGKiL,IAHL,CAGUrL,MAAMgT,IAAN,CAAWlM,KAHrB,EAIKzD,MAJL,CAIY,MAJZ,EAKKJ,IALL,CAKU,OALV,EAKmB,OALnB,EAMKA,IANL,CAMU,GANV,EAMejD,MAAM2E,MAAN,CAAaI,MAAb,GAAsB,EANrC,EAOK9B,IAPL,CAOU,GAPV,EAOe,CAACjD,MAAME,KAAP,GAAe,CAP9B,EAQK+C,IARL,CAQU,IARV,EAQgB,OARhB,EASKA,IATL,CASU,MATV,EASkB,MATlB,EAUK3C,KAVL,CAUW,aAVX,EAU0B,QAV1B,EAWKgC,IAXL,CAWUtC,MAAMwW,UAXhB;;EAaAxW,kBAAMgT,IAAN,CAAWnK,IAAX,CAAgBxF,MAAhB,CAAuB,GAAvB,EACKJ,IADL,CACU,OADV,EACmB,QADnB,EAEKoI,IAFL,CAEUrL,MAAMgT,IAAN,CAAW7M,KAFrB,EAGK9C,MAHL,CAGY,MAHZ,EAIKJ,IAJL,CAIU,OAJV,EAImB,OAJnB,EAKKA,IALL,CAKU,WALV,EAKuB,aALvB,EAMKA,IANL,CAMU,GANV,EAMe,CAACjD,MAAM2E,MAAN,CAAaC,IAAd,GAAqB,GANpC,EAOK3B,IAPL,CAOU,GAPV,EAOe,CAACjD,MAAMI,MAAP,GAAgB,CAP/B,EAQK6C,IARL,CAQU,IARV,EAQgB,OARhB,EASKA,IATL,CASU,MATV,EASkB,MATlB,EAUK3C,KAVL,CAUW,aAVX,EAU0B,QAV1B,EAWKgC,IAXL,CAWUtC,MAAMyW,UAXhB;;EAaA;EACAzW,kBAAMgT,IAAN,CAAWzQ,OAAX,GAAqBvC,MAAMgT,IAAN,CAAWC,OAAX,CAAmB5P,MAAnB,CAA0B,KAA1B,EAAiCJ,IAAjC,CAAsC,OAAtC,EAA+C,SAA/C,EAA0D3C,KAA1D,CAAgE,SAAhE,EAA2E,MAA3E,CAArB;EACA,iBAAK,IAAI6V,KAAT,IAAkBnW,MAAM+S,SAAxB,EAAmC;EAC/B/S,sBAAM+S,SAAN,CAAgBoD,KAAhB,EAAuBhD,CAAvB,GAA2BnT,MAAMgT,IAAN,CAAWG,CAAX,CAAa9P,MAAb,CAAoB,GAApB,EAAyBJ,IAAzB,CAA8B,OAA9B,EAAuC,OAAvC,CAA3B;EACA;;;;;;;;EAQH;EACDjD,kBAAM+W,MAAN;EACD;;EAnEA,eAASI,YAAT;EAAA,SAAD;;EAqEA;;;;;;;;;;;;;;;EAeAnX,UAAMqX,gBAAN,GAAyB,UAAUtK,OAAV,EAAmB;EACxC/M,cAAMiX,WAAN,GAAoB,EAApB;;EAEA,YAAIK,iBAAiB;EACjBzT,kBAAM,IADW;EAEjB0T,4BAAgB,IAFC;EAGjBC,wBAAY,GAHK;EAIjB9J,uBAAW,EAJM;EAKjBxN,mBAAO,EALU;EAMjBuX,mBAAO5W,gBANU;EAOjBgW,mBAAO,CAPU;EAQjB7H,oBAAQhP,MAAMoT,UARG;EASjB8D,wBAAY,IATK;EAAA,SAArB;EAWAlX,cAAMiX,WAAN,CAAkBlK,OAAlB,GAA4BoH,YAAYmD,cAAZ,CAA5B;EACA,aAAK,IAAIpI,MAAT,IAAmBnC,OAAnB,EAA4B;EACxB/M,kBAAMiX,WAAN,CAAkBlK,OAAlB,CAA0BmC,MAA1B,IAAoCnC,QAAQmC,MAAR,CAApC;EACH;EACD,YAAIwI,QAAQ1X,MAAMiX,WAAN,CAAkBlK,OAA9B;;EAEA;EACA,aAAK,IAAIoJ,KAAT,IAAkBnW,MAAM+S,SAAxB,EAAmC;EAC/B/S,kBAAM+S,SAAN,CAAgBoD,KAAhB,EAAuBwB,MAAvB,GAAgC,EAAhC;EACA3X,kBAAM+S,SAAN,CAAgBoD,KAAhB,EAAuBwB,MAAvB,CAA8B3E,IAA9B,GAAqC,EAArC;EACH;;EAED;;;;EAIAhT,cAAMiX,WAAN,CAAkBlJ,MAAlB,GAA2B,UAAU6J,aAAV,EAAyB;EAChD,gBAAIA,aAAJ,EAAmB;EACf,qBAAK,IAAI5G,GAAT,IAAgB4G,aAAhB,EAA+B;EAC3BF,0BAAM1G,GAAN,IAAa4G,cAAc5G,GAAd,CAAb;EACH;EACJ;;EAED,iBAAK,IAAImF,KAAT,IAAkBnW,MAAM+S,SAAxB,EAAmC;EAC/B/S,sBAAM+S,SAAN,CAAgBoD,KAAhB,EAAuBwB,MAAvB,CAA8B3E,IAA9B,CAAmCG,CAAnC,CAAqCxI,MAArC;EACH;;EAED3K,kBAAMiX,WAAN,CAAkBY,aAAlB;EACA7X,kBAAMiX,WAAN,CAAkBF,MAAlB;EACH,SAbD;;EAeA/W,cAAMiX,WAAN,CAAkBa,KAAlB,GAA0B,YAAY;EAClC9X,kBAAMiX,WAAN,CAAkBlJ,MAAlB,CAAyBuJ,cAAzB;EACH,SAFD;EAGAtX,cAAMiX,WAAN,CAAkBpT,IAAlB,GAAyB,UAAUkU,IAAV,EAAgB;EACrC,gBAAIA,SAASvW,SAAb,EAAwB;EACpBuW,qBAAKlU,IAAL,GAAY,IAAZ;EACA,oBAAIkU,KAAKD,KAAT,EAAgB;EACZ9X,0BAAMiX,WAAN,CAAkBa,KAAlB;EACH;EACJ,aALD,MAKO;EACHC,uBAAO,EAAClU,MAAM,IAAP,EAAP;EACH;EACD7D,kBAAMiX,WAAN,CAAkBlJ,MAAlB,CAAyBgK,IAAzB;EAEH,SAXD;;EAaA/X,cAAMiX,WAAN,CAAkBnT,IAAlB,GAAyB,UAAUiU,IAAV,EAAgB;EACrC,gBAAIA,SAASvW,SAAb,EAAwB;EACpBuW,qBAAKlU,IAAL,GAAY,KAAZ;EACA,oBAAIkU,KAAKD,KAAT,EAAgB;EACZ9X,0BAAMiX,WAAN,CAAkBa,KAAlB;EACH;EACJ,aALD,MAKO;EACHC,uBAAO,EAAClU,MAAM,KAAP,EAAP;EACH;EACD7D,kBAAMiX,WAAN,CAAkBlJ,MAAlB,CAAyBgK,IAAzB;EAEH,SAXD;;EAaA;;;EAGA/X,cAAMiX,WAAN,CAAkBF,MAAlB,GAA2B,YAAY;EACnC,gBAAIZ,KAAJ,EAAW6B,WAAX;;EAEA,iBAAK7B,KAAL,IAAcnW,MAAM+S,SAApB,EAA+B;EAC3BiF,8BAAchY,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuBwB,MAArC;;EAEA;EACA,oBAAIM,UAAUjY,MAAM0W,MAAN,CAAawB,IAAb,EAAd;;EAGA;EACAF,4BAAYG,GAAZ,GAAkBC,uBAAuBC,QAAQX,MAAMhK,SAAd,CAAvB,EAAiDuK,QAAQxR,KAAR,CAAciR,MAAMF,UAApB,CAAjD,CAAlB;EACAQ,4BAAYM,OAAZ,GAAsBN,YAAYG,GAAZ,CAAgBnY,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB1M,MAAvC,CAAtB;;EAEA,oBAAI8O,iBAAiBvY,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB3B,OAAvB,CAA+B9C,GAApD;EAAA,oBACI8G,iBAAiBxY,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB3B,OAAvB,CAA+B/C,GADpD;;EAGA,oBAAIiG,MAAMb,KAAN,IAAe,CAAf,IAAoBa,MAAMb,KAAN,IAAe,CAAC,CAAxC,EAA2C;EAAE;EACzC;EACA;EACA0B,qCAAiB1X,MAAA,CAAOmX,YAAYM,OAAZ,CAAoBlJ,MAApB,CAA2B,UAAUhO,CAAV,EAAa;EAC5D,+BAAQA,EAAEgI,CAAF,GAAMpJ,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB3B,OAAvB,CAA+B9C,GAArC,IAA4CtQ,EAAE4B,CAAF,IAAO,CAA3D;EACH,qBAFuB,CAAP,EAEb,UAAU5B,CAAV,EAAa;EACb,+BAAOA,EAAEgI,CAAT;EACH,qBAJgB,CAAjB;EAKA;EACAoP,qCAAiB3X,MAAA,CAAOmX,YAAYM,OAAZ,CAAoBlJ,MAApB,CAA2B,UAAUhO,CAAV,EAAa;EAC5D,+BAAQA,EAAEgI,CAAF,GAAMpJ,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB3B,OAAvB,CAA+B/C,GAArC,IAA4CrQ,EAAE4B,CAAF,IAAO,CAA3D;EACH,qBAFuB,CAAP,EAEb,UAAU5B,CAAV,EAAa;EACb,+BAAOA,EAAEgI,CAAT;EACH,qBAJgB,CAAjB;EAKA;EACA,wBAAIsO,MAAMb,KAAN,IAAe,CAAC,CAApB,EAAuB;EACnB4B,oCAAYC,YAAYL,QAAQX,MAAMhK,SAAd,CAAZ,EAAsC1N,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB1M,MAA7D,CAAZ;EACA,4BAAI,CAAC8O,cAAL,EAAqB;EACjB,gCAAII,YAAYF,UAAUzY,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB3B,OAAvB,CAA+B9C,GAAzC,CAAhB;EACA,gCAAIkH,YAAY5Y,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB3B,OAAvB,CAA+B9C,GAA/C;EACA,gCAAImH,QAAQ,EAAZ,CAHiB;EAIjB,mCAAOA,QAAQ,CAAR,IAAaF,aAAa,CAAjC,EAAoC;EAChCA,4CAAYF,UAAUG,SAAV,CAAZ;EACAA,6CAAa,CAAb;EACAC,yCAAS,CAAT;EACH;EACDN,6CAAiBK,SAAjB;EACH;EACD,4BAAI,CAACJ,cAAL,EAAqB;EACjB,gCAAIM,YAAYL,UAAUzY,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB3B,OAAvB,CAA+B/C,GAAzC,CAAhB;EACA,gCAAIsH,YAAY/Y,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB3B,OAAvB,CAA+B/C,GAA/C;EACA,gCAAIoH,QAAQ,EAAZ,CAHiB;EAIjB,mCAAOA,QAAQ,CAAR,IAAaC,aAAa,CAAjC,EAAoC;EAChCA,4CAAYL,UAAUM,SAAV,CAAZ;EACAA,6CAAa,CAAb;EACAF,yCAAS,CAAT;EACH;EACDL,6CAAiBO,SAAjB;EACH;EAEJ;EACD;EACA;EACA,wBAAI,CAACrB,MAAMR,UAAX,EAAuBQ,MAAMR,UAAN,GAAmBlX,MAAMkB,KAAN,CAAY8C,KAAZ,CAAkB,CAAlB,CAAnB;EACvB,wBAAIwU,kBAAkBA,iBAAiBd,MAAMR,UAAN,CAAiB,CAAjB,CAAvC,EAA4D;EACxDQ,8BAAMR,UAAN,CAAiB,CAAjB,IAAsBsB,cAAtB;EACH;EACD,wBAAID,kBAAkBA,iBAAiBb,MAAMR,UAAN,CAAiB,CAAjB,CAAvC,EAA4D;EACxDQ,8BAAMR,UAAN,CAAiB,CAAjB,IAAsBqB,cAAtB;EACH;EAGJ;;EAGD,oBAAIb,MAAMH,cAAV,EAA0B;EACtBvX,0BAAM+W,MAAN;EACAkB,8BAAUjY,MAAM0W,MAAN,CAAawB,IAAb,EAAV;;EAEA;EACAF,gCAAYG,GAAZ,GAAkBC,uBAAuBC,QAAQX,MAAMhK,SAAd,CAAvB,EAAiDuK,QAAQxR,KAAR,CAAciR,MAAMF,UAApB,CAAjD,CAAlB;EACAQ,gCAAYM,OAAZ,GAAsBN,YAAYG,GAAZ,CAAgBnY,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB1M,MAAvC,CAAtB;EACH;;EAEDuO,4BAAYM,OAAZ,GAAsBN,YAAYM,OAAZ,CACjBlJ,MADiB,CACV,UAAUhO,CAAV,EAAa;EACjB,2BAAQ,CAACoX,cAAD,IAAmBpX,EAAEgI,CAAF,IAAOoP,cAAlC;EACH,iBAHiB,EAIjBpJ,MAJiB,CAIV,UAAUhO,CAAV,EAAa;EACjB,2BAAQ,CAACmX,cAAD,IAAmBnX,EAAEgI,CAAF,IAAOmP,cAAlC;EACH,iBANiB,CAAtB;EAOH;EACD,iBAAKpC,KAAL,IAAcnW,MAAM+S,SAApB,EAA+B;EAC3BiF,8BAAchY,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuBwB,MAArC;;EAEA;EACA,oBAAIqB,YAAYvF,YAAYiE,MAAMxX,KAAlB,EAAyBiW,KAAzB,CAAhB;EACA,oBAAIjW,QAAQ,CAAC8Y,UAAUnU,KAAV,GAAkBmU,UAAUpU,IAA7B,IAAqC,CAAjD;;EAEA,oBAAIqU,UAAUpY,cAAA,GACTK,KADS,CACH,CAAChB,KAAD,EAAQ,CAAR,CADG,EAET4B,MAFS,CAEF,CAAC,CAAD,EAAIjB,MAAA,CAAOmX,YAAYM,OAAnB,EAA4B,UAAUlX,CAAV,EAAa;EAAC,2BAAOA,EAAE4B,CAAT;EAAY,iBAAtD,CAAJ,CAFE,EAGT6T,KAHS,CAGH,IAHG,CAAd;;EAKA,oBAAIqC,OAAOrY,OAAA,GACN4W,KADM,CACAC,MAAMD,KADN,EAENrO,CAFM,CAEJ,UAAUhI,CAAV,EAAa;EAAC,2BAAO6W,QAAQ7W,EAAEgI,CAAV,CAAP;EAAqB,iBAF/B,EAGN+P,EAHM,CAGHjZ,KAHG,EAINkZ,EAJM,CAIH,UAAUhY,CAAV,EAAa;EAAC,2BAAO6X,QAAQ7X,EAAE4B,CAAV,CAAP;EAAqB,iBAJhC,CAAX;;EAMA,oBAAIH,OAAOhC,OAAA,GACN4W,KADM,CACAC,MAAMD,KADN,EAENrO,CAFM,CAEJ,UAAUhI,CAAV,EAAa;EAAC,2BAAO6W,QAAQ7W,EAAEgI,CAAV,CAAP;EAAqB,iBAF/B,EAGNpG,CAHM,CAGJ,UAAU5B,CAAV,EAAa;EAAC,2BAAO6X,QAAQ7X,EAAE4B,CAAV,CAAP;EAAoB,iBAH9B,CAAX;;EAKA,oBAAIgV,YAAYhF,IAAZ,CAAiBpO,IAAjB,CAAsBsU,IAA1B,EAAgC;EAC5BlB,gCAAYhF,IAAZ,CAAiBpO,IAAjB,CAAsBsU,IAAtB,CACKG,KADL,CACWrB,YAAYM,OADvB,EAEKrV,IAFL,CAEU,GAFV,EAEeiW,IAFf;EAGAlB,gCAAYhF,IAAZ,CAAiBpO,IAAjB,CAAsB/B,IAAtB,CACKwW,KADL,CACWrB,YAAYM,OADvB,EAEKrV,IAFL,CAEU,GAFV,EAEeJ,IAFf;;EAIAmV,gCAAYhF,IAAZ,CAAiBnO,KAAjB,CAAuBqU,IAAvB,CACKG,KADL,CACWrB,YAAYM,OADvB,EAEKrV,IAFL,CAEU,GAFV,EAEeiW,IAFf;EAGAlB,gCAAYhF,IAAZ,CAAiBnO,KAAjB,CAAuBhC,IAAvB,CACKwW,KADL,CACWrB,YAAYM,OADvB,EAEKrV,IAFL,CAEU,GAFV,EAEeJ,IAFf;EAGH;;EAED;EACAmV,4BAAYhF,IAAZ,CAAiBpO,IAAjB,CAAsBuO,CAAtB,CAAwBlQ,IAAxB,CAA6B,WAA7B,EAA0C,mCAAmC+V,UAAUpU,IAA7C,GAAoD,gBAA9F;EACAoT,4BAAYhF,IAAZ,CAAiBnO,KAAjB,CAAuBsO,CAAvB,CAAyBlQ,IAAzB,CAA8B,WAA9B,EAA2C,kCAAkC+V,UAAUnU,KAA5C,GAAoD,GAA/F;EACH;EACJ,SApID;;EAsIA;;;EAGA7E,cAAMiX,WAAN,CAAkBY,aAAlB,GAAkC,YAAY;EAC1C,gBAAI1B,KAAJ,EAAW6B,WAAX;;EAEA,gBAAIN,MAAM1I,MAAV,EAAkB;EACdhP,sBAAMiX,WAAN,CAAkB/R,KAAlB,GAA0BmO,cAAcqE,MAAM1I,MAApB,CAA1B;EACH,aAFD,MAEO;EACHhP,sBAAMiX,WAAN,CAAkB/R,KAAlB,GAA0BlF,MAAMoT,UAAhC;EACH;;EAED,gBAAIsE,MAAM7T,IAAN,IAAc,KAAlB,EAAyB;EAAC;EAAO;;EAEjC,iBAAKsS,KAAL,IAAcnW,MAAM+S,SAApB,EAA+B;EAC3BiF,8BAAchY,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuBwB,MAArC;;EAEAK,4BAAYhF,IAAZ,CAAiBG,CAAjB,GAAqBnT,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuBhD,CAAvB,CAAyB9P,MAAzB,CAAgC,GAAhC,EAAqCJ,IAArC,CAA0C,OAA1C,EAAmD,aAAnD,CAArB;EACA+U,4BAAYhF,IAAZ,CAAiBpO,IAAjB,GAAwB,EAACsU,MAAM,IAAP,EAAarW,MAAM,IAAnB,EAAyBsQ,GAAG,IAA5B,EAAxB;EACA6E,4BAAYhF,IAAZ,CAAiBnO,KAAjB,GAAyB,EAACqU,MAAM,IAAP,EAAarW,MAAM,IAAnB,EAAyBsQ,GAAG,IAA5B,EAAzB;;EAEA6E,4BAAYhF,IAAZ,CAAiBpO,IAAjB,CAAsBuO,CAAtB,GAA0B6E,YAAYhF,IAAZ,CAAiBG,CAAjB,CAAmB9P,MAAnB,CAA0B,GAA1B,CAA1B;EACA2U,4BAAYhF,IAAZ,CAAiBnO,KAAjB,CAAuBsO,CAAvB,GAA2B6E,YAAYhF,IAAZ,CAAiBG,CAAjB,CAAmB9P,MAAnB,CAA0B,GAA1B,CAA3B;;EAEA,oBAAIqU,MAAMH,cAAN,KAAyB,KAA7B,EAAoC;EAChC;EACAS,gCAAYhF,IAAZ,CAAiBpO,IAAjB,CAAsBsU,IAAtB,GAA6BlB,YAAYhF,IAAZ,CAAiBpO,IAAjB,CAAsBuO,CAAtB,CAAwB9P,MAAxB,CAA+B,MAA/B,EACxBJ,IADwB,CACnB,OADmB,EACV,MADU,EAExB3C,KAFwB,CAElB,MAFkB,EAEVN,MAAMiX,WAAN,CAAkB/R,KAAlB,CAAwBiR,KAAxB,CAFU,CAA7B;EAGA6B,gCAAYhF,IAAZ,CAAiBnO,KAAjB,CAAuBqU,IAAvB,GAA8BlB,YAAYhF,IAAZ,CAAiBnO,KAAjB,CAAuBsO,CAAvB,CAAyB9P,MAAzB,CAAgC,MAAhC,EACzBJ,IADyB,CACpB,OADoB,EACX,MADW,EAEzB3C,KAFyB,CAEnB,MAFmB,EAEXN,MAAMiX,WAAN,CAAkB/R,KAAlB,CAAwBiR,KAAxB,CAFW,CAA9B;;EAIA;EACA6B,gCAAYhF,IAAZ,CAAiBpO,IAAjB,CAAsB/B,IAAtB,GAA6BmV,YAAYhF,IAAZ,CAAiBpO,IAAjB,CAAsBuO,CAAtB,CAAwB9P,MAAxB,CAA+B,MAA/B,EACxBJ,IADwB,CACnB,OADmB,EACV,MADU,EAExBA,IAFwB,CAEnB,MAFmB,EAEX,MAFW,EAGxB3C,KAHwB,CAGlB,QAHkB,EAGRN,MAAMiX,WAAN,CAAkB/R,KAAlB,CAAwBiR,KAAxB,CAHQ,CAA7B;EAIA6B,gCAAYhF,IAAZ,CAAiBnO,KAAjB,CAAuBhC,IAAvB,GAA8BmV,YAAYhF,IAAZ,CAAiBnO,KAAjB,CAAuBsO,CAAvB,CAAyB9P,MAAzB,CAAgC,MAAhC,EACzBJ,IADyB,CACpB,OADoB,EACX,MADW,EAEzBA,IAFyB,CAEpB,MAFoB,EAEZ,MAFY,EAGzB3C,KAHyB,CAGnB,QAHmB,EAGTN,MAAMiX,WAAN,CAAkB/R,KAAlB,CAAwBiR,KAAxB,CAHS,CAA9B;EAIH;EAEJ;EAEJ,SA3CD;;EA8CA,iBAASiC,sBAAT,CAAgCkB,MAAhC,EAAwClQ,CAAxC,EAA2C;EACvC,mBAAO,UAAUmQ,MAAV,EAAkB;EACrB,uBAAOnQ,EAAExJ,GAAF,CAAM,UAAUwJ,CAAV,EAAa;EACtB,2BAAO,EAACA,GAAEA,CAAH,EAAMpG,GAAEnC,OAAA,CAAQ0Y,MAAR,EAAgB,UAAUC,CAAV,EAAa;EAAC,mCAAOF,OAAOlQ,IAAIoQ,CAAX,CAAP;EAAsB,yBAApD,CAAR,EAAP;EACH,iBAFM,CAAP;EAGH,aAJD;EAKH;;EAED,iBAASnB,OAAT,CAAiBrX,KAAjB,EAAwB;EACpB,mBAAO,UAAUyY,CAAV,EAAa;EAChB,uBAAO9J,KAAKC,GAAL,CAAS6J,KAAKzY,KAAd,KAAwB,CAAxB,GAA4B,OAAO,IAAIyY,IAAIA,CAAf,IAAoBzY,KAAhD,GAAwD,CAA/D;EACH,aAFD;EAGH;;EAED;EACA;EACA,iBAAS0X,WAAT,CAAqBY,MAArB,EAA6BI,KAA7B,EAAoC;EAChC,mBAAO,UAAUC,KAAV,EAAiB;EACpB,uBAAO9Y,OAAA,CAAQ6Y,KAAR,EAAe,UAAUF,CAAV,EAAa;EAAC,2BAAOF,OAAOK,QAAQH,CAAf,CAAP;EAA0B,iBAAvD,CAAP;EACH,aAFD;EAGH;;EAEDxZ,cAAMiX,WAAN,CAAkBY,aAAlB;;EAEAhX,iBAAA,CAAUuW,MAAV,EAAkBxT,EAAlB,CAAqB,YAAY5D,MAAM4H,QAAlB,GAA6B,aAAlD,EAAiE5H,MAAMiX,WAAN,CAAkBF,MAAnF;EACA/W,cAAMiX,WAAN,CAAkBF,MAAlB;EACA,eAAO/W,KAAP;EACH,KA/RD;;EAiSA;;;;;;;;;;;;;;;;;EAiBAA,UAAM4Z,aAAN,GAAsB,UAAU7M,OAAV,EAAmB;EACrC/M,cAAM6Z,QAAN,GAAiB,EAAjB;;EAEA;EACA,YAAIvC,iBAAiB;EACjBzT,kBAAM,IADW;EAEjBiW,qBAAS,IAFQ;EAGjBC,0BAAc,IAHG;EAIjBC,wBAAY,IAJK;EAKjBC,sBAAU,KALO;EAMjBC,yBAAa,GANI;EAOjBC,0BAAc,IAPG;EAQjBC,sBAAU,EARO;EASjBC,uBAAW,IATM;EAUjBC,6BAAiB,KAVA;EAWjBC,0BAAc,GAXG;EAYjBvL,oBAAQhP,MAAMoT;EAZG,SAArB;EAcApT,cAAM6Z,QAAN,CAAe9M,OAAf,GAAyBoH,YAAYmD,cAAZ,CAAzB;EACA,aAAK,IAAIpI,MAAT,IAAmBnC,OAAnB,EAA4B;EACxB/M,kBAAM6Z,QAAN,CAAe9M,OAAf,CAAuBmC,MAAvB,IAAiCnC,QAAQmC,MAAR,CAAjC;EACH;EACD,YAAIsL,QAAQxa,MAAM6Z,QAAN,CAAe9M,OAA3B;;EAEA;EACA,aAAK,IAAIoJ,KAAT,IAAkBnW,MAAM+S,SAAxB,EAAmC;EAC/B/S,kBAAM+S,SAAN,CAAgBoD,KAAhB,EAAuBsE,OAAvB,GAAiC,EAAjC;EACAza,kBAAM+S,SAAN,CAAgBoD,KAAhB,EAAuBsE,OAAvB,CAA+BzH,IAA/B,GAAsC,EAAtC;EACH;;EAGD;;;EAGA,SAAC;EAAA,qBAAS0H,eAAT,GAA2B;;EAExB;;;;;EAKA,yBAASC,YAAT,CAAsBC,MAAtB,EAA8B;EAC1B,wBAAIC,YAAY,EAAhB;EACA,wBAAIC,YAAY,EAAhB;EACA,wBAAIC,IAAJ,EAAUC,GAAV;EACA,yBAAKA,MAAM,CAAX,EAAcA,OAAOJ,OAAOnR,MAAP,CAAc9F,MAAnC,EAA2CqX,KAA3C,EAAkD;EAC9CD,+BAAO,EAAC7Y,OAAO0Y,OAAOnR,MAAP,CAAcuR,GAAd,CAAR,EAAP;;EAEA,4BAAID,KAAK7Y,KAAL,GAAa0Y,OAAOpG,OAAP,CAAeiB,eAAhC,EAAiD;EAC7C,gCAAIsF,KAAK7Y,KAAL,GAAa0Y,OAAOpG,OAAP,CAAekB,eAAhC,EAAiD;EAC7CmF,0CAAUtX,IAAV,CAAewX,IAAf;EACH,6BAFD,MAEO;EACHD,0CAAUvX,IAAV,CAAewX,IAAf;EACH;EACJ,yBAND,MAMO,IAAIA,KAAK7Y,KAAL,GAAa0Y,OAAOpG,OAAP,CAAee,eAAhC,EAAiD;EACpD,gCAAIwF,KAAK7Y,KAAL,GAAa0Y,OAAOpG,OAAP,CAAec,eAAhC,EAAiD;EAC7CuF,0CAAUtX,IAAV,CAAewX,IAAf;EACH,6BAFD,MAEO;EACHD,0CAAUvX,IAAV,CAAewX,IAAf;EACH;EACJ;EACJ;EACDH,2BAAOH,OAAP,CAAezH,IAAf,CAAoBiI,QAApB,GAA+BH,SAA/B;EACAF,2BAAOH,OAAP,CAAezH,IAAf,CAAoBkI,QAApB,GAA+BL,SAA/B;EACH;;EAED,qBAAK,IAAI1E,KAAT,IAAkBnW,MAAM+S,SAAxB,EAAmC;EAC/B4H,iCAAa3a,MAAM+S,SAAN,CAAgBoD,KAAhB,CAAb;EACH;EACJ;;EAnCA,mBAASuE,eAAT;EAAA,aAAD;;EAqCA;;;;EAIA1a,cAAM6Z,QAAN,CAAe9L,MAAf,GAAwB,UAAU6J,aAAV,EAAyB;EAC7C,gBAAIA,aAAJ,EAAmB;EACf,qBAAK,IAAI5G,GAAT,IAAgB4G,aAAhB,EAA+B;EAC3B4C,0BAAMxJ,GAAN,IAAa4G,cAAc5G,GAAd,CAAb;EACH;EACJ;;EAED,iBAAK,IAAImF,KAAT,IAAkBnW,MAAM+S,SAAxB,EAAmC;EAC/B/S,sBAAM+S,SAAN,CAAgBoD,KAAhB,EAAuBsE,OAAvB,CAA+BzH,IAA/B,CAAoCG,CAApC,CAAsCxI,MAAtC;EACH;EACD3K,kBAAM6Z,QAAN,CAAesB,cAAf;EACAnb,kBAAM6Z,QAAN,CAAe9C,MAAf;EACH,SAZD;;EAcA/W,cAAM6Z,QAAN,CAAe/B,KAAf,GAAuB,YAAY;EAC/B9X,kBAAM6Z,QAAN,CAAe9L,MAAf,CAAsBuJ,cAAtB;EACH,SAFD;EAGAtX,cAAM6Z,QAAN,CAAehW,IAAf,GAAsB,UAAUkU,IAAV,EAAgB;EAClC,gBAAIA,SAASvW,SAAb,EAAwB;EACpBuW,qBAAKlU,IAAL,GAAY,IAAZ;EACA,oBAAIkU,KAAKD,KAAT,EAAgB;EACZ9X,0BAAM6Z,QAAN,CAAe/B,KAAf;EACH;EACJ,aALD,MAKO;EACHC,uBAAO,EAAClU,MAAM,IAAP,EAAP;EACH;EACD7D,kBAAM6Z,QAAN,CAAe9L,MAAf,CAAsBgK,IAAtB;EAEH,SAXD;EAYA/X,cAAM6Z,QAAN,CAAe/V,IAAf,GAAsB,UAAUiU,IAAV,EAAgB;EAClC,gBAAIA,SAASvW,SAAb,EAAwB;EACpBuW,qBAAKlU,IAAL,GAAY,KAAZ;EACA,oBAAIkU,KAAKD,KAAT,EAAgB;EACZ9X,0BAAM6Z,QAAN,CAAe/B,KAAf;EACH;EACJ,aALD,MAKO;EACHC,uBAAO,EAAClU,MAAM,KAAP,EAAP;EACH;EACD7D,kBAAM6Z,QAAN,CAAe9L,MAAf,CAAsBgK,IAAtB;EACH,SAVD;;EAYA;;;EAGA/X,cAAM6Z,QAAN,CAAe9C,MAAf,GAAwB,YAAY;EAChC,gBAAIZ,KAAJ,EAAWiF,QAAX;;EAEA,iBAAKjF,KAAL,IAAcnW,MAAM+S,SAApB,EAA+B;EAC3BqI,2BAAWpb,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuBsE,OAAlC;;EAEA;EACA,oBAAIzB,YAAYvF,YAAY+G,MAAMJ,QAAlB,EAA4BjE,KAA5B,CAAhB;EACA,oBAAIjW,QAAS8Y,UAAUnU,KAAV,GAAkBmU,UAAUpU,IAAzC;;EAEA,oBAAIyW,WAAW,EAAf,CAP2B;EAQ3B,qBAAK,IAAIpY,IAAT,IAAiBjD,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB3B,OAAxC,EAAiD;EAC7C6G,6BAASpY,IAAT,IAAiB,IAAjB;EACAoY,6BAASpY,IAAT,IAAiBjD,MAAM0W,MAAN,CAAa1W,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB3B,OAAvB,CAA+BvR,IAA/B,CAAb,CAAjB;EACH;;EAED;EACA,oBAAImY,SAASpI,IAAT,CAAcsI,GAAlB,EAAuB;EACnBF,6BAASpI,IAAT,CAAcsI,GAAd,CACKrY,IADL,CACU,GADV,EACe+V,UAAUpU,IADzB,EAEK3B,IAFL,CAEU,OAFV,EAEmB/C,KAFnB,EAGK+C,IAHL,CAGU,GAHV,EAGeoY,SAASvG,SAHxB,EAIK7R,IAJL,CAIU,IAJV,EAIgB,CAJhB,EAKKA,IALL,CAKU,IALV,EAKgB,CALhB,EAMKA,IANL,CAMU,QANV,EAMoB,CAACoY,SAASvG,SAAV,GAAsBuG,SAASpG,SANnD;EAOH;;EAED;EACA,oBAAIsG,aAAa,IAAjB;EACA,oBAAIf,MAAMH,SAAV,EAAqB;EACjBkB,iCAAa9H,YAAY+G,MAAMH,SAAlB,EAA6BlE,KAA7B,CAAb;EACH,iBAFD,MAEO;EACHoF,iCAAavC,SAAb;EACH;EACD;EACA,oBAAIoC,SAASpI,IAAT,CAAcwI,YAAlB,EAAgC;EAC5BJ,6BAASpI,IAAT,CAAcwI,YAAd,CAA2BC,KAA3B,CACKxY,IADL,CACU,IADV,EACgBsY,WAAW3W,IAD3B,EAEK3B,IAFL,CAEU,IAFV,EAEgBsY,WAAW1W,KAF3B,EAGK5B,IAHL,CAGU,IAHV,EAGgBoY,SAAS9F,eAHzB,EAIKtS,IAJL,CAIU,IAJV,EAIgBoY,SAAS9F,eAJzB;EAKA6F,6BAASpI,IAAT,CAAcwI,YAAd,CAA2B3Y,IAA3B,CACKI,IADL,CACU,IADV,EACgBsY,WAAW1H,MAD3B,EAEK5Q,IAFL,CAEU,IAFV,EAEgBsY,WAAW1H,MAF3B,EAGK5Q,IAHL,CAGU,IAHV,EAGgBoY,SAASvG,SAHzB,EAIK7R,IAJL,CAIU,IAJV,EAIgBoY,SAAS9F,eAJzB;;EAMA6F,6BAASpI,IAAT,CAAc0I,YAAd,CAA2BD,KAA3B,CACKxY,IADL,CACU,IADV,EACgBsY,WAAW3W,IAD3B,EAEK3B,IAFL,CAEU,IAFV,EAEgBsY,WAAW1W,KAF3B,EAGK5B,IAHL,CAGU,IAHV,EAGgBoY,SAAS5F,eAHzB,EAIKxS,IAJL,CAIU,IAJV,EAIgBoY,SAAS5F,eAJzB;EAKA2F,6BAASpI,IAAT,CAAc0I,YAAd,CAA2B7Y,IAA3B,CACKI,IADL,CACU,IADV,EACgBsY,WAAW1H,MAD3B,EAEK5Q,IAFL,CAEU,IAFV,EAEgBsY,WAAW1H,MAF3B,EAGK5Q,IAHL,CAGU,IAHV,EAGgBoY,SAASpG,SAHzB,EAIKhS,IAJL,CAIU,IAJV,EAIgBoY,SAAS5F,eAJzB;EAKH;;EAED;EACA,oBAAI2F,SAASpI,IAAT,CAAcgC,MAAlB,EAA0B;EACtBoG,6BAASpI,IAAT,CAAcgC,MAAd,CAAqBnS,IAArB,CACKI,IADL,CACU,IADV,EACgBsY,WAAW3W,IAD3B,EAEK3B,IAFL,CAEU,IAFV,EAEgBsY,WAAW1W,KAF3B,EAGK5B,IAHL,CAGU,IAHV,EAGgBoY,SAASrG,MAHzB,EAIK/R,IAJL,CAIU,IAJV,EAIgBoY,SAASrG,MAJzB;EAKAoG,6BAASpI,IAAT,CAAcgC,MAAd,CAAqB2G,MAArB,CACK1Y,IADL,CACU,IADV,EACgBsY,WAAW1H,MAD3B,EAEK5Q,IAFL,CAEU,IAFV,EAEgBoY,SAASrG,MAFzB;EAGH;;EAED;EACA,oBAAIoG,SAASpI,IAAT,CAAc+B,IAAlB,EAAwB;EACpBqG,6BAASpI,IAAT,CAAc+B,IAAd,CAAmBlS,IAAnB,CACKI,IADL,CACU,IADV,EACgBsY,WAAW3W,IAD3B,EAEK3B,IAFL,CAEU,IAFV,EAEgBsY,WAAW1W,KAF3B,EAGK5B,IAHL,CAGU,IAHV,EAGgBoY,SAAStG,IAHzB,EAIK9R,IAJL,CAIU,IAJV,EAIgBoY,SAAStG,IAJzB;EAKAqG,6BAASpI,IAAT,CAAc+B,IAAd,CAAmB4G,MAAnB,CACK1Y,IADL,CACU,IADV,EACgBsY,WAAW1H,MAD3B,EAEK5Q,IAFL,CAEU,IAFV,EAEgBoY,SAAStG,IAFzB;EAGH;;EAED;;EAEA,oBAAI6G,EAAJ;EACA,oBAAIR,SAASpI,IAAT,CAAciI,QAAlB,EAA4B;EACxB,yBAAKW,EAAL,IAAWR,SAASpI,IAAT,CAAciI,QAAzB,EAAmC;EAC/BG,iCAASpI,IAAT,CAAciI,QAAd,CAAuBW,EAAvB,EAA2BC,KAA3B,CACK5Y,IADL,CACU,IADV,EACgB+V,UAAUnF,MAAV,GAAmBG,UAAUwG,MAAMF,eAAhB,EAAiCpa,KAAjC,CADnC,EAEK+C,IAFL,CAEU,IAFV,EAEgBjD,MAAM0W,MAAN,CAAa0E,SAASpI,IAAT,CAAciI,QAAd,CAAuBW,EAAvB,EAA2B1Z,KAAxC,CAFhB;EAGH;EACJ;EACD,oBAAIkZ,SAASpI,IAAT,CAAckI,QAAlB,EAA4B;EACxB,yBAAKU,EAAL,IAAWR,SAASpI,IAAT,CAAckI,QAAzB,EAAmC;EAC/BE,iCAASpI,IAAT,CAAckI,QAAd,CAAuBU,EAAvB,EAA2BC,KAA3B,CACK5Y,IADL,CACU,IADV,EACgB+V,UAAUnF,MAAV,GAAmBG,UAAUwG,MAAMF,eAAhB,EAAiCpa,KAAjC,CADnC,EAEK+C,IAFL,CAEU,IAFV,EAEgBjD,MAAM0W,MAAN,CAAa0E,SAASpI,IAAT,CAAckI,QAAd,CAAuBU,EAAvB,EAA2B1Z,KAAxC,CAFhB;EAGH;EACJ;EACJ;EACJ,SArGD;;EAuGA;;;EAGAlC,cAAM6Z,QAAN,CAAesB,cAAf,GAAgC,YAAY;EACxC,gBAAIhF,KAAJ,EAAWiF,QAAX;;EAEA,gBAAIZ,MAAMxL,MAAV,EAAkB;EACdhP,sBAAM6Z,QAAN,CAAezG,UAAf,GAA4BC,cAAcmH,MAAMxL,MAApB,CAA5B;EACH,aAFD,MAEO;EACHhP,sBAAM6Z,QAAN,CAAezG,UAAf,GAA4BpT,MAAMoT,UAAlC;EACH;;EAED,gBAAIoH,MAAM3W,IAAN,IAAc,KAAlB,EAAyB;EACrB;EACH;;EAED,iBAAKsS,KAAL,IAAcnW,MAAM+S,SAApB,EAA+B;EAC3BqI,2BAAWpb,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuBsE,OAAlC;;EAEAW,yBAASpI,IAAT,CAAcG,CAAd,GAAkBnT,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuBhD,CAAvB,CAAyB9P,MAAzB,CAAgC,GAAhC,EAAqCJ,IAArC,CAA0C,OAA1C,EAAmD,UAAnD,CAAlB;;EAEA;EACA,oBAAIuX,MAAMV,OAAV,EAAmB;EACfsB,6BAASpI,IAAT,CAAcsI,GAAd,GAAoBF,SAASpI,IAAT,CAAcG,CAAd,CAAgB9P,MAAhB,CAAuB,MAAvB,EACfJ,IADe,CACV,OADU,EACD,KADC,EAEf3C,KAFe,CAET,MAFS,EAEDN,MAAM6Z,QAAN,CAAezG,UAAf,CAA0B+C,KAA1B,CAFC,EAGf7V,KAHe,CAGT,QAHS,EAGCN,MAAM6Z,QAAN,CAAezG,UAAf,CAA0B+C,KAA1B,CAHD,CAApB;EAIA;EACA;EACH;;EAED;EACA,oBAAIqE,MAAMR,UAAV,EAAsB;EAClBoB,6BAASpI,IAAT,CAAcgC,MAAd,GAAuB,EAACnS,MAAM,IAAP,EAAa8Y,QAAQ,IAArB,EAAvB;EACAP,6BAASpI,IAAT,CAAcgC,MAAd,CAAqBnS,IAArB,GAA4BuY,SAASpI,IAAT,CAAcG,CAAd,CAAgB9P,MAAhB,CAAuB,MAAvB,EACvBJ,IADuB,CAClB,OADkB,EACT,QADS,CAA5B;EAEAmY,6BAASpI,IAAT,CAAcgC,MAAd,CAAqB2G,MAArB,GAA8BP,SAASpI,IAAT,CAAcG,CAAd,CAAgB9P,MAAhB,CAAuB,QAAvB,EACzBJ,IADyB,CACpB,OADoB,EACX,QADW,EAEzBA,IAFyB,CAEpB,GAFoB,EAEfuX,MAAMN,WAFS,EAGzB5Z,KAHyB,CAGnB,MAHmB,EAGXN,MAAM6Z,QAAN,CAAezG,UAAf,CAA0B+C,KAA1B,CAHW,EAIzBvS,EAJyB,CAItB,WAJsB,EAIT,YAAY;EACzB5D,8BAAMgT,IAAN,CAAWzQ,OAAX,CACKjC,KADL,CACW,SADX,EACsB,IADtB,EAEKA,KAFL,CAEW,MAFX,EAEoBO,QAAA,CAASib,KAAV,GAAmB,IAFtC,EAGKxb,KAHL,CAGW,KAHX,EAGmBO,QAAA,CAASkb,KAAT,GAAiB,EAAlB,GAAwB,IAH1C;EAIH,qBATyB,EASvBnY,EATuB,CASpB,UAToB,EASR,YAAY;EAC5B5D,8BAAMgT,IAAN,CAAWzQ,OAAX,CAAmBjC,KAAnB,CAAyB,SAAzB,EAAoC,MAApC;EACD,qBAXyB,EAWvBsD,EAXuB,CAWpB,WAXoB,EAWP0Q,aAAa6B,KAAb,EAAoBnW,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB3B,OAA3C,EAAoD,EAApD,EAAwD,EAAxD,EAA4D,QAA5D,CAXO,CAA9B;EAYH;;EAED;EACA,oBAAIgG,MAAMP,QAAV,EAAoB;EAChBmB,6BAASpI,IAAT,CAAc+B,IAAd,GAAqB,EAAClS,MAAM,IAAP,EAAa8Y,QAAQ,IAArB,EAArB;EACAP,6BAASpI,IAAT,CAAc+B,IAAd,CAAmBlS,IAAnB,GAA0BuY,SAASpI,IAAT,CAAcG,CAAd,CAAgB9P,MAAhB,CAAuB,MAAvB,EACrBJ,IADqB,CAChB,OADgB,EACP,MADO,CAA1B;EAEAmY,6BAASpI,IAAT,CAAc+B,IAAd,CAAmB4G,MAAnB,GAA4BP,SAASpI,IAAT,CAAcG,CAAd,CAAgB9P,MAAhB,CAAuB,QAAvB,EACvBJ,IADuB,CAClB,OADkB,EACT,MADS,EAEvBA,IAFuB,CAElB,GAFkB,EAEbuX,MAAMN,WAFO,EAGvB5Z,KAHuB,CAGjB,MAHiB,EAGTN,MAAM6Z,QAAN,CAAezG,UAAf,CAA0B+C,KAA1B,CAHS,EAIvBvS,EAJuB,CAIpB,WAJoB,EAIP,YAAY;EACzB5D,8BAAMgT,IAAN,CAAWzQ,OAAX,CACKjC,KADL,CACW,SADX,EACsB,IADtB,EAEKA,KAFL,CAEW,MAFX,EAEoBO,QAAA,CAASib,KAAV,GAAmB,IAFtC,EAGKxb,KAHL,CAGW,KAHX,EAGmBO,QAAA,CAASkb,KAAT,GAAiB,EAAlB,GAAwB,IAH1C;EAIH,qBATuB,EASrBnY,EATqB,CASlB,UATkB,EASN,YAAY;EAC5B5D,8BAAMgT,IAAN,CAAWzQ,OAAX,CAAmBjC,KAAnB,CAAyB,SAAzB,EAAoC,MAApC;EACD,qBAXuB,EAWrBsD,EAXqB,CAWlB,WAXkB,EAWL0Q,aAAa6B,KAAb,EAAoBnW,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB3B,OAA3C,EAAoD,EAApD,EAAwD,EAAxD,EAA4D,MAA5D,CAXK,CAA5B;EAYH;;EAED;EACA,oBAAIgG,MAAMT,YAAV,EAAwB;EACpBqB,6BAASpI,IAAT,CAAcwI,YAAd,GAA6B,EAACC,OAAO,IAAR,EAAc5Y,MAAM,IAApB,EAA7B;EACAuY,6BAASpI,IAAT,CAAc0I,YAAd,GAA6B,EAACD,OAAO,IAAR,EAAc5Y,MAAM,IAApB,EAA7B;EACAuY,6BAASpI,IAAT,CAAcwI,YAAd,CAA2BC,KAA3B,GAAmCL,SAASpI,IAAT,CAAcG,CAAd,CAAgB9P,MAAhB,CAAuB,MAAvB,EAC9BJ,IAD8B,CACzB,OADyB,EAChB,eADgB,EAE9B3C,KAF8B,CAExB,QAFwB,EAEdN,MAAM6Z,QAAN,CAAezG,UAAf,CAA0B+C,KAA1B,CAFc,CAAnC;EAGAiF,6BAASpI,IAAT,CAAcwI,YAAd,CAA2B3Y,IAA3B,GAAkCuY,SAASpI,IAAT,CAAcG,CAAd,CAAgB9P,MAAhB,CAAuB,MAAvB,EAC7BJ,IAD6B,CACxB,OADwB,EACf,eADe,EAE7B3C,KAF6B,CAEvB,QAFuB,EAEbN,MAAM6Z,QAAN,CAAezG,UAAf,CAA0B+C,KAA1B,CAFa,CAAlC;;EAIAiF,6BAASpI,IAAT,CAAc0I,YAAd,CAA2BD,KAA3B,GAAmCL,SAASpI,IAAT,CAAcG,CAAd,CAAgB9P,MAAhB,CAAuB,MAAvB,EAC9BJ,IAD8B,CACzB,OADyB,EAChB,eADgB,EAE9B3C,KAF8B,CAExB,QAFwB,EAEdN,MAAM6Z,QAAN,CAAezG,UAAf,CAA0B+C,KAA1B,CAFc,CAAnC;EAGAiF,6BAASpI,IAAT,CAAc0I,YAAd,CAA2B7Y,IAA3B,GAAkCuY,SAASpI,IAAT,CAAcG,CAAd,CAAgB9P,MAAhB,CAAuB,MAAvB,EAC7BJ,IAD6B,CACxB,OADwB,EACf,eADe,EAE7B3C,KAF6B,CAEvB,QAFuB,EAEbN,MAAM6Z,QAAN,CAAezG,UAAf,CAA0B+C,KAA1B,CAFa,CAAlC;EAGH;;EAED;EACA,oBAAIqE,MAAML,YAAV,EAAwB;EACpB,wBAAI,CAACiB,SAASpI,IAAT,CAAciI,QAAnB,EAA6BP;EAC7B,wBAAIkB,EAAJ;EACA,wBAAIR,SAASpI,IAAT,CAAciI,QAAd,CAAuBtX,MAA3B,EAAmC;EAC/B,4BAAIqY,SAASZ,SAASpI,IAAT,CAAcG,CAAd,CAAgB9P,MAAhB,CAAuB,GAAvB,EAA4BJ,IAA5B,CAAiC,OAAjC,EAA0C,kBAA1C,CAAb;EACA,6BAAK2Y,EAAL,IAAWR,SAASpI,IAAT,CAAciI,QAAzB,EAAmC;EAC/BG,qCAASpI,IAAT,CAAciI,QAAd,CAAuBW,EAAvB,EAA2BC,KAA3B,GAAmCG,OAAO3Y,MAAP,CAAc,QAAd,EAC9BJ,IAD8B,CACzB,OADyB,EAChB,SADgB,EAE9BA,IAF8B,CAEzB,GAFyB,EAEpBuX,MAAMD,YAFc,EAG9Bja,KAH8B,CAGxB,MAHwB,EAGhBN,MAAM6Z,QAAN,CAAezG,UAAf,CAA0B+C,KAA1B,CAHgB,CAAnC;EAIH;EACJ;;EAED,wBAAIiF,SAASpI,IAAT,CAAckI,QAAd,CAAuBvX,MAA3B,EAAmC;EAC/B,4BAAIsY,SAASb,SAASpI,IAAT,CAAcG,CAAd,CAAgB9P,MAAhB,CAAuB,GAAvB,EAA4BJ,IAA5B,CAAiC,OAAjC,EAA0C,kBAA1C,CAAb;EACA,6BAAK2Y,EAAL,IAAWR,SAASpI,IAAT,CAAckI,QAAzB,EAAmC;EAC/BE,qCAASpI,IAAT,CAAckI,QAAd,CAAuBU,EAAvB,EAA2BC,KAA3B,GAAmCI,OAAO5Y,MAAP,CAAc,QAAd,EAC9BJ,IAD8B,CACzB,OADyB,EAChB,SADgB,EAE9BA,IAF8B,CAEzB,GAFyB,EAEpBuX,MAAMD,YAFc,EAG9Bja,KAH8B,CAGxB,QAHwB,EAGdN,MAAM6Z,QAAN,CAAezG,UAAf,CAA0B+C,KAA1B,CAHc,CAAnC;EAIH;EACJ;EACJ;EAGJ;EACJ,SAhHD;EAiHAnW,cAAM6Z,QAAN,CAAesB,cAAf;;EAEAta,iBAAA,CAAUuW,MAAV,EAAkBxT,EAAlB,CAAqB,YAAY5D,MAAM4H,QAAlB,GAA6B,UAAlD,EAA8D5H,MAAM6Z,QAAN,CAAe9C,MAA7E;EACA/W,cAAM6Z,QAAN,CAAe9C,MAAf;EACA,eAAO/W,KAAP;EAEH,KAxVD;;EA0VA;;;;;;;;;;;;;EAaAA,UAAMkc,gBAAN,GAAyB,UAAUnP,OAAV,EAAmB;EACxC/M,cAAMmc,UAAN,GAAmB,EAAnB;;EAEA;EACA,YAAI7E,iBAAiB;EACjBzT,kBAAM,IADW;EAEjBuY,0BAAc,IAFG;EAGjBC,uBAAW,KAHM;EAIjBjC,sBAAU,EAJO;EAKjBkC,yBAAa,EALI;EAMjBjC,uBAAW,EANM;EAOjBkC,wBAAY,IAPK;EAQjBvN,oBAAQ;EARS,SAArB;EAUAhP,cAAMmc,UAAN,CAAiBpP,OAAjB,GAA2BoH,YAAYmD,cAAZ,CAA3B;EACA,aAAK,IAAIpI,MAAT,IAAmBnC,OAAnB,EAA4B;EACxB/M,kBAAMmc,UAAN,CAAiBpP,OAAjB,CAAyBmC,MAAzB,IAAmCnC,QAAQmC,MAAR,CAAnC;EACH;EACD,YAAIsN,QAAQxc,MAAMmc,UAAN,CAAiBpP,OAA7B;;EAEA;EACA,aAAK,IAAIoJ,KAAT,IAAkBnW,MAAM+S,SAAxB,EAAmC;EAC/B/S,kBAAM+S,SAAN,CAAgBoD,KAAhB,EAAuBsG,QAAvB,GAAkC,EAAlC;EACAzc,kBAAM+S,SAAN,CAAgBoD,KAAhB,EAAuBsG,QAAvB,CAAgCzJ,IAAhC,GAAuC,EAAvC;EACH;;EAED;;;;;;EAMA,iBAAS0J,YAAT,CAAsBC,MAAtB,EAA8BC,WAA9B,EAA2C;EACvC,gBAAIC,eAAe,EAAnB;EACA,gBAAIL,MAAMD,UAAN,IAAoB,KAAxB,EAA+B;EAC3BM,+BAAe,CACX,CAACD,YAAYE,OAAb,EAAsB9c,MAAM0W,MAAN,CAAaiG,OAAOnI,OAAP,CAAeS,SAA5B,CAAtB,CADW,EAEX,CAAC2H,YAAYE,OAAb,EAAsB9c,MAAM0W,MAAN,CAAaiG,OAAOnI,OAAP,CAAeuI,UAA5B,CAAtB,CAFW,EAGX,CAACH,YAAYI,UAAb,EAAyBhd,MAAM0W,MAAN,CAAaiG,OAAOnI,OAAP,CAAeuI,UAA5B,CAAzB,CAHW,EAIX,CAACH,YAAYI,UAAb,EAAyBhd,MAAM0W,MAAN,CAAaiG,OAAOnI,OAAP,CAAeQ,MAA5B,CAAzB,CAJW,EAKX,CAAC4H,YAAYI,UAAb,EAAyBhd,MAAM0W,MAAN,CAAaiG,OAAOnI,OAAP,CAAeyI,UAA5B,CAAzB,CALW,EAMX,CAACL,YAAYE,OAAb,EAAsB9c,MAAM0W,MAAN,CAAaiG,OAAOnI,OAAP,CAAeyI,UAA5B,CAAtB,CANW,EAOX,CAACL,YAAYE,OAAb,EAAsB9c,MAAM0W,MAAN,CAAaiG,OAAOnI,OAAP,CAAeM,SAA5B,CAAtB,CAPW,EAQX,CAAC8H,YAAYM,QAAb,EAAuBld,MAAM0W,MAAN,CAAaiG,OAAOnI,OAAP,CAAeM,SAA5B,CAAvB,CARW,EASX,CAAC8H,YAAYM,QAAb,EAAuBld,MAAM0W,MAAN,CAAaiG,OAAOnI,OAAP,CAAeyI,UAA5B,CAAvB,CATW,EAUX,CAACL,YAAYO,WAAb,EAA0Bnd,MAAM0W,MAAN,CAAaiG,OAAOnI,OAAP,CAAeyI,UAA5B,CAA1B,CAVW,EAWX,CAACL,YAAYO,WAAb,EAA0Bnd,MAAM0W,MAAN,CAAaiG,OAAOnI,OAAP,CAAeQ,MAA5B,CAA1B,CAXW,EAYX,CAAC4H,YAAYO,WAAb,EAA0Bnd,MAAM0W,MAAN,CAAaiG,OAAOnI,OAAP,CAAeuI,UAA5B,CAA1B,CAZW,EAaX,CAACH,YAAYM,QAAb,EAAuBld,MAAM0W,MAAN,CAAaiG,OAAOnI,OAAP,CAAeuI,UAA5B,CAAvB,CAbW,EAcX,CAACH,YAAYM,QAAb,EAAuBld,MAAM0W,MAAN,CAAaiG,OAAOnI,OAAP,CAAeS,SAA5B,CAAvB,CAdW,CAAf;EAgBH,aAjBD,MAiBO;EACH4H,+BAAe,CACX,CAACD,YAAYE,OAAb,EAAsB9c,MAAM0W,MAAN,CAAaiG,OAAOnI,OAAP,CAAeS,SAA5B,CAAtB,CADW,EAEX,CAAC2H,YAAYE,OAAb,EAAsB9c,MAAM0W,MAAN,CAAaiG,OAAOnI,OAAP,CAAeuI,UAA5B,CAAtB,CAFW,EAGX,CAACH,YAAYI,UAAb,EAAyBhd,MAAM0W,MAAN,CAAaiG,OAAOnI,OAAP,CAAeQ,MAA5B,CAAzB,CAHW,EAIX,CAAC4H,YAAYE,OAAb,EAAsB9c,MAAM0W,MAAN,CAAaiG,OAAOnI,OAAP,CAAeyI,UAA5B,CAAtB,CAJW,EAKX,CAACL,YAAYE,OAAb,EAAsB9c,MAAM0W,MAAN,CAAaiG,OAAOnI,OAAP,CAAeM,SAA5B,CAAtB,CALW,EAMX,CAAC8H,YAAYM,QAAb,EAAuBld,MAAM0W,MAAN,CAAaiG,OAAOnI,OAAP,CAAeM,SAA5B,CAAvB,CANW,EAOX,CAAC8H,YAAYM,QAAb,EAAuBld,MAAM0W,MAAN,CAAaiG,OAAOnI,OAAP,CAAeyI,UAA5B,CAAvB,CAPW,EAQX,CAACL,YAAYO,WAAb,EAA0Bnd,MAAM0W,MAAN,CAAaiG,OAAOnI,OAAP,CAAeQ,MAA5B,CAA1B,CARW,EASX,CAAC4H,YAAYM,QAAb,EAAuBld,MAAM0W,MAAN,CAAaiG,OAAOnI,OAAP,CAAeuI,UAA5B,CAAvB,CATW,EAUX,CAACH,YAAYM,QAAb,EAAuBld,MAAM0W,MAAN,CAAaiG,OAAOnI,OAAP,CAAeS,SAA5B,CAAvB,CAVW,CAAf;EAYH;EACD,mBAAO4H,aAAajd,GAAb,CAAiB,UAAUwB,CAAV,EAAa;EACjC,uBAAO,CAACA,EAAE,CAAF,CAAD,EAAOA,EAAE,CAAF,CAAP,EAAaoC,IAAb,CAAkB,GAAlB,CAAP;EACH,aAFM,EAEJA,IAFI,CAEC,GAFD,CAAP;EAGH;;EAED;;;EAGA,SAAC;EAAA,qBAAS4Z,WAAT,GAAuB;EACpB,oBAAIT,MAAJ,EAAYU,QAAZ;EACA,qBAAK,IAAIlH,KAAT,IAAkBnW,MAAM+S,SAAxB,EAAmC;EAC/B4J,6BAAS3c,MAAM+S,SAAN,CAAgBoD,KAAhB,CAAT;EACAkH,+BAAY,QAAQV,OAAOnI,OAAP,CAAegB,GAAf,GAAqB7F,KAAK2N,IAAL,CAAUX,OAAOlT,MAAP,CAAc9F,MAAxB,CAA7B,CAAZ;EACAgZ,2BAAOnI,OAAP,CAAeyI,UAAf,GAA4BN,OAAOnI,OAAP,CAAeQ,MAAf,GAAwBqI,QAApD;EACAV,2BAAOnI,OAAP,CAAeuI,UAAf,GAA4BJ,OAAOnI,OAAP,CAAeQ,MAAf,GAAwBqI,QAApD;EACH;EACJ;;EARA,mBAASD,WAAT;EAAA,aAAD;;EAUA;;;;EAIApd,cAAMmc,UAAN,CAAiBpO,MAAjB,GAA0B,UAAU6J,aAAV,EAAyB;EAC/C,gBAAIA,aAAJ,EAAmB;EACf,qBAAK,IAAI5G,GAAT,IAAgB4G,aAAhB,EAA+B;EAC3B4E,0BAAMxL,GAAN,IAAa4G,cAAc5G,GAAd,CAAb;EACH;EACJ;;EAED,iBAAK,IAAImF,KAAT,IAAkBnW,MAAM+S,SAAxB,EAAmC;EAC/B/S,sBAAM+S,SAAN,CAAgBoD,KAAhB,EAAuBsG,QAAvB,CAAgCzJ,IAAhC,CAAqCG,CAArC,CAAuCxI,MAAvC;EACH;EACD3K,kBAAMmc,UAAN,CAAiBoB,iBAAjB;EACAvd,kBAAMmc,UAAN,CAAiBpF,MAAjB;EACH,SAZD;;EAcA/W,cAAMmc,UAAN,CAAiBrE,KAAjB,GAAyB,YAAY;EACjC9X,kBAAMmc,UAAN,CAAiBpO,MAAjB,CAAwBuJ,cAAxB;EACH,SAFD;EAGAtX,cAAMmc,UAAN,CAAiBtY,IAAjB,GAAwB,UAAUkU,IAAV,EAAgB;EACpC,gBAAIA,SAASvW,SAAb,EAAwB;EACpBuW,qBAAKlU,IAAL,GAAY,IAAZ;EACA,oBAAIkU,KAAKD,KAAT,EAAgB;EACZ9X,0BAAMmc,UAAN,CAAiBrE,KAAjB;EACH;EACJ,aALD,MAKO;EACHC,uBAAO,EAAClU,MAAM,IAAP,EAAP;EACH;EACD7D,kBAAMmc,UAAN,CAAiBpO,MAAjB,CAAwBgK,IAAxB;EACH,SAVD;EAWA/X,cAAMmc,UAAN,CAAiBrY,IAAjB,GAAwB,UAAUiU,IAAV,EAAgB;EACpC,gBAAIA,SAASvW,SAAb,EAAwB;EACpBuW,qBAAKlU,IAAL,GAAY,KAAZ;EACA,oBAAIkU,KAAKD,KAAT,EAAgB;EACZ9X,0BAAMmc,UAAN,CAAiBrE,KAAjB;EACH;EACJ,aALD,MAKO;EACHC,uBAAO,EAAClU,MAAM,KAAP,EAAP;EACH;EACD7D,kBAAMmc,UAAN,CAAiBpO,MAAjB,CAAwBgK,IAAxB;EACH,SAVD;;EAYA;;;EAGA/X,cAAMmc,UAAN,CAAiBpF,MAAjB,GAA0B,YAAY;EAClC,gBAAIZ,KAAJ,EAAWyE,MAAX;;EAEA,iBAAKzE,KAAL,IAAcnW,MAAM+S,SAApB,EAA+B;EAC3B6H,yBAAS5a,MAAM+S,SAAN,CAAgBoD,KAAhB,CAAT;;EAEA;EACA,oBAAIqH,YAAY/J,YAAY+I,MAAMpC,QAAlB,EAA4BjE,KAA5B,CAAhB;EACA,oBAAIsH,eAAehK,YAAY+I,MAAMF,WAAlB,EAA+BnG,KAA/B,CAAnB;;EAEA,oBAAIyG,cAAc;EACdE,6BAASU,UAAU5Y,IADL;EAEdsY,8BAAUM,UAAU3Y,KAFN;EAGdgP,4BAAQ2J,UAAU3J,MAHJ;EAIdmJ,gCAAYS,aAAa7Y,IAJX;EAKduY,iCAAaM,aAAa5Y;EALZ,iBAAlB;;EAQA;EACA,oBAAI+V,OAAO6B,QAAP,CAAgBzJ,IAAhB,CAAqB0K,KAAzB,EAAgC;EAC5B9C,2BAAO6B,QAAP,CAAgBzJ,IAAhB,CAAqB0K,KAArB,CACKza,IADL,CACU,QADV,EACoByZ,aAAa9B,MAAb,EAAqBgC,WAArB,CADpB;EAEH;EACD,oBAAIhC,OAAO6B,QAAP,CAAgBzJ,IAAhB,CAAqB2K,SAAzB,EAAoC;EAChC,wBAAIpC,aAAa,IAAjB;EACA,wBAAIiB,MAAMnC,SAAV,EAAqB;EACjBkB,qCAAa9H,YAAY+I,MAAMnC,SAAlB,EAA6BlE,KAA7B,CAAb;EACH,qBAFD,MAEO;EACHoF,qCAAavC,SAAb;EACH;;EAED,wBAAI4E,kBAAkB;EAClBC,+BAAO7d,MAAM0W,MAAN,CAAakE,OAAOpG,OAAP,CAAeyI,UAA5B,CADW;EAElBa,+BAAO9d,MAAM0W,MAAN,CAAakE,OAAOpG,OAAP,CAAeuI,UAA5B;EAFW,qBAAtB;EAIAnC,2BAAO6B,QAAP,CAAgBzJ,IAAhB,CAAqB2K,SAArB,CACK1a,IADL,CACU,IADV,EACgBsY,WAAW3W,IAD3B,EAEK3B,IAFL,CAEU,IAFV,EAEgBsY,WAAW1W,KAF3B,EAGK5B,IAHL,CAGU,IAHV,EAGgB2a,gBAAgBC,KAHhC,EAIK5a,IAJL,CAIU,IAJV,EAIgB2a,gBAAgBC,KAJhC;EAKAjD,2BAAO6B,QAAP,CAAgBzJ,IAAhB,CAAqB+K,SAArB,CACK9a,IADL,CACU,IADV,EACgBsY,WAAW3W,IAD3B,EAEK3B,IAFL,CAEU,IAFV,EAEgBsY,WAAW1W,KAF3B,EAGK5B,IAHL,CAGU,IAHV,EAGgB2a,gBAAgBE,KAHhC,EAIK7a,IAJL,CAIU,IAJV,EAIgB2a,gBAAgBE,KAJhC;EAKH;EACJ;EACJ,SA/CD;;EAiDA;;;EAGA9d,cAAMmc,UAAN,CAAiBoB,iBAAjB,GAAqC,YAAY;EAC7C,gBAAIpH,KAAJ,EAAWwG,MAAX;;EAEA,gBAAIH,SAASA,MAAMxN,MAAnB,EAA2B;EACvBhP,sBAAMmc,UAAN,CAAiB/I,UAAjB,GAA8BC,cAAcmJ,MAAMxN,MAApB,CAA9B;EACH,aAFD,MAEO;EACHhP,sBAAMmc,UAAN,CAAiB/I,UAAjB,GAA8BpT,MAAMoT,UAApC;EACH;;EAED,gBAAIoJ,MAAM3Y,IAAN,IAAc,KAAlB,EAAyB;EACrB;EACH;;EAED,iBAAKsS,KAAL,IAAcnW,MAAM+S,SAApB,EAA+B;EAC3B4J,yBAAS3c,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuBsG,QAAhC;;EAEAE,uBAAO3J,IAAP,CAAYG,CAAZ,GAAgBnT,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuBhD,CAAvB,CAAyB9P,MAAzB,CAAgC,GAAhC,EAAqCJ,IAArC,CAA0C,OAA1C,EAAmD,YAAnD,CAAhB;;EAEA;EACA,oBAAIuZ,MAAMJ,YAAV,EAAwB;EACpBO,2BAAO3J,IAAP,CAAY0K,KAAZ,GAAoBf,OAAO3J,IAAP,CAAYG,CAAZ,CAAc9P,MAAd,CAAqB,SAArB,EACfJ,IADe,CACV,OADU,EACD,OADC,EAEf3C,KAFe,CAET,MAFS,EAEDN,MAAMmc,UAAN,CAAiB/I,UAAjB,CAA4B+C,KAA5B,CAFC,EAGf7V,KAHe,CAGT,QAHS,EAGCN,MAAMmc,UAAN,CAAiB/I,UAAjB,CAA4B+C,KAA5B,CAHD,CAApB;EAIA;EACA;EACH;;EAED;EACA,oBAAIqG,MAAMH,SAAV,EAAqB;EACjBM,2BAAO3J,IAAP,CAAY2K,SAAZ,GAAwBhB,OAAO3J,IAAP,CAAYG,CAAZ,CAAc9P,MAAd,CAAqB,MAArB,EACnBJ,IADmB,CACd,OADc,EACL,uBADK,EAEnB3C,KAFmB,CAEb,QAFa,EAEHN,MAAMmc,UAAN,CAAiB/I,UAAjB,CAA4B+C,KAA5B,CAFG,CAAxB;;EAIAwG,2BAAO3J,IAAP,CAAY+K,SAAZ,GAAwBpB,OAAO3J,IAAP,CAAYG,CAAZ,CAAc9P,MAAd,CAAqB,MAArB,EACnBJ,IADmB,CACd,OADc,EACL,uBADK,EAEnB3C,KAFmB,CAEb,QAFa,EAEHN,MAAMmc,UAAN,CAAiB/I,UAAjB,CAA4B+C,KAA5B,CAFG,CAAxB;EAGH;EACJ;EACJ,SAvCD;EAwCAnW,cAAMmc,UAAN,CAAiBoB,iBAAjB;;EAEA1c,iBAAA,CAAUuW,MAAV,EAAkBxT,EAAlB,CAAqB,YAAY5D,MAAM4H,QAAlB,GAA6B,WAAlD,EAA+D5H,MAAMmc,UAAN,CAAiBpF,MAAhF;EACA/W,cAAMmc,UAAN,CAAiBpF,MAAjB;EACA,eAAO/W,KAAP;EACH,KAnOD;;EAqOA;;;;;;;;;;;;;;EAcAA,UAAMge,eAAN,GAAwB,UAAUjR,OAAV,EAAmB;EACvC/M,cAAMie,SAAN,GAAkB,EAAlB;;EAGA;EACA,YAAI3G,iBAAiB;EACjBzT,kBAAM,IADW;EAEjBqa,sBAAU,KAFO;EAGjBC,sBAAU,MAHO;EAIjBC,uBAAW,CAJM;EAKjB/B,uBAAW,KALM;EAMjBgC,2BAAe,KANE;EAOjBC,uBAAW,EAPM;EAQjBtP,oBAAQ;EARS,SAArB;EAUAhP,cAAMie,SAAN,CAAgBlR,OAAhB,GAA0BoH,YAAYmD,cAAZ,CAA1B;EACA,aAAK,IAAIpI,MAAT,IAAmBnC,OAAnB,EAA4B;EACxB/M,kBAAMie,SAAN,CAAgBlR,OAAhB,CAAwBmC,MAAxB,IAAkCnC,QAAQmC,MAAR,CAAlC;EACH;EACD,YAAIqP,QAAQve,MAAMie,SAAN,CAAgBlR,OAA5B;;EAEA;EACA,aAAK,IAAIoJ,KAAT,IAAkBnW,MAAM+S,SAAxB,EAAmC;EAC/B/S,kBAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB8H,SAAvB,GAAmC,EAAnC;EACAje,kBAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB8H,SAAvB,CAAiCjL,IAAjC,GAAwC,EAAxC;EACH;EACD;EACAhT,cAAMie,SAAN,CAAgBjL,IAAhB,GAAuB,EAAvB;;EAEA;;;;EAIAhT,cAAMie,SAAN,CAAgBlQ,MAAhB,GAAyB,UAAU6J,aAAV,EAAyB;EAC9C,gBAAIA,aAAJ,EAAmB;EACf,qBAAK,IAAI5G,GAAT,IAAgB4G,aAAhB,EAA+B;EAC3B2G,0BAAMvN,GAAN,IAAa4G,cAAc5G,GAAd,CAAb;EACH;EACJ;;EAEDhR,kBAAMie,SAAN,CAAgBjL,IAAhB,CAAqBG,CAArB,CAAuBxI,MAAvB;EACA,iBAAK,IAAIwL,KAAT,IAAkBnW,MAAM+S,SAAxB,EAAmC;EAC/B/S,sBAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB8H,SAAvB,CAAiCjL,IAAjC,CAAsCG,CAAtC,CAAwCxI,MAAxC;EACH;EACD3K,kBAAMie,SAAN,CAAgBO,YAAhB;EACAxe,kBAAMie,SAAN,CAAgBlH,MAAhB;EACH,SAbD;;EAeA/W,cAAMie,SAAN,CAAgBnG,KAAhB,GAAwB,YAAY;EAChC9X,kBAAMie,SAAN,CAAgBlQ,MAAhB,CAAuBuJ,cAAvB;EACH,SAFD;EAGAtX,cAAMie,SAAN,CAAgBpa,IAAhB,GAAuB,UAAUkU,IAAV,EAAgB;EACnC,gBAAIA,SAASvW,SAAb,EAAwB;EACpBuW,qBAAKlU,IAAL,GAAY,IAAZ;EACA,oBAAIkU,KAAKD,KAAT,EAAgB;EACZ9X,0BAAMie,SAAN,CAAgBnG,KAAhB;EACH;EACJ,aALD,MAKO;EACHC,uBAAO,EAAClU,MAAM,IAAP,EAAP;EACH;EACD7D,kBAAMie,SAAN,CAAgBlQ,MAAhB,CAAuBgK,IAAvB;EACH,SAVD;EAWA/X,cAAMie,SAAN,CAAgBna,IAAhB,GAAuB,UAAUiU,IAAV,EAAgB;EACnC,gBAAIA,SAASvW,SAAb,EAAwB;EACpBuW,qBAAKlU,IAAL,GAAY,KAAZ;EACA,oBAAIkU,KAAKD,KAAT,EAAgB;EACZ9X,0BAAMie,SAAN,CAAgBnG,KAAhB;EACH;EACJ,aALD,MAKO;EACHC,uBAAO,EAAClU,MAAM,KAAP,EAAP;EACH;EACD7D,kBAAMie,SAAN,CAAgBlQ,MAAhB,CAAuBgK,IAAvB;EACH,SAVD;;EAYA;;;EAGA/X,cAAMie,SAAN,CAAgBlH,MAAhB,GAAyB,YAAY;EACjC,gBAAIZ,KAAJ,EAAWyE,MAAX,EAAmB6D,KAAnB;;EAEA;EACA,gBAAIze,MAAMie,SAAN,CAAgBjL,IAAhB,CAAqBG,CAAzB,EAA4B;EACxB,oBAAIuL,WAAW1e,MAAM8T,MAAN,CAAapG,SAAb,KAA2B,CAA1C,CADwB;EAExB,qBAAK,IAAIiR,OAAT,IAAoB3e,MAAMie,SAAN,CAAgBjL,IAAhB,CAAqB4L,KAAzC,EAAgD;EAC5C5e,0BAAMie,SAAN,CAAgBjL,IAAhB,CAAqB4L,KAArB,CAA2BD,OAA3B,EAAoC9b,IAApC,CACKuG,CADL,CACO,UAAUhI,CAAV,EAAa;EACZ,+BAAOpB,MAAM8T,MAAN,CAAa1S,EAAEgI,CAAf,IAAoBsV,QAA3B;EACH,qBAHL;EAIA1e,0BAAMie,SAAN,CAAgBjL,IAAhB,CAAqB4L,KAArB,CAA2BD,OAA3B,EAAoCxL,CAApC,CACKkG,KADL,CACWrZ,MAAMie,SAAN,CAAgBjL,IAAhB,CAAqB4L,KAArB,CAA2BD,OAA3B,EAAoClV,MAD/C,EAEKxG,IAFL,CAEU,GAFV,EAEejD,MAAMie,SAAN,CAAgBjL,IAAhB,CAAqB4L,KAArB,CAA2BD,OAA3B,EAAoC9b,IAFnD;EAGH;EACJ;;EAGD,iBAAKsT,KAAL,IAAcnW,MAAM+S,SAApB,EAA+B;EAC3B6H,yBAAS5a,MAAM+S,SAAN,CAAgBoD,KAAhB,CAAT;EACAsI,wBAAQ7D,OAAOqD,SAAf;;EAEA,oBAAIQ,MAAMzL,IAAN,CAAW6L,MAAf,EAAuB;EACnB,wBAAIN,MAAMJ,QAAN,IAAkB,UAAtB,EAAkC;EAC9B,4BAAIW,cAAcrL,YAAY,GAAZ,EAAiB0C,KAAjB,CAAlB;EACA,4BAAI4I,WAAW/e,MAAM0W,MAAN,CAAawB,IAAb,GACVhX,KADU,CACJ,CAACyO,KAAKiD,KAAL,CAAW5S,MAAM0W,MAAN,CAAaxV,KAAb,GAAqB,CAArB,IAA0Bqd,MAAMH,SAA3C,CAAD,EAAwD,CAAxD,CADI,EAEVY,WAFU,CAEEne,mBAFF,EAGViB,MAHU,CAGH9B,MAAM0W,MAAN,CAAa5U,MAAb,EAHG,CAAf;EAIA,4BAAImd,WAAWtP,KAAKiD,KAAL,CAAW5S,MAAM8T,MAAN,CAAapG,SAAb,KAA2B6Q,MAAMH,SAA5C,CAAf;EACA,4BAAIc,SAAS,EAAb;EACA,4BAAIC,WAAW,IAAf;EACA;EACA,6BAAK,IAAIvD,KAAK,CAAd,EAAiBA,KAAKhB,OAAOnR,MAAP,CAAc9F,MAApC,EAA4CiY,IAA5C,EAAkD;EAC9CuD,uCAAWJ,SAASnE,OAAOnR,MAAP,CAAcmS,EAAd,CAAT,CAAX;EACA,gCAAIsD,OAAOjU,cAAP,CAAsBkU,QAAtB,MAAoC,IAAxC,EAA8C;EAC1CD,uCAAOC,QAAP,IAAmB,EAAnB;EACH;EACDD,mCAAOC,QAAP,EAAiB5b,IAAjB,CAAsBkb,MAAMzL,IAAN,CAAW6L,MAAX,CAAkBO,GAAlB,CAAsBxD,EAAtB,EACjB3Y,IADiB,CACZ,IADY,EACN6b,YAAYjL,MADN,EAEjB5Q,IAFiB,CAEZ,IAFY,EAEN8b,SAASnE,OAAOnR,MAAP,CAAcmS,EAAd,CAAT,IAA8B2C,MAAMH,SAF9B,CAAtB;EAGH;EACD;EACA,4BAAIiB,WAAW1P,KAAK8B,GAAL,CAASqN,YAAYja,KAAZ,GAAoB0Z,MAAMH,SAAnC,CAAf;EACA,6BAAK,IAAIkB,GAAT,IAAgBJ,MAAhB,EAAwB;EACpB,gCAAIK,UAAUT,YAAYla,IAAZ,GAAoB+K,KAAK+B,GAAL,CAAS,CAACuN,WAAWC,OAAOI,GAAP,EAAY3b,MAAxB,IAAkC,CAA3C,EAA8C,CAA9C,IAAmD4a,MAAMH,SAA3F;EACA,gCAAIoB,MAAM,CAAV;EACA,iCAAK5D,EAAL,IAAWsD,OAAOI,GAAP,CAAX,EAAwB;EACpBJ,uCAAOI,GAAP,EAAY1D,EAAZ,EAAgB3Y,IAAhB,CAAqB,IAArB,EAA2B0M,KAAK8B,GAAL,CAAS8N,UAAUC,MAAMjB,MAAMH,SAA/B,EAA0CiB,QAA1C,IAAsDd,MAAMH,SAAN,GAAkB,CAAnG;EACAoB;EACH;EACJ;EACJ,qBA7BD,MA6BO;EAAE;EACL,4BAAIC,aAAa,IAAjB;EAAA,4BACIC,eAAe,CADnB;EAAA,4BAEIxf,QAAQ,CAFZ;EAGA,4BAAIqe,MAAMJ,QAAN,IAAkB,SAAlB,IAA+B,OAAOI,MAAMJ,QAAb,IAAyB,QAA5D,EAAsE;EAClE;EACAuB,2CAAe,OAAOnB,MAAMJ,QAAb,IAAyB,QAAzB,GAAoCI,MAAMJ,QAA1C,GAAqD,EAApE;EACH;;EAEDsB,qCAAahM,YAAYiM,YAAZ,EAA0BvJ,KAA1B,CAAb;EACAjW,gCAAQuf,WAAW5a,KAAX,GAAmB4a,WAAW7a,IAAtC;;EAEA,6BAAK,IAAIgX,KAAK,CAAd,EAAiBA,KAAKhB,OAAOnR,MAAP,CAAc9F,MAApC,EAA4CiY,IAA5C,EAAkD;EAC9C6C,kCAAMzL,IAAN,CAAW6L,MAAX,CAAkBO,GAAlB,CAAsBxD,EAAtB,EACK3Y,IADL,CACU,IADV,EACgBwc,WAAW5L,MAAX,GAAoBG,UAAU,IAAV,EAAgB9T,KAAhB,CADpC,EAEK+C,IAFL,CAEU,IAFV,EAEgBjD,MAAM0W,MAAN,CAAakE,OAAOnR,MAAP,CAAcmS,EAAd,CAAb,CAFhB;EAGH;EACJ;EACJ;;EAGD,oBAAI6C,MAAMzL,IAAN,CAAW2M,IAAf,EAAqB;EACjB,wBAAIC,aAAanM,YAAY8K,MAAMD,SAAlB,EAA6BnI,KAA7B,CAAjB;EACA,yBAAK,IAAIyF,KAAK,CAAd,EAAiBA,KAAKhB,OAAOnR,MAAP,CAAc9F,MAApC,EAA4CiY,IAA5C,EAAkD;EAC9C6C,8BAAMzL,IAAN,CAAW2M,IAAX,CAAgBf,KAAhB,CAAsBhD,EAAtB,EACK3Y,IADL,CACU,IADV,EACgB2c,WAAWhb,IAD3B,EAEK3B,IAFL,CAEU,IAFV,EAEgB2c,WAAW/a,KAF3B,EAGK5B,IAHL,CAGU,IAHV,EAGgBjD,MAAM0W,MAAN,CAAakE,OAAOnR,MAAP,CAAcmS,EAAd,CAAb,CAHhB,EAIK3Y,IAJL,CAIU,IAJV,EAIgBjD,MAAM0W,MAAN,CAAakE,OAAOnR,MAAP,CAAcmS,EAAd,CAAb,CAJhB;EAKH;EACJ;EACJ;EACJ,SApFD;;EAsFA;;;EAGA5b,cAAMie,SAAN,CAAgBO,YAAhB,GAA+B,YAAY;EACvC,gBAAIrI,KAAJ,EAAWsI,KAAX;;EAEA,gBAAIF,SAASA,MAAMvP,MAAnB,EAA2B;EACvBhP,sBAAMie,SAAN,CAAgB7K,UAAhB,GAA6BC,cAAckL,MAAMvP,MAApB,CAA7B;EACH,aAFD,MAEO;EACHhP,sBAAMie,SAAN,CAAgB7K,UAAhB,GAA6BpT,MAAMoT,UAAnC;EACH;;EAED,gBAAImL,MAAM1a,IAAN,IAAc,KAAlB,EAAyB;EACrB;EACH;;EAED;EACA7D,kBAAMie,SAAN,CAAgBjL,IAAhB,CAAqBG,CAArB,GAAyBnT,MAAMgT,IAAN,CAAWG,CAAX,CAAa9P,MAAb,CAAoB,GAApB,EAAyBJ,IAAzB,CAA8B,OAA9B,EAAuC,eAAvC,CAAzB;EACA,gBAAIsb,MAAMlC,SAAN,IAAmBkC,MAAMlC,SAAN,CAAgB1Y,MAAhB,GAAyB,CAAhD,EAAmD;EAC/C3D,sBAAMie,SAAN,CAAgBjL,IAAhB,CAAqB4L,KAArB,GAA6B,EAA7B;EACA,oBAAID,OAAJ;EACA,qBAAK,IAAI9b,IAAT,IAAiB0b,MAAMlC,SAAvB,EAAkC;EAC9BsC,8BAAUJ,MAAMlC,SAAN,CAAgBxZ,IAAhB,CAAV;EACA7C,0BAAMie,SAAN,CAAgBjL,IAAhB,CAAqB4L,KAArB,CAA2BD,OAA3B,IAAsC,EAAtC;EACA3e,0BAAMie,SAAN,CAAgBjL,IAAhB,CAAqB4L,KAArB,CAA2BD,OAA3B,EAAoClV,MAApC,GAA6C,EAA7C;EACA,yBAAK,IAAImR,MAAT,IAAmB5a,MAAM+S,SAAzB,EAAoC;EAChC/S,8BAAMie,SAAN,CAAgBjL,IAAhB,CAAqB4L,KAArB,CAA2BD,OAA3B,EAAoClV,MAApC,CAA2ClG,IAA3C,CAAgD;EAC5C6F,+BAAGwR,MADyC;EAE5C5X,+BAAGhD,MAAM+S,SAAN,CAAgB6H,MAAhB,EAAwBpG,OAAxB,CAAgCmK,OAAhC;EAFyC,yBAAhD;EAIH;EACD3e,0BAAMie,SAAN,CAAgBjL,IAAhB,CAAqB4L,KAArB,CAA2BD,OAA3B,EAAoC9b,IAApC,GAA2ChC,OAAA,GACtC4W,KADsC,CAChC5W,gBADgC,EAEtCmC,CAFsC,CAEpC,UAAU5B,CAAV,EAAa;EACZ,+BAAOpB,MAAM0W,MAAN,CAAatV,EAAE4B,CAAf,CAAP;EACH,qBAJsC,CAA3C;EAKAhD,0BAAMie,SAAN,CAAgBjL,IAAhB,CAAqB4L,KAArB,CAA2BD,OAA3B,EAAoCxL,CAApC,GAAwCnT,MAAMie,SAAN,CAAgBjL,IAAhB,CAAqBG,CAArB,CAAuB9P,MAAvB,CAA8B,MAA9B,EACnCJ,IADmC,CAC9B,OAD8B,EACrB,UAAU0b,OADW,EAEnC1b,IAFmC,CAE9B,aAF8B,EAEf0b,OAFe,EAGnCre,KAHmC,CAG7B,MAH6B,EAGrB,MAHqB,EAInCA,KAJmC,CAI7B,QAJ6B,EAInBN,MAAMoT,UAAN,CAAiBuL,OAAjB,CAJmB,CAAxC;EAKH;EAEJ;;EAGD,iBAAKxI,KAAL,IAAcnW,MAAM+S,SAApB,EAA+B;EAC3B0L,wBAAQze,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB8H,SAA/B;EACAQ,sBAAMzL,IAAN,CAAWG,CAAX,GAAenT,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuBhD,CAAvB,CAAyB9P,MAAzB,CAAgC,GAAhC,EAAqCJ,IAArC,CAA0C,OAA1C,EAAmD,WAAnD,CAAf;EACA;EACA,oBAAIsb,MAAML,QAAV,EAAoB;EAChBO,0BAAMzL,IAAN,CAAW6L,MAAX,GAAoB,EAAC1L,GAAG,IAAJ,EAAUiM,KAAK,EAAf,EAApB;EACAX,0BAAMzL,IAAN,CAAW6L,MAAX,CAAkB1L,CAAlB,GAAsBsL,MAAMzL,IAAN,CAAWG,CAAX,CAAa9P,MAAb,CAAoB,GAApB,EAAyBJ,IAAzB,CAA8B,OAA9B,EAAuC,aAAvC,CAAtB;;EAFgB;EAIZ,4BAAI4c,MAAM7f,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB1M,MAAvB,CAA8BmS,EAA9B,CAAV;EACA,4BAAIkE,UAAU9f,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuBD,UAAvB,CAAkC0F,EAAlC,CAAd;EACA6C,8BAAMzL,IAAN,CAAW6L,MAAX,CAAkBO,GAAlB,CAAsB7b,IAAtB,CAA2Bkb,MAAMzL,IAAN,CAAW6L,MAAX,CAAkB1L,CAAlB,CAAoB9P,MAApB,CAA2B,QAA3B,EACtBJ,IADsB,CACjB,OADiB,EACR,OADQ;EAEvB;EAFuB,yBAGtBA,IAHsB,CAGjB,OAHiB,EAGR,YAAW;EAAE,gCAAI2L,KAAK5O,MAAM8R,QAAN,CAAelD,EAAf,GAAoB5O,MAAM8R,QAAN,CAAelD,EAAnC,GAAwC,KAAjD;EAC5B,mCAAOA,KAAK,YAAYkR,QAAQlR,EAAzB,GAA8B,EAArC;EAAyC,yBAJlB,EAKtB3L,IALsB,CAKjB,GALiB,EAKZsb,MAAMH,SAAN,GAAkB,CALN;EAAA,yBAMtB9d,KANsB,CAMhB,MANgB,EAMRN,MAAMie,SAAN,CAAgB7K,UAAhB,CAA2B+C,KAA3B,CANQ,EAOtB7V,KAPsB,CAOhB,cAPgB,EAOA,GAPA,EAQtBA,KARsB,CAQhB,QARgB,EAQNN,MAAMie,SAAN,CAAgB7K,UAAhB,CAA2B+C,KAA3B,CARM,EAStB7V,KATsB,CAShB,cATgB,EASA,KATA,EAUtBsD,EAVsB,CAUnB,WAVmB,EAUN,YAAI;EACjB5D,kCAAMgT,IAAN,CAAWzQ,OAAX,CACKjC,KADL,CACW,SADX,EACsB,IADtB,EAEKA,KAFL,CAEW,MAFX,EAEoBO,QAAA,CAASib,KAAV,GAAmB,IAFtC,EAGKxb,KAHL,CAGW,KAHX,EAGmBO,QAAA,CAASkb,KAAT,GAAiB,EAAlB,GAAwB,IAH1C;EAIH,yBAfsB,EAepBnY,EAfoB,CAejB,UAfiB,EAeL,YAAY;EAC1B5D,kCAAMgT,IAAN,CAAWzQ,OAAX,CAAmBjC,KAAnB,CAAyB,SAAzB,EAAoC,MAApC;EACH,yBAjBsB,EAiBpBsD,EAjBoB,CAiBjB,WAjBiB,EAiBJ0Q,aAAa6B,KAAb,EAAoBnW,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB3B,OAA3C,EAAoDsL,QAAQ/N,MAA5D,EAAoE8N,GAApE,CAjBI,EAkBtBjc,EAlBsB,CAkBnB,OAlBmB,EAkBV,YAAU;EACnB,gCAAI5D,MAAM8R,QAAN,CAAe9I,MAAf,CAAsB+W,cAA1B,EAA0C;EACtC/f,sCAAM8R,QAAN,CAAe9I,MAAf,CAAsB+W,cAAtB,CAAqC1U,IAArC,CAA0C,IAA1C,EAAgDyU,OAAhD;EACH;EACJ,yBAtBsB,CAA3B;EANY;;EAGhB,yBAAK,IAAIlE,KAAK,CAAd,EAAiBA,KAAK5b,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB1M,MAAvB,CAA8B9F,MAApD,EAA4DiY,IAA5D,EAAkE;EAAA;EA0BjE;EACJ;;EAGD;EACA,oBAAI2C,MAAMF,aAAV,EAAyB;EACrBI,0BAAMzL,IAAN,CAAW2M,IAAX,GAAkB,EAACxM,GAAG,IAAJ,EAAUyL,OAAO,EAAjB,EAAlB;EACAH,0BAAMzL,IAAN,CAAW2M,IAAX,CAAgBxM,CAAhB,GAAoBsL,MAAMzL,IAAN,CAAWG,CAAX,CAAa9P,MAAb,CAAoB,GAApB,EAAyBJ,IAAzB,CAA8B,OAA9B,EAAuC,WAAvC,CAApB;EACA,yBAAK,IAAI2Y,KAAK,CAAd,EAAiBA,KAAK5b,MAAM+S,SAAN,CAAgBoD,KAAhB,EAAuB1M,MAAvB,CAA8B9F,MAApD,EAA4DiY,IAA5D,EAAkE;EAC9D6C,8BAAMzL,IAAN,CAAW2M,IAAX,CAAgBf,KAAhB,CAAsBrb,IAAtB,CAA2Bkb,MAAMzL,IAAN,CAAW2M,IAAX,CAAgBxM,CAAhB,CAAkB9P,MAAlB,CAAyB,MAAzB,EACtBJ,IADsB,CACjB,OADiB,EACR,WADQ,EAEtB3C,KAFsB,CAEhB,cAFgB,EAEA,GAFA,EAGtBA,KAHsB,CAGhB,QAHgB,EAGNN,MAAMie,SAAN,CAAgB7K,UAAhB,CAA2B+C,KAA3B,CAHM,CAA3B;EAIH;EACJ;EACJ;EAEJ,SA7FD;EA8FAnW,cAAMie,SAAN,CAAgBO,YAAhB;;EAEA3d,iBAAA,CAAUuW,MAAV,EAAkBxT,EAAlB,CAAqB,YAAY5D,MAAM4H,QAAlB,GAA6B,WAAlD,EAA+D5H,MAAMie,SAAN,CAAgBlH,MAA/E;EACA/W,cAAMie,SAAN,CAAgBlH,MAAhB;EACA,eAAO/W,KAAP;EACH,KAzQD;;EA2QA,WAAOA,KAAP;EACH;;ECxpDD;;;AAGA,EAAe,iBAASf,MAAT,EAAiBqI,MAAjB,EAAyB;;EAEtC,MAAI0Y,YAAYnf,YAAA,CAAa,UAAb,CAAhB;;EAEA,MAAIof,SAASpY,OAAO4G,MAAP,CAAcnH,MAAd,CAAb;;EAEA2Y,SAAOzb,IAAP,GAAc,UAASvF,MAAT,EAAgB;EAC5B,QAAIa,KAAK,IAAT;EACAA,OAAGG,OAAH,GAAahB,SAASA,MAAT,GAAkB,EAA/B;EACAa,OAAGkH,KAAH,GAAW,EAAX;EACAlH,OAAGqH,OAAH,GAAY,EAAZ;EACArH,OAAGsH,KAAH,GAAW,EAAX;;EAGAtH,OAAG4O,IAAH,GAAU5O,GAAGc,KAAH,CAASC,EAAT,CAAYC,GAAZ,GAAkBmC,IAAlB,CAAuB,OAAvB,EAAgC,QAAhC,EACP2H,IADO,CACF9K,GAAGG,OAAH,CAAWa,GAAX,GAAiBhB,GAAGG,OAAH,CAAWa,GAA5B,GAAkC,UAASM,CAAT,EAAY;EAClD6L,cAAQC,GAAR,CAAY9L,CAAZ;EACA,UAAIwJ,OAAM,EAAV;EACA;EACAA,cAAQxJ,EAAE4B,CAAF,GAAO,YAAYoB,OAAOC,KAAP,CAAa,CAACjD,EAAE4B,CAAhB,IAAqB5B,EAAE4B,CAAvB,GAA2BlD,GAAGc,KAAH,CAASqB,MAAT,CAAgBb,EAAE4B,CAAlB,CAAvC,IAA+D,cAAtE,GAAwF,EAAhG;EACA;;EAEA,aAAO4H,IAAP;EACD,KATO,CAAV;EAWD,GAnBD;;EAqBA;EACA;EACAqV,SAAOxe,IAAP,GAAc,UAASA,IAAT,EAAc;EAC1B,QAAI3B,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWwB,IAAX,GAAkBA,IAAlB;EACA,WAAO3B,EAAP;EACD,GAJD;;EAMAmgB,SAAO7W,CAAP,GAAW,UAASoW,GAAT,EAAa;EACtB,QAAI1f,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWmJ,CAAX,GAAeoW,GAAf;EACA,WAAO1f,EAAP;EACD,GAJD;;EAMAmgB,SAAOjd,CAAP,GAAW,UAASwc,GAAT,EAAa;EACtB,QAAI1f,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAW+C,CAAX,GAAewc,GAAf;EACA,WAAO1f,EAAP;EACD,GAJD;;EAMAmgB,SAAOhR,MAAP,GAAgB,UAASiR,GAAT,EAAa;EAC3B,QAAIpgB,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWgP,MAAX,GAAoBiR,GAApB;EACA,WAAOpgB,EAAP;EACD,GAJD;;EAMAmgB,SAAOlR,IAAP,GAAc,UAASyQ,GAAT,EAAa;EACzB,QAAI1f,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAW8O,IAAX,GAAkByQ,GAAlB;EACA,WAAO1f,EAAP;EACD,GAJD;;EAMAmgB,SAAOrR,EAAP,GAAY,UAAU4Q,GAAV,EAAe;EACzB,QAAI1f,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAW2O,EAAX,GAAgB4Q,GAAhB;EACA,WAAO1f,EAAP;EACD,GAJD;;EAMAmgB,SAAOjR,MAAP,GAAgB,UAASA,MAAT,EAAiB;EAC/B,QAAIlP,KAAK,IAAT;EACA,QAAG6B,MAAMC,OAAN,CAAcoN,MAAd,CAAH,EAA0B;EACxB;EACAlP,SAAGG,OAAH,CAAW+O,MAAX,GAAoBA,MAApB;EACD,KAHD,MAGO;EACL;EACAlP,SAAGqH,OAAH,CAAWjC,KAAX,GAAmB8J,MAAnB;EACD;EACD,WAAOlP,EAAP;EACD,GAVD;;EAYAmgB,SAAOnf,GAAP,GAAa,UAAUA,GAAV,EAAe;EAC1B,QAAIhB,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWa,GAAX,GAAiBA,GAAjB;EACAhB,OAAG4O,IAAH,CAAQ9D,IAAR,CAAa9K,GAAGG,OAAH,CAAWa,GAAxB;EACA,WAAOhB,EAAP;EACD,GALD;;EAOA;EACA;EACAmgB,SAAOzgB,IAAP,GAAc,UAASA,IAAT,EAAc;EAC1B,QAAIM,KAAK,IAAT;;EAEAA,OAAGkH,KAAH,GAAW,EAAX;EACAxH,SAAK+K,OAAL,CAAa,UAASnJ,CAAT,EAAW;EACtBA,QAAEgI,CAAF,GAAMhI,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,CAAN;EACAhI,QAAE4B,CAAF,GAAM,CAAC5B,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,CAAP;EACA5B,QAAE8D,KAAF,GAAUpF,GAAGG,OAAH,CAAW8O,IAAX,GAAkB3N,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb,CAAlB,GAAuC,KAAjD;EACA,aAAO3N,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,CAAP;EACA,aAAOhI,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,CAAP;EACA,UAAGlD,GAAGG,OAAH,CAAW8O,IAAd,EAAoB,OAAO3N,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,CAAP;;EAEpBtJ,SAAGkH,KAAH,CAASzD,IAAT,CAAcnC,CAAd;EACD,KATD;;EAWA,WAAOtB,EAAP;EACD,GAhBD;;EAkBAmgB,SAAO1X,MAAP,GAAgB,YAAU;EACxB,QAAIzI,KAAK,IAAT;;EAIA,WAAOA,EAAP;EACD,GAND;;EASAmgB,SAAO5X,IAAP,GAAc,YAAU;EACtB,QAAIvI,KAAK,IAAT;EACA;EACA;;EAEAA,OAAGE,KAAH,CAASQ,OAAT,GAAmBmK,MAAnB;;EAEA,QAAIwV,SAAStO,gBAAgB;EACzB7R,aAAOF,GAAGE,KADe;EAEzBR,YAAMM,GAAGkH,KAFgB;EAGzB4H,UAAI9O,GAAGG,OAAH,CAAW2O,EAHU;EAIzBmD,cAAQjS,GAAGG,OAAH,CAAW8R,MAJM;EAKzB/I,cAAQlJ,GAAGG,OAAH,CAAW+I,MALM;EAMzBgJ,aAAM,GANmB;EAOzBC,aAAOmO,QAAOtgB,GAAGG,OAAH,CAAWgP,MAAlB,MAA6B,QAA7B,IAA0CnP,GAAGG,OAAH,CAAWgP,MAAX,CAAkB7F,CAA5D,GAAgEtJ,GAAGG,OAAH,CAAWgP,MAAX,CAAkB7F,CAAlF,GAAsF,IAPpE;EAQzB8I,aAAM,GARmB;EASzBqE,kBAAY,EAAEzP,OAAOhH,GAAGG,OAAH,CAAWsW,UAAX,CAAsBzP,KAA/B,EAAsCX,OAAOrG,GAAGG,OAAH,CAAWsW,UAAX,CAAsBpQ,KAAnE,EATa;EAUzByB,gBAAU,SAVe;EAWzBoH,cAAQ,CAAC,SAAD,EAAY,SAAZ,EAAuB,SAAvB,EAAkC,SAAlC,CAXiB;EAYzBqD,iBAAW,EAAEjS,QAAQN,GAAGG,OAAH,CAAWyE,IAAX,CAAgBtE,MAA1B,EAAkCF,OAAOJ,GAAGG,OAAH,CAAWyE,IAAX,CAAgBxE,KAAzD,EAZc;EAazByE,cAAQ,EAAEG,KAAKhF,GAAGG,OAAH,CAAWyE,IAAX,CAAgBC,MAAhB,CAAuBG,GAA9B,EAAmCD,OAAO/E,GAAGG,OAAH,CAAWyE,IAAX,CAAgBC,MAAhB,CAAuBE,KAAjE,EAAwEE,QAAQjF,GAAGG,OAAH,CAAWyE,IAAX,CAAgBC,MAAhB,CAAuBI,MAAvG,EAA+GH,MAAM9E,GAAGG,OAAH,CAAWyE,IAAX,CAAgBC,MAAhB,CAAuBC,IAA5I,EAbiB;EAczB0N,yBAAmB,IAdM,EAAhB,CAAb;;EAgBA,QAAIxS,GAAGE,KAAH,CAASf,MAAT,CAAgBsM,MAApB,EAA4B;EAC1B1K,eAAA,CAAU,kBAAV,EACGP,KADH,CACS,kBADT,EAC6BR,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuB0C,eADpD,EAEG3E,KAFH,CAES,aAFT,EAEwB,CAFxB,EAGGA,KAHH,CAGS,aAHT,EAGwBR,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuBD,IAAvB,CAA4BgD,UAHpD,EAIGhF,KAJH,CAIS,WAJT,EAIsBR,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuBD,IAAvB,CAA4B+C,QAJlD,EAKG/E,KALH,CAKS,OALT,EAKkBR,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuBD,IAAvB,CAA4B8C,SAL9C,EAMG9E,KANH,CAMS,aANT,EAMwBR,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuBD,IAAvB,CAA4B0D,UANpD,EAOG1F,KAPH,CAOS,kBAPT,EAO6BR,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuB0C,eAPpD,EAQG3E,KARH,CAQS,SART,EAQoBR,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuBD,IAAvB,CAA4BP,OARhD,EASGzB,KATH,CASS,QATT,EASmBR,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuB0D,MAAvB,CAA8B/F,KAA9B,GAAsC,SAAtC,GAAkDJ,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuB0D,MAAvB,CAA8Bf,KATnG,EAUG5E,KAVH,CAUS,eAVT,EAU0BR,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuB0D,MAAvB,CAA8BC,MAVxD;EAWD;;EAEDia,WAAOvG,aAAP;EACAuG,WAAOnC,eAAP;EACAmC,WAAOjE,gBAAP,CAAwB,EAACE,cAAa,KAAd,EAAxB;EACA+D,WAAO9I,gBAAP,CAAwB,EAACE,gBAAe,KAAhB,EAAxB;;EAEA4I,WAAOtG,QAAP,CAAgBhW,IAAhB,CAAqB,EAACiU,OAAM,IAAP,EAAaiC,cAAa,KAA1B,EAAgCI,cAAa,KAA7C,EAAoDF,UAAS,IAA7D,EAAmED,YAAW,IAA9E,EAAoFF,SAAQ,KAA5F,EAArB;EACAqG,WAAOlC,SAAP,CAAiBlQ,MAAjB,CAAwB,EAACmQ,UAAS,IAAV,EAAxB;EACAiC,WAAOlJ,WAAP,CAAmBpT,IAAnB,CAAwB,EAACiU,OAAM,IAAP,EAAYjB,OAAM,CAAlB,EAAqB3W,OAAM,GAA3B,EAAxB;EACA;EACA;;;;;EAKA;EACD;;;;;EAKC;EACA;;;;;EAKA;EACA,QAAIJ,GAAGG,OAAH,CAAWwB,IAAX,KAAoB,QAAxB,EAAkC;EAChC0e,aAAOlJ,WAAP,CAAmBpT,IAAnB,CAAwB,EAACiU,OAAM,IAAP,EAAYjB,OAAM,CAAlB,EAAqB3W,OAAM,EAA3B,EAAxB;EACAigB,aAAOtG,QAAP,CAAgBhW,IAAhB,CAAqB,EAACiU,OAAM,IAAP,EAAaiC,cAAa,KAA1B,EAAgCI,cAAa,KAA7C,EAAmDC,UAAS,EAA5D,EAA+DC,WAAU,EAAzE,EAA4ErL,QAAO,CAAC,MAAD,CAAnF,EAArB;EACAmR,aAAOhE,UAAP,CAAkBrY,IAAlB;EACAqc,aAAOlC,SAAP,CAAiBlQ,MAAjB,CAAwB,EAACmQ,UAAS,KAAV,EAAgBG,eAAc,KAA9B,EAAxB;EACD;;EAGD;EACA;;;;;EAKA;EACA;;;;;EAKA;EACA,QAAIve,GAAGG,OAAH,CAAWwB,IAAX,KAAoB,SAAxB,EAAmC;EACjC0e,aAAOlJ,WAAP,CAAmBnT,IAAnB;EACAqc,aAAOlC,SAAP,CAAiBpa,IAAjB,CAAsB,EAACqa,UAAS,IAAV,EAAgBC,UAAS,EAAzB,EAA6BE,eAAc,KAA3C,EAAiDrP,QAAO,IAAxD,EAAtB;EACAmR,aAAOhE,UAAP,CAAkBrY,IAAlB;EACA;EACD;;EAGD;EACA;;;;;;EAOA,WAAOhE,EAAP;EACD,GAtGD;;EAwGAmgB,SAAOvV,MAAP,GAAgB,UAASkE,EAAT,EAAa;AAC3B,EACA,WAAO/N,SAAA,CAAU,qBAAqB+N,EAA/B,CAAP;EACD,GAHD;;EAKAqR,SAAOlU,SAAP,GAAmB,UAAS6C,EAAT,EAAa;AAC9B,EACA,WAAO/N,YAAA,CAAa,aAAY+N,EAAzB,CAAP;EACD,GAHD;;EAKAqR,SAAOzb,IAAP,CAAYvF,MAAZ;EACA,SAAOghB,MAAP;EACD;;EC1OD;;;AAGA,EAAe,kBAAUhhB,MAAV,EAAkBqI,MAAlB,EAA0B;;EAEvC,MAAI+Y,UAAUxY,OAAO4G,MAAP,CAAcnH,MAAd,CAAd;;EAEA+Y,UAAQ7b,IAAR,GAAe,UAAUvF,MAAV,EAAkB;EAC/B,QAAIa,KAAK,IAAT;EACAA,OAAGG,OAAH,GAAahB,SAASA,MAAT,GAAkB,EAA/B;EACAa,OAAGkH,KAAH,GAAW,EAAX;EACAlH,OAAGqH,OAAH,GAAa,EAAb;EACArH,OAAGsH,KAAH,GAAW,EAAX;;EAEAtH,OAAGwgB,mBAAH,GAAyBxgB,GAAGygB,UAA5B;;EAEAzgB,OAAG4O,IAAH,GAAU5O,GAAGc,KAAH,CAASC,EAAT,CAAYC,GAAZ,GACPmC,IADO,CACF,OADE,EACO,QADP,EAEP0L,SAFO,CAEG,GAFH,EAGP/D,IAHO,CAGF9K,GAAGG,OAAH,CAAWa,GAAX,IAAkB,UAAUM,CAAV,EAAa;EACnC,UAAIwJ,OAAOxJ,EAAEgI,CAAb;EACA,UAAIhI,EAAEgI,CAAF,KAAQhI,EAAE4B,CAAd,EAAiB;EACf4H,gBAAQ,SAASxJ,EAAE4B,CAAnB;EACD;EACD4H,cAAQ,SAAS9K,GAAGc,KAAH,CAASqB,MAAT,CAAgBb,EAAEc,KAAlB,EAAyBpC,GAAGG,OAAH,CAAW6P,QAApC,CAAjB;EACA,aAAOlF,IAAP;EACD,KAVO,CAAV;EAWD,GApBD;;EAsBA;EACA;EACAyV,UAAQjX,CAAR,GAAY,UAAU/H,MAAV,EAAkB;EAC5B,QAAIvB,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWmJ,CAAX,GAAe/H,MAAf;EACA,WAAOvB,EAAP;EACD,GAJD;;EAMAugB,UAAQrd,CAAR,GAAY,UAAU3B,MAAV,EAAkB;EAC5B,QAAIvB,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAW+C,CAAX,GAAe3B,MAAf;EACA,WAAOvB,EAAP;EACD,GAJD;;EAMAugB,UAAQtR,IAAR,GAAe,UAAU1N,MAAV,EAAkB;EAC/B,QAAIvB,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAW8O,IAAX,GAAkB1N,MAAlB;EACA,WAAOvB,EAAP;EACD,GAJD;;EAMAugB,UAAQrR,MAAR,GAAiB,UAAUA,MAAV,EAAkB;EACjC,QAAIlP,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAW+O,MAAX,GAAoBA,MAApB;EACA,WAAOlP,EAAP;EACD,GAJD;;EAMAugB,UAAQG,WAAR,GAAsB,UAAUxY,WAAV,EAAuB;EAC3C,QAAIlI,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAW+H,WAAX,GAAyBA,WAAzB;EACA,WAAOlI,EAAP;EACD,GAJD;;EAMA;;;;EAIAugB,UAAQI,YAAR,GAAuB,UAAUva,MAAV,EAAkB;EACvC,QAAIpG,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWwgB,YAAX,GAA0Bva,MAA1B;EACA,WAAOpG,EAAP;EACD,GAJD;;EAMAugB,UAAQpR,MAAR,GAAiB,UAAUA,MAAV,EAAkB;EACjC,QAAInP,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWgP,MAAX,GAAoBA,MAApB;EACA,WAAOnP,EAAP;EACD,GAJD;;EAMAugB,UAAQvf,GAAR,GAAc,UAAUA,GAAV,EAAe;EAC3B,QAAIhB,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWa,GAAX,GAAiBA,GAAjB;EACAhB,OAAG4O,IAAH,CAAQ9D,IAAR,CAAa9K,GAAGG,OAAH,CAAWa,GAAxB;EACA,WAAOhB,EAAP;EACD,GALD;;EAOA;EACA;EACAugB,UAAQ7gB,IAAR,GAAe,UAAUA,IAAV,EAAgB;EAC7B,QAAIM,KAAK,IAAT;EACA,QAAImS,QAAQnS,GAAGc,KAAH,CAASqD,aAArB;EACA,QAAIyc,QAAQ5gB,GAAGc,KAAH,CAASqD,aAArB;;EAEA,QAAI,OAAOnE,GAAGG,OAAH,CAAWgP,MAAlB,KAA6B,QAAjC,EAA2C;EACzC,UAAInP,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,QAA1B,KAAuCnL,GAAGG,OAAH,CAAWgP,MAAX,KAAsB,MAAjE,EAAyEgD,QAAQnS,GAAGc,KAAH,CAAS0D,cAAjB;EAC1E;;EAED,QAAI8b,QAAOtgB,GAAGG,OAAH,CAAWgP,MAAlB,MAA6B,QAAjC,EAA2C;EACzC,UAAInP,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,QAA1B,KAAuCnL,GAAGG,OAAH,CAAWgP,MAAX,CAAkBhE,cAAlB,CAAiC,GAAjC,CAAvC,IAAgFnL,GAAGG,OAAH,CAAWgP,MAAX,CAAkB7F,CAAlB,KAAwB,MAA5G,EAAoH6I,QAAQnS,GAAGc,KAAH,CAAS0D,cAAjB;EACpH,UAAIxE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,QAA1B,KAAuCnL,GAAGG,OAAH,CAAWgP,MAAX,CAAkBhE,cAAlB,CAAiC,GAAjC,CAAvC,IAAgFnL,GAAGG,OAAH,CAAWgP,MAAX,CAAkBjM,CAAlB,KAAwB,MAA5G,EAAoH0d,QAAQ5gB,GAAGc,KAAH,CAAS0D,cAAjB;EACrH;;EAEDxE,OAAGG,OAAH,CAAW0gB,WAAX,GAAyB9f,OAAA,GACtBmQ,GADsB,CAClB,UAAU5P,CAAV,EAAa;EAChB,aAAOA,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,CAAP;EACD,KAHsB,EAGpBwX,QAHoB,CAGX3O,KAHW,EAItB4O,OAJsB,CAIdrhB,IAJc,EAKtBI,GALsB,CAKlB,UAAUwB,CAAV,EAAa;EAChB,aAAOA,EAAE4P,GAAT;EACD,KAPsB,CAAzB;;EASAlR,OAAGG,OAAH,CAAW6gB,WAAX,GAAyBjgB,OAAA,GACtBmQ,GADsB,CAClB,UAAU5P,CAAV,EAAa;EAChB,aAAOA,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,CAAP;EACD,KAHsB,EAGpB4d,QAHoB,CAGXF,KAHW,EAItBG,OAJsB,CAIdrhB,IAJc,EAKtBI,GALsB,CAKlB,UAAUwB,CAAV,EAAa;EAChB,aAAOA,EAAE4P,GAAT;EACD,KAPsB,CAAzB;;EASAlR,OAAGG,OAAH,CAAW8gB,UAAX,GAAwBlgB,OAAA,GACrBmQ,GADqB,CACjB,UAAU5P,CAAV,EAAa;EAChB,aAAOA,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb,CAAP;EACD,KAHqB,EAIrB8R,OAJqB,CAIbrhB,IAJa,EAKrBI,GALqB,CAKjB,UAAUwB,CAAV,EAAa;EAChB,aAAOgD,OAAOhD,EAAE4P,GAAT,CAAP;EACD,KAPqB,CAAxB;;EASA;;;EAGAlR,OAAGygB,UAAH,GAAgB5Q,KAAKiD,KAAL,CAAW,CAAC9S,GAAGG,OAAH,CAAWyE,IAAX,CAAgBxE,KAAhB,IAAyBJ,GAAGG,OAAH,CAAWyE,IAAX,CAAgBC,MAAhB,CAAuBC,IAAvB,GAA8B9E,GAAGG,OAAH,CAAWyE,IAAX,CAAgBC,MAAhB,CAAuBE,KAA9E,CAAD,IAAyF/E,GAAGG,OAAH,CAAW0gB,WAAX,CAAuBhd,MAA3H,CAAhB;;EAEA7D,OAAGkhB,WAAH,GAAiBrR,KAAKiD,KAAL,CAAW,CAAC9S,GAAGG,OAAH,CAAWyE,IAAX,CAAgBtE,MAAhB,IAA0BN,GAAGG,OAAH,CAAWyE,IAAX,CAAgBC,MAAhB,CAAuBG,GAAvB,GAA6BhF,GAAGG,OAAH,CAAWyE,IAAX,CAAgBC,MAAhB,CAAuBI,MAA9E,CAAD,IAA0FjF,GAAGG,OAAH,CAAW6gB,WAAX,CAAuBnd,MAA5H,CAAjB;;EAEA7D,OAAGkH,KAAH,GAAWxH,KAAKI,GAAL,CAAS,UAAUwB,CAAV,EAAa;EAC/B,UAAI6f,IAAI;EACNje,WAAG5B,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,CADG;EAENoG,WAAGhI,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,CAFG;EAGNlH,eAAO,CAACd,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb;EAHF,OAAR;EAKA,UAAI3N,EAAE2O,WAAN,EAAmB;EACjBkR,UAAElR,WAAF,GAAgB3O,EAAE2O,WAAF,CAAcC,OAAd,CAAsB,CAAtB,CAAhB;EACD;EACD,aAAOiR,CAAP;EACD,KAVU,CAAX;;EAYA,WAAOnhB,EAAP;EACD,GA7DD;;EA+DAugB,UAAQ9X,MAAR,GAAiB,YAAY;EAC3B,QAAIzI,KAAK,IAAT;EACA,WAAOA,EAAP;EACD,GAHD;;EAKAugB,UAAQa,eAAR,GAA0B,YAAY;EACpC,QAAIphB,KAAK,IAAT;;EAEA,QAAIgC,SAAShC,GAAGG,OAAH,CAAW+O,MAAxB;EACA,QAAImS,mBAAmBtgB,YAAA,GAAegB,UAAf,CAA0B,CAAC/B,GAAGG,OAAH,CAAWyE,IAAX,CAAgBtE,MAAhB,GAAyB,GAA1B,EAA+B,CAA/B,CAA1B,EAA6D0B,MAA7D,CAAoEA,MAApE,CAAvB;EACA;EACA;EACA,QAAI8D,SAAS/E,SAAA,CAAUf,GAAGG,OAAH,CAAW0H,MAArB,EAA6B+C,MAA7B,CAAoC,KAApC,EACVrH,MADU,CACH,GADG,EAEVJ,IAFU,CAEL,OAFK,EAEI,kBAFJ,EAGVA,IAHU,CAGL,WAHK,EAGQ,gBAAgBnD,GAAGG,OAAH,CAAWyE,IAAX,CAAgBxE,KAAhB,GAAwB,GAAxC,IAA+C,GAA/C,GAAqDJ,GAAGG,OAAH,CAAWyE,IAAX,CAAgBtE,MAAhB,GAAyB,EAA9E,GAAmF,GAH3F,CAAb;;EAKA;EACAwF,WAAOvC,MAAP,CAAc,MAAd,EACGJ,IADH,CACQ,GADR,EACa,CAAC,EADd,EAEGA,IAFH,CAEQ,GAFR,EAEa,CAAC,EAFd,EAGGA,IAHH,CAGQ,OAHR,EAGiB,GAHjB,EAIGA,IAJH,CAIQ,QAJR,EAIkBnD,GAAGG,OAAH,CAAWyE,IAAX,CAAgBtE,MAAhB,GAAyB,EAJ3C,EAKG6C,IALH,CAKQ,IALR,EAKc,EALd,EAMGA,IANH,CAMQ,IANR,EAMc,EANd,EAOGA,IAPH,CAOQ,OAPR,EAOiB,mBAPjB,EAQGA,IARH,CAQQ,MARR,EAQgB,uBARhB;;EAUA;EACA2C,WAAOvC,MAAP,CAAc,MAAd,EACGJ,IADH,CACQ,GADR,EACa,CADb,EAEGA,IAFH,CAEQ,GAFR,EAEa,CAAC,EAFd,EAGGA,IAHH,CAGQ,OAHR,EAGiB,cAHjB,EAIGA,IAJH,CAIQ,aAJR,EAIuB,QAJvB,EAKGX,IALH,CAKQxC,GAAGG,OAAH,CAAW+H,WALnB;;EAQA,QAAIsI,YAAY1K,OAAOmG,SAAP,CAAiB,WAAjB,EACbvM,IADa,CACRM,GAAGG,OAAH,CAAW+O,MADH,EAEbhD,KAFa,GAGb3I,MAHa,CAGN,GAHM,EAIbJ,IAJa,CAIR,OAJQ,EAIC,UAJD,EAKbA,IALa,CAKR,WALQ,EAKK,UAAU7B,CAAV,EAAa;EAC9B,aAAO,oBAAoB+f,iBAAiB/f,CAAjB,CAApB,GACL,GADF;EAED,KARa,CAAhB;;EAUA;EACAkP,cAAUjN,MAAV,CAAiB,MAAjB,EACGJ,IADH,CACQ,GADR,EACa,CAAC,EADd,EAEGA,IAFH,CAEQ,GAFR,EAEa,CAFb,EAGGA,IAHH,CAGQ,OAHR,EAGiB,EAHjB,EAIGA,IAJH,CAIQ,QAJR,EAIkBke,iBAAiBzT,SAAjB,EAJlB,EAKGzK,IALH,CAKQ,MALR,EAKgB,UAAU7B,CAAV,EAAa;EACzB,aAAOA,CAAP;EACD,KAPH;;EAUA;EACAkP,cAAUjN,MAAV,CAAiB,MAAjB,EACGJ,IADH,CACQ,GADR,EACa,EADb,EAEGA,IAFH,CAEQ,GAFR,EAEa,CAFb,EAGGA,IAHH,CAGQ,OAHR,EAGiB,WAHjB,EAIGA,IAJH,CAIQ,aAJR,EAIuB,MAJvB,EAKGX,IALH,CAKQ,UAAUlB,CAAV,EAAa;EACjB,UAAIsQ,MAAO5R,GAAGqH,OAAH,CAAWjC,KAAX,CAAiBkc,YAAjB,CAA8BhgB,CAA9B,EAAiC,CAAjC,CAAX;EACA,UAAItB,GAAGG,OAAH,CAAW+H,WAAX,KAA2B,YAA3B,IAA2C0J,MAAM,GAArD,EAA0D;EACxDA,cAAM,GAAN;EACD;EACD,aAAO5R,GAAGc,KAAH,CAASqB,MAAT,CAAgByP,GAAhB,EAAqB5R,GAAGG,OAAH,CAAW6P,QAAhC,CAAP;EACD,KAXH;;EAaA;EACAQ,cAAUjN,MAAV,CAAiB,MAAjB,EACGJ,IADH,CACQ,GADR,EACa,EADb,EAEGA,IAFH,CAEQ,GAFR,EAEanD,GAAGG,OAAH,CAAWyE,IAAX,CAAgBtE,MAAhB,GAAyB,CAAzB,GAA6B,EAF1C,EAGG6C,IAHH,CAGQ,OAHR,EAGiB,cAHjB,EAIGA,IAJH,CAIQ,aAJR,EAIuB,MAJvB,EAKGX,IALH,CAKQ,UAAUlB,CAAV,EAAa2C,CAAb,EAAgB;EACpB,UAAIA,MAAM,CAAV,EAAa;EACX,YAAI0N,MAAO3R,GAAGqH,OAAH,CAAWjC,KAAX,CAAiBkc,YAAjB,CAA8BhgB,CAA9B,EAAiC,CAAjC,CAAX;EACA,eAAOtB,GAAGc,KAAH,CAASqB,MAAT,CAAgBwP,GAAhB,EAAqB3R,GAAGG,OAAH,CAAW6P,QAAhC,CAAP;EACD,OAHD,MAGO;EACL,eAAO,EAAP;EACD;EACF,KAZH;EAaD,GAjFD;;EAmFAuQ,UAAQ7Q,UAAR,GAAqB,YAAY;EAC/B,QAAI1P,KAAK,IAAT;EACA,QAAIuhB,QAAQvhB,GAAGE,KAAH,CAASU,GAAT,GAAeqL,SAAf,CAAyB,aAAzB,EAAwCvM,IAAxC,CAA6CM,GAAGkH,KAAhD,EAAuD,UAAU5F,CAAV,EAAa;EAC9E,aAAOA,EAAE4B,CAAF,GAAM,GAAN,GAAY5B,EAAEgI,CAArB;EACD,KAFW,CAAZ;EAGA;EACA;;;;;;;;;;;;;;;;;;;;;EAsBAiY,UAAMrV,KAAN,GAAc3I,MAAd,CAAqB,MAArB,EACGJ,IADH,CACQ,WADR,EACqB,eAAgB,CAACnD,GAAGygB,UAAJ,GAAe,CAA/B,GAAoC,OADzD,EAEGtd,IAFH,CAEQ,IAFR,EAEc,UAAS7B,CAAT,EAAW;EACrB,aAAQ,CAAEtB,GAAGG,OAAH,CAAW0gB,WAAX,CAAuBW,OAAvB,CAA+BC,OAAOngB,EAAEgI,CAAT,CAA/B,CAAD,GAAgD,CAAjD,IAAsDtJ,GAAGygB,UAAjE;EACD,KAJH,EAKGtd,IALH,CAKQ,IALR,EAKc,UAAS7B,CAAT,EAAY;EACtB,aAAQtB,GAAGG,OAAH,CAAW6gB,WAAX,CAAuBQ,OAAvB,CAA+BC,OAAOngB,EAAE4B,CAAT,CAA/B,CAAD,GAAgDlD,GAAGkhB,WAA1D;EACD,KAPH,EAQG/d,IARH,CAQQ,OARR,EAQiB,YARjB,EASGX,IATH,CASS,UAASlB,CAAT,EAAY;EACjB,aAAOA,EAAEc,KAAF,GAAUpC,GAAGc,KAAH,CAASqB,MAAT,CAAgBb,EAAEc,KAAlB,EAAyBpC,GAAGG,OAAH,CAAW6P,QAApC,CAAV,GAA0D,EAAjE;EACD,KAXH;;EAaA;EACAuR,UAAMrV,KAAN,GAAc3I,MAAd,CAAqB,MAArB,EACGJ,IADH,CACQ,WADR,EACqB,eAAgB,CAACnD,GAAGygB,UAAJ,GAAe,CAA/B,GAAoC,OADzD,EAEGtd,IAFH,CAEQ,IAFR,EAEc,UAAS7B,CAAT,EAAW;EACrB,aAAQ,CAAEtB,GAAGG,OAAH,CAAW0gB,WAAX,CAAuBW,OAAvB,CAA+BC,OAAOngB,EAAEgI,CAAT,CAA/B,CAAD,GAAgD,CAAjD,IAAsDtJ,GAAGygB,UAAjE;EACD,KAJH,EAKGtd,IALH,CAKQ,IALR,EAKc,UAAS7B,CAAT,EAAY;EACtB,aAAQtB,GAAGG,OAAH,CAAW6gB,WAAX,CAAuBQ,OAAvB,CAA+BC,OAAOngB,EAAE4B,CAAT,CAA/B,CAAD,GAAgDlD,GAAGkhB,WAA1D;EACD,KAPH,EAQG/d,IARH,CAQQ,OARR,EAQiB,wBARjB,EASGX,IATH,CASS,UAASlB,CAAT,EAAY;EACjB,aAAOA,EAAE2O,WAAF,GAAgB,MAAM5M,WAAW/B,EAAE2O,WAAb,EAA0BC,OAA1B,CAAkC,CAAlC,CAAN,GAA6C,GAA7D,GAAmE,EAA1E;EACD,KAXH;EAYD,GAtDD;;EAwDAqQ,UAAQhY,IAAR,GAAe,YAAY;EACzB,QAAIvI,KAAK,IAAT;;EAEA;EACAA,OAAGE,KAAH,CAASU,GAAT,GAAe2K,IAAf,CAAoBvL,GAAG4O,IAAvB;;EAEA,QAAMnC,UAAUzM,GAAGc,KAAH,CAASC,EAAT,CAAYC,GAAZ,GAAkB8J,IAAlB,CAAuB,aAAK;EAC1C,aAAO,4BAA4BxJ,CAA5B,GAAgC,QAAvC;EACD,KAFe,CAAhB;EAGAtB,OAAGE,KAAH,CAASU,GAAT,GAAe2K,IAAf,CAAoBkB,OAApB;;EAEAzM,OAAG0hB,QAAH,GAAc1hB,GAAGE,KAAH,CAASU,GAAT,GAAe2C,MAAf,CAAsB,GAAtB,EACXJ,IADW,CACN,OADM,EACG,QADH,EAEXA,IAFW,CAEN,WAFM,EAEO,gBAFP,EAGX8I,SAHW,CAGD,OAHC,EAIXvM,IAJW,CAINM,GAAGG,OAAH,CAAW6gB,WAJL,EAKX9U,KALW,GAMX3I,MANW,CAMJ,GANI,EAOXJ,IAPW,CAON,OAPM,EAOG,MAPH,EAQXA,IARW,CAQN,WARM,EAQO,UAAS7B,CAAT,EAAY2C,CAAZ,EAAe;EAChC,aAAO,iBAAkBA,IAAIjE,GAAGkhB,WAAzB,GAAwC,GAA/C;EACD,KAVW,EAWX3d,MAXW,CAWJ,MAXI,EAYXJ,IAZW,CAYN,aAZM,EAYS,KAZT,EAaXA,IAbW,CAaN,WAbM,EAaO,kBAAkBnD,GAAGkhB,WAAH,GAAiB,GAAnC,GAAyC,GAbhD,EAcX1e,IAdW,CAcN,UAAUlB,CAAV,EAAa;EACjB,aAAOA,CAAP;EACD,KAhBW,CAAd;;EAkBAtB,OAAG0hB,QAAH,CAAYhf,IAAZ,CAAiB,UAASpB,CAAT,EAAY;EAAA;;EAC3B,UAAI,KAAKsC,qBAAL,KAA+B5D,GAAGG,OAAH,CAAWyE,IAAX,CAAgBC,MAAhB,CAAuBC,IAAvB,GAA8B,GAAjE,EAAsE;EAAA;EACpE/D,mBAAA,QACG+C,EADH,CACM,WADN,EACmB2I,QAAQ1I,IAD3B,EAEGD,EAFH,CAEM,UAFN,EAEkB2I,QAAQzI,IAF1B;EAGA,cAAIC,IAAI,CAAR;EACA,iBAAO,MAAKL,qBAAL,KAA+B5D,GAAGG,OAAH,CAAWyE,IAAX,CAAgBC,MAAhB,CAAuBC,IAAvB,GAA8B,GAApE,EAAyE;EACvE/D,qBAAA,QAAgByB,IAAhB,CAAqB,UAAUlB,CAAV,EAAa;EAChC,qBAAOA,EAAE4C,KAAF,CAAQ,CAAR,EAAW,CAACD,CAAZ,IAAiB,KAAxB;EACD,aAFD,EAEGd,IAFH,CAEQ,OAFR,EAEiB7B,CAFjB;EAGA,cAAE2C,CAAF;EACD;EAVmE;EAWrE;EACF,KAbD;;EAeAjE,OAAG2hB,QAAH,GAAc3hB,GAAGE,KAAH,CAASU,GAAT,GAAe2C,MAAf,CAAsB,GAAtB,EACXJ,IADW,CACN,OADM,EACG,QADH,EAEXA,IAFW,CAEN,WAFM,EAEO,gBAFP,EAGX8I,SAHW,CAGD,OAHC,EAIXvM,IAJW,CAINM,GAAGG,OAAH,CAAW0gB,WAJL,EAKX3U,KALW,GAMX3I,MANW,CAMJ,GANI,EAOXJ,IAPW,CAON,OAPM,EAOG,MAPH,EAQXA,IARW,CAQN,WARM,EAQO,UAAU7B,CAAV,EAAa2C,CAAb,EAAgB;EACjC,aAAO,gBAAgBA,IAAIjE,GAAGygB,UAAP,GAAqBzgB,GAAGygB,UAAH,GAAgB,CAArD,IAA2D,GAA3D,IAAkEzgB,GAAGG,OAAH,CAAW6gB,WAAX,CAAuBnd,MAAvB,GAAgC7D,GAAGkhB,WAAnC,GAAiD,EAAnH,IAA0H,GAAjI;EACD,KAVW,EAWX3d,MAXW,CAWJ,MAXI,EAYXJ,IAZW,CAYN,aAZM,EAYS,QAZT,EAaXX,IAbW,CAaN,UAAUlB,CAAV,EAAa;EACjB,aAAOA,CAAP;EACD,KAfW,CAAd;;EAiBA,QAAMmM,oBAAoB1M,MAAA,CAAOA,SAAA,CAAU,SAAV,EAAqBkL,SAArB,CAA+B,MAA/B,EAAuCyB,KAAvC,GAA+C5N,GAA/C,CAAmD;EAAA,aAAKiM,EAAEnI,qBAAF,EAAL;EAAA,KAAnD,CAAP,CAA1B,CA7DyB;EA8DzB,QAAI+J,aAAa3N,GAAGygB,UAApB;EACA,QAAImB,gBAAgBjU,UAApB;EACA,QAAIF,oBAAoBE,UAAxB,EAAoC;EAAE;EACpC3N,SAAG2hB,QAAH,CAAYjf,IAAZ,CAAiB,UAAUpB,CAAV,EAAa;EAAA;;EAC5BP,iBAAA,CAAU,IAAV,EACGoC,IADH,CACQ,aADR,EACuB,KADvB,EAEGA,IAFH,CAEQ,IAFR,EAEc,CAFd,EAGGA,IAHH,CAGQ,WAHR,EAGqB,8BAHrB;EAIA;EACAye,wBAAgB,OAAO5hB,GAAGG,OAAH,CAAWyE,IAAX,CAAgBC,MAAhB,CAAuBI,MAA9C;EACA,YAAI,KAAKrB,qBAAL,KAA+Bge,aAAnC,EAAkD;EAAA;EAChD7gB,qBAAA,SACG+C,EADH,CACM,WADN,EACmB2I,QAAQ1I,IAD3B,EAEGD,EAFH,CAEM,UAFN,EAEkB2I,QAAQzI,IAF1B;EAGA,gBAAIC,IAAI,CAAR;EACA,mBAAO,OAAKL,qBAAL,KAA+Bge,aAAtC,EAAqD;EACnD7gB,uBAAA,SAAgByB,IAAhB,CAAqB,UAAUlB,CAAV,EAAa;EAChC,uBAAOA,EAAE4C,KAAF,CAAQ,CAAR,EAAW,CAACD,CAAZ,IAAiB,KAAxB;EACD,eAFD,EAEGd,IAFH,CAEQ,OAFR,EAEiB7B,CAFjB;EAGA,gBAAE2C,CAAF;EACD;EAV+C;EAWjD,SAXD,MAWO;EACL,iBAAO3C,CAAP;EACD;EACF,OArBD;EAsBD;;EAEDtB,OAAGqH,OAAH,CAAWjC,KAAX,GAAmBrE,gBAAA,GAChBiB,MADgB,CACT,CAAC,CAAD,EAAIjB,MAAA,CAAOf,GAAGkH,KAAV,EAAiB,UAAU5F,CAAV,EAAa;EACxC,aAAOA,EAAEc,KAAT;EACD,KAFW,CAAJ,CADS,EAIhBhB,KAJgB,CAIVpB,GAAGG,OAAH,CAAW+O,MAJD,CAAnB;;EAMA,QAAIqS,QAAQvhB,GAAGE,KAAH,CAASU,GAAT,GAAeqL,SAAf,CAAyB,YAAzB,EACTvM,IADS,CACJM,GAAGkH,KADC,EACM,UAAU5F,CAAV,EAAa;EAC3B,aAAOA,EAAE4B,CAAF,GAAM,GAAN,GAAY5B,EAAEgI,CAArB;EACD,KAHS,CAAZ;;EAKAiY,UAAMrV,KAAN,GAAc3I,MAAd,CAAqB,MAArB,EACGJ,IADH,CACQ,GADR,EACa,UAAU7B,CAAV,EAAa;EACtB,aAAQtB,GAAGG,OAAH,CAAW0gB,WAAX,CAAuBW,OAAvB,CAA+BC,OAAOngB,EAAEgI,CAAT,CAA/B,CAAD,GAAgDtJ,GAAGygB,UAA1D;EACD,KAHH,EAIGtd,IAJH,CAIQ,GAJR,EAIa,UAAU7B,CAAV,EAAa;EACtB,aAAQtB,GAAGG,OAAH,CAAW6gB,WAAX,CAAuBQ,OAAvB,CAA+BC,OAAOngB,EAAE4B,CAAT,CAA/B,CAAD,GAAgDlD,GAAGkhB,WAA1D;EACD,KANH,EAOG/d,IAPH,CAOQ,IAPR,EAOcnD,GAAGG,OAAH,CAAWwgB,YAAX,IAA2B,CAPzC,EAQGxd,IARH,CAQQ,IARR,EAQcnD,GAAGG,OAAH,CAAWwgB,YAAX,IAA2B,CARzC,EAUGxd,IAVH,CAUQ,OAVR,EAUiB,WAVjB,EAWGA,IAXH,CAWQ,QAXR,EAWkB,MAXlB,EAYGA,IAZH,CAYQ,cAZR,EAYwB,KAZxB,EAaGA,IAbH,CAaQ,IAbR,EAac,UAAU7B,CAAV,EAAa;EACvB,aAAO,MAAMA,EAAEgI,CAAR,GAAY,GAAZ,GAAkBhI,EAAE4B,CAA3B;EACD,KAfH,EAgBGC,IAhBH,CAgBQ,OAhBR,EAgBiBnD,GAAGygB,UAhBpB,EAiBGtd,IAjBH,CAiBQ,QAjBR,EAiBkBnD,GAAGkhB,WAjBrB,EAkBGpd,EAlBH,CAkBM,WAlBN,EAkBmB,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC/BjE,SAAG4O,IAAH,CAAQ7K,IAAR,CAAazC,CAAb,EAAgBP,SAAA,CAAU,IAAV,EAAgB4C,IAAhB,EAAhB;EACA,UAAI3D,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,WAA1B,CAAJ,EAA4C;EAC1CnL,WAAGG,OAAH,CAAW0hB,SAAX,CAAqBtW,IAArB,CAA0BvL,EAA1B,EAA8BsB,CAA9B,EAAiC2C,CAAjC;EACD;EACF,KAvBH,EAwBGH,EAxBH,CAwBM,UAxBN,EAwBkB,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC9BjE,SAAG4O,IAAH,CAAQ5K,IAAR,CAAa1C,CAAb,EAAgBP,SAAA,CAAU,IAAV,EAAgB4C,IAAhB,EAAhB;EACA,UAAI3D,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,UAA1B,CAAJ,EAA2C;EACzCnL,WAAGG,OAAH,CAAW2hB,QAAX,CAAoBvW,IAApB,CAAyB,IAAzB,EAA+BjK,CAA/B,EAAkC2C,CAAlC;EACD;EACF,KA7BH,EA8BGH,EA9BH,CA8BM,OA9BN,EA8Be,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC3B,UAAIjE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,SAA1B,CAAJ,EAA0C;EACxCnL,WAAGG,OAAH,CAAWwQ,OAAX,CAAmBpF,IAAnB,CAAwB,IAAxB,EAA8BjK,CAA9B,EAAiC2C,CAAjC;EACD;EACF,KAlCH,EAmCGd,IAnCH,CAmCQ,MAnCR,EAmCgBnD,GAAGG,OAAH,CAAW+O,MAAX,CAAkB,CAAlB,CAnChB,EAoCGkG,UApCH,GAqCGC,QArCH,CAqCY,IArCZ,EAsCG0M,IAtCH,CAsCQhhB,aAtCR,EAuCGoC,IAvCH,CAuCQ,MAvCR,EAuCgB,UAAU7B,CAAV,EAAa;EACzB,aAAOtB,GAAGqH,OAAH,CAAWjC,KAAX,CAAiB9D,EAAEc,KAAnB,CAAP;EACD,KAzCH;;EA2CAme,YAAQ7Q,UAAR;;EAEA,QAAI1P,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,aAA1B,CAAJ,EAA+C;EAC7CoV,cAAQa,eAAR;EACD;;EAED;;;;;;;;;;;;;;;;;EAqBA,WAAOphB,EAAP;EACD,GA3KD;;EA6KAugB,UAAQ7b,IAAR,CAAavF,MAAb;;EAEA,SAAOohB,OAAP;EACD;;ECtdD;;;;AAIA,EAAe,kBAAUphB,MAAV,EAAkBqI,MAAlB,EAA0B;;EAEvC,MAAIwa,UAAUja,OAAO4G,MAAP,CAAcnH,MAAd,CAAd;;EAEAwa,UAAQtd,IAAR,GAAe,UAAUvF,MAAV,EAAkB;EAC/B,QAAMa,KAAK,IAAX;EACAA,OAAGG,OAAH,GAAahB,SAASA,MAAT,GAAkB,EAA/B;EACAa,OAAGqH,OAAH,GAAa,EAAb;EACArH,OAAGsH,KAAH,GAAW,EAAX;EACAtH,OAAGkH,KAAH,GAAW,EAAX;;EAEAlH,OAAGqH,OAAH,CAAWjC,KAAX,GAAmBrE,gBAAA,GAAmBK,KAAnB,CAAyB,CAAC,SAAD,EAAY,SAAZ,EAAuB,SAAvB,EAAkC,SAAlC,EAA6C,SAA7C,CAAzB,CAAnB;EAED,GATD;;EAWA4gB,UAAQlT,EAAR,GAAa,UAAU4Q,GAAV,EAAe;EAC1B,QAAI1f,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAW2O,EAAX,GAAgB4Q,GAAhB;EACA,WAAO1f,EAAP;EACD,GAJD;;EAMAgiB,UAAQ/S,IAAR,GAAe,UAAUyQ,GAAV,EAAe;EAC5B,QAAI1f,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAW8O,IAAX,GAAkByQ,GAAlB;EACA,WAAO1f,EAAP;EACD,GAJD;;EAMAgiB,UAAQ/b,OAAR,GAAkB,UAAU7D,KAAV,EAAiB;EACjC,QAAIpC,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAW8F,OAAX,GAAqB7D,KAArB;EACA,WAAOpC,EAAP;EACD,GAJD;;EAMAgiB,UAAQ9S,MAAR,GAAiB,UAAUA,MAAV,EAAkB;EACjC,QAAIlP,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAW+O,MAAX,GAAoBA,MAApB;EACA,QAAIA,UAAUrN,MAAMC,OAAN,CAAcoN,MAAd,CAAd,EAAqC;EACnClP,SAAGqH,OAAH,CAAWjC,KAAX,CAAiBhE,KAAjB,CAAuB8N,MAAvB;EACD,KAFD,MAEO,IAAI,OAAOA,MAAP,KAAkB,UAAtB,EAAkC;EACvClP,SAAGqH,OAAH,CAAWjC,KAAX,GAAmB8J,MAAnB;EACD;EACD,WAAOlP,EAAP;EACD,GATD;;EAWAgiB,UAAQtB,WAAR,GAAsB,UAAUxY,WAAV,EAAuB;EAC3C,QAAIlI,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAW+H,WAAX,GAAyBA,WAAzB;EACA,WAAOlI,EAAP;EACD,GAJD;;EAMA;EACA;EACAgiB,UAAQtiB,IAAR,GAAe,UAAUA,IAAV,EAAgB;EAC7B,QAAIM,KAAK,IAAT;EACAA,OAAGiiB,SAAH,GAAeviB,KAAK,CAAL,IAAUA,KAAK,CAAL,CAAV,GAAoB,KAAnC,CAF6B;EAG7BA,WAAOA,KAAK,CAAL,CAAP,CAH6B;;EAK7B,QAAIM,GAAGG,OAAH,CAAWT,IAAX,CAAgB4P,MAApB,EAA4B;EAC1B5P,aAAOA,KAAK4P,MAAL,CAAYtP,GAAGG,OAAH,CAAWT,IAAX,CAAgB4P,MAA5B,CAAP;EACD;;EAEDtP,OAAGkH,KAAH,GAAWxH,IAAX;EACA;EACAM,OAAGyP,OAAH,GAAa1O,SAAA,CAAUrB,IAAV,EAAgB,UAAS4B,CAAT,EAAY;EAAE,aAAO,CAACA,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb,CAAR;EAA6B,KAA3D,CAAb;;EAEAjP,OAAGqH,OAAH,CAAWjC,KAAX,CAAiBpD,MAAjB,CAAwBhC,GAAGyP,OAA3B;;EAEA,QAAIyS,UAAUliB,GAAGG,OAAH,CAAWL,GAAX,CAAesK,QAAf,CAAwB8X,OAAtC;;EAEAliB,OAAGmiB,MAAH,GAAY,EAAZ;EACA,QAAItgB,MAAMC,OAAN,CAAcogB,OAAd,CAAJ,EAA4B;EAC1B,WAAK,IAAIhH,MAAM,CAAf,EAAkBA,MAAMgH,QAAQre,MAAhC,EAAwCqX,KAAxC,EAA+C;EAC7C,YAAMlN,MAAMkU,QAAQhH,GAAR,CAAZ;EACAlb,WAAGiiB,SAAH,CAAaC,OAAb,CAAqBlU,GAArB,EAA0BoU,UAA1B,CAAqC3X,OAArC,CAA6C,UAAU4X,IAAV,EAAgB;EAC3DA,eAAKvT,EAAL,GAAU9O,GAAGG,OAAH,CAAWL,GAAX,CAAesK,QAAf,CAAwBvK,MAAxB,CAA+BwiB,IAA/B,CAAV;EACA,cAAIC,QAAQtiB,GAAGkH,KAAH,CAASoI,MAAT,CAAgB;EAAA,mBAAKvD,EAAE/L,GAAGG,OAAH,CAAW2O,EAAb,KAAoBuT,KAAKvT,EAA9B;EAAA,WAAhB,EAAkD,CAAlD,CAAZ;EACA,cAAIwT,KAAJ,EAAW;EACTD,iBAAKE,UAAL,CAAgBviB,GAAGG,OAAH,CAAW8O,IAA3B,IAAmCqT,MAAMtiB,GAAGG,OAAH,CAAW8O,IAAjB,CAAnC;EACD;EACDjP,aAAGmiB,MAAH,CAAU1e,IAAV,CAAe4e,IAAf;EACD,SAPD;EAQD;EACF,KAZD,MAYO,IAAIH,OAAJ,EAAa;EAClBliB,SAAGiiB,SAAH,CAAaC,OAAb,CAAqBA,OAArB,EAA8BE,UAA9B,CAAyC3X,OAAzC,CAAiD,UAAU4X,IAAV,EAAgB;EAC/DA,aAAKvT,EAAL,GAAU9O,GAAGG,OAAH,CAAWL,GAAX,CAAesK,QAAf,CAAwBvK,MAAxB,CAA+BwiB,IAA/B,CAAV;EACA,YAAIC,QAAQtiB,GAAGkH,KAAH,CAASoI,MAAT,CAAgB;EAAA,iBAAKvD,EAAE/L,GAAGG,OAAH,CAAW2O,EAAb,KAAoBuT,KAAKvT,EAA9B;EAAA,SAAhB,EAAkD,CAAlD,CAAZ;EACA,YAAIwT,KAAJ,EAAW;EACTD,eAAKE,UAAL,CAAgBviB,GAAGG,OAAH,CAAW8O,IAA3B,IAAmCqT,MAAMtiB,GAAGG,OAAH,CAAW8O,IAAjB,CAAnC;EACD;EACDjP,WAAGmiB,MAAH,CAAU1e,IAAV,CAAe4e,IAAf;EACD,OAPD;EAQD;;EAED;EACA;EACA,WAAOriB,EAAP;EACD,GA5CD;;EA8CAgiB,UAAQvZ,MAAR,GAAiB,YAAY;EAC3B,QAAIzI,KAAK,IAAT;EACA,WAAOA,EAAP;EACD,GAHD;;EAKAgiB,UAAQZ,eAAR,GAA0B,YAAY;EACpC,QAAIphB,KAAK,IAAT;;EAEA,QAAIoB,QAAQpB,GAAGqH,OAAH,CAAWjC,KAAX,CAAiBhE,KAAjB,GAAyByC,MAArC;EACA,QAAI2e,OAAO,CAACxiB,GAAGyP,OAAH,CAAW,CAAX,IAAgBzP,GAAGyP,OAAH,CAAW,CAAX,CAAjB,KAAmCrO,QAAQ,CAA3C,CAAX;EACA,QAAIY,SAAShC,GAAGG,OAAH,CAAW+O,MAAxB;;EAEA,QAAImS,mBAAmBtgB,YAAA,GAAegB,UAAf,CAA0B,CAAC/B,GAAGG,OAAH,CAAWyE,IAAX,CAAgBtE,MAAhB,GAAyB,GAA1B,EAA+B,CAA/B,CAA1B,EAA6D0B,MAA7D,CAAoEA,MAApE,CAAvB;EACA;EACA;EACA,QAAI8D,SAAS/E,SAAA,CAAU,MAAMf,GAAGG,OAAH,CAAW0H,MAA3B,EACVtE,MADU,CACH,KADG,EAERJ,IAFQ,CAEH,OAFG,EAEM,GAFN,EAGRA,IAHQ,CAGH,QAHG,EAGOnD,GAAGG,OAAH,CAAWyE,IAAX,CAAgBtE,MAHvB,EAIRE,KAJQ,CAIF,SAJE,EAIS,GAJT,EAKRA,KALQ,CAKF,UALE,EAKU,UALV,EAMRA,KANQ,CAMF,KANE,EAMK,KANL,EAORA,KAPQ,CAOF,OAPE,EAOO,KAPP,EAQV+C,MARU,CAQH,GARG,EASVJ,IATU,CASL,OATK,EASI,kBATJ,EAUVA,IAVU,CAUL,WAVK,EAUQ,kBAVR,CAAb;;EAYA;EACA2C,WAAOvC,MAAP,CAAc,MAAd,EACGJ,IADH,CACQ,GADR,EACa,CAAC,EADd,EAEGA,IAFH,CAEQ,GAFR,EAEa,CAAC,EAFd,EAGGA,IAHH,CAGQ,OAHR,EAGiB,GAHjB,EAIGA,IAJH,CAIQ,QAJR,EAIkBnD,GAAGG,OAAH,CAAWyE,IAAX,CAAgBtE,MAAhB,GAAyB,EAJ3C,EAKG6C,IALH,CAKQ,IALR,EAKc,EALd,EAMGA,IANH,CAMQ,IANR,EAMc,EANd,EAOGA,IAPH,CAOQ,OAPR,EAOiB,mBAPjB,EAQGA,IARH,CAQQ,MARR,EAQgB,uBARhB;;EAUE;EACF2C,WAAOvC,MAAP,CAAc,MAAd,EACGJ,IADH,CACQ,GADR,EACa,CADb,EAEGA,IAFH,CAEQ,GAFR,EAEa,CAAC,EAFd,EAGGA,IAHH,CAGQ,OAHR,EAGiB,cAHjB,EAIGA,IAJH,CAIQ,aAJR,EAIuB,QAJvB,EAKGX,IALH,CAKQxC,GAAGG,OAAH,CAAW+H,WALnB;;EAOA,QAAIsI,YAAY1K,OAAOmG,SAAP,CAAiB,WAAjB,EACbvM,IADa,CACRM,GAAGG,OAAH,CAAW+O,MADH,EAEbhD,KAFa,GAGb3I,MAHa,CAGN,GAHM,EAIbJ,IAJa,CAIR,OAJQ,EAIC,UAJD,EAKbA,IALa,CAKR,WALQ,EAKK,UAAS7B,CAAT,EAAY;EAC7B,aAAO,oBAAoB+f,iBAAiB/f,CAAjB,CAApB,GACJ,GADH;EAED,KARa,CAAhB;;EAUA;EACAkP,cAAUjN,MAAV,CAAiB,MAAjB,EACGJ,IADH,CACQ,GADR,EACa,CAAC,EADd,EAEGA,IAFH,CAEQ,GAFR,EAEa,CAFb,EAGGA,IAHH,CAGQ,OAHR,EAGiB,EAHjB,EAIGA,IAJH,CAIQ,QAJR,EAIkBke,iBAAiBzT,SAAjB,EAJlB,EAKGzK,IALH,CAKQ,MALR,EAKgB,UAAU7B,CAAV,EAAa;EACzB,aAAOA,CAAP;EACD,KAPH;;EAUA;EACAkP,cAAUjN,MAAV,CAAiB,MAAjB,EACGJ,IADH,CACQ,GADR,EACa,EADb,EAEGA,IAFH,CAEQ,GAFR,EAEa,CAFb,EAGGA,IAHH,CAGQ,OAHR,EAGiB,WAHjB,EAIGA,IAJH,CAIQ,aAJR,EAIuB,MAJvB,EAKGX,IALH,CAKQ,UAASlB,CAAT,EAAW;EACf,UAAIsQ,MAAO5R,GAAGqH,OAAH,CAAWjC,KAAX,CAAiBkc,YAAjB,CAA8BhgB,CAA9B,EAAiC,CAAjC,CAAX;EACA,UAAItB,GAAGG,OAAH,CAAW+H,WAAX,KAA2B,YAA3B,IAA2C0J,MAAM,GAArD,EAA0D;EACxDA,cAAM,GAAN;EACD;EACD,UAAI5R,GAAGG,OAAH,CAAWL,GAAX,CAAe2iB,YAAnB,EAAiC;EAC/B,eAAOziB,GAAGG,OAAH,CAAWL,GAAX,CAAe2iB,YAAf,CAA4B7Q,GAA5B,CAAP;EACD,OAFD,MAEO;EACL,eAAO5R,GAAGc,KAAH,CAASqB,MAAT,CAAgByP,GAAhB,CAAP;EACD;EACF,KAfH;;EAiBA;EACApB,cAAUjN,MAAV,CAAiB,MAAjB,EACGJ,IADH,CACQ,GADR,EACa,EADb,EAEGA,IAFH,CAEQ,GAFR,EAEanD,GAAGG,OAAH,CAAWyE,IAAX,CAAgBtE,MAAhB,GAAyB,CAAzB,GAA6B,EAF1C,EAGG6C,IAHH,CAGQ,OAHR,EAGiB,cAHjB,EAIGA,IAJH,CAIQ,aAJR,EAIuB,MAJvB,EAKGX,IALH,CAKQ,UAASlB,CAAT,EAAY2C,CAAZ,EAAc;EAClB,UAAIA,MAAM,CAAV,EAAa;EACX,YAAI0N,MAAO3R,GAAGqH,OAAH,CAAWjC,KAAX,CAAiBkc,YAAjB,CAA8BhgB,CAA9B,EAAiC,CAAjC,CAAX;EACA,YAAItB,GAAGG,OAAH,CAAWL,GAAX,CAAe2iB,YAAnB,EAAiC;EAC/B,iBAAOziB,GAAGG,OAAH,CAAWL,GAAX,CAAe2iB,YAAf,CAA4B9Q,GAA5B,CAAP;EACD,SAFD,MAEO;EACL,iBAAO3R,GAAGc,KAAH,CAASqB,MAAT,CAAgBwP,GAAhB,CAAP;EACD;EACF,OAPD,MAOO;EACL,eAAO,EAAP;EACD;EACF,KAhBH;EAiBD,GAlGD;;EAoGAqQ,UAAQzZ,IAAR,GAAe,YAAY;EACzB,QAAIvI,KAAK,IAAT;;EAEA,QAAI0iB,cAAc1iB,GAAGG,OAAH,CAAWL,GAAX,CAAesK,QAAf,CAAwBC,GAA1C;EACA,QAAI6X,UAAUliB,GAAGG,OAAH,CAAWL,GAAX,CAAesK,QAAf,CAAwB8X,OAAtC,CAJyB;EAKzB,QAAIS,OAAO3iB,GAAGG,OAAH,CAAWL,GAAX,CAAesK,QAAf,CAAwBwY,SAAnC,CALyB;EAMzB,QAAI1hB,QAAQlB,GAAGG,OAAH,CAAWL,GAAX,CAAesK,QAAf,CAAwBlJ,KAApC,CANyB;EAOzB,QAAIrB,SAASG,GAAGG,OAAH,CAAWL,GAAX,CAAesK,QAAf,CAAwBvK,MAArC;EACA,QAAIiP,KAAK9O,GAAGG,OAAH,CAAWL,GAAX,CAAesK,QAAf,CAAwB0E,EAAjC;;EAEA+T,MAAEC,QAAF,GAAaD,EAAEE,OAAF,CAAUC,MAAV,CAAiB;EAC5BC;EAAS,yBAAUC,QAAV,EAAoB;EAC3B,cAAIC,OAAJ,EAAajS,GAAb;EACA,cAAIgS,SAASvhB,IAAT,KAAkB,UAAtB,EAAkC;EAChC,gBAAIugB,OAAJ,EAAa;EACX,kBAAIrgB,MAAMC,OAAN,CAAcogB,OAAd,CAAJ,EAA4B;EAC1B,qBAAK,IAAIhH,MAAM,CAAf,EAAkBA,MAAMgH,QAAQre,MAAhC,EAAwCqX,KAAxC,EAA+C;EAC7C,sBAAMlN,MAAMkU,QAAQhH,GAAR,CAAZ;EACAiI,4BAAU/Y,SAASgZ,OAAT,CAAiBF,QAAjB,EAA2BA,SAAShB,OAAT,CAAiBlU,GAAjB,CAA3B,CAAV;EACA6U,oBAAEE,OAAF,CAAUM,SAAV,CAAoBJ,OAApB,CAA4B1X,IAA5B,CAAiC,IAAjC,EAAuC4X,OAAvC;EACD;EACF,eAND,MAMO;EACLA,0BAAU/Y,SAASgZ,OAAT,CAAiBF,QAAjB,EAA2BA,SAAShB,OAAT,CAAiBA,OAAjB,CAA3B,CAAV;EACAW,kBAAEE,OAAF,CAAUM,SAAV,CAAoBJ,OAApB,CAA4B1X,IAA5B,CAAiC,IAAjC,EAAuC4X,OAAvC;EACD;EACF,aAXD,MAWO;EACL,mBAAKjS,GAAL,IAAYgS,SAAShB,OAArB,EAA8B;EAC5BiB,0BAAU/Y,SAASgZ,OAAT,CAAiBF,QAAjB,EAA2BA,SAAShB,OAAT,CAAiBhR,GAAjB,CAA3B,CAAV;EACA2R,kBAAEE,OAAF,CAAUM,SAAV,CAAoBJ,OAApB,CAA4B1X,IAA5B,CAAiC,IAAjC,EAAuC4X,OAAvC;EACD;EACF;EACF,WAlBD,MAkBO;EACLN,cAAEE,OAAF,CAAUM,SAAV,CAAoBJ,OAApB,CAA4B1X,IAA5B,CAAiC,IAAjC,EAAuC2X,QAAvC;EACD;EACF;;EAvBD;EAAA;EAD4B,KAAjB,CAAb;;EA2BA,QAAII,SAAS;EACXC,WAAK,UADM;EAEXC,WAAK,CAAC;EAFK,KAAb;EAIA,QAAIxjB,GAAGG,OAAH,CAAWL,GAAX,CAAesK,QAAf,CAAwBqZ,MAAxB,IAAkCzjB,GAAGG,OAAH,CAAWL,GAAX,CAAesK,QAAf,CAAwBqZ,MAAxB,CAA+B5f,MAA/B,KAA0C,CAAhF,EAAmF;EACjFyf,aAAOC,GAAP,GAAavjB,GAAGG,OAAH,CAAWL,GAAX,CAAesK,QAAf,CAAwBqZ,MAAxB,CAA+B,CAA/B,CAAb;EACAH,aAAOE,GAAP,GAAaxjB,GAAGG,OAAH,CAAWL,GAAX,CAAesK,QAAf,CAAwBqZ,MAAxB,CAA+B,CAA/B,CAAb;EACD;;EAED,QAAIC,SAAS,IAAIb,EAAEc,YAAN,CAAmB,IAAId,EAAES,MAAN,CAAaA,OAAOC,GAAP,GAAa,CAA1B,EAA6BD,OAAOE,GAAP,GAAa,CAA1C,CAAnB,EAAiE,IAAIX,EAAES,MAAN,CAAaA,OAAOC,GAAP,GAAa,CAA1B,EAA6BD,OAAOE,GAAP,GAAa,CAA1C,CAAjE,CAAb;;EAEAxjB,OAAG4jB,IAAH,GAAU,IAAIf,EAAEgB,GAAN,CAAU7jB,GAAGG,OAAH,CAAW0H,MAArB,EAA6B;EACnC4b,cAAQC,OAAOI,SAAP,EAD2B;EAEnCC,YAAM/jB,GAAGG,OAAH,CAAWL,GAAX,CAAesK,QAAf,CAAwB2Z,IAAxB,IAAgC,CAFH;EAGnCC,eAAShkB,GAAGG,OAAH,CAAWL,GAAX,CAAesK,QAAf,CAAwB4Z,OAAxB,IAAmC,EAHT;EAInCC,eAASjkB,GAAGG,OAAH,CAAWL,GAAX,CAAesK,QAAf,CAAwB6Z,OAAxB,IAAmC,CAJT;EAKnCC,iBAAWR,MALwB;EAMnCS,0BAAoB;EANe,KAA7B,CAAV;;EASA,QAAIC,WAAWvB,EAAEwB,SAAF,CAAY,oDAAZ,EAAkE;EAC7EC,mBAAa;EADgE,KAAlE,CAAf;EAGA,QAAIC,YAAY,IAAI1B,EAAEC,QAAN,EAAhB;;EAEAsB,aAASI,KAAT,CAAexkB,GAAG4jB,IAAlB;EACAa,gBAAYzkB,GAAGiiB,SAAf;;EAEA,aAASwC,WAAT,CAAqBC,QAArB,EAA+B;EAC7BH,gBAAUtB,OAAV,CAAkByB,QAAlB;EACAH,gBAAUC,KAAV,CAAgBxkB,GAAG4jB,IAAnB;EACAW,gBAAUI,SAAV,CAAoBC,WAApB;EACD;;EAED,QAAI5jB,MAAMhB,GAAGc,KAAH,CAASC,EAAT,CAAYC,GAAZ,GAAkB8J,IAAlB,CAAuB9K,GAAGG,OAAH,CAAWa,GAAX,IAAkB,UAASM,CAAT,EAAY;EAC7D,UAAIwJ,OAAO,wDAAwDxJ,EAAE8hB,OAAF,CAAUb,UAAV,CAAqBsC,OAArB,IAAgCvjB,EAAE8hB,OAAF,CAAUb,UAAV,CAAqBuC,OAA7G,IAAwH,oBAAxH,GACT9kB,GAAGc,KAAH,CAASqB,MAAT,CAAgBb,EAAE8hB,OAAF,CAAUb,UAAV,CAAqBviB,GAAGG,OAAH,CAAW8O,IAAhC,CAAhB,CADS,GACgD,eAD3D;EAEA,aAAOnE,IAAP;EACD,KAJS,CAAV;EAKA/J,aAAA,CAAU,MAAMf,GAAGG,OAAH,CAAW0H,MAA3B,EAAmC+C,MAAnC,CAA0C,2BAA1C,EAAuEW,IAAvE,CAA4EvK,GAA5E;EACA,aAAS4jB,WAAT,CAAqBzc,KAArB,EAA4B;;EAE1B,UAAI/F,QAAQ+F,MAAMib,OAAN,CAAcb,UAAd,CAAyBviB,GAAGG,OAAH,CAAW8O,IAApC,CAAZ;EACA,UAAI,CAAC7M,KAAL,EAAY;EACV;EACA;EACArB,iBAAA,CAAUoH,MAAM4c,KAAhB,EAAuBla,MAAvB;EACD,OAJD,MAIO;EACL,YAAIma,YAAYhlB,GAAGqH,OAAH,CAAWjC,KAAX,CAAiBhD,KAAjB,CAAhB;;EAEA+F,cAAM8c,QAAN,CAAe;EACbD,qBAAWA,SADE;EAEbE,uBAAallB,GAAGG,OAAH,CAAW8F,OAAX,IAAsB,GAFtB;EAGbb,iBAAO,MAHM;EAIb+f,kBAAQ,CAJK;EAKblf,mBAAS;EALI,SAAf;;EAQAkC,cAAMrE,EAAN,CAAS;EACP+d;EAAW,iCAAW;EACpBuD,yBAAWjd,KAAX;EACD;;EAFD;EAAA,aADO;EAIP2Z;EAAU,gCAAW;EACnBuD,yBAAWld,KAAX;EACD;;EAFD;EAAA;EAJO,SAAT;EAQD;EACF;;EAED,aAASid,UAAT,CAAoBjd,KAApB,EAA2B;EACzBnH,UAAI+C,IAAJ,CAASoE,KAAT,EAAgBpH,SAAA,CAAUoH,MAAM4c,KAAhB,EAAuBphB,IAAvB,EAAhB;EACD;;EAED,aAAS0hB,UAAT,CAAoBld,KAApB,EAA2B;EACzBnH,UAAIgD,IAAJ,CAASmE,KAAT;EACD;;EAED;;;EAGA,QAAI,OAAOnI,GAAGG,OAAH,CAAW2F,MAAlB,KAA6B,UAAjC,EAA6C;EAC3C9F,SAAGG,OAAH,CAAW2F,MAAX,CAAkByF,IAAlB,CAAuB,IAAvB,EAA6BvL,GAAGmiB,MAAhC;EACD;;EAEDH,YAAQZ,eAAR;;EAEA,WAAOphB,EAAP;EACD,GA5HD;;EA+HAgiB,UAAQtd,IAAR,CAAavF,MAAb;;EAEA,SAAO6iB,OAAP;EACD;;ECjVD;;;;AAIA,EAAe,cAAS7iB,MAAT,EAAiB;;EAE9B,WAAS0kB,GAAT,CAAa1kB,MAAb,EAAqB;EACnB,QAAIa,KAAK,IAAT;EACAA,OAAGG,OAAH,GAAahB,SAASA,MAAT,GAAkB,EAA/B;EACAa,OAAGkH,KAAH,GAAW,EAAX;EACAlH,OAAGqH,OAAH,GAAa,EAAb;EACArH,OAAGsH,KAAH,GAAW,EAAX;EACAtH,OAAG4O,IAAH,GAAU5O,GAAGc,KAAH,CAASC,EAAT,CAAYC,GAAZ,GAAkBmC,IAAlB,CAAuB,OAAvB,EAAgC,QAAhC,CAAV;;EAEAnD,OAAGslB,uBAAH,GAA8BvkB,SAAA,CAAU,MAAV,CAA9B;EACAf,OAAGulB,qBAAH,GAA8BxkB,SAAA,CAAU,MAAV,CAA9B;EACAf,OAAGwlB,sBAAH,GAA8BzkB,SAAA,CAAU,MAAV,CAA9B;EACAf,OAAGylB,wBAAH,GAA8B1kB,SAAA,CAAU,MAAV,CAA9B;;EAEAf,OAAG0lB,OAAH,GAAa,EAAb;EACA1lB,OAAG0lB,OAAH,CAAWhU,KAAX,GAAmB1R,GAAGslB,uBAAtB;EACAtlB,OAAG0lB,OAAH,CAAWC,UAAX,GAAwB,UAASrkB,CAAT,EAAW;EAAC,aAAOP,SAAA,CAAU,MAAV,EAAkBO,CAAlB,IAAuB,GAA9B;EAAmC,KAAvE;EACAtB,OAAG0lB,OAAH,CAAWzX,MAAX,GAAqBlN,SAAA,CAAU,MAAV,CAArB;EAED;;EAED;EACA;;EAEA8iB,MAAIR,SAAJ,CAAcvU,EAAd,GAAmB,UAAS4Q,GAAT,EAAc;EAC/B,QAAI1f,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAW2O,EAAX,GAAgB4Q,GAAhB;EACA,WAAO1f,EAAP;EACD,GAJD;;EAMA6jB,MAAIR,SAAJ,CAAcje,KAAd,GAAsB,UAASsa,GAAT,EAAc;EAClC,QAAI1f,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWiF,KAAX,GAAmBsa,GAAnB;EACA,WAAO1f,EAAP;EACD,GAJD;;EAMA6jB,MAAIR,SAAJ,CAAcriB,GAAd,GAAoB,UAASA,GAAT,EAAa;EAC/B,QAAIhB,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWa,GAAX,GAAiBA,GAAjB;EACAhB,OAAG4O,IAAH,CAAQ9D,IAAR,CAAa9K,GAAGG,OAAH,CAAWa,GAAxB;EACA,WAAOhB,EAAP;EACD,GALD;;EAOA6jB,MAAIR,SAAJ,CAAc1S,OAAd,GAAwB,UAASA,OAAT,EAAiB;EACvC,QAAI3Q,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWwQ,OAAX,GAAqBA,OAArB;EACA,WAAO3Q,EAAP;EACD,GAJD;;EAMA6jB,MAAIR,SAAJ,CAAcuC,GAAd,GAAoB,YAAW;EAC7B,QAAI5lB,KAAK,IAAT;EACA,WAAOA,GAAG6lB,MAAV;EACD,GAHD;;EAKA;EACA;EACAhC,MAAIR,SAAJ,CAAcnjB,KAAd,GAAsB,UAASA,KAAT,EAAgB;EACpC,QAAIF,KAAK,IAAT;EACAA,OAAG6lB,MAAH,GAAY3lB,KAAZ;EACA,WAAOF,EAAP;EACD,GAJD;;EAOA6jB,MAAIR,SAAJ,CAAc3jB,IAAd,GAAqB,UAASA,IAAT,EAAe;EAClC,QAAIM,KAAK,IAAT;;EAEAA,OAAGiiB,SAAH,GAAeviB,KAAK,CAAL,IAASA,KAAK,CAAL,CAAT,GAAmB,KAAlC,CAHkC;EAIlC,QAAIA,OAAOA,KAAK,CAAL,CAAX,CAJkC;;EAMlC,QAAGM,GAAGG,OAAH,CAAWT,IAAX,CAAgB4P,MAAnB,EAA0B;EACxB5P,aAAOA,KAAK,CAAL,EAAQ4P,MAAR,CAAetP,GAAGG,OAAH,CAAWT,IAAX,CAAgB4P,MAA/B,CAAP;EACD;;EAEDtP,OAAGkH,KAAH,GAAWxH,IAAX;EACAM,OAAGuP,UAAH,GAAgBvP,GAAGoR,YAAH,CAAgB1R,IAAhB,CAAhB;EACAM,OAAGyP,OAAH,GAAa1O,SAAA,CAAUrB,IAAV,EAAgB,UAAS4B,CAAT,EAAY;EAAE,aAAO,CAACA,EAAEtB,GAAGG,OAAH,CAAWiF,KAAb,CAAR;EAA8B,KAA5D,CAAb;;EAEApF,OAAGG,OAAH,CAAWL,GAAX,CAAe6R,GAAf,GAAqB3R,GAAGyP,OAAH,CAAW,CAAX,CAArB;EACAzP,OAAGG,OAAH,CAAWL,GAAX,CAAe8R,GAAf,GAAqB5R,GAAGyP,OAAH,CAAW,CAAX,CAArB;;EAEA,WAAOzP,EAAP;EACD,GAlBD;;EAoBA6jB,MAAIR,SAAJ,CAAc5a,MAAd,GAAuB,UAASqd,CAAT,EAAY;EACjC,QAAI9lB,KAAK,IAAT;EACAA,OAAGqH,OAAH,GAAaye,CAAb;EACA,WAAO9lB,EAAP;EACD,GAJD;;EAMA6jB,MAAIR,SAAJ,CAActa,IAAd,GAAqB,UAAS3E,CAAT,EAAY;EAC/B,QAAIpE,KAAK,IAAT;EACAA,OAAGsH,KAAH,GAAWlD,CAAX;EACA,WAAOpE,EAAP;EACD,GAJD;;EAMA6jB,MAAIR,SAAJ,CAAcliB,OAAd,GAAwB,YAAW;EACjC,QAAInB,KAAK,IAAT;EACA,WAAOA,EAAP;EACD,GAHD;;EAKA6jB,MAAIR,SAAJ,CAAc9a,IAAd,GAAsB,YAAU;EAC9B,QAAIvI,KAAK,IAAT;;EAEA;EACA,QAAI0iB,cAAc1iB,GAAGG,OAAH,CAAWL,GAAX,CAAesK,QAAf,CAAwBC,GAA1C;EACA,QAAI6X,UAAUliB,GAAGG,OAAH,CAAWL,GAAX,CAAesK,QAAf,CAAwB8X,OAAtC,CAL8B;EAM9B,QAAIS,OAAO3iB,GAAGG,OAAH,CAAWL,GAAX,CAAesK,QAAf,CAAwBwY,SAAnC,CAN8B;EAO9B,QAAI1hB,QAAQlB,GAAGG,OAAH,CAAWL,GAAX,CAAesK,QAAf,CAAwBlJ,KAApC,CAP8B;;EAS9B,QAAIrB,SAASG,GAAGG,OAAH,CAAWL,GAAX,CAAesK,QAAf,CAAwBvK,MAArC;;EAEA,QAAIiP,KAAK9O,GAAGG,OAAH,CAAWL,GAAX,CAAesK,QAAf,CAAwB0E,EAAjC;;EAEA;EACA9O,OAAG6lB,MAAH,CAAUhlB,IAAV,CAAe0K,IAAf,CAAoBvL,GAAG4O,IAAvB;;EAEA5O,OAAG+lB,WAAH,GAAiBhlB,cAAA,GACZG,KADY,CACNA,KADM,EAEZ0hB,SAFY,CAEFD,IAFE,CAAjB;;EAIA3iB,OAAGgmB,IAAH,GAAUjlB,UAAA,GACLklB,UADK,CACMjmB,GAAG+lB,WADT,CAAV;;EAGA/lB,OAAGkmB,SAAH,GAAelmB,GAAG6lB,MAAH,CAAUhlB,IAAV,CAAe0C,MAAf,CAAsB,GAAtB,EACVJ,IADU,CACL,IADK,EACC,mBADD,EAEV3C,KAFU,CAEJ,SAFI,EAEO,MAFP,EAGV2C,IAHU,CAGL,WAHK,EAGQ,YAAW;EAC1B,aAAO,eAAgBnD,GAAGG,OAAH,CAAWyE,IAAX,CAAgBuhB,UAAhC,GAA8C,cAA9C,GAA+DnmB,GAAGG,OAAH,CAAWyE,IAAX,CAAgB1D,KAA/E,GAAuF,GAA9F;EACH,KALU,CAAf;;EAOA,QAAIklB,WAAWhc,SAASgZ,OAAT,CAAiBpjB,GAAGiiB,SAApB,EAA+BjiB,GAAGiiB,SAAH,CAAaC,OAAb,CAAqBA,OAArB,CAA/B,EAA8DkE,QAA7E;EACA;EACA,QAAI,OAAOpmB,GAAGG,OAAH,CAAWL,GAAX,CAAesK,QAAf,CAAwBkF,MAA/B,IAAyC,WAA7C,EAA0D;EACxD,UAAIA,SAAStP,GAAGG,OAAH,CAAWL,GAAX,CAAesK,QAAf,CAAwBkF,MAArC;EACAnC,cAAQC,GAAR,CAAYkC,MAAZ;EACAvH,aAAO+F,IAAP,CAAYwB,MAAZ,EAAoBxP,GAApB,CAAwB,UAASoR,GAAT,EAAc;EACpCkV,mBAAWA,SAAS9W,MAAT,CAAgB;EAAA,iBAAW8T,QAAQb,UAAR,CAAmBrR,GAAnB,MAA4B5B,OAAO4B,GAAP,CAAvC;EAAA,SAAhB,CAAX;EACD,OAFD;EAGD;;EAEDlR,OAAGkmB,SAAH,CAAaja,SAAb,CAAuB,MAAvB,EACKvM,IADL,CACU0mB,QADV,EACoBvmB,MADpB,EAEKqM,KAFL,GAEa3I,MAFb,CAEoB,MAFpB,EAGKJ,IAHL,CAGU,GAHV,EAGepC,UAAA,GAAaklB,UAAb,CAAwBjmB,GAAG+lB,WAA3B,CAHf,EAIK5iB,IAJL,CAIU,IAJV,EAIgB2L,EAJhB,EAKK3L,IALL,CAKU,cALV,EAK0B+e,OAL1B,EAMK/e,IANL,CAMU,MANV,EAMkB,SANlB,EAOKA,IAPL,CAOU,QAPV,EAOoB,SAPpB,EAQK3C,KARL,CAQW,cARX,EAQ2B,KAR3B,EASKsD,EATL,CASQ,WATR,EASqB,UAASxC,CAAT,EAAY2C,CAAZ,EAAe;;EAE9B,UAAGjE,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAAf,CAAyBsB,aAA5B,EAA0C;EAAE;EAC1C/Q,iBAAA,CAAU,IAAV,EAAgBoC,IAAhB,CAAqB,MAArB,EAA6B,UAAS7B,CAAT,EAAY;EACrC,iBAAOtB,GAAGuQ,iBAAH,CAAqBjP,EAAEtB,GAAGG,OAAH,CAAWiF,KAAb,CAArB,EAAyC,SAAzC,CAAP;EACH,SAFD;EAGD;;EAED;;EAEA,UAAIpF,GAAGG,OAAH,CAAWT,IAAX,CAAgB+Q,WAApB,EAAiC;EAAE;EACjCzQ,WAAGG,OAAH,CAAWT,IAAX,CAAgB+Q,WAAhB,CAA4BlF,IAA5B,CAAiC,IAAjC,EAAuCjK,CAAvC,EAA0C2C,CAA1C;EACD;EAEF,KAvBL,EAwBKH,EAxBL,CAwBQ,UAxBR,EAwBoB,UAASxC,CAAT,EAAY2C,CAAZ,EAAe;;EAE3B,UAAGjE,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAAf,CAAyBsB,aAA5B,EAA0C;EAAE;EAC1C/Q,iBAAA,CAAU,IAAV,EAAgBoC,IAAhB,CAAqB,MAArB,EAA6B,UAAS7B,CAAT,EAAY;EACrC,iBAAOtB,GAAGuQ,iBAAH,CAAqBjP,EAAEtB,GAAGG,OAAH,CAAWiF,KAAb,CAArB,EAAyC,SAAzC,CAAP;EACH,SAFD;EAGD;EACD;EACA;;EAEA,UAAIpF,GAAGG,OAAH,CAAWT,IAAX,CAAgBgR,UAApB,EAAgC;EAAE;EAChC1Q,WAAGG,OAAH,CAAWT,IAAX,CAAgBgR,UAAhB,CAA2BnF,IAA3B,CAAgC,IAAhC,EAAsCjK,CAAtC,EAAyC2C,CAAzC;EACD;EAEJ,KAtCL,EAuCKH,EAvCL,CAuCQ,OAvCR,EAuCiB,UAASxC,CAAT,EAAY2C,CAAZ,EAAe;EACxB,UAAIjE,GAAGG,OAAH,CAAWT,IAAX,CAAgBiR,OAApB,EAA6B;EACzB3Q,WAAGG,OAAH,CAAWT,IAAX,CAAgBiR,OAAhB,CAAwBpF,IAAxB,CAA6B,IAA7B,EAAmCjK,CAAnC,EAAsC2C,CAAtC;EACH;EACJ,KA3CL;;EA6CAjE,OAAGqmB,gBAAH,GAAsBrmB,GAAGkmB,SAAH,CAAaja,SAAb,CAAuB,MAAvB,EAA+BvM,IAA/B,EAAtB;;EAEAM,OAAGkmB,SAAH,CAAaja,SAAb,CAAuB,MAAvB,EAA+B9I,IAA/B,CAAoC,QAApC,EAA8C,MAA9C,EAAsDA,IAAtD,CAA2D,cAA3D,EAA2E,GAA3E;EACAnD,OAAGkmB,SAAH,CAAaja,SAAb,CAAuB,MAAvB,EAA+B9I,IAA/B,CAAoC,MAApC,EAA4C,KAA5C;EACAnD,OAAGkmB,SAAH,CAAaja,SAAb,CAAuB,MAAvB,EAA+B9I,IAA/B,CAAoC,YAApC,EAAkD,IAAlD;EACAnD,OAAGkmB,SAAH,CAAaja,SAAb,CAAuB,MAAvB,EACKvM,IADL,CACUM,GAAGkH,KADb,EACoB,UAAS5F,CAAT,EAAY;EAC1B;EACA,aAAOA,EAAEwN,EAAF,GAAOxN,EAAEwN,EAAT,GAAcxN,EAAEtB,GAAGG,OAAH,CAAW2O,EAAb,CAArB;EACD,KAJL,EAKK3L,IALL,CAKU,MALV,EAKkB,UAAS7B,CAAT,EAAY;EACtB,aAAOtB,GAAGuQ,iBAAH,CAAqBjP,EAAEtB,GAAGG,OAAH,CAAWiF,KAAb,CAArB,EAAyC,SAAzC,CAAP;EACH,KAPL,EAQKjC,IARL,CAQU,YARV,EAQwB,UAAS7B,CAAT,EAAY;EAC5B,aAAO,CAACA,EAAEtB,GAAGG,OAAH,CAAWiF,KAAb,CAAR;EACH,KAVL;;EAYA;EACApF,OAAGkmB,SAAH,CAAaja,SAAb,CAAuB,MAAvB,EAA+BvM,IAA/B,CAAoCM,GAAGqmB,gBAAvC,EAAyD,UAAS/kB,CAAT,EAAY;EACjE,aAAOA,EAAEwN,EAAT;EACH,KAFD;EAKD,GA5GD;;EA8GA+U,MAAIR,SAAJ,CAAcjS,YAAd,GAA6B,UAAS1R,IAAT,EAAc;EACzC,QAAIM,KAAK,IAAT;EACA,QAAI2J,SAAS,EAAb;EACA,QAAI0H,WAAW,EAAf;;EAEA,QAAGrR,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAAf,IAA6BxQ,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAAf,CAAyBc,mBAAtD,IACItR,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAAf,CAAyBc,mBAAzB,CAA6CzN,MAA7C,GAAsD,CAD7D,EAC+D;EAC7D,aAAO7D,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAAf,CAAyBc,mBAAhC;EACD;;EAED5R,SAAK+K,OAAL,CAAa,UAASnJ,CAAT,EAAW;EACtBqI,aAAOlG,IAAP,CAAY,CAACnC,EAAEtB,GAAGG,OAAH,CAAWiF,KAAb,CAAb;EACD,KAFD;;EAIAuE,WAAO4E,IAAP,CAAYxN,YAAZ;;EAEA;EACA,QAAGf,GAAGG,OAAH,IAAcH,GAAGG,OAAH,CAAWL,GAAzB,IAAgCE,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAA/C,IAA4DxQ,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAAf,CAAyBjH,OAAxF,EAAgG;;EAE9F,UAAGvJ,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAAf,CAAyBe,WAAzB,KAAyC,IAA5C,EAAiD;EAC/C,YAAIC,MAAMvK,EAAEqf,SAAF,CAAY3c,MAAZ,EAAoB,UAASoC,CAAT,EAAY;EAAE,iBAAOA,KAAK,CAAZ;EAAe,SAAjD,CAAV;EACA;;EAEAsF,iBAAS5N,IAAT,CAAckG,OAAO,CAAP,CAAd;EACA0H,iBAAS5N,IAAT,CAAc,CAAd;;EAEA,aAAI,IAAIQ,IAAI,CAAZ,EAAeA,KAAKjE,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAAf,CAAyBjH,OAAzB,GAAmC,CAAvD,EAA0DtF,GAA1D,EAA+D;EAC7DoN,mBAAS5N,IAAT,CAAe1C,WAAA,CAAYyQ,GAAZ,EAAkBvN,IAAG,CAAH,IAAMjE,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAAf,CAAyBjH,OAAzB,GAAmC,CAAzC,CAAlB,CAAf;EACD;EAEF,OAXD,MAWK;EACH8H,iBAAS5N,IAAT,CAAe1C,WAAA,CAAY4I,MAAZ,EAAoB,CAApB,CAAf;EACA,aAAI,IAAI1F,IAAI,CAAZ,EAAeA,KAAKjE,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAAf,CAAyBjH,OAA7C,EAAsDtF,GAAtD,EAA2D;EACzDoN,mBAAS5N,IAAT,CAAe1C,WAAA,CAAY4I,MAAZ,EAAqB1F,IAAG,CAAH,GAAKjE,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAAf,CAAyBjH,OAAnD,CAAf;EACD;EACF;EAEF,KApBD,MAoBK;EACH8H,iBAAW,CAAEtQ,WAAA,CAAY4I,MAAZ,EAAoB,CAApB,CAAF,EAA0B5I,WAAA,CAAY4I,MAAZ,EAAoB,GAApB,CAA1B,EAAoD5I,WAAA,CAAY4I,MAAZ,EAAoB,GAApB,CAApD,EAA8E5I,WAAA,CAAY4I,MAAZ,EAAoB,GAApB,CAA9E,EAAwG5I,WAAA,CAAY4I,MAAZ,EAAoB,GAApB,CAAxG,EAAkI5I,WAAA,CAAY4I,MAAZ,EAAmB,CAAnB,CAAlI,CAAX;EACD;;EAED;EACA,QAAI3J,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAAf,IAA4BxQ,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAAf,CAAyBjH,OAArD,IACGvJ,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAAf,CAAyBjH,OAAzB,KAAqC,CAD5C,EAC8C;;EAE5C,UAAI8H,SAAS,CAAT,MAAgBA,SAAS,CAAT,CAAhB,IAA+BA,SAAS,CAAT,MAAgBA,SAAS,CAAT,CAA/C,IAA8DA,SAAS,CAAT,MAAgBA,SAAS,CAAT,CAA9E,IAA6FA,SAAS,CAAT,MAAgBA,SAAS,CAAT,CAAjH,EAA6H;EAC3HA,mBAAW,CAAEtQ,WAAA,CAAY4I,MAAZ,EAAoB,CAApB,CAAF,EAA0B5I,WAAA,CAAY4I,MAAZ,EAAoB,GAApB,CAA1B,CAAX;EACD;EACF;;EAED,WAAO0H,QAAP;EACD,GAnDD;;EAqDAwS,MAAIR,SAAJ,CAAc9S,iBAAd,GAAkC,UAASjP,CAAT,EAAWK,IAAX,EAAgB;EAChD,QAAI3B,KAAK,IAAT;EACA,QAAI0R,QAAQrO,WAAW/B,CAAX,CAAZ;;EAEA;EACA,QAAGtB,GAAGG,OAAH,IAAcH,GAAGG,OAAH,CAAWL,GAAzB,IAAgCE,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAA/C,IAA4DxQ,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAAf,CAAyBtB,MAAxF,EAA+F;EAC7F,UAAGlP,GAAGuP,UAAH,CAAc1L,MAAd,GAAuB,CAA1B,EAA4B;;EAE1B,YAAG7D,GAAGG,OAAH,IAAcH,GAAGG,OAAH,CAAWL,GAAzB,IAAgCE,GAAGG,OAAH,CAAWL,GAAX,CAAe6R,GAAf,KAAuBjQ,SAAvD,IAAoE1B,GAAGG,OAAH,CAAWL,GAAX,CAAe8R,GAAf,KAAuBlQ,SAA9F,EAAwG;EACtG,cAAGgQ,QAAQ1R,GAAGG,OAAH,CAAWL,GAAX,CAAe6R,GAAvB,IAA8BD,QAAQ1R,GAAGG,OAAH,CAAWL,GAAX,CAAe8R,GAAxD,EAA4D;EAC1DzE,oBAAQC,GAAR,CAAY,iBAAZ,EAA+BsE,KAA/B,EAAsC1R,GAAGG,OAAH,CAAWL,GAAX,CAAe6R,GAArD,EAA0D3R,GAAGG,OAAH,CAAWL,GAAX,CAAe8R,GAAzE;EACA,mBAAO5R,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAAf,CAAyBqB,eAAhC;EACD;EACF,SALD,MAKK;EACH,cAAGH,QAAQ1R,GAAGyP,OAAH,CAAW,CAAX,CAAR,IAAyBiC,QAAQ1R,GAAGyP,OAAH,CAAW,CAAX,CAApC,EAAkD;EAChDtC,oBAAQC,GAAR,CAAY,iBAAZ,EAA+BsE,KAA/B,EAAsC1R,GAAGG,OAAH,CAAWL,GAAX,CAAe6R,GAArD,EAA0D3R,GAAGG,OAAH,CAAWL,GAAX,CAAe8R,GAAzE;EACA,mBAAO5R,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAAf,CAAyBqB,eAAhC;EACD;EACF;;EAED,YAAGlQ,QAAQ,SAAX,EAAqB;EACnB,cAAG+P,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAZ,EAA6B;EAC3B,mBAAOvP,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAAf,CAAyBtB,MAAzB,CAAgC,CAAhC,CAAP,CAD2B;EAE5B,WAFD,MAEM,IAAGwC,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAZ,EAA6B;EACjC,mBAAOvP,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAAf,CAAyBtB,MAAzB,CAAgC,CAAhC,CAAP,CADiC;EAElC,WAFK,MAEA,IAAGwC,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAZ,EAA6B;EACjC,mBAAOvP,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAAf,CAAyBtB,MAAzB,CAAgC,CAAhC,CAAP,CADiC;EAElC,WAFK,MAEA,IAAGwC,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAZ,EAA6B;EACjC,mBAAOvP,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAAf,CAAyBtB,MAAzB,CAAgC,CAAhC,CAAP,CADiC;EAElC,WAFK,MAEA,IAAGwC,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAZ,EAA6B;EACjC,mBAAOvP,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAAf,CAAyBtB,MAAzB,CAAgC,CAAhC,CAAP,CADiC;EAElC;EACF;;EAED,YAAGvN,QAAQ,SAAR,IAAqB3B,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAAf,CAAyBsB,aAAjD,EAA+D;EAC7D,cAAGJ,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAZ,EAA6B;EAC3B,mBAAOvP,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAAf,CAAyBsB,aAAzB,CAAuC,CAAvC,CAAP,CAD2B;EAE5B,WAFD,MAEM,IAAGJ,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAZ,EAA6B;EACjC,mBAAOvP,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAAf,CAAyBsB,aAAzB,CAAuC,CAAvC,CAAP,CADiC;EAElC,WAFK,MAEA,IAAGJ,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAZ,EAA6B;EACjC,mBAAOvP,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAAf,CAAyBsB,aAAzB,CAAuC,CAAvC,CAAP,CADiC;EAElC,WAFK,MAEA,IAAGJ,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAZ,EAA6B;EACjC,mBAAOvP,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAAf,CAAyBsB,aAAzB,CAAuC,CAAvC,CAAP,CADiC;EAElC,WAFK,MAEA,IAAGJ,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAZ,EAA6B;EACjC,mBAAOvP,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAAf,CAAyBsB,aAAzB,CAAuC,CAAvC,CAAP,CADiC;EAElC;EACF;EAEF;EACF;;EAED,QAAG9R,GAAGuP,UAAH,CAAc1L,MAAd,IAAwB,CAA3B,EAA6B;EAC3B;;;;;EAKA,UAAG6N,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAZ,EAA6B;EAC3B,eAAOvP,GAAGG,OAAH,CAAWL,GAAX,CAAe0Q,SAAf,CAAyBtB,MAAzB,CAAgC,CAAhC,CAAP,CAD2B;EAE5B;EACF;EAEF,GA9DD;;EAqED,SAAO,IAAI2U,GAAJ,CAAQ1kB,MAAR,CAAP;EACA;;ECjVD;;;AAGA,EAAe,gBAASA,MAAT,EAAiB;EAC9B,WAASonB,KAAT,CAAepnB,MAAf,EAAuB;EACrB,QAAIa,KAAK,IAAT;EAAA,QAAe4E,IAAf;;EAEA5E,OAAGwmB,cAAH,GAAoB,IAAI3W,KAAK4W,EAA7B;;EAEA;EACAzmB,OAAG0mB,iBAAH,GAAuB1mB,GAAGwmB,cAAH,GAAoB,CAAC,CAA5C;;EAEAxmB,OAAGG,OAAH,GAAahB,SAASA,MAAT,GAAkB,EAA/B;EACAa,OAAGkH,KAAH,GAAW,EAAX;EACAlH,OAAGqH,OAAH,GAAa,EAAb;EACArH,OAAGsH,KAAH,GAAW,EAAX;EACAtH,OAAG2mB,SAAH,GAAe,EAAf;EACA3mB,OAAG4mB,OAAH,GAAa,IAAb;EACA5mB,OAAGyP,OAAH,GAAa,CAAC,CAAD,EAAI,CAAJ,CAAb;EACAzP,OAAG6mB,SAAH,GAAe,EAAf;EACA7mB,OAAG8mB,SAAH,GAAe,EAAf;EACA9mB,OAAG+mB,MAAH,GAAY,CAAZ;EACA/mB,OAAGgnB,MAAH,GAAY,IAAZ;EACAhnB,OAAGinB,iBAAH,GAAuB,EAAvB;;EAEA;EACA,QAAG,CAACjnB,GAAGG,OAAH,CAAWwG,KAAf,EAAsB;EACpB3G,SAAGG,OAAH,CAAWwG,KAAX,GAAmB,EAAnB;EACD;;EAED,QAAG,CAAC3G,GAAGG,OAAH,CAAW+mB,kBAAf,EAAmC;EACjClnB,SAAGG,OAAH,CAAW+mB,kBAAX,GAAgC,GAAhC;EACD;;EAED,QAAG,CAAClnB,GAAGG,OAAH,CAAWgnB,eAAf,EAAgC;EAC9BnnB,SAAGG,OAAH,CAAWgnB,eAAX,GAA6B,EAA7B;EACD;;EAED,QAAG,CAACnnB,GAAGG,OAAH,CAAW2F,MAAf,EAAuB;EACrB9F,SAAGG,OAAH,CAAW2F,MAAX,GAAoB;EAClBshB,gBAAQ;EADU,OAApB;EAGD;;EAED,QAAG,CAACpnB,GAAGG,OAAH,CAAW2F,MAAX,CAAkBuhB,EAAtB,EAA0B;EACxBrnB,SAAGG,OAAH,CAAW2F,MAAX,CAAkBuhB,EAAlB,GAAuB;EACrB/d,WAAG,EADkB;EAErBpG,WAAG;EAFkB,OAAvB;EAID;;EAED,QAAG,eAAe,OAAOlD,GAAGG,OAAH,CAAWmnB,aAApC,EAAmD;EACjDtnB,SAAGG,OAAH,CAAWmnB,aAAX,GAA2B,IAA3B;EACD;;EAED;EACA1iB,WAAO5E,GAAGG,OAAH,CAAWyE,IAAlB;;EAEA5E,OAAGunB,OAAH,GAAa;EACXje,SAAI1E,KAAKxE,KAAL,GAAa,CAAd,GAAmBwE,KAAKC,MAAL,CAAYC,IADvB;EAEX5B,SAAI0B,KAAKtE,MAAL,GAAc,CAAf,GAAoBsE,KAAKC,MAAL,CAAYG;EAFxB,KAAb;;EAKAhF,OAAGwnB,OAAH,GAAa3X,KAAK8B,GAAL,CACX,CAAC/M,KAAKxE,KAAL,GAAawE,KAAKC,MAAL,CAAYC,IAAzB,GAAgCF,KAAKC,MAAL,CAAYE,KAA7C,IAAsD,CAD3C,EAEX,CAACH,KAAKtE,MAAL,GAAcsE,KAAKC,MAAL,CAAYG,GAA1B,GAAgCJ,KAAKC,MAAL,CAAYI,MAA7C,IAAuD,CAF5C,CAAb;EAID;;EAED;;EAEAshB,QAAMlD,SAAN,CAAgBoE,YAAhB,GAA+B,UAASlmB,MAAT,EAAiB;EAC9C,QAAIvB,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWsnB,YAAX,GAA0BlmB,MAA1B;EACA,WAAOvB,EAAP;EACD,GAJD;;EAMAumB,QAAMlD,SAAN,CAAgBqE,QAAhB,GAA2B,UAASnmB,MAAT,EAAiB;EAC1C,QAAIvB,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWunB,QAAX,GAAsBnmB,MAAtB;EACA,WAAOvB,EAAP;EACD,GAJD;;EAMAumB,QAAMlD,SAAN,CAAgBsE,UAAhB,GAA6B,UAASpmB,MAAT,EAAiB;EAC5C,QAAIvB,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWwnB,UAAX,GAAwBpmB,MAAxB;EACA,WAAOvB,EAAP;EACD,GAJD;;EAMAumB,QAAMlD,SAAN,CAAgB1c,KAAhB,GAAwB,UAASA,KAAT,EAAgB;EACtC,QAAI3G,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWwG,KAAX,GAAmBA,KAAnB;EACA,WAAO3G,EAAP;EACD,GAJD;;EAMAumB,QAAMlD,SAAN,CAAgBnU,MAAhB,GAAyB,UAASA,MAAT,EAAiB;EACxC,QAAIlP,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAW+O,MAAX,GAAoBA,MAApB;EACA,WAAOlP,EAAP;EACD,GAJD;;EAMAumB,QAAMlD,SAAN,CAAgBuC,GAAhB,GAAsB,YAAW;EAC/B,QAAI5lB,KAAK,IAAT;EACA,WAAOA,GAAG6lB,MAAV;EACD,GAHD;;EAKA;;EAEAU,QAAMlD,SAAN,CAAgBuE,SAAhB,GAA4B,YAAW;EACrC,QAAI5nB,KAAK,IAAT;EAAA,QACEY,MAAMZ,GAAG6lB,MAAH,CAAUhlB,IADlB;EAAA,QAEEgnB,MAAM7nB,GAAGG,OAAH,CAAW+mB,kBAFnB;EAAA,QAGEY,GAHF;;EAKAA,UAAMlnB,IAAIgK,MAAJ,CAAW,SAAX,CAAN;;EAEA,QAAGkd,IAAIC,KAAJ,EAAH,EAAgB;EACdD,YAAMlnB,IAAI2C,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB,OAArB,EAA8B,OAA9B,CAAN;EACD;;EAED2kB,UAAMA,IAAI7b,SAAJ,CAAc,aAAd,EACHvM,IADG;EAEF;EACA;EACA;EACA;EACAM,OAAG+mB,MAAH,CAAUjnB,GAAV,CAAc,UAACigB,GAAD,EAAM7E,GAAN;EAAA,aAAc,CAACA,GAAD,EAAM6E,GAAN,CAAd;EAAA,KAAd,EAAwCld,OAAxC,EANE,EAOF;EAAA,aAAKvB,EAAE,CAAF,CAAL;EAAA,KAPE,CAAN;;EASAwmB,QACG1S,UADH,GAEGC,QAFH,CAEYwS,GAFZ,EAGG1kB,IAHH,CAGQ,GAHR,EAGa,UAAS7B,CAAT,EAAY;EAAE,aAAOtB,GAAGgnB,MAAH,CAAU1lB,EAAE,CAAF,CAAV,CAAP;EAAyB,KAHpD;;EAKAwmB,QAAI5b,KAAJ,GACG3I,MADH,CACU,QADV,EAEGyH,OAFH,CAEW,MAFX,EAEmB,IAFnB,EAGG7H,IAHH,CAGQ,IAHR,EAGcnD,GAAGunB,OAAH,CAAWje,CAHzB,EAIGnG,IAJH,CAIQ,IAJR,EAIcnD,GAAGunB,OAAH,CAAWrkB,CAJzB,EAKG1C,KALH,CAKS,MALT,EAKiBR,GAAGgoB,gBAAH,CAAoB,MAApB,CALjB,EAMGxnB,KANH,CAMS,QANT,EAMmBR,GAAGgoB,gBAAH,CAAoB,MAApB,CANnB,EAOG7kB,IAPH,CAOQ,GAPR,EAOa,UAAS7B,CAAT,EAAY;EAAE,aAAOtB,GAAGgnB,MAAH,CAAU1lB,EAAE,CAAF,CAAV,CAAP;EAAyB,KAPpD,EAQG6B,IARH,CAQQ,SARR,EAQmB,CARnB,EASGiS,UATH,GAUGC,QAVH,CAUYwS,GAVZ,EAWG1kB,IAXH,CAWQ,SAXR,EAWmB,CAXnB;;EAaA2kB,QAAIG,IAAJ,GACG7S,UADH,GAEGC,QAFH,CAEYwS,GAFZ,EAGG1kB,IAHH,CAGQ,SAHR,EAGmB,CAHnB,EAIG0H,MAJH;EAKD,GA5CD;;EA8CA0b,QAAMlD,SAAN,CAAgB6E,eAAhB,GAAkC,YAAW;EAC3C,QAAIloB,KAAK,IAAT;EAAA,QACEY,MAAMZ,GAAG6lB,MAAH,CAAUhlB,IADlB;EAAA,QAEEgE,SAAS,CAFX;EAAA,QAGEgjB,MAAM7nB,GAAGG,OAAH,CAAW+mB,kBAHnB;EAAA,QAIEY,GAJF;;EAMAA,UAAMlnB,IAAIgK,MAAJ,CAAW,gBAAX,CAAN;;EAEA,QAAGkd,IAAIC,KAAJ,EAAH,EAAgB;EACdD,YAAMlnB,IAAI2C,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB,OAArB,EAA8B,cAA9B,CAAN;EACD;;EAED2kB,UAAMA,IAAI7b,SAAJ,CAAc,iBAAd,EACHvM,IADG,CACEM,GAAG+mB,MADL,CAAN;;EAGAe,QACG1S,UADH,GAEGC,QAFH,CAEYwS,GAFZ,EAGGrlB,IAHH,CAGQ,UAASlB,CAAT,EAAY;EAAE,aAAOA,CAAP;EAAW,KAHjC,EAIG6B,IAJH,CAIQ,GAJR,EAIa,UAAS7B,CAAT,EAAY;EAAE,aAAOtB,GAAGunB,OAAH,CAAWrkB,CAAX,GAAe2B,MAAf,GAAwB7E,GAAGgnB,MAAH,CAAU1lB,CAAV,CAA/B;EAA8C,KAJzE;;EAMAwmB,QAAI5b,KAAJ,GACG3I,MADH,CACU,MADV,EAEGf,IAFH,CAEQ,UAASlB,CAAT,EAAY;EAAE,aAAOA,EAAE4O,OAAF,CAAU,CAAV,CAAP;EAAsB,KAF5C,EAGG/M,IAHH,CAGQ,OAHR,EAGiB,YAHjB,EAIGA,IAJH,CAIQ,GAJR,EAIanD,GAAGunB,OAAH,CAAWje,CAAX,GAAezE,MAJ5B,EAKG1B,IALH,CAKQ,GALR,EAKa,UAAS7B,CAAT,EAAY;EAAE,aAAOtB,GAAGunB,OAAH,CAAWrkB,CAAX,GAAe2B,MAAf,GAAwB7E,GAAGgnB,MAAH,CAAU1lB,CAAV,CAA/B;EAA8C,KALzE,EAMG6B,IANH,CAMQ,MANR,EAMgBnD,GAAGgoB,gBAAH,CAAoB,MAApB,CANhB,EAOGxnB,KAPH,CAOS,aAPT,EAOwBR,GAAGgoB,gBAAH,CAAoB,YAApB,CAPxB,EAQG7kB,IARH,CAQQ,SARR,EAQmB,CARnB,EASGiS,UATH,GAUGC,QAVH,CAUYwS,GAVZ,EAWG1kB,IAXH,CAWQ,SAXR,EAWmB,CAXnB;;EAaA2kB,QAAIG,IAAJ,GACG7S,UADH,GAEGC,QAFH,CAEYwS,GAFZ,EAGG1kB,IAHH,CAGQ,SAHR,EAGmB,CAHnB,EAIG0H,MAJH;EAKD,GAxCD;;EA0CA0b,QAAMlD,SAAN,CAAgB8E,WAAhB,GAA8B,UAASzoB,IAAT,EAAe;EAC3C,QAAIC,MAAJ;EAAA,QACEK,KAAK,IADP;EAAA,QAEE+I,OAAO/I,GAAGG,OAAH,CAAWunB,QAFpB;EAAA,QAGEU,cAHF;;EAKAzoB,aAASD,KAAK2oB,MAAL,CACP,UAASC,IAAT,EAAeC,IAAf,EAAqB;EACnB,aAAOD,KAAK9G,OAAL,CAAa+G,KAAKxf,IAAL,CAAb,IAA2B,CAAC,CAA5B,GACHuf,IADG,GAEHA,KAAKE,MAAL,CAAYD,KAAKxf,IAAL,CAAZ,CAFJ;EAGD,KALM,EAKJ,EALI,CAAT;;EAOAqf,qBAAkBpoB,GAAGwmB,cAAH,GAAoB7mB,OAAOkE,MAA7C;;EAEAlE,aAASA,OAAOG,GAAP,CACP,UAASyoB,IAAT,EAAerN,GAAf,EAAoB;EAClB,aAAO;EACL5U,cAAMiiB,IADD;EAELE,cAAOvN,MAAMkN,cAAP,GAAyBpoB,GAAG0mB;EAF7B,OAAP;EAID,KANM,CAAT;;EAQA,WAAO;EACLgC,YAAM/oB,MADD;EAELgpB,YAAMhpB,OAAO0oB,MAAP,CAAc,UAASO,MAAT,EAAiB9X,EAAjB,EAAqB;EACvC8X,eAAO9X,GAAGxK,IAAV,IAAkBwK,EAAlB;EACA,eAAO8X,MAAP;EACD,OAHK,EAGH,EAHG;EAFD,KAAP;EAOD,GA9BD;;EAgCArC,QAAMlD,SAAN,CAAgBwF,aAAhB,GAAgC,UAASnpB,IAAT,EAAe;EAC7C,QAAIM,KAAK,IAAT;EAAA,QACEkP,SAASlP,GAAGG,OAAH,CAAW+O,MADtB;EAEA,WAAOxP,KAAK2oB,MAAL,CAAY,UAASS,IAAT,EAAetJ,GAAf,EAAoB;EACrC,UAAIuJ,QAAQvJ,IAAIxf,GAAGG,OAAH,CAAWsnB,YAAf,CAAZ;EAAA,UACEuB,OAAOF,KAAK9X,KAAL,CAAWwQ,OAAX,CAAmBuH,KAAnB,CADT;;EAGA,UAAGC,QAAQ,CAAC,CAAZ,EAAe;EACbA,eAAOF,KAAK9X,KAAL,CAAWvN,IAAX,CAAgBslB,KAAhB,IAAyB,CAAhC;EACAD,aAAKH,IAAL,CAAUI,KAAV,IAAmB7Z,OAAO8Z,IAAP,CAAnB;EACAF,aAAKJ,IAAL,CAAUjlB,IAAV,CAAe,EAACwlB,SAASF,KAAV,EAAiB3jB,OAAO8J,OAAO8Z,IAAP,CAAxB,EAAf;EACD;EACD,aAAOF,IAAP;EACD,KAVM,EAUJ,EAAC9X,OAAO,EAAR,EAAY2X,MAAM,EAAlB,EAAsBD,MAAM,EAA5B,EAVI,CAAP;EAWD,GAdD;;EAgBAnC,QAAMlD,SAAN,CAAgBra,QAAhB,GAA2B,YAAW;EACpC,QAAIhJ,KAAK,IAAT;EAAA,QACEY,MAAMZ,GAAG6lB,MAAH,CAAUhlB,IADlB;EAAA,QAEEwU,WAAWrV,GAAGG,OAAH,CAAW+mB,kBAFxB;EAAA,QAGEgC,SAHF;;EAKAA,gBAAYtoB,IAAIqL,SAAJ,CAAc,WAAd,EACTvM,IADS,CACJM,GAAG2mB,SAAH,CAAa+B,IADT,EACe,UAASpnB,CAAT,EAAY;EAAE,aAAOA,EAAEgF,IAAT;EAAgB,KAD7C,CAAZ;;EAGA4iB,cAAUhd,KAAV,GACG3I,MADH,CACU,MADV,EAEGyH,OAFH,CAEW,MAFX,EAEmB,IAFnB,EAGG7H,IAHH,CAGQ,IAHR,EAGcnD,GAAGunB,OAAH,CAAWje,CAHzB,EAIGnG,IAJH,CAIQ,IAJR,EAIcnD,GAAGunB,OAAH,CAAWrkB,CAJzB,EAKG1C,KALH,CAKS,QALT,EAKmBR,GAAGgoB,gBAAH,CAAoB,MAApB,CALnB,EAMG7kB,IANH,CAMQ,IANR,EAMcnD,GAAGunB,OAAH,CAAWje,CANzB,EAOGnG,IAPH,CAOQ,IAPR,EAOcnD,GAAGunB,OAAH,CAAWrkB,CAPzB,EAQGkS,UARH,GASGC,QATH,CASYA,QATZ,EAUGlS,IAVH,CAUQ,IAVR,EAUc,UAAS7B,CAAT,EAAY;EACtB,aAAOtB,GAAGmpB,GAAH,CAAO7nB,EAAEmnB,IAAT,EAAezoB,GAAGwnB,OAAH,GAAa,CAA5B,CAAP;EACD,KAZH,EAaGrkB,IAbH,CAaQ,IAbR,EAac,UAAS7B,CAAT,EAAY;EACtB,aAAOtB,GAAGopB,GAAH,CAAO9nB,EAAEmnB,IAAT,EAAezoB,GAAGwnB,OAAH,GAAa,CAA5B,CAAP;EACD,KAfH;;EAiBA0B,cACG9T,UADH,GAEGC,QAFH,CAEYA,QAFZ,EAGGlS,IAHH,CAGQ,IAHR,EAGc,UAAS7B,CAAT,EAAY;EACtB,aAAOtB,GAAGmpB,GAAH,CAAO7nB,EAAEmnB,IAAT,EAAezoB,GAAGwnB,OAAH,GAAa,CAA5B,CAAP;EACD,KALH,EAMGrkB,IANH,CAMQ,IANR,EAMc,UAAS7B,CAAT,EAAY;EACtB,aAAOtB,GAAGopB,GAAH,CAAO9nB,EAAEmnB,IAAT,EAAezoB,GAAGwnB,OAAH,GAAa,CAA5B,CAAP;EACD,KARH;;EAUA0B,cAAUjB,IAAV,GACG7S,UADH,GAEGC,QAFH,CAEYA,QAFZ,EAGGlS,IAHH,CAGQ,IAHR,EAGcnD,GAAGunB,OAAH,CAAWje,CAHzB,EAIGnG,IAJH,CAIQ,IAJR,EAIcnD,GAAGunB,OAAH,CAAWrkB,CAJzB,EAKG2H,MALH;EAMD,GA1CD;;EA4CA0b,QAAMlD,SAAN,CAAgBgG,cAAhB,GAAiC,YAAW;EAC1C,QAAIrpB,KAAK,IAAT;EAAA,QACEY,MAAMZ,GAAG6lB,MAAH,CAAUhlB,IADlB;EAAA,QAEEwU,WAAWrV,GAAGG,OAAH,CAAW+mB,kBAFxB;EAAA,QAGEoC,aAAatpB,GAAGwnB,OAAH,GAAaxnB,GAAGG,OAAH,CAAWgnB,eAHvC;EAAA,QAIErgB,MAJF;EAAA,QAKEyiB,KALF;;EAUAA,YAAQ3oB,IAAIqL,SAAJ,CAAc,iBAAd,EACLvM,IADK,CACAM,GAAG2mB,SAAH,CAAa+B,IADb,EACmB,UAASpnB,CAAT,EAAY;EAAE,aAAOA,EAAEgF,IAAT;EAAgB,KADjD,CAAR;;EAGAijB,UAAMrd,KAAN,GACG3I,MADH,CACU,MADV,EAEGJ,IAFH,CAEQ,OAFR,EAEiB,YAFjB,EAGGA,IAHH,CAGQ,GAHR,EAGa,UAAC7B,CAAD;EAAA,aAAOtB,GAAGmpB,GAAH,CAAO7nB,EAAEmnB,IAAT,EAAea,UAAf,IAA6B,EAApC;EAAA,KAHb,EAIGnmB,IAJH,CAIQ,GAJR,EAIa,UAAC7B,CAAD;EAAA,aAAOtB,GAAGopB,GAAH,CAAO9nB,EAAEmnB,IAAT,EAAea,UAAf,IAA6B,EAApC;EAAA,KAJb,EAKGnmB,IALH,CAKQ,IALR,EAKc,KALd,EAMGA,IANH,CAMQ,IANR,EAMc,KANd,EAOGA,IAPH,CAOQ,OAPR,EAOiB,OAPjB,EAQGA,IARH,CAQQ,QARR,EAQkB,MARlB,EASGA,IATH,CASQ,MATR,EASgB,SAThB,EAUGA,IAVH,CAUQ,SAVR,EAUmB,CAVnB,EAWGiS,UAXH,GAYGC,QAZH,CAYYA,QAZZ,EAaGlS,IAbH,CAaQ,SAbR,EAamB,CAbnB;;EAeAomB,UAAMtB,IAAN,GACG7S,UADH,GAEGC,QAFH,CAEYA,QAFZ,EAGGlS,IAHH,CAGQ,SAHR,EAGmB,CAHnB,EAIG0H,MAJH;;EAOA/D,aAASlG,IAAIqL,SAAJ,CAAc,iBAAd,EACNvM,IADM,CACDM,GAAG2mB,SAAH,CAAa+B,IADZ,EACkB,UAASpnB,CAAT,EAAY;EAAE,aAAOA,EAAEgF,IAAT;EAAgB,KADhD,CAAT;;EAGAQ,WACGsO,UADH,GAEGC,QAFH,CAEYA,QAFZ,EAGGlS,IAHH,CAGQ,GAHR,EAGa,UAAC7B,CAAD;EAAA,aAAOtB,GAAGmpB,GAAH,CAAO7nB,EAAEmnB,IAAT,EAAea,aAAW,CAA1B,CAAP;EAAA,KAHb,EAIGnmB,IAJH,CAIQ,GAJR,EAIa,UAAC7B,CAAD;EAAA,aAAOtB,GAAGopB,GAAH,CAAO9nB,EAAEmnB,IAAT,EAAea,aAAW,CAA1B,CAAP;EAAA,KAJb;;EAMAxiB,WAAOoF,KAAP,GACG3I,MADH,CACU,MADV,EAEGJ,IAFH,CAEQ,OAFR,EAEiB,YAFjB,EAGGA,IAHH,CAGQ,aAHR,EAGuB,QAHvB,EAIGA,IAJH,CAIQ,MAJR,EAIgB,OAJhB;EAAA,KAKG3C,KALH,CAKS,aALT,EAKwBR,GAAGgoB,gBAAH,CAAoB,YAApB,CALxB,EAMGxlB,IANH,CAMQ,UAASlB,CAAT,EAAY;EAAE,aAAOA,EAAEgF,IAAT;EAAgB,KANtC,EAOGnD,IAPH,CAOQ,GAPR,EAOa,UAAC7B,CAAD;EAAA,aAAOtB,GAAGmpB,GAAH,CAAO7nB,EAAEmnB,IAAT,EAAea,aAAW,CAA1B,CAAP;EAAA,KAPb,EAQGnmB,IARH,CAQQ,GARR,EAQa,UAAC7B,CAAD;EAAA,aAAOtB,GAAGopB,GAAH,CAAO9nB,EAAEmnB,IAAT,EAAea,aAAW,CAA1B,CAAP;EAAA,KARb,EASGnmB,IATH,CASQ,SATR,EASmB,CATnB,EAUGiS,UAVH,GAWGC,QAXH,CAWYA,QAXZ,EAYGlS,IAZH,CAYQ,SAZR,EAYmB,CAZnB;;EAcA2D,WAAOmhB,IAAP,GACG7S,UADH,GAEGC,QAFH,CAEYA,QAFZ,EAGGlS,IAHH,CAGQ,SAHR,EAGmB,CAHnB,EAIG0H,MAJH;EAKD,GAhED;;EAkEA0b,QAAMlD,SAAN,CAAgBmG,YAAhB,GAA+B,YAAW;;EAGxC,QAAIxpB,KAAK,IAAT;EAAA,QACEN,OAAOM,GAAG6mB,SADZ;EAAA,QAEEjmB,MAAMZ,GAAG6lB,MAAH,CAAUhlB,IAFlB;EAAA,QAGEwU,WAAWrV,GAAGG,OAAH,CAAW+mB,kBAHxB;EAAA,QAIEuC,WAJF;EAAA,QAKEC,EALF;EAAA,QAKMC,MALN;EAAA,QAKcC,OALd;;EAOA;EACAH,kBAAc/pB,KAAK2oB,MAAL,CAAY,UAASwB,MAAT,EAAiBrK,GAAjB,EAAsB;EAC9C,UAAIsK,WAAWD,OAAO/b,IAAP,CAAY0T,OAAZ,CAAoBhC,IAAIyJ,OAAxB,CAAf;EACA,UAAGa,YAAY,CAAC,CAAhB,EAAmB;EACjBA,mBAAWD,OAAO/b,IAAP,CAAYrK,IAAZ,CAAiB+b,IAAIyJ,OAArB,IAAgC,CAA3C;EACAY,eAAOE,QAAP,CAAgBtmB,IAAhB,CAAqB;EACnBwlB,mBAASzJ,IAAIyJ,OADM;EAEnB7jB,iBAAOoa,IAAIpa,KAFQ;EAGnB2Z,kBAAQ,EAHW;EAInBpV,kBAAQ,EAJW;EAKnBqgB,mBAAQxK,IAAIwK;EALO,SAArB;EAOD;EACDH,aAAOE,QAAP,CAAgBD,QAAhB,EAA0BngB,MAA1B,CAAiClG,IAAjC,CAAsC+b,GAAtC;EACAqK,aAAOE,QAAP,CAAgBD,QAAhB,EAA0B/K,MAA1B,CAAiCtb,IAAjC,CAAsC+b,IAAIyK,EAAJ,CAAOvmB,IAAP,CAAY,GAAZ,CAAtC;EACA,aAAOmmB,MAAP;EACD,KAfa,EAeX,EAAC/b,MAAM,EAAP,EAAWic,UAAS,EAApB,EAfW,EAecA,QAf5B;;EAkBAL,SAAK9oB,IAAIqL,SAAJ,CAAc,qBAAd,EACFvM,IADE,CACG+pB,WADH,EACgB,UAASnoB,CAAT,EAAY;EAAE,aAAOA,EAAE2nB,OAAF,GAAY,YAAnB;EAAkC,KADhE,CAAL;;EAGAW,cAAUF,GAAGxd,KAAH,GACP3I,MADO,CACA,GADA,EAEPJ,IAFO,CAEF,OAFE,EAEO,mBAFP,EAGPA,IAHO,CAGF,IAHE,EAGI,UAAS7B,CAAT,EAAY;AACtB,EACA,aAAO,cAAYA,EAAE0oB,OAAF,CAAUE,OAA7B;EACD,KANO,CAAV;;EAQAP,aAASD,GAAGzB,IAAH,EAAT;EACA0B,WAAOvU,UAAP,GAAoBC,QAApB,CAA6BA,QAA7B,EAAuCxK,MAAvC;;EAEA7K,OAAGmqB,oBAAH,CAAwBT,EAAxB,EAA4BE,OAA5B,EAAqCD,MAArC;EACA3pB,OAAGoqB,oBAAH,CAAwBV,EAAxB,EAA4BE,OAA5B,EAAqCD,MAArC;EACD,GA7CD;;EA+CApD,QAAMlD,SAAN,CAAgB+G,oBAAhB,GAAuC,UAASnT,MAAT,EAAiB/K,KAAjB,EAAwB+b,IAAxB,EAA8B;EACnE,QAAIjoB,KAAK,IAAT;EAAA,QACEqV,WAAWrV,GAAGG,OAAH,CAAW+mB,kBADxB;EAAA,QAEEpf,WAAW,eAFb;EAAA,QAGEuiB,QAHF;;EAKA,aAASC,YAAT,CAAsBpB,SAAtB,EAAiC;EAC/BA,gBACG3lB,MADH,CACU,QADV,EAEGJ,IAFH,CAEQ,OAFR,EAEiB,QAFjB,EAGGA,IAHH,CAGQ,IAHR,EAGcnD,GAAGunB,OAAH,CAAWje,CAHzB,EAIGnG,IAJH,CAIQ,IAJR,EAIcnD,GAAGunB,OAAH,CAAWrkB,CAJzB,EAKGC,IALH,CAKQ,GALR,EAKa,CALb,EAMGA,IANH,CAMQ,MANR,EAMgB;EAAA,eAAK7B,EAAE8D,KAAP;EAAA,OANhB,EAOGmG,IAPH,CAOQgf,YAPR,EAQGzmB,EARH,CAQM,WARN,EAQmB,aAAK;EACpB,YAAIwF,IAAIhI,EAAE2oB,EAAF,CAAK,CAAL,IAAU,EAAlB;EAAA,YACE/mB,IAAI5B,EAAE2oB,EAAF,CAAK,CAAL,IAAU,EADhB;EAEAjqB,WAAGwqB,YAAH,CAAgBlhB,CAAhB,EAAmBpG,CAAnB,EAAsB5B,EAAE2nB,OAAxB,EAAiC3nB,EAAEc,KAAnC;EACD,OAZH,EAaG0B,EAbH,CAaM,UAbN,EAakB,YAAM;EACpB9D,WAAGyqB,YAAH;EACD,OAfH;EAgBD;;EAED,aAASC,YAAT,CAAsBxB,SAAtB,EAAiC;EAC/BA,gBACG9T,UADH,GAEGC,QAFH,CAEYA,QAFZ,EAGGlS,IAHH,CAGQ,IAHR,EAGcnD,GAAGunB,OAAH,CAAWje,CAHzB,EAIGnG,IAJH,CAIQ,IAJR,EAIcnD,GAAGunB,OAAH,CAAWrkB,CAJzB,EAKG2H,MALH;EAMD;;EAED,aAAS0f,YAAT,CAAsBrB,SAAtB,EAAiC;EAC/BA,gBACG9T,UADH,GAEGC,QAFH,CAEYA,QAFZ,EAGGlS,IAHH,CAGQ,IAHR,EAGc,UAAS7B,CAAT,EAAY;EAAE,eAAOA,EAAE2oB,EAAF,CAAK,CAAL,CAAP;EAAiB,OAH7C,EAIG9mB,IAJH,CAIQ,IAJR,EAIc,UAAS7B,CAAT,EAAY;EAAE,eAAOA,EAAE2oB,EAAF,CAAK,CAAL,CAAP;EAAiB,OAJ7C;EAKD;;EAED,aAASU,QAAT,CAAkBrpB,CAAlB,EAAqB;EAAE,aAAOA,EAAEqI,MAAT;EAAkB;;EAEzC,aAASihB,OAAT,CAAiBtpB,CAAjB,EAAoB;EAAE,aAAOA,EAAE2nB,OAAF,GAAY,GAAZ,GAAkB3nB,EAAEgF,IAA3B;EAAkC;;EAExD+jB,eAAWpT,OAAOhL,SAAP,CAAiBnE,QAAjB,EACRpI,IADQ,CACHirB,QADG,EACOC,OADP,CAAX;;EAGAP,aACG9e,IADH,CACQgf,YADR;;EAGAF,aAASne,KAAT,GACGX,IADH,CACQ+e,YADR;;EAGAD,aAASpC,IAAT,GACG1c,IADH,CACQmf,YADR;;EAGAxe,UAAMD,SAAN,CAAgBnE,QAAhB,EACGpI,IADH,CACQirB,QADR,EACkBC,OADlB,EAEG1e,KAFH,GAGGX,IAHH,CAGQ+e,YAHR;;EAKArC,SAAKhc,SAAL,CAAenE,QAAf,EACGyD,IADH,CACQmf,YADR;EAED,GAjED;;EAmEA;;;;;;;;EAQAnE,QAAMlD,SAAN,CAAgBmH,YAAhB,GAA+B,UAASlhB,CAAT,EAAYpG,CAAZ,EAAe2nB,IAAf,EAAqBC,IAArB,EAA2B;EACxD,QAAIC,EAAJ;EAAA,QAAQC,KAAR;EAAA,QAAeC,EAAf;EAAA,QAAmBC,IAAnB;EAAA,QACEjpB,UAAU,CADZ;EAAA,QAEEjC,KAAK,IAFP;EAAA,QAGEY,MAAMZ,GAAG6lB,MAAH,CAAUhlB,IAHlB;;EAKAkqB,SAAKnqB,IAAI2C,MAAJ,CAAW,GAAX,EACFJ,IADE,CACG,OADH,EACY,SADZ,EAEFA,IAFE,CAEG,SAFH,EAEc,CAFd,CAAL;;EAIA8nB,SAAKF,GAAGxnB,MAAH,CAAU,MAAV,EAAkBJ,IAAlB,CAAuB,OAAvB,EAAgC,oBAAhC,CAAL;;EAEA6nB,YAAQD,GACLxnB,MADK,CACE,MADF,EAELJ,IAFK,CAEA,GAFA,EAEKD,CAFL,EAGLC,IAHK,CAGA,GAHA,EAGKmG,CAHL,EAIL9I,KAJK,CAIC,MAJD,EAISR,GAAGgoB,gBAAH,CAAoB,OAApB,CAJT,EAKLxnB,KALK,CAKC,aALD,EAKgBR,GAAGgoB,gBAAH,CAAoB,YAApB,CALhB,CAAR;;EAOAgD,UAAMznB,MAAN,CAAa,OAAb,EACGf,IADH,CACQ8B,OAAOwmB,IAAP,EAAa5a,OAAb,CAAqB,CAArB,CADR;;EAGA8a,UAAMznB,MAAN,CAAa,OAAb,EACGJ,IADH,CACQ,IADR,EACc,QADd,EAEGA,IAFH,CAEQ,GAFR,EAEamG,CAFb,EAGG9G,IAHH,CAGQqoB,IAHR;;EAKAK,WAAOH,GAAGpnB,IAAH,GAAUwnB,OAAV,EAAP;;EAEAF,OAAG9nB,IAAH,CAAQ,GAAR,EAAa+nB,KAAK5hB,CAAL,GAASrH,OAAtB,EACGkB,IADH,CACQ,GADR,EACa+nB,KAAKhoB,CAAL,GAASjB,OADtB,EAEGkB,IAFH,CAEQ,OAFR,EAEiB+nB,KAAK9qB,KAAL,GAAc6B,UAAU,CAFzC,EAGGkB,IAHH,CAGQ,QAHR,EAGkB+nB,KAAK5qB,MAAL,IAAe2B,UAAU,CAAzB,CAHlB,EAIGzB,KAJH,CAIS,MAJT,EAIiBR,GAAGgoB,gBAAH,CAAoB,MAApB,CAJjB;;EAMA+C,OAAG3V,UAAH,GACGC,QADH,CACY,GADZ,EAEGlS,IAFH,CAEQ,SAFR,EAEmB,EAFnB;;EAIA,WAAO4nB,EAAP;EACD,GAxCD;;EA0CA;;;;EAIAxE,QAAMlD,SAAN,CAAgBoH,YAAhB,GAA+B,YAAW;EACxC,SAAK5E,MAAL,CAAYhlB,IAAZ,CAAiBoL,SAAjB,CAA2B,WAA3B,EACGmJ,UADH,GAEGC,QAFH,CAEY,GAFZ,EAGGlS,IAHH,CAGQ,SAHR,EAGmB,CAHnB,EAIG0H,MAJH;EAKD,GAND;;EAQA0b,QAAMlD,SAAN,CAAgB8G,oBAAhB,GAAuC,UAASlT,MAAT,EAAiB/K,KAAjB,EAAwB+b,IAAxB,EAA8B;EACnE,QAAIjoB,KAAK,IAAT;EAAA,QACEqV,WAAWrV,GAAGG,OAAH,CAAW+mB,kBADxB;EAAA,QAEEpf,WAAW,kBAFb;EAAA,QAGEuiB,QAHF;;EAKA;EACA;EACA,aAASe,YAAT,CAAsB1rB,IAAtB,EAA4B;EAC1B,UAAI+jB,SAAS,CAACzjB,GAAGunB,OAAH,CAAWje,CAAZ,EAAetJ,GAAGunB,OAAH,CAAWrkB,CAA1B,EAA6BQ,IAA7B,CAAkC,GAAlC,CAAb;EACA,aAAOhE,KAAKqf,MAAL,CAAYjf,GAAZ,CAAgB,YAAW;EAChC;EACA,eAAO2jB,MAAP;EACD,OAHM,EAGJ/f,IAHI,CAGC,GAHD,CAAP;EAID;;EAED,aAAS4mB,YAAT,CAAsBpB,SAAtB,EAAiC;EAC/BA,gBACG3lB,MADH,CACU,SADV,EAEGJ,IAFH,CAEQ,OAFR,EAEiB,UAFjB,EAGGA,IAHH,CAGQ,QAHR,EAGkBioB,YAHlB,EAIG5qB,KAJH,CAIS,QAJT,EAImB,UAASc,CAAT,EAAY;EAAE,eAAOA,EAAE8D,KAAT;EAAiB,OAJlD,EAKG5E,KALH,CAKS,MALT,EAKiB,UAASc,CAAT,EAAY;EAAE,eAAOA,EAAE8D,KAAT;EAAiB,OALhD,EAMG5E,KANH,CAMS,cANT,EAMyB,GANzB,EAOGA,KAPH,CAOS,cAPT,EAOyBR,GAAGgoB,gBAAH,CAAoB,KAApB,CAPzB,EAQGzc,IARH,CAQQgf,YARR;EASD;;EAED,aAASG,YAAT,CAAsBxB,SAAtB,EAAiC;EAC/BA,gBACG9T,UADH,GAEGC,QAFH,CAEYA,QAFZ,EAGGlS,IAHH,CAGQ,QAHR,EAGkBioB,YAHlB,EAIGvgB,MAJH;EAKD;;EAED,aAAS0f,YAAT,CAAsBrB,SAAtB,EAAiC;EAC/BA,gBACG9T,UADH,GAEGC,QAFH,CAEYA,QAFZ,EAGGlS,IAHH,CAGQ,QAHR,EAGkB,UAAS7B,CAAT,EAAY;EAAE,eAAOA,EAAEyd,MAAF,CAASrb,IAAT,CAAc,GAAd,CAAP;EAA4B,OAH5D;EAID;;EAED,aAASinB,QAAT,CAAkBrpB,CAAlB,EAAqB;EAAE,aAAO,CAACA,CAAD,CAAP;EAAa;;EAEpC,aAASspB,OAAT,CAAiBtpB,CAAjB,EAAoB;EAAE,aAAOA,EAAE2nB,OAAT;EAAmB;;EAEzCoB,eAAWpT,OAAOhL,SAAP,CAAiBnE,QAAjB,EACRpI,IADQ,CACHirB,QADG,EACOC,OADP,CAAX;;EAGAP,aACG9e,IADH,CACQgf,YADR;;EAGAF,aAASne,KAAT,GACGX,IADH,CACQ+e,YADR;;EAGAD,aAASpC,IAAT,GACG1c,IADH,CACQmf,YADR;;EAGAxe,UAAMD,SAAN,CAAgBnE,QAAhB,EACGpI,IADH,CACQirB,QADR,EACkBC,OADlB,EAEG1e,KAFH,GAGGX,IAHH,CAGQ+e,YAHR;;EAKArC,SAAKhc,SAAL,CAAenE,QAAf,EACGyD,IADH,CACQmf,YADR;EAGD,GAnED;;EAqEAnE,QAAMlD,SAAN,CAAgBjY,UAAhB,GAA6B,YAAW;EACtC,QAAIpL,KAAK,IAAT;EAAA,QACE8oB,OAAO9oB,GAAG8mB,SAAH,CAAa4B,IADtB;EAAA,QAEE9nB,MAAMZ,GAAG6lB,MAAH,CAAUhlB,IAFlB;EAAA,QAGEwmB,KAAKrnB,GAAGG,OAAH,CAAW2F,MAAX,CAAkBuhB,EAHzB;EAAA,QAIEgE,OAAO,EAJT;EAAA,QAKExmB,SAAS,CALX;EAAA,QAMEiB,MANF;EAAA,QAMUwlB,SANV;;EAQAxlB,aAASlF,IAAIqL,SAAJ,CAAc,eAAd,EACNvM,IADM,CACDopB,IADC,EACK,UAASxnB,CAAT,EAAY;EAAE,aAAOA,EAAE2nB,OAAT;EAAmB,KADtC,EAEN9lB,IAFM,CAED,SAFC,EAEU,aAAK;EACpB,aAAOnD,GAAGinB,iBAAH,CAAqBzF,OAArB,CAA6BlgB,EAAE2nB,OAA/B,IAA0C,CAAC,CAA3C,GAA+C,EAA/C,GAAoD,CAA3D;EACD,KAJM,CAAT;;EAMAqC,gBAAYxlB,OAAOoG,KAAP,GACT3I,MADS,CACF,GADE,EAETO,EAFS,CAEN,OAFM,EAEG,UAACxC,CAAD,EAAO;EAClBtB,SAAGinB,iBAAH,GAAuBjnB,GAAGurB,WAAH,CACrBvrB,GAAGinB,iBADkB,EACC,CAAC3lB,EAAE2nB,OAAH,CADD,CAAvB;EAEAjpB,SAAGuI,IAAH;EACD,KANS,EAOTpF,IAPS,CAOJ,OAPI,EAOK,aAPL,CAAZ;;EASAmoB,cACG/nB,MADH,CACU,MADV,EAEGf,IAFH,CAEQ;EAAA,aAAKlB,EAAE2nB,OAAP;EAAA,KAFR,EAGG9lB,IAHH,CAGQ,GAHR,EAGakkB,GAAG/d,CAAH,GAAO+hB,IAAP,GAAcxmB,MAH3B,EAIG1B,IAJH,CAIQ,GAJR,EAIa,UAAC7B,CAAD,EAAI2C,CAAJ;EAAA,aAAW,CAAConB,OAAOxmB,MAAR,IAAkBZ,CAAnB,GAAwBojB,GAAGnkB,CAA3B,GAA+BmoB,IAAzC;EAAA,KAJb,EAKG7qB,KALH,CAKS,aALT,EAKwBR,GAAGgoB,gBAAH,CAAoB,YAApB,CALxB;;EAOAsD,cACG/nB,MADH,CACU,MADV,EAEGJ,IAFH,CAEQ,MAFR,EAEgB;EAAA,aAAK7B,EAAE8D,KAAP;EAAA,KAFhB,EAGGjC,IAHH,CAGQ,OAHR,EAGiBkoB,IAHjB,EAIGloB,IAJH,CAIQ,QAJR,EAIkBkoB,IAJlB,EAKGloB,IALH,CAKQ,GALR,EAKakkB,GAAG/d,CALhB,EAMGnG,IANH,CAMQ,GANR,EAMa,UAAC7B,CAAD,EAAI2C,CAAJ;EAAA,aAAW,CAAConB,OAAOxmB,MAAR,IAAkBZ,CAAnB,GAAwBojB,GAAGnkB,CAArC;EAAA,KANb;EAOD,GAtCD;;EAwCA;;;;;EAKAqjB,QAAMlD,SAAN,CAAgB2E,gBAAhB,GAAmC,UAAS5lB,KAAT,EAAgB;EACjD,WAAO,KAAKjC,OAAL,CAAamnB,aAAb,GAA6BllB,KAA7B,GAAqC,IAA5C;EACD,GAFD;;EAIA;;;;;;EAMAmkB,QAAMlD,SAAN,CAAgBkI,WAAhB,GAA8B,UAACC,IAAD,EAAOC,KAAP,EAAiB;EAC7C,QAAIC,WAAWD,MAAMnc,MAAN,CAAa;EAAA,aAAMkc,KAAKhK,OAAL,CAAamK,EAAb,KAAoB,CAAC,CAA3B;EAAA,KAAb,CAAf;EACA,WAAOH,KAAKlc,MAAL,CAAY;EAAA,aAAMmc,MAAMjK,OAAN,CAAcmK,EAAd,KAAqB,CAAC,CAA5B;EAAA,KAAZ,EAA2CnD,MAA3C,CAAkDkD,QAAlD,CAAP;EACD,GAHD;;EAKAnF,QAAMlD,SAAN,CAAgB8F,GAAhB,GAAsB,UAASV,IAAT,EAAermB,KAAf,EAAsB;EAC1C,QAAIpC,KAAK,IAAT;EACA,WAAOA,GAAGunB,OAAH,CAAWje,CAAX,GAAgBlH,QAAQyN,KAAK+b,GAAL,CAASnD,IAAT,CAA/B;EACD,GAHD;;EAKAlC,QAAMlD,SAAN,CAAgB+F,GAAhB,GAAsB,UAASX,IAAT,EAAermB,KAAf,EAAsB;EAC1C,QAAIpC,KAAK,IAAT;EACA,WAAOA,GAAGunB,OAAH,CAAWrkB,CAAX,GAAgBd,QAAQyN,KAAKgc,GAAL,CAASpD,IAAT,CAA/B;EACD,GAHD;;EAKAlC,QAAMlD,SAAN,CAAgBlV,MAAhB,GAAyB,UAASzO,IAAT,EAAe;EACtC,QAAIM,KAAK,IAAT;EACA,WAAON,KAAK2oB,MAAL,CAAY,UAASla,MAAT,EAAiBqR,GAAjB,EAAsB;EACvC,UAAIO,MAAM7I,SAASsI,IAAIxf,GAAGG,OAAH,CAAWwnB,UAAf,CAAT,CAAV;EACA,UAAGxZ,OAAOtK,MAAP,IAAiB,CAApB,EAAuB;EACrB,eAAO,CAACkc,GAAD,EAAMA,GAAN,CAAP;EACD;EACD,aAAO,CACLA,MAAM5R,OAAO,CAAP,CAAN,GAAkB4R,GAAlB,GAAwB5R,OAAO,CAAP,CADnB,EAEL4R,MAAM5R,OAAO,CAAP,CAAN,GAAkB4R,GAAlB,GAAwB5R,OAAO,CAAP,CAFnB,CAAP;EAID,KATM,EASJ,EATI,CAAP;EAUD,GAZD;;EAcA;EACAoY,QAAMlD,SAAN,CAAgByI,oBAAhB,GAAuC,UAASpsB,IAAT,EAAe;EACpD,QAAIM,KAAK,IAAT;EAAA,QACEkB,QAAQlB,GAAGgnB,MADb;EAAA,QAEE+E,UAAU/rB,GAAGG,OAAH,CAAWunB,QAFvB;EAAA,QAGEsE,SAAShsB,GAAGG,OAAH,CAAWwnB,UAHtB;EAAA,QAIEsE,WAAWjsB,GAAGG,OAAH,CAAWsnB,YAJxB;EAAA,QAKEyE,WAAWlsB,GAAG2mB,SAAH,CAAagC,IAL1B;;EAOA,WAAOjpB,KAAKI,GAAL,CAAS,UAAS0f,GAAT,EAAc;EAC5B,UAAIlZ,OAAOkZ,IAAIuM,OAAJ,CAAX;EAAA,UACEtD,OAAOyD,SAAS5lB,IAAT,EAAemiB,IADxB;EAAA,UAEEQ,UAAUzJ,IAAIyM,QAAJ,CAFZ;EAAA,UAGElM,MAAMP,IAAIwM,MAAJ,CAHR;EAAA,UAIEG,QAAQjrB,MAAM6e,GAAN,CAJV;EAKA,aAAO;EACLkK,YAAI,CACFjqB,GAAGmpB,GAAH,CAAOV,IAAP,EAAa0D,KAAb,CADE,EAEFnsB,GAAGopB,GAAH,CAAOX,IAAP,EAAa0D,KAAb,CAFE,CADC;EAKL/pB,eAAO2d,GALF;EAMLkJ,iBAASA,OANJ;EAOL3iB,cAAMA,IAPD;EAQLlB,eAAOpF,GAAG8mB,SAAH,CAAa6B,IAAb,CAAkBM,OAAlB,CARF;EASLe,iBAASxK;EATJ,OAAP;EAWD,KAjBM,CAAP;EAkBD,GA1BD;;EA4BA+G,QAAMlD,SAAN,CAAgB/T,MAAhB,GAAyB,UAAS8c,GAAT,EAAc;EACrC,QAAIpsB,KAAK,IAAT;EACAA,OAAG4mB,OAAH,GAAawF,GAAb;EACA,WAAOpsB,EAAP;EACD,GAJD;;EAMA;;EAEAumB,QAAMlD,SAAN,CAAgBnjB,KAAhB,GAAwB,UAASA,KAAT,EAAgB;EACtC,QAAIF,KAAK,IAAT;EACAA,OAAG6lB,MAAH,GAAY3lB,KAAZ;EACA,WAAOF,EAAP;EACD,GAJD;;EAMAumB,QAAMlD,SAAN,CAAgB3jB,IAAhB,GAAuB,UAASA,IAAT,EAAe;EACpC,QAAIM,KAAK,IAAT;EACA;EACA,QAAGA,GAAGG,OAAH,CAAWT,IAAX,CAAgB4P,MAAnB,EAA0B;EACxB5P,aAAOA,KAAK4P,MAAL,CAAYtP,GAAGG,OAAH,CAAWT,IAAX,CAAgB4P,MAA5B,CAAP;EACD;;EAEDtP,OAAGkH,KAAH,GAAWxH,IAAX;EACA,WAAOM,EAAP;EACD,GATD;;EAWAumB,QAAMlD,SAAN,CAAgB5a,MAAhB,GAAyB,UAASA,MAAT,EAAiB;EACxC,QAAIzI,KAAK,IAAT;EACAA,OAAGqH,OAAH,GAAaoB,MAAb;EACA;EACAzI,OAAGgnB,MAAH,GAAYhnB,GAAGqH,OAAH,CAAWiC,CAAvB;EACAtJ,OAAGgnB,MAAH,CAAU5lB,KAAV,CAAgB,CAAC,CAAD,EAAIpB,GAAGwnB,OAAP,CAAhB;EACA,WAAOxnB,EAAP;EACD,GAPD;;EASAumB,QAAMlD,SAAN,CAAgBta,IAAhB,GAAuB,UAASA,IAAT,EAAe;EACpC,QAAI/I,KAAK,IAAT;EACA;EACA,WAAOA,EAAP;EACD,GAJD;;EAMAumB,QAAMlD,SAAN,CAAgBliB,OAAhB,GAA0B,YAAW;EACnC,QAAInB,KAAK,IAAT;EACAA,OAAGqsB,YAAH,CAAgBrsB,GAAGkH,KAAnB;EACA,WAAOlH,EAAP;EACD,GAJD;;EAMAumB,QAAMlD,SAAN,CAAgBgJ,YAAhB,GAA+B,UAAS3sB,IAAT,EAAe;EAC5C,QAAIM,KAAK,IAAT;EACAA,OAAGyP,OAAH,GAAazP,GAAGmO,MAAH,CAAUzO,IAAV,CAAb;EACAM,OAAGgnB,MAAH,CAAUhlB,MAAV,CAAiBhC,GAAGG,OAAH,CAAWsI,MAAX,IAAqBzI,GAAGG,OAAH,CAAWsI,MAAX,CAAkBa,CAAvC,IAA4CtJ,GAAGG,OAAH,CAAWsI,MAAX,CAAkBa,CAAlB,CAAoBtH,MAAhE,IAA0EH,MAAMC,OAAN,CAAc9B,GAAGG,OAAH,CAAWsI,MAAX,CAAkBa,CAAlB,CAAoBtH,MAAlC,CAA1E,GAAsHhC,GAAGG,OAAH,CAAWsI,MAAX,CAAkBa,CAAlB,CAAoBtH,MAA1I,GAAmJ,CAAC,CAAD,EAAIhC,GAAGyP,OAAH,CAAW,CAAX,CAAJ,CAApK;;EAEAzP,OAAG+mB,MAAH,GAAY/mB,GAAGgnB,MAAH,CAAUrgB,KAAV,CAAgB3G,GAAGG,OAAH,CAAWwG,KAA3B,CAAZ;EACA;EACA;EACA,QAAG3G,GAAG+mB,MAAH,CAAUljB,MAAV,GAAmB,CAAnB,IAAwB7D,GAAG+mB,MAAH,CAAU,CAAV,MAAiB,CAA5C,EAA+C;EAC7C/mB,SAAG+mB,MAAH,GAAY/mB,GAAG+mB,MAAH,CAAU7iB,KAAV,CAAgB,CAAhB,CAAZ;EACD;EACF,GAXD;;EAaAqiB,QAAMlD,SAAN,CAAgB9a,IAAhB,GAAuB,YAAW;EAChC,QAAIvI,KAAK,IAAT;EAAA,QACEN,OAAOM,GAAGkH,KADZ;;EAGA;EACA;EACA;EACAlH,OAAG8mB,SAAH,GAAe9mB,GAAG6oB,aAAH,CAAiBnpB,IAAjB,CAAf;;EAEA;EACA,QAAG,OAAOM,GAAG4mB,OAAV,KAAsB,UAAzB,EAAqC;EACnClnB,aAAOA,KAAK4P,MAAL,CAAYtP,GAAG4mB,OAAf,CAAP;EACD;;EAED;EACA,QAAG5mB,GAAGinB,iBAAH,CAAqBpjB,MAArB,GAA8B,CAAjC,EAAoC;EAClCnE,aAAOA,KAAK4P,MAAL,CAAY,cAAM;EACvB,eAAOtP,GAAGinB,iBAAH,CAAqBzF,OAArB,CACLmK,GAAG3rB,GAAGG,OAAH,CAAWsnB,YAAd,CADK,KAC2B,CAAC,CADnC;EAED,OAHM,CAAP;EAID;;EAEDznB,OAAGqsB,YAAH,CAAgB3sB,IAAhB;EACAM,OAAG2mB,SAAH,GAAe3mB,GAAGmoB,WAAH,CAAezoB,IAAf,CAAf;EACAM,OAAG6mB,SAAH,GAAe7mB,GAAG8rB,oBAAH,CAAwBpsB,IAAxB,CAAf;;EAEAM,OAAG4nB,SAAH;EACA5nB,OAAGgJ,QAAH;EACAhJ,OAAGqpB,cAAH;EACArpB,OAAGkoB,eAAH;EACAloB,OAAGwpB,YAAH;EACAxpB,OAAGoL,UAAH;EACD,GAhCD;;EAkCA,SAAO,IAAImb,KAAJ,CAAUpnB,MAAV,CAAP;EAED;;ECxyBD;;;;AAIA,EAAe,kBAAUA,MAAV,EAAkBqI,MAAlB,EAA0B;;EAEvC,MAAI8kB,UAAUvkB,OAAO4G,MAAP,CAAcnH,MAAd,CAAd;;EAEA8kB,UAAQ5nB,IAAR,GAAe,UAAUvF,MAAV,EAAkB;EAC/B,QAAIa,KAAK,IAAT;EACAA,OAAGG,OAAH,GAAahB,SAASA,MAAT,GAAkB,EAA/B;EACAa,OAAGkH,KAAH,GAAW,EAAX;EACAlH,OAAGqH,OAAH,GAAa,EAAb;EACArH,OAAGsH,KAAH,GAAW,EAAX;;EAEAtH,OAAG4O,IAAH,GAAU,KAAK9N,KAAL,CAAWC,EAAX,CAAcC,GAAd,GAAoBmC,IAApB,CAAyB,OAAzB,EAAkC,QAAlC,EACP2H,IADO,CACF9K,GAAGG,OAAH,CAAWa,GAAX,IAAkBhB,GAAGG,OAAH,CAAWa,GAAX,CAAe8J,IAAjC,GAAwC9K,GAAGG,OAAH,CAAWa,GAAX,CAAe8J,IAAvD,GAA8D,UAASxJ,CAAT,EAAY;EAC9E,UAAItB,GAAGE,KAAH,CAASf,MAAT,CAAgBsM,MAApB,EAA4B;EAC1B,YAAIX,qFAES9K,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuBwD,OAFhC,6CAGajG,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuBD,IAAvB,CAA4BgD,UAHzC,2CAIWxF,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuBD,IAAvB,CAA4B+C,QAJvC,uCAKOvF,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuBD,IAAvB,CAA4B8C,SALnC,4CAMatF,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuBD,IAAvB,CAA4B0D,UANzC,iDAOkBlG,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuB0C,eAPzC,yCAQSnF,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuBD,IAAvB,CAA4BP,OARrC,0CASQjC,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuB0D,MAAvB,CAA8B/F,KATtC,uBASqDJ,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuB0D,MAAvB,CAA8Bf,KATnF,iDAUgBpF,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuB0D,MAAvB,CAA8BC,MAV9C,UAAJ;EAWA0E,kDAAgC9K,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuBD,IAAvB,CAA4B+pB,SAA5D;EACD,OAbD,MAcK;EAAE,YAAIzhB,OAAO,gBAAX;EAA6B;EACpCA,cAAQ9K,GAAGG,OAAH,CAAW8R,MAAX,GAAoB3Q,EAAEiY,KAAF,CAAQvZ,GAAGG,OAAH,CAAW8R,MAAnB,IAA6B3Q,EAAEiY,KAAF,CAAQvZ,GAAGG,OAAH,CAAW8R,MAAnB,IAA6B,MAA1D,GAAmE,EAAvF,GAA4F,EAApG;EACAnH,cAAQxJ,EAAEgI,CAAF,GAAO,aAAahF,OAAOC,KAAP,CAAa,CAACjD,EAAEgI,CAAhB,KAAsBtJ,GAAGG,OAAH,CAAW6G,KAAX,CAAiB9F,KAAjB,KAA2B,QAAjD,GAA4DI,EAAEgI,CAA9D,GAAkEtJ,GAAGc,KAAH,CAASqB,MAAT,CAAgBb,EAAEgI,CAAlB,EAAqBtJ,GAAGG,OAAH,CAAW6P,QAAhC,CAA/E,IAA4H,SAAnI,GAAgJ,KAAxJ;EACAlF,cAAQxJ,EAAE4B,CAAF,GAAO,oBAAoBoB,OAAOC,KAAP,CAAa,CAACjD,EAAE4B,CAAhB,KAAsBlD,GAAGG,OAAH,CAAWkG,KAAX,CAAiBnF,KAAjB,KAA2B,QAAjD,GAA4DI,EAAE4B,CAA9D,GAAkElD,GAAGc,KAAH,CAASqB,MAAT,CAAgBb,EAAE4B,CAAlB,EAAqBlD,GAAGG,OAAH,CAAW6P,QAAhC,CAAtF,IAAmI,UAA1I,GAAwJ,OAAhK;EACAlF,cAAQ,gBAAR;EACA,UAAI9K,GAAGG,OAAH,CAAWqsB,SAAX,IAAwBlrB,EAAEkrB,SAAF,KAAgBlrB,EAAEgI,CAA1C,IAA+ChI,EAAEkrB,SAAF,KAAgBlrB,EAAE4B,CAArE,EAAwE;EACtE4H,gBAAQxJ,EAAEkrB,SAAF,GAAe,YAAYloB,OAAOC,KAAP,CAAa,CAACjD,EAAEkrB,SAAhB,KAA+B,CAAClrB,EAAEkrB,SAAH,IAAgB,IAAhB,IAAwB,CAAClrB,EAAEkrB,SAAH,IAAgB,IAAvE,GAA8ElrB,EAAEkrB,SAAhF,GAA4FxsB,GAAGc,KAAH,CAASqB,MAAT,CAAgBb,EAAEkrB,SAAlB,CAAxG,IAAwI,SAAvJ,GAAoK,EAA5K;EACD;EACD,UAAIlrB,EAAE8D,KAAF,KAAY9D,EAAEgI,CAAd,IAAmBhI,EAAE8D,KAAF,KAAY9D,EAAE4B,CAAjC,IAAsC5B,EAAE8D,KAAF,KAAY9D,EAAEkrB,SAAxD,EAAmE;EACjE1hB,gBAAQxJ,EAAE8D,KAAF,GAAW,aAAad,OAAOC,KAAP,CAAa,CAACjD,EAAE8D,KAAhB,KAA2B,CAAC9D,EAAE8D,KAAH,IAAY,IAAZ,IAAoB,CAAC9D,EAAE8D,KAAH,IAAY,IAA3D,GAAmE9D,EAAE8D,KAArE,GAA6EpF,GAAGc,KAAH,CAASqB,MAAT,CAAgBb,EAAE8D,KAAlB,EAAyBpF,GAAGG,OAAH,CAAW6P,QAApC,CAA1F,IAA2I,SAAtJ,GAAmK,EAA3K;EACD;EACDlF,cAAQ,QAAR;;EAEA,aAAOA,IAAP;EACD,KA9BO,CAAV;EA+BD,GAtCD;;EAwCA;EACA;;EAEAwhB,UAAQxd,EAAR,GAAa,UAAU4Q,GAAV,EAAe;EAC1B,QAAI1f,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAW2O,EAAX,GAAgB4Q,GAAhB;EACA,WAAO1f,EAAP;EACD,GAJD;;EAMAssB,UAAQra,MAAR,GAAiB,UAAUyN,GAAV,EAAe;EAC9B,QAAI1f,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAW8R,MAAX,GAAoByN,GAApB;EACA,WAAO1f,EAAP;EACD,GAJD;;EAMAssB,UAAQhjB,CAAR,GAAY,UAAUoW,GAAV,EAAe;EACzB,QAAI1f,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWmJ,CAAX,GAAeoW,GAAf;EACA,WAAO1f,EAAP;EACD,GAJD;;EAMAssB,UAAQppB,CAAR,GAAY,UAAUwc,GAAV,EAAe;EACzB,QAAI1f,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAW+C,CAAX,GAAewc,GAAf;EACA,WAAO1f,EAAP;EACD,GAJD;;EAMAssB,UAAQlmB,MAAR,GAAiB,UAAUA,MAAV,EAAkB;EACjC,QAAIpG,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWiG,MAAX,GAAoBA,MAApB;EACA,WAAOpG,EAAP;EACD,GAJD;;EAMAssB,UAAQE,SAAR,GAAoB,UAAUA,SAAV,EAAqB;EACvC,QAAIxsB,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWqsB,SAAX,GAAuBA,SAAvB;EACA,WAAOxsB,EAAP;EACD,GAJD;;EAMAssB,UAAQG,WAAR,GAAsB,UAAUA,WAAV,EAAuB;EAC3C,QAAIzsB,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWssB,WAAX,GAAyBA,WAAzB;EACA,WAAOzsB,EAAP;EACD,GAJD;;EAMAssB,UAAQI,cAAR,GAAyB,UAAUA,cAAV,EAA0B;EACjD,QAAI1sB,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWusB,cAAX,GAA4BA,cAA5B;EACA,WAAO1sB,EAAP;EACD,GAJD;;EAMAssB,UAAQ/J,UAAR,GAAqB,UAAUA,UAAV,EAAsB;EACzC,QAAIviB,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWoiB,UAAX,GAAwBA,UAAxB;EACA,WAAOviB,EAAP;EACD,GAJD;;EAMAssB,UAAQtmB,MAAR,GAAiB,UAAU2mB,UAAV,EAAsB;EACrC,QAAI3sB,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWwsB,UAAX,GAAwBA,UAAxB;EACA,WAAO3sB,EAAP;EACD,GAJD;;EAMAssB,UAAQpd,MAAR,GAAiB,UAASA,MAAT,EAAiB;EAChC,QAAIlP,KAAK,IAAT;EACA,QAAI6B,MAAMC,OAAN,CAAcoN,MAAd,CAAJ,EAA2B;EACzB;EACAlP,SAAGG,OAAH,CAAW+O,MAAX,GAAoBA,MAApB;EACD,KAHD,MAGO;EACL;EACAlP,SAAGqH,OAAH,CAAWjC,KAAX,GAAmB8J,MAAnB;EACD;EACD,WAAOlP,EAAP;EACD,GAVD;;EAYAssB,UAAQrd,IAAR,GAAe,UAAUyQ,GAAV,EAAe;EAC5B,QAAI1f,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAW8O,IAAX,GAAkByQ,GAAlB;EACA,WAAO1f,EAAP;EACD,GAJD;;EAMAssB,UAAQrmB,OAAR,GAAkB,UAAUA,OAAV,EAAmB;EACnC,QAAIjG,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAW8F,OAAX,GAAqBA,OAArB;EACA,WAAOjG,EAAP;EACD,GAJD;;EAMAssB,UAAQM,UAAR,GAAqB,UAAUA,UAAV,EAAsB;EACzC,QAAI5sB,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWysB,UAAX,GAAwBA,UAAxB;EACA,WAAO5sB,EAAP;EACD,GAJD;;EAMAssB,UAAQtrB,GAAR,GAAc,UAAUA,GAAV,EAAe;EAC3B,QAAIhB,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWa,GAAX,GAAiBA,GAAjB;EACAhB,OAAG4O,IAAH,CAAQ9D,IAAR,CAAa9K,GAAGG,OAAH,CAAWa,GAAxB;EACA,WAAOhB,EAAP;EACD,GALD;;EAOAssB,UAAQ5sB,IAAR,GAAe,UAAUA,IAAV,EAAgB;EAC7B,QAAIM,KAAK,IAAT;EACA,QAAI6sB,EAAJ,EAAOC,EAAP,EAAWC,KAAX,EAAkBC,KAAlB,EAAyBC,EAAzB,EAA6BC,EAA7B,EAAiCC,KAAjC,EAAwCC,KAAxC;EACAptB,OAAGkH,KAAH,GAAW,EAAX;;EAEAxH,SAAK+K,OAAL,CAAa,UAAUnJ,CAAV,EAAa;EACxB,UAAI6f,IAAI,EAAR;EACAA,QAAE5H,KAAF,GAAUjY,CAAV;EACA6f,QAAE7X,CAAF,GAAMtJ,GAAGG,OAAH,CAAW6G,KAAX,CAAiB9F,KAAjB,IAA0B,QAA1B,GAAqC,CAACI,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,CAAtC,GAAwDhI,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,CAA9D;EACA6X,QAAEje,CAAF,GAAMlD,GAAGG,OAAH,CAAWkG,KAAX,CAAiBnF,KAAjB,IAA0B,QAA1B,GAAqC,CAACI,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,CAAtC,GAAwD5B,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,CAA9D;EACA,UAAIlD,GAAGG,OAAH,CAAW6G,KAAX,CAAiB9F,KAAjB,IAA0B,QAA1B,IACEoD,OAAOC,KAAP,CAAa4c,EAAE7X,CAAf,CADN,EACyB;EACvB6X,UAAE7X,CAAF,GAAM,CAAN;EACD;EACD,UAAItJ,GAAGG,OAAH,CAAWkG,KAAX,CAAiBnF,KAAjB,IAA0B,QAA1B,IACEoD,OAAOC,KAAP,CAAa4c,EAAEje,CAAf,CADN,EACyB;EACvBie,UAAEje,CAAF,GAAM,CAAN;EACD;EACDie,QAAE/b,KAAF,GAAUpF,GAAGG,OAAH,CAAW8O,IAAX,CAAgB/K,KAAhB,CAAsB,CAAtB,EAAyB,CAAzB,MAAgC,GAAhC,GAAsC5C,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb,CAAtC,GAA2DjP,GAAGG,OAAH,CAAW8O,IAAhF;EACAkS,QAAE/a,MAAF,GAAWpG,GAAGG,OAAH,CAAWiG,MAAX,KAAsB1E,SAAtB,GAAkC6C,MAAMvE,GAAGG,OAAH,CAAWiG,MAAjB,IAA2B,CAAC9E,EAAEtB,GAAGG,OAAH,CAAWiG,MAAb,CAA5B,GAAmDpG,GAAGG,OAAH,CAAWiG,MAAhG,GAAyG,CAApH;;EAEA;;EAEA+a,QAAEqL,SAAF,GAAcxsB,GAAGG,OAAH,CAAWqsB,SAAX,KAAyB9qB,SAAzB,GAAqC6C,MAAMvE,GAAGG,OAAH,CAAWqsB,SAAjB,IAA8B,CAAClrB,EAAEtB,GAAGG,OAAH,CAAWqsB,SAAb,CAA/B,GAAyDxsB,GAAGG,OAAH,CAAWqsB,SAAzG,GAAqH,CAAnI;;EAEA,UAAIxsB,GAAGG,OAAH,CAAWoiB,UAAX,KAA0B7gB,SAA1B,IAAuCG,MAAMC,OAAN,CAAc9B,GAAGG,OAAH,CAAWoiB,UAAzB,CAAvC,IAA+EviB,GAAGG,OAAH,CAAWoiB,UAAX,CAAsB1e,MAAtB,GAA+B,CAAlH,EAAqH;EACnH7D,WAAGG,OAAH,CAAWoiB,UAAX,CAAsB9X,OAAtB,CAA8B,UAAU4iB,CAAV,EAAa;EACzClM,YAAEkM,CAAF,IAAO/rB,EAAE+rB,CAAF,CAAP;EACD,SAFD;EAGD;;EAEDrtB,SAAGkH,KAAH,CAASzD,IAAT,CAAc0d,CAAd;EACD,KA3BD;;EA6BA,QAAInhB,GAAGG,OAAH,CAAWysB,UAAX,KAA0B,IAA1B,IACC5sB,GAAGG,OAAH,CAAWkG,KAAX,CAAiBnF,KAAjB,KAA2B,QAD5B,IAEClB,GAAGG,OAAH,CAAW6G,KAAX,CAAiB9F,KAAjB,KAA2B,QAFhC,EAE2C;EACzC6rB,cAAQhsB,OAAA,CAAQrB,KAAKI,GAAL,CAAS,UAAUwB,CAAV,EAAa;EACpC,eAAO,CAACgD,OAAOC,KAAP,CAAa,CAACjD,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,CAAd,CAAD,GAAkC,CAAEhI,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,CAApC,GAAsD,CAA7D;EACD,OAFe,CAAR,CAAR;EAGA0jB,cAAQjsB,OAAA,CAAQrB,KAAKI,GAAL,CAAS,UAAUwB,CAAV,EAAa;EACpC,eAAO,CAACgD,OAAOC,KAAP,CAAa,CAACjD,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,CAAd,CAAD,GAAkC,CAAE5B,EAAEtB,GAAGG,OAAH,CAAW+C,CAAb,CAApC,GAAsD,CAA7D;EACD,OAFe,CAAR,CAAR;EAGA2pB,WAAK,CAAL;EACAC,WAAK,CAAL;EACAK,cAAQ,CAAR;EACAC,cAAQ,CAAR;;EAEAptB,SAAGkH,KAAH,CAASuD,OAAT,CAAiB,UAAS0W,CAAT,EAAW;EAC1B0L,aAAKvoB,OAAOC,KAAP,CAAa,CAAC4c,EAAE7X,CAAhB,IAAqB,CAACyjB,KAAtB,GAA+B,CAAC5L,EAAE7X,CAAJ,GAASyjB,KAA5C;EACAD,aAAKxoB,OAAOC,KAAP,CAAa,CAAC4c,EAAEje,CAAhB,IAAqB,CAAC8pB,KAAtB,GAA+B,CAAC7L,EAAEje,CAAJ,GAAS8pB,KAA5C;EACAG,iBAASN,KAAKC,EAAd;EACAM,iBAASP,KAAKA,EAAd;EACD,OALD;;EAOA,UAAII,KAAKE,QAAQC,KAAjB;EACA,UAAIF,KAAKF,QAASC,KAAKF,KAAvB;;EAEA/sB,SAAGkH,KAAH,CAASuD,OAAT,CAAiB,UAAS0W,CAAT,EAAW;EAC1BA,UAAEmM,IAAF,GAASJ,KAAM5oB,OAAO6c,EAAE7X,CAAT,IAAc2jB,EAA7B;EACD,OAFD;EAGD;;EAED,QAAIjtB,GAAGG,OAAH,CAAWkG,KAAX,CAAiBnF,KAAjB,KAA2B,QAA/B,EAAyC;EACvClB,SAAGkH,KAAH,CAASqH,IAAT,CAAc,UAASnK,CAAT,EAAYC,CAAZ,EAAe;EAC3B,eAAOrE,GAAGc,KAAH,CAASqD,aAAT,CAAuBC,EAAElB,CAAzB,EAA4BmB,EAAEnB,CAA9B,CAAP;EACD,OAFD;EAGD;EACD,QAAIlD,GAAGG,OAAH,CAAW6G,KAAX,CAAiB9F,KAAjB,KAA2B,QAA/B,EAAyC;EACvClB,SAAGkH,KAAH,CAASqH,IAAT,CAAc,UAASnK,CAAT,EAAYC,CAAZ,EAAe;EAC3B,eAAOrE,GAAGc,KAAH,CAASqD,aAAT,CAAuBC,EAAEkF,CAAzB,EAA4BjF,EAAEiF,CAA9B,CAAP;EACD,OAFD;EAGD;;EAED,WAAOtJ,EAAP;EACD,GA3ED;;EA6EAssB,UAAQ7jB,MAAR,GAAiB,YAAY;EAC3B,QAAIzI,KAAK,IAAT;;EAEA,QAAIA,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,GAA1B,KAAkCnL,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,GAA1B,CAAtC,EAAsE;EACpEhM,eAAS;EACPoC,gBAAQ,GADD;EAEPI,cAAM3B,GAAGG,OAAH,CAAW6G,KAAX,CAAiB9F,KAFhB;EAGPE,eAAO,CAAC,CAAD,EAAIpB,GAAGE,KAAH,CAASE,KAAb,CAHA;EAIPwB,iBAAS5B,GAAGG,OAAH,CAAW6G,KAAX,CAAiBpF,OAAjB,GAA2B5B,GAAGG,OAAH,CAAW6G,KAAX,CAAiBpF,OAA5C,GAAsD;EAJxD,OAAT;EAMA5B,SAAGqH,OAAH,CAAWiC,CAAX,GAAetJ,GAAGc,KAAH,CAASG,aAAT,CAAuBjB,GAAGkH,KAA1B,EAAiC/H,MAAjC,CAAf;;EAGAA,eAAS;EACPoC,gBAAQ,GADD;EAEPI,cAAM3B,GAAGG,OAAH,CAAWkG,KAAX,CAAiBnF,KAFhB;EAGPE,eAAO,CAACpB,GAAGE,KAAH,CAASI,MAAV,EAAkB,CAAlB,CAHA;EAIPsB,iBAAS5B,GAAGG,OAAH,CAAWkG,KAAX,CAAiBzE,OAAjB,GAA2B5B,GAAGG,OAAH,CAAWkG,KAAX,CAAiBzE,OAA5C,GAAsD;EAJxD,OAAT;EAMA5B,SAAGqH,OAAH,CAAWnE,CAAX,GAAelD,GAAGc,KAAH,CAASG,aAAT,CAAuBjB,GAAGkH,KAA1B,EAAiC/H,MAAjC,CAAf;EACD;;EAED,QAAIa,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,QAA1B,CAAJ,EAAyC;EACvCnL,SAAGqH,OAAH,CAAWjC,KAAX,GAAmBrE,eAAA,CAAgBf,GAAGG,OAAH,CAAW+O,MAA3B,CAAnB;EACD,KAFD,MAEO;EACLlP,SAAGqH,OAAH,CAAWjC,KAAX,GAAmBrE,eAAA,CAAgBA,oBAAhB,CAAnB;EACD;;EAED,QAAIwsB,eAAexsB,SAAA,CAAUf,GAAGkH,KAAb,EAAoB,UAAU5F,CAAV,EAAa;EAClD,aAAOA,EAAE8E,MAAT;EACD,KAFkB,CAAnB;;EAIA,QAAIonB,kBAAkBzsB,SAAA,CAAUf,GAAGkH,KAAb,EAAoB,UAAU5F,CAAV,EAAa;EACrD,aAAOA,EAAEkrB,SAAT;EACD,KAFqB,CAAtB;;EAIAxsB,OAAGqH,OAAH,CAAWjB,MAAX,GAAoBrF,cAAA,GACjBK,KADiB,CACXpB,GAAGG,OAAH,CAAWssB,WAAX,IAA0B/qB,SAA1B,GAAsC1B,GAAGG,OAAH,CAAWssB,WAAjD,GAA+D,CAAC,CAAD,EAAI,EAAJ,CADpD,EAEjBzqB,MAFiB,CAEVurB,YAFU,EAEIzW,IAFJ,EAApB;;EAIA9W,OAAGqH,OAAH,CAAWmlB,SAAX,GAAuBzrB,cAAA,GACpBK,KADoB,CACdpB,GAAGG,OAAH,CAAWusB,cAAX,IAA6BhrB,SAA7B,GAAyC1B,GAAGG,OAAH,CAAWusB,cAApD,GAAqE,CAAC,CAAD,EAAI,EAAJ,CADvD,EAEpB1qB,MAFoB,CAEbwrB,eAFa,EAEI1W,IAFJ,EAAvB;;EAIA,QAAI9W,GAAGG,OAAH,CAAW6G,KAAX,CAAiBymB,WAAjB,IAAgC5rB,MAAMC,OAAN,CAAc9B,GAAGG,OAAH,CAAW6G,KAAX,CAAiBymB,WAA/B,CAApC,EAAiF;EAC/EztB,SAAGqH,OAAH,CAAWiC,CAAX,CAAatH,MAAb,CAAoBhC,GAAGG,OAAH,CAAW6G,KAAX,CAAiBymB,WAArC;EAED;EACD,QAAIztB,GAAGG,OAAH,CAAWkG,KAAX,CAAiBonB,WAAjB,IAAgC5rB,MAAMC,OAAN,CAAc9B,GAAGG,OAAH,CAAWkG,KAAX,CAAiBonB,WAA/B,CAApC,EAAiF;EAC/EztB,SAAGqH,OAAH,CAAWnE,CAAX,CAAalB,MAAb,CAAoBhC,GAAGG,OAAH,CAAWkG,KAAX,CAAiBonB,WAArC;EACD;EACD,WAAOztB,EAAP;EACD,GApDD;;EAsDAssB,UAAQ5c,UAAR,GAAqB,YAAW;EAC9B,QAAI1P,KAAK,IAAT;EACA,QAAI0tB,UAAU,EAAd;EACA,QAAIC,UAAU,EAAd;EACA,QAAIC,SAAS,EAAb;;EAEA5tB,OAAGE,KAAH,CAASU,GAAT,GAAeqL,SAAf,CAAyB,aAAzB,EACGvM,IADH,CACQM,GAAGkH,KADX,EAEGgF,KAFH,GAEW3I,MAFX,CAEkB,MAFlB,EAGGJ,IAHH,CAGQ,OAHR,EAGiB,YAHjB,EAIGA,IAJH,CAIQ,WAJR,EAIqB,UAAS7B,CAAT,EAAY0P,KAAZ,EAAmB;EACpC,UAAI6c,MAAJ;EACA,UAAI7tB,GAAGG,OAAH,CAAW6G,KAAX,CAAiB9F,KAAjB,IAA0B,SAA1B,IAAuClB,GAAGG,OAAH,CAAW6G,KAAX,CAAiB9F,KAAjB,IAA0B,MAArE,EAA6E;EAC3E2sB,iBAAU7tB,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEgI,CAAf,IAAoBtJ,GAAGqH,OAAH,CAAWiC,CAAX,CAAasE,SAAb,KAA2B,CAA/C,GAAmD5N,GAAGqH,OAAH,CAAWmlB,SAAX,CAAqBlrB,EAAEkrB,SAAvB,IAAkC,CAA/F;EACD,OAFD,MAEO;EACLqB,iBAAS7tB,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEgI,CAAf,CAAT;EACD;EACDqkB,cAAQlqB,IAAR,CAAanC,EAAEiY,KAAF,CAAQvZ,GAAGG,OAAH,CAAWmJ,CAAnB,CAAb;;EAEA,UAAIwkB,MAAJ;EACA,UAAIC,QAAQ,EAAZ;EACA,UAAI/tB,GAAGG,OAAH,CAAWkG,KAAX,CAAiBnF,KAAjB,IAA0B,SAA1B,IAAuClB,GAAGG,OAAH,CAAWkG,KAAX,CAAiBnF,KAAjB,IAA0B,MAArE,EAA6E;EAC3E4sB,iBAAS9tB,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAE4B,CAAf,IAAoBlD,GAAGqH,OAAH,CAAWnE,CAAX,CAAa0K,SAAb,KAA2B,CAA/C,GAAmD5N,GAAGqH,OAAH,CAAWmlB,SAAX,CAAqBlrB,EAAEkrB,SAAvB,IAAkC,CAA9F;EACA,YAAIkB,QAAQlM,OAAR,CAAgB3R,KAAKme,IAAL,CAAUF,MAAV,CAAhB,MAAuC,CAAC,CAA5C,EAA+C;EAC7CF,iBAAOnqB,IAAP,CAAYoM,KAAKme,IAAL,CAAUF,MAAV,CAAZ;EACA,cAAIG,UAAU,IAAd;EACA,cAAIC,MAAM,CAAV;EACA,eAAK,IAAIjqB,IAAI,CAAb,EAAgBA,IAAI2pB,OAAO/pB,MAA3B,EAAmCI,GAAnC,EAAwC;EACtC,gBAAI2pB,OAAO3pB,CAAP,KAAagqB,OAAjB,EAA0B;EACxBA,wBAAUL,OAAO3pB,CAAP,CAAV;EACAiqB,oBAAM,CAAN;EACD,aAHD,MAGO;EACLA;EACD;;EAEDH,oBAAQA,QAAQG,GAAhB;EACD;EACDJ,mBAASA,SAASC,KAAlB;EACD;EACF,OAlBD,MAkBO;EACLD,iBAAS9tB,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAE4B,CAAf,CAAT;EACA,YAAIwqB,QAAQlM,OAAR,CAAgB3R,KAAKme,IAAL,CAAUF,MAAV,CAAhB,MAAuC,CAAC,CAA5C,EAA+C;EAC7CF,iBAAOnqB,IAAP,CAAYoM,KAAKme,IAAL,CAAUF,MAAV,CAAZ;EACA,cAAIG,UAAU,IAAd;EACA,cAAIC,MAAM,CAAV;EACA,eAAK,IAAIjqB,IAAI,CAAb,EAAgBA,IAAI2pB,OAAO/pB,MAA3B,EAAmCI,GAAnC,EAAwC;EACtC,gBAAI2pB,OAAO3pB,CAAP,KAAagqB,OAAjB,EAA0B;EACxBA,wBAAUL,OAAO3pB,CAAP,CAAV;EACAiqB,oBAAM,CAAN;EACD,aAHD,MAGO;EACLA;EACD;;EAEDH,oBAAQA,QAAQG,GAAhB;EACD;EACDJ,mBAASA,SAASC,KAAlB;EACD;EACF;EACDL,cAAQjqB,IAAR,CAAaoM,KAAKme,IAAL,CAAUF,MAAV,CAAb;;EAEA,UAAIH,QAAQ3c,QAAQ,CAAhB,MAAuB1P,EAAEiY,KAAF,CAAQvZ,GAAGG,OAAH,CAAWmJ,CAAnB,CAA3B,EAAkD;EAChDokB,kBAAU,EAAV;EACAE,iBAAS,EAAT;EACD;;EAED,aAAO,gBAAgBC,SAAS,EAAzB,IAA+B,GAA/B,IAAsCC,SAAS,EAA/C,IAAqD,GAA5D;EACD,KA5DH,EA6DGtrB,IA7DH,CA6DQ,UAASlB,CAAT,EAAY;EAChB,UAAI6sB,UAAU,EAAd;EACAA,iBAAW7sB,EAAE8D,KAAF,GAAW9D,EAAE8D,KAAb,GAAqB,KAAhC;EACA+oB,iBAAW,KAAX;EACAA,iBAAW7sB,EAAEiY,KAAF,CAAQvZ,GAAGG,OAAH,CAAWqsB,SAAnB,IAAgCxsB,GAAGc,KAAH,CAASqB,MAAT,CAAgBb,EAAEiY,KAAF,CAAQvZ,GAAGG,OAAH,CAAWqsB,SAAnB,CAAhB,EAA+CxsB,GAAGG,OAAH,CAAW6P,QAA1D,CAAhC,GAAsG,KAAjH;EACA,aAAOme,OAAP;EACD,KAnEH;;EAqEEnuB,OAAGE,KAAH,CAASU,GAAT,GAAeqL,SAAf,CAAyB,yBAAzB,EACGvM,IADH,CACQM,GAAGkH,KADX,EAEGgF,KAFH,GAEW3I,MAFX,CAEkB,MAFlB,EAGGJ,IAHH,CAGQ,OAHR,EAGiB,wBAHjB,EAIGA,IAJH,CAIQ,WAJR,EAIqB,UAAS7B,CAAT,EAAY0P,KAAZ,EAAmB;EACpC,UAAI6c,MAAJ;EACA,UAAI7tB,GAAGG,OAAH,CAAW6G,KAAX,CAAiB9F,KAAjB,IAA0B,SAA1B,IAAuClB,GAAGG,OAAH,CAAW6G,KAAX,CAAiB9F,KAAjB,IAA0B,MAArE,EAA6E;EAC3E2sB,iBAAU7tB,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEgI,CAAf,IAAoBtJ,GAAGqH,OAAH,CAAWiC,CAAX,CAAasE,SAAb,KAA2B,CAA/C,GAAmD5N,GAAGqH,OAAH,CAAWmlB,SAAX,CAAqBlrB,EAAEkrB,SAAvB,IAAkC,CAA/F;EACD,OAFD,MAGK;EACHqB,iBAAS7tB,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEgI,CAAf,CAAT;EACD;EACD,UAAIwkB,MAAJ;EACA,UAAI9tB,GAAGG,OAAH,CAAWkG,KAAX,CAAiBnF,KAAjB,IAA0B,SAA1B,IAAuClB,GAAGG,OAAH,CAAWkG,KAAX,CAAiBnF,KAAjB,IAA0B,MAArE,EAA6E;EAC3E4sB,iBAAS9tB,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAE4B,CAAf,IAAoBlD,GAAGqH,OAAH,CAAWnE,CAAX,CAAa0K,SAAb,KAA2B,CAA/C,GAAmD5N,GAAGqH,OAAH,CAAWmlB,SAAX,CAAqBlrB,EAAEkrB,SAAvB,IAAkC,CAA9F;EACAsB,iBAAS9c,QAAM,CAAN,KAAY,CAAZ,GAAgB8c,SAAS,EAAzB,GAA8BA,MAAvC;EACD,OAHD,MAIK;EACHA,iBAAS9tB,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAE4B,CAAf,CAAT;EACA4qB,iBAAS9c,QAAM,CAAN,KAAY,CAAZ,GAAgB8c,SAAS,EAAzB,GAA8BA,MAAvC;EACD;EACD,aAAO,gBAAgBD,SAAS,EAAzB,IAA+B,GAA/B,IAAsCC,SAAS,EAA/C,IAAqD,GAA5D;EACD,KAtBH,EAuBGtrB,IAvBH,CAuBQ,UAASlB,CAAT,EAAY;EAChB,UAAI6sB,UAAU,EAAd;EACAA,iBAAW7sB,EAAE8D,KAAF,GAAW9D,EAAE8D,KAAb,GAAqB,KAAhC;EACA+oB,iBAAW,KAAX;EACAA,iBAAW7sB,EAAEiY,KAAF,CAAQjY,EAAE8D,KAAF,GAAU,aAAlB,MAAoC1D,SAApC,GAAgDJ,EAAEiY,KAAF,CAAQjY,EAAE8D,KAAF,GAAU,aAAlB,EAAiC8K,OAAjC,CAAyC,CAAzC,CAAhD,GAA8F,KAAzG;EACA,aAAOie,OAAP;EACD,KA7BH;EA8BA;;;;;;EAMH,GA/GD;;EAiHA7B,UAAQ/jB,IAAR,GAAe,YAAY;EACzB,QAAIvI,KAAK,IAAT;EACA;EACAA,OAAGE,KAAH,CAASU,GAAT,GAAe2K,IAAf,CAAoBvL,GAAG4O,IAAvB;;EAEA;EACA,QAAK5O,GAAGG,OAAH,CAAWwsB,UAAX,KAA0B,QAA/B,EAA0C;EACxC3sB,SAAGE,KAAH,CAASU,GAAT,GAAeqL,SAAf,CAAyB,QAAzB,EACGvM,IADH,CACQM,GAAGkH,KADX,EAEGgF,KAFH,GAEW3I,MAFX,CAEkB,MAFlB,EAGGJ,IAHH,CAGQ,OAHR,EAGiB,QAHjB,EAIGA,IAJH,CAIQ,OAJR,EAIiB,UAAU7B,CAAV,EAAa2C,CAAb,EAAgB;EAC7B;EACA,YAAI6K,KAAMxN,EAAEihB,UAAF,KAAiB7gB,SAAjB,IAA8BJ,EAAEihB,UAAF,CAAazT,EAAb,KAAoBpN,SAAnD,GAAgEJ,EAAEihB,UAAF,CAAazT,EAA7E,GAAkF,KAA3F;EACAA,aAAK9O,GAAGG,OAAH,CAAW2O,EAAX,GAAgB9O,GAAGG,OAAH,CAAW2O,EAA3B,GAAgC,KAArC;EACA,eAAOA,KAAK,aAAaxN,EAAEiY,KAAF,CAAQzK,EAAR,CAAlB,GAAgC,aAAa7K,CAApD;EACD,OATH,EAUGd,IAVH,CAUQ,OAVR,EAUiB,UAAU7B,CAAV,EAAa;EAC1B,eAAOtB,GAAGqH,OAAH,CAAWmlB,SAAX,CAAqBlrB,EAAEkrB,SAAvB,CAAP;EACD,OAZH,EAaGrpB,IAbH,CAaQ,QAbR,EAakB,UAAU7B,CAAV,EAAa;EAC3B,eAAOtB,GAAGqH,OAAH,CAAWmlB,SAAX,CAAqBlrB,EAAEkrB,SAAvB,CAAP;EACD,OAfH,EAgBGrpB,IAhBH,CAgBQ,GAhBR,EAgBa,UAAU7B,CAAV,EAAa;EACtB,YAAItB,GAAGG,OAAH,CAAW6G,KAAX,CAAiB9F,KAAjB,IAA0B,SAA1B,IAAuClB,GAAGG,OAAH,CAAW6G,KAAX,CAAiB9F,KAAjB,IAA0B,MAArE,EAA6E;EAC3E,iBAAOlB,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEgI,CAAf,IAAoBtJ,GAAGqH,OAAH,CAAWiC,CAAX,CAAasE,SAAb,KAA2B,CAA/C,GAAmD5N,GAAGqH,OAAH,CAAWmlB,SAAX,CAAqBlrB,EAAEkrB,SAAvB,IAAkC,CAA5F;EACD,SAFD,MAGK;EACH,iBAAOxsB,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEgI,CAAf,CAAP;EACD;EACF,OAvBH,EAwBGnG,IAxBH,CAwBQ,GAxBR,EAwBa,UAAU7B,CAAV,EAAa;EACtB,YAAItB,GAAGG,OAAH,CAAWkG,KAAX,CAAiBnF,KAAjB,IAA0B,SAA1B,IAAuClB,GAAGG,OAAH,CAAWkG,KAAX,CAAiBnF,KAAjB,IAA0B,MAArE,EAA6E;EAC3E,iBAAOlB,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAE4B,CAAf,IAAoBlD,GAAGqH,OAAH,CAAWnE,CAAX,CAAa0K,SAAb,KAA2B,CAA/C,GAAmD5N,GAAGqH,OAAH,CAAWmlB,SAAX,CAAqBlrB,EAAEkrB,SAAvB,IAAkC,CAA5F;EACD,SAFD,MAGK;EACH,iBAAOxsB,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAE4B,CAAf,CAAP;EACD;EACF,OA/BH,EAgCG1C,KAhCH,CAgCS,MAhCT,EAgCiB,UAAUc,CAAV,EAAa;EAC1B,eAAOmgB,OAAOngB,EAAE8D,KAAT,EAAgBlB,KAAhB,CAAsB,CAAtB,EAAyB,CAAzB,MAAgC,GAAhC,GAAsClE,GAAGqH,OAAH,CAAWjC,KAAX,CAAiB9D,EAAE8D,KAAnB,CAAtC,GAAkE9D,EAAE8D,KAA3E;EACD,OAlCH,EAmCG5E,KAnCH,CAmCS,SAnCT,EAmCoBR,GAAGG,OAAH,CAAW8F,OAAX,KAAuBvE,SAAvB,GAAmC1B,GAAGG,OAAH,CAAW8F,OAA9C,GAAwD,CAnC5E,EAoCGnC,EApCH,CAoCM,WApCN,EAoCmB,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC/B,YAAIjE,GAAGG,OAAH,CAAW+I,MAAX,CAAkB2Y,SAAtB,EAAiC;EAC/B7hB,aAAGG,OAAH,CAAW+I,MAAX,CAAkB2Y,SAAlB,CAA4BtW,IAA5B,CAAiCvL,EAAjC,EAAqCsB,CAArC,EAAwC2C,CAAxC;EACD;EACDjE,WAAG4O,IAAH,CAAQ7K,IAAR,CAAazC,CAAb,EAAgBP,SAAA,CAAU,IAAV,EAAgB4C,IAAhB,EAAhB;EACD,OAzCH,EA0CGG,EA1CH,CA0CM,UA1CN,EA0CkB,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC9B,YAAIjE,GAAGG,OAAH,CAAW+I,MAAX,CAAkB4Y,QAAtB,EAAgC;EAC9B9hB,aAAGG,OAAH,CAAW+I,MAAX,CAAkB4Y,QAAlB,CAA2BvW,IAA3B,CAAgC,IAAhC,EAAsCjK,CAAtC,EAAyC2C,CAAzC;EACD;EACDjE,WAAG4O,IAAH,CAAQ5K,IAAR,CAAa1C,CAAb,EAAgBP,SAAA,CAAU,IAAV,EAAgB4C,IAAhB,EAAhB;EACD,OA/CH,EAgDGG,EAhDH,CAgDM,OAhDN,EAgDe,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC3B,YAAIjE,GAAGG,OAAH,CAAW+I,MAAX,CAAkB+W,cAAtB,EAAsC;EACpCjgB,aAAGG,OAAH,CAAW+I,MAAX,CAAkB+W,cAAlB,CAAiC1U,IAAjC,CAAsC,IAAtC,EAA4CjK,CAA5C,EAA+C2C,CAA/C;EACD;EACF,OApDH;EAqDD;EACD;EAvDA,SAwDK;EACHjE,WAAGE,KAAH,CAASU,GAAT,GAAeqL,SAAf,CAAyB,MAAzB,EACGvM,IADH,CACQM,GAAGkH,KADX;EAEE;EAFF,SAGGgF,KAHH,GAGW3I,MAHX,CAGkB,QAHlB,EAIGJ,IAJH,CAIQ,OAJR,EAIiB,KAJjB,EAKGA,IALH,CAKQ,OALR,EAKiB,UAAU7B,CAAV,EAAa2C,CAAb,EAAgB;EAC7B;EACA,cAAI6K,KAAMxN,EAAEihB,UAAF,KAAiB7gB,SAAjB,IAA8BJ,EAAEihB,UAAF,CAAazT,EAAb,KAAoBpN,SAAnD,GAAgEJ,EAAEihB,UAAF,CAAazT,EAA7E,GAAkF,KAA3F;EACAA,eAAK9O,GAAGG,OAAH,CAAW2O,EAAX,GAAgB9O,GAAGG,OAAH,CAAW2O,EAA3B,GAAgC,KAArC;EACA,iBAAOA,KAAK,aAAaxN,EAAEiY,KAAF,CAAQzK,EAAR,CAAlB,GAAgC,aAAa7K,CAApD;EACD,SAVH,EAWGd,IAXH,CAWQ,GAXR,EAWa,UAAU7B,CAAV,EAAa;EACtB,iBAAOtB,GAAGqH,OAAH,CAAWjB,MAAX,CAAkB9E,EAAE8E,MAApB,CAAP;EACD,SAbH,EAcGjD,IAdH,CAcQ,IAdR,EAcc,UAAU7B,CAAV,EAAa;EACvB,cAAItB,GAAGG,OAAH,CAAW6G,KAAX,CAAiB9F,KAAjB,IAA0B,SAA1B,IAAuClB,GAAGG,OAAH,CAAW6G,KAAX,CAAiB9F,KAAjB,IAA0B,MAArE,EACE,OAAOlB,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEgI,CAAf,IAAoBtJ,GAAGqH,OAAH,CAAWiC,CAAX,CAAasE,SAAb,KAA2B,CAAtD,CADF,KAGE,OAAO5N,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEgI,CAAf,CAAP;;EAEF;;;;EAID,SAxBH,EAyBGnG,IAzBH,CAyBQ,IAzBR,EAyBc,UAAU7B,CAAV,EAAa;EACvB,cAAItB,GAAGG,OAAH,CAAWkG,KAAX,CAAiBnF,KAAjB,IAA0B,SAA1B,IAAuClB,GAAGG,OAAH,CAAWkG,KAAX,CAAiBnF,KAAjB,IAA0B,MAArE,EACE,OAAOlB,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAE4B,CAAf,IAAoBlD,GAAGqH,OAAH,CAAWnE,CAAX,CAAa0K,SAAb,KAA2B,CAAtD,CADF,KAGE,OAAO5N,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAE4B,CAAf,CAAP;;EAEF;;;;EAID,SAnCH,EAoCG1C,KApCH,CAoCS,MApCT,EAoCiB,UAAUc,CAAV,EAAa;EAC1B,iBAAOmgB,OAAOngB,EAAE8D,KAAT,EAAgBlB,KAAhB,CAAsB,CAAtB,EAAyB,CAAzB,MAAgC,GAAhC,GAAsClE,GAAGqH,OAAH,CAAWjC,KAAX,CAAiB9D,EAAE8D,KAAnB,CAAtC,GAAkE9D,EAAE8D,KAA3E;EACD,SAtCH,EAuCG5E,KAvCH,CAuCS,SAvCT,EAuCoBR,GAAGG,OAAH,CAAW8F,OAAX,KAAuBvE,SAAvB,GAAmC1B,GAAGG,OAAH,CAAW8F,OAA9C,GAAwD,CAvC5E,EAwCGnC,EAxCH,CAwCM,WAxCN,EAwCmB,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC/B,cAAIjE,GAAGG,OAAH,CAAW+I,MAAX,CAAkB2Y,SAAtB,EAAiC;EAC/B7hB,eAAGG,OAAH,CAAW+I,MAAX,CAAkB2Y,SAAlB,CAA4BtW,IAA5B,CAAiCvL,EAAjC,EAAqCsB,CAArC,EAAwC2C,CAAxC;EACD;EACDjE,aAAG4O,IAAH,CAAQ7K,IAAR,CAAazC,CAAb,EAAgBP,SAAA,CAAU,IAAV,EAAgB4C,IAAhB,EAAhB;EACD,SA7CH,EA8CGG,EA9CH,CA8CM,UA9CN,EA8CkB,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC9B,cAAIjE,GAAGG,OAAH,CAAW+I,MAAX,CAAkB4Y,QAAtB,EAAgC;EAC9B9hB,eAAGG,OAAH,CAAW+I,MAAX,CAAkB4Y,QAAlB,CAA2BvW,IAA3B,CAAgC,IAAhC,EAAsCjK,CAAtC,EAAyC2C,CAAzC;EACD;EACDjE,aAAG4O,IAAH,CAAQ5K,IAAR,CAAa1C,CAAb,EAAgBP,SAAA,CAAU,IAAV,EAAgB4C,IAAhB,EAAhB;EACD,SAnDH,EAoDGG,EApDH,CAoDM,OApDN,EAoDe,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC3B,cAAIjE,GAAGG,OAAH,CAAW+I,MAAX,CAAkB+W,cAAtB,EAAsC;EACpCjgB,eAAGG,OAAH,CAAW+I,MAAX,CAAkB+W,cAAlB,CAAiC1U,IAAjC,CAAsC,IAAtC,EAA4CjK,CAA5C,EAA+C2C,CAA/C;EACD;EACF,SAxDH;EAyDD;;EAED,QAAIjE,GAAGG,OAAH,CAAWysB,UAAX,KAA0B,IAA9B,EAAoC;EAClC,UAAI7pB,OAAOhC,OAAA,GACRuI,CADQ,CACN,UAAUhI,CAAV,EAAa;EACd,eAAOtB,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEgI,CAAf,CAAP;EACD,OAHQ,EAIRpG,CAJQ,CAIN,UAAU5B,CAAV,EAAa;EACd,eAAOtB,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAEgsB,IAAf,CAAP;EACD,OANQ,CAAX;;EAQAttB,SAAGE,KAAH,CAASU,GAAT,GAAe2C,MAAf,CAAsB,MAAtB,EACGgW,KADH,CACSvZ,GAAGkH,KADZ,EAEG/D,IAFH,CAEQ,OAFR,EAEiB,MAFjB,EAGGA,IAHH,CAGQ,GAHR,EAGaJ,IAHb,EAIGvC,KAJH,CAIS,QAJT,EAImB,mBAJnB;EAKD;;EAED8rB,YAAQ5c,UAAR;;EAEA,WAAO1P,EAAP;EACD,GA7ID;;EA+IAssB,UAAQ1hB,MAAR,GAAiB,UAAUkE,EAAV,EAAc;EAC7B,QAAI9O,KAAK,IAAT;EACA,WAAOA,GAAGE,KAAH,CAASU,GAAT,GAAegK,MAAf,CAAsB,oBAAoBkE,EAA1C,CAAP;EACD,GAHD;;EAKAwd,UAAQrgB,SAAR,GAAoB,UAAU6C,EAAV,EAAc;EAChC,QAAI9O,KAAK,IAAT;EACA,WAAOA,GAAGE,KAAH,CAASU,GAAT,GAAeqL,SAAf,CAAyB,QAAzB,CAAP;EACD,GAHD;;EAKAqgB,UAAQ5nB,IAAR,CAAavF,MAAb;EACA,SAAOmtB,OAAP;EACD;;ECjiBD;;;AAGA,EAAe,oBAAUntB,MAAV,EAAkBqI,MAAlB,EAA0B;;EAEvC;EACA,MAAI4mB,YAAYrmB,OAAO4G,MAAP,CAAcnH,MAAd,CAAhB;;EAEA4mB,YAAU1pB,IAAV,GAAiB,UAAUvF,MAAV,EAAkB;EACjC,QAAIa,KAAK,IAAT;;EAEAA,OAAGG,OAAH,GAAahB,SAASA,MAAT,GAAkB,EAA/B;EACAa,OAAGG,OAAH,CAAWkuB,WAAX,GAAyB,YAAzB;EACAruB,OAAGkH,KAAH,GAAW,EAAX;EACAlH,OAAGqH,OAAH,GAAa,EAAb;EACArH,OAAG4O,IAAH,GAAU5O,GAAGc,KAAH,CAASC,EAAT,CAAYC,GAAZ,GACPmC,IADO,CACF,OADE,EACO,QADP,EAEP0L,SAFO,CAEG,GAFH,EAGP/D,IAHO,CAGF9K,GAAGG,OAAH,CAAWa,GAAX,IAAkB,UAAUM,CAAV,EAAa;EACnC,UAAIwJ,OAAO,OAAX;EACAA,cAAQ,WAAWxJ,EAAEtB,GAAGG,OAAH,CAAWmuB,QAAb,CAAX,GAAoC,SAA5C;EACAxjB,cAAQ,gBAAgB9K,GAAGc,KAAH,CAASqB,MAAT,CAAgBb,EAAEtB,GAAGG,OAAH,CAAWiC,KAAb,CAAhB,EAAqC,CAArC,CAAhB,GAA0D,SAAlE;EACA0I,cAAQ,QAAR;EACA,aAAOA,IAAP;EACD,KATO,CAAV;EAWD,GAlBD;;EAqBA;EACA;EACAsjB,YAAUtf,EAAV,GAAe,UAAUC,UAAV,EAAsB;EACnC,QAAI/O,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAW2O,EAAX,GAAgBC,UAAhB;EACA,WAAO/O,EAAP;EACD,GAJD;;EAMAouB,YAAUE,QAAV,GAAqB,UAAUvf,UAAV,EAAsB;EACzC,QAAI/O,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWmuB,QAAX,GAAsBvf,UAAtB;EACA,WAAO/O,EAAP;EACD,GAJD;;EAMAouB,YAAUhsB,KAAV,GAAkB,UAAU2M,UAAV,EAAsB;EACtC,QAAI/O,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWiC,KAAX,GAAmB2M,UAAnB;EACA,WAAO/O,EAAP;EACD,GAJD;;EAMAouB,YAAUC,WAAV,GAAwB,UAAUA,WAAV,EAAuB;EAC7C,QAAIruB,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWkuB,WAAX,GAAyBA,WAAzB;EACA,WAAOruB,EAAP;EACD,GAJD;;EAMA;;;;EAIAouB,YAAU5sB,OAAV,GAAoB,UAAUuN,UAAV,EAAsB;EACxC,QAAI/O,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWqB,OAAX,GAAqBuN,UAArB;EACA,WAAO/O,EAAP;EACD,GAJD;;EAMA;;;;EAIAouB,YAAUnf,IAAV,GAAiB,UAAUF,UAAV,EAAsB;EACrC,QAAI/O,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAW8O,IAAX,GAAkBF,UAAlB;EACA,WAAO/O,EAAP;EACD,GAJD;;EAMA;;;;EAIAouB,YAAUlf,MAAV,GAAmB,UAAUA,MAAV,EAAkB;EACnC,QAAIlP,KAAK,IAAT;EACA,QAAI6B,MAAMC,OAAN,CAAcoN,MAAd,CAAJ,EAA2B;EACzB;EACAlP,SAAGG,OAAH,CAAW+O,MAAX,GAAoBA,MAApB;EACD,KAHD,MAGO;EACL;EACAlP,SAAGqH,OAAH,CAAWjC,KAAX,GAAmB8J,MAAnB;EACD;EACD,WAAOlP,EAAP;EACD,GAVD;;EAYAouB,YAAUjf,MAAV,GAAmB,UAAUC,MAAV,EAAkB;EACnC;EACA;EACA,QAAIpP,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWgP,MAAX,GAAoBC,MAApB;EACA,WAAOpP,EAAP;EACD,GAND;;EAQAouB,YAAUjsB,MAAV,GAAmB,UAAUA,MAAV,EAAkB;EACnC,QAAInC,KAAK,IAAT;EACA,QAAI,OAAOmC,MAAP,IAAiB,UAAjB,IAA+BA,kBAAkBkN,QAArD,EACErP,GAAGc,KAAH,CAASqB,MAAT,GAAkBA,MAAlB,CADF,KAGEnC,GAAGc,KAAH,CAASqB,MAAT,GAAkBpB,SAAA,CAAUoB,MAAV,CAAlB;EACF,WAAOnC,EAAP;EACD,GAPD;;EASAouB,YAAUptB,GAAV,GAAgB,UAAUA,GAAV,EAAe;EAC7B,QAAIhB,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWa,GAAX,GAAiBA,GAAjB;EACA,WAAOhB,EAAP;EACD,GAJD;;EAMAouB,YAAUtoB,MAAV,GAAmB,UAAUA,MAAV,EAAkB;EACnC,QAAI9F,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAW2F,MAAX,GAAoBA,MAApB;EACA,WAAO9F,EAAP;EACD,GAJD;;EAOA;EACA;EACAouB,YAAU1uB,IAAV,GAAiB,UAAUA,IAAV,EAAgB;EAC/B,QAAIM,KAAK,IAAT;;EAEA,QAAIA,GAAGG,OAAH,CAAWmP,MAAf,EAAuB;EACrB;EACA5P,aAAOA,KAAK4P,MAAL,CAAYtP,GAAGG,OAAH,CAAWmP,MAAvB,CAAP;EACD;EACD;EACA,QAAItP,GAAGG,OAAH,CAAWgP,MAAf,EAAuB;EACrB,UAAInP,GAAGG,OAAH,CAAWgP,MAAX,CAAkBmf,QAAtB,EAAgC;EAC9B5uB,eAAOA,KAAK6O,IAAL,CAAU,UAAUnK,CAAV,EAAaC,CAAb,EAAgB;EAC/B,iBAAOrE,GAAGG,OAAH,CAAWgP,MAAX,CAAkBmf,QAAlB,KAA+B,MAA/B,GAAwCtuB,GAAGc,KAAH,CAAS0D,cAAT,CAAwBJ,EAAEpE,GAAGG,OAAH,CAAWmuB,QAAb,CAAxB,EAAgDjqB,EAAErE,GAAGG,OAAH,CAAWmuB,QAAb,CAAhD,CAAxC,GAAkHtuB,GAAGc,KAAH,CAASqD,aAAT,CAAuBC,EAAEpE,GAAGG,OAAH,CAAWmuB,QAAb,CAAvB,EAA+CjqB,EAAErE,GAAGG,OAAH,CAAWmuB,QAAb,CAA/C,CAAzH;EACD,SAFM,CAAP;EAGD;EACD,UAAItuB,GAAGG,OAAH,CAAWgP,MAAX,CAAkB/M,KAAtB,EAA6B;EAC3B1C,eAAOA,KAAK6O,IAAL,CAAU,UAAUnK,CAAV,EAAaC,CAAb,EAAgB;EAC/B,iBAAOrE,GAAGG,OAAH,CAAWgP,MAAX,CAAkB/M,KAAlB,KAA4B,MAA5B,GAAqCpC,GAAGc,KAAH,CAAS0D,cAAT,CAAwBJ,EAAEpE,GAAGG,OAAH,CAAWiC,KAAb,CAAxB,EAA6CiC,EAAErE,GAAGG,OAAH,CAAWiC,KAAb,CAA7C,CAArC,GAAyGpC,GAAGc,KAAH,CAASqD,aAAT,CAAuBC,EAAEpE,GAAGG,OAAH,CAAWiC,KAAb,CAAvB,EAA4CiC,EAAErE,GAAGG,OAAH,CAAWiC,KAAb,CAA5C,CAAhH;EACD,SAFM,CAAP;EAGD;EACF,KAXD,MAWO;EACL1C,aAAOA,KAAK6O,IAAL,CAAU,UAAUnK,CAAV,EAAaC,CAAb,EAAgB;EAC/B,eAAOrE,GAAGc,KAAH,CAASqD,aAAT,CAAuBC,EAAEpE,GAAGG,OAAH,CAAWmuB,QAAb,CAAvB,EAA+CjqB,EAAErE,GAAGG,OAAH,CAAWmuB,QAAb,CAA/C,CAAP;EACD,OAFM,CAAP;EAGD;;EAED,QAAI5c,QAAQ,CAAZ;EACA1R,OAAGkH,KAAH,GAAWxH,KAAKI,GAAL,CAAS,UAASwB,CAAT,EAAY;EAC9BA,QAAEitB,EAAF,GAAO7c,KAAP;EACApQ,QAAEktB,EAAF,GAAO9c,QAAQpQ,EAAEtB,GAAGG,OAAH,CAAWiC,KAAb,CAAf;EACAsP,eAAS,CAACpQ,EAAEtB,GAAGG,OAAH,CAAWiC,KAAb,CAAV;EACA,UAAIpC,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,SAA1B,KAAwCtJ,MAAMC,OAAN,CAAc9B,GAAGG,OAAH,CAAWqB,OAAzB,CAAxC,IAA6ExB,GAAGG,OAAH,CAAWqB,OAAX,CAAmBqC,MAAnB,GAA4B,CAA7G,EAAgH;EAC9GvC,UAAEmtB,WAAF,GAAgB1tB,QAAA,GAAW+M,IAAX,CAAgB9N,GAAGG,OAAH,CAAWqB,OAA3B,EAAoC,CAACF,CAAD,CAApC,CAAhB;EACAA,UAAEotB,aAAF,GAAkB3tB,MAAA,CAAOO,EAAEmtB,WAAT,EAAsB,UAASE,KAAT,EAAgB;EACtD,iBAAOA,MAAM,CAAN,EAAS,CAAT,IAAcA,MAAM,CAAN,EAAS,CAAT,CAArB;EACD,SAFiB,CAAlB;EAGD;EACD,aAAOrtB,CAAP;EACD,KAXU,CAAX;;EAaA,QAAItB,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,WAA1B,CAAJ,EAA4C;EAC1CnL,SAAGuP,UAAH,GAAgBvP,GAAGoR,YAAH,CAAgB1R,IAAhB,CAAhB;EACAM,SAAGyP,OAAH,GAAa1O,SAAA,CAAUrB,IAAV,EAAgB,UAAU4B,CAAV,EAAa;EACxC,eAAO,CAACA,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb,CAAR;EACD,OAFY,CAAb;EAGD;;EAED,WAAOjP,EAAP;EACD,GA/CD;;EAiDAouB,YAAU3lB,MAAV,GAAmB,YAAY;EAC7B,QAAIzI,KAAK,IAAT;EACA,QAAIb,MAAJ;EACA;EACA;;;;;;;EAOA;EACA,QAAIa,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,UAA1B,KAAyCnL,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,OAA1B,CAA7C,EAAiF;EAC/EhM,eAAS;EACPoC,gBAAQ,IADD;EAEPI,cAAM,QAFC;EAGPP,eAAO,CAAC,CAAD,EAAIpB,GAAGE,KAAH,CAASE,KAAb,CAHA;EAIPwB,iBAAS;EAJF,OAAT;EAMA5B,SAAGqH,OAAH,CAAWiC,CAAX,GAAetJ,GAAGc,KAAH,CAASG,aAAT,CAAuBjB,GAAGkH,KAA1B,EAAiC/H,MAAjC,CAAf;;EAEAA,eAAS;EACPoC,gBAAQvB,GAAGG,OAAH,CAAWiC,KADZ;EAEPT,cAAM,QAFC;EAGPP,eAAO,CAACpB,GAAGE,KAAH,CAASI,MAAV,EAAkB,CAAlB,CAHA;EAIPsB,iBAAS;EAJF,OAAT;EAMA5B,SAAGqH,OAAH,CAAWnE,CAAX,GAAelD,GAAGc,KAAH,CAASG,aAAT,CAAuBjB,GAAGkH,KAA1B,EAAiC/H,MAAjC,CAAf;EACD;;EAGD;EACA,QAAIa,GAAGG,OAAH,CAAWkuB,WAAX,KAA2B,YAA3B,IAA2CruB,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,SAA1B,CAA/C,EAAqF;EACnF;EACAhM,eAAS;EACPoC,gBAAQ,IADD;EAEPI,cAAM,QAFC;EAGPP,eAAO,CAAC,CAAD,EAAIpB,GAAGE,KAAH,CAASE,KAAb,CAHA;EAIPwB,iBAAS;EAJF,OAAT;EAMA5B,SAAGqH,OAAH,CAAWiC,CAAX,GAAetJ,GAAGc,KAAH,CAASG,aAAT,CAAuBjB,GAAGkH,KAA1B,EAAiC/H,MAAjC,CAAf;;EAEA;EACAA,eAAS;EACPoC,gBAAQ,EADD;EAEPI,cAAM,QAFC;EAGPP,eAAO,CAACpB,GAAGE,KAAH,CAASI,MAAV,EAAkB,CAAlB,CAHA;EAIPsB,iBAAS;EAJF,OAAT;EAMA5B,SAAGqH,OAAH,CAAWnE,CAAX,GAAenC,cAAA,GAAiBK,KAAjB,CAAuBjC,OAAOiC,KAA9B,EAAqCY,MAArC,CAA4C,CAAC,CAAD,EAAI,CAAJ,CAA5C,CAAf;EACD;;EAED;EACA,QAAIhC,GAAGG,OAAH,CAAWkuB,WAAX,KAA2B,UAA3B,IAAyCruB,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,SAA1B,CAA7C,EAAmF;EACjF;EACAhM,eAAS;EACPoC,gBAAQ,EADD;EAEPqtB,cAAM,QAFC;EAGPxtB,eAAO,CAACpB,GAAGE,KAAH,CAASI,MAAV,EAAkB,CAAlB,CAHA;EAIPsB,iBAAS;EAJF,OAAT;EAMA5B,SAAGqH,OAAH,CAAWiC,CAAX,GAAevI,cAAA,GAAiBK,KAAjB,CAAuBjC,OAAOiC,KAA9B,EAAqCY,MAArC,CAA4C,CAAC,CAAD,EAAI,CAAJ,CAA5C,CAAf;;EAEA;EACA7C,eAAS;EACPoC,gBAAQvB,GAAGG,OAAH,CAAWiC,KADZ;EAEPT,cAAM,QAFC;EAGPP,eAAO,CAAC,CAAD,EAAIpB,GAAGE,KAAH,CAASE,KAAb,CAHA;EAIPwB,iBAAS;EAJF,OAAT;EAMA5B,SAAGqH,OAAH,CAAWnE,CAAX,GAAelD,GAAGc,KAAH,CAASG,aAAT,CAAuBjB,GAAGkH,KAA1B,EAAiC/H,MAAjC,CAAf;EAED;EACD;EACA;;EAEA,QAAIa,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,QAA1B,CAAJ,EACEnL,GAAGqH,OAAH,CAAWjC,KAAX,GAAmBrE,eAAA,CAAgBf,GAAGG,OAAH,CAAW+O,MAA3B,CAAnB,CADF,KAGElP,GAAGqH,OAAH,CAAWjC,KAAX,GAAmBrE,eAAA,CAAgBA,mBAAhB,CAAnB;;EAEF,WAAOf,EAAP;EACD,GAlFD;;EAoFAouB,YAAU1e,UAAV,GAAuB,YAAW;EAChC,QAAI1P,KAAK,IAAT;;EAEA,QAAI6uB,SAAS7uB,GAAGE,KAAH,CAASU,GAAT,GAAeqL,SAAf,CAAyB,WAAzB,CAAb;EACA4iB,WAAOnsB,IAAP,CAAY,UAASqO,GAAT,EAAc;EACxB,UAAID,KAAK,IAAT;EACAC,UAAI0d,WAAJ,CAAgBhkB,OAAhB,CAAwB,UAASqkB,EAAT,EAAa;;EAEnC,YAAIC,QAAQ/uB,GAAGqH,OAAH,CAAWiC,CAAX,CAAawlB,GAAG,CAAH,EAAMpvB,IAAN,CAAWM,GAAGG,OAAH,CAAWiC,KAAtB,CAAb,CAAZ;EACA,YAAI4sB,QAAQhvB,GAAGqH,OAAH,CAAWnE,CAAX,CAAc4rB,GAAG,CAAH,EAAM,CAAN,IAAWA,GAAG,CAAH,EAAMpvB,IAAN,CAAWgvB,aAApC,IAAsD1uB,GAAGqH,OAAH,CAAWnE,CAAX,CAAa4rB,GAAG,CAAH,EAAM,CAAN,IAAWA,GAAG,CAAH,EAAMpvB,IAAN,CAAWgvB,aAAnC,CAAlE;;EAEA,YAAIM,QAAQ,EAAZ,EAAgB;EACdjuB,mBAAA,CAAU+P,EAAV,EAAcvN,MAAd,CAAqB,MAArB,EACGJ,IADH,CACQ,OADR,EACiB,YADjB,EAEGA,IAFH,CAEQ,WAFR,EAEqB,YAAW;EAC5B,mBAAO,gBAAgBnD,GAAGqH,OAAH,CAAWiC,CAAX,CAAawlB,GAAG,CAAH,EAAMpvB,IAAN,CAAW6uB,EAAxB,IAA8BQ,QAAM,CAApD,IAAyD,GAAzD,IAAgED,GAAG,CAAH,EAAM,CAAN,IAAW9uB,GAAGqH,OAAH,CAAWnE,CAAX,CAAa4rB,GAAG,CAAH,EAAM,CAAN,IAAWA,GAAG,CAAH,EAAMpvB,IAAN,CAAWgvB,aAAnC,IAAoD,EAA/D,GAAoE1uB,GAAGqH,OAAH,CAAWnE,CAAX,CAAa,CAAb,IAAkB,EAAtJ,IAA4J,GAAnK;EACD,WAJH,EAKGV,IALH,CAKQ,YAAW;EACf,mBAAOssB,GAAG5d,GAAV;EACD,WAPH;;EASA;;;;;;;;;;EAUAnQ,mBAAA,CAAU+P,EAAV,EAAcvN,MAAd,CAAqB,MAArB,EACGJ,IADH,CACQ,OADR,EACiB,YADjB,EAEGA,IAFH,CAEQ,WAFR,EAEqB,YAAW;EAC5B,mBAAO,gBAAgBnD,GAAGqH,OAAH,CAAWiC,CAAX,CAAawlB,GAAG,CAAH,EAAMpvB,IAAN,CAAW6uB,EAAxB,IAA8BQ,QAAM,CAApD,IAAyD,GAAzD,IAAgED,GAAG,CAAH,EAAM,CAAN,IAAW9uB,GAAGqH,OAAH,CAAWnE,CAAX,CAAa4rB,GAAG,CAAH,EAAM,CAAN,IAAWA,GAAG,CAAH,EAAMpvB,IAAN,CAAWgvB,aAAnC,IAAoD,EAA/D,GAAoE1uB,GAAGqH,OAAH,CAAWnE,CAAX,CAAa,CAAb,IAAkB,EAAtJ,IAA4J,GAAnK;EACD,WAJH,EAKGV,IALH,CAKQ,UAASlB,CAAT,EAAY;EAChB,mBAAOA,EAAEwtB,GAAG5d,GAAL,IAAYlR,GAAGc,KAAH,CAASqB,MAAT,CAAgBb,EAAEwtB,GAAG5d,GAAL,CAAhB,EAA2B,CAA3B,CAAZ,GAA4C,EAAnD;EACD,WAPH;;EASA;EACAnQ,mBAAA,CAAU+P,EAAV,EAAcvN,MAAd,CAAqB,MAArB,EACGJ,IADH,CACQ,OADR,EACiB,wBADjB,EAEGA,IAFH,CAEQ,WAFR,EAEqB,YAAW;EAC5B,mBAAO,gBAAgBnD,GAAGqH,OAAH,CAAWiC,CAAX,CAAawlB,GAAG,CAAH,EAAMpvB,IAAN,CAAW6uB,EAAxB,IAA8BQ,QAAM,CAApD,IAAyD,GAAzD,IAAgED,GAAG,CAAH,EAAM,CAAN,IAAW9uB,GAAGqH,OAAH,CAAWnE,CAAX,CAAa4rB,GAAG,CAAH,EAAM,CAAN,IAAWA,GAAG,CAAH,EAAMpvB,IAAN,CAAWgvB,aAAnC,IAAoD,EAA/D,GAAoE1uB,GAAGqH,OAAH,CAAWnE,CAAX,CAAa,CAAb,IAAkB,EAAtJ,IAA4J,GAAnK;EACD,WAJH,EAKGV,IALH,CAKQ,UAASlB,CAAT,EAAY;EAChB,mBAAOA,EAAEwtB,GAAG5d,GAAH,GAAS,aAAX,IAA4B,MAAM5P,EAAEwtB,GAAG5d,GAAH,GAAS,aAAX,EAA0BhB,OAA1B,CAAkC,CAAlC,CAAN,GAA6C,GAAzE,GAA+E,EAAtF;EACD,WAPH;EAQD;EACF,OA5CD;EA6CD,KA/CD;EAgDD,GApDD;;EAsDAke,YAAU7lB,IAAV,GAAiB,YAAW;EAC1B,QAAIvI,KAAK,IAAT;EACA,QAAIA,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,SAA1B,CAAJ,EAA0C;EACxC,UAAInL,GAAGG,OAAH,CAAWkuB,WAAX,KAA2B,YAA/B,EAA6CruB,GAAGqQ,iBAAH;EAC7C,UAAIrQ,GAAGG,OAAH,CAAWkuB,WAAX,KAA2B,UAA/B,EAA2CruB,GAAGsQ,iBAAH;EAC3C,aAAOtQ,EAAP;EACD;;EAEDA,OAAGE,KAAH,CAASU,GAAT,GAAe2K,IAAf,CAAoBvL,GAAG4O,IAAvB;;EAEA,QAAMnC,UAAUzM,GAAGc,KAAH,CAASC,EAAT,CAAYC,GAAZ,GACbmC,IADa,CACR,OADQ,EACC,WADD,EAEb2H,IAFa,CAER,aAAK;EACT,aAAOxJ,EAAEtB,GAAGG,OAAH,CAAWmuB,QAAb,CAAP;EACD,KAJa,CAAhB;EAKAtuB,OAAGE,KAAH,CAASU,GAAT,GAAe2K,IAAf,CAAoBkB,OAApB;;EAEA,QAAIzM,GAAGG,OAAH,CAAWkuB,WAAX,KAA2B,YAA/B,EAA6C;;EAE3C;;;EAGA,UAAIY,OAAO,EAAX;EACAjvB,SAAG2hB,QAAH,GAAc3hB,GAAGE,KAAH,CAASU,GAAT,GAAe2C,MAAf,CAAsB,GAAtB,EACXJ,IADW,CACN,OADM,EACG,QADH,EAEXA,IAFW,CAEN,WAFM,EAEO,kBAAkBnD,GAAGE,KAAH,CAASI,MAAT,GAAkB,EAApC,IAA0C,GAFjD,EAGX2L,SAHW,CAGD,OAHC,EAIXvM,IAJW,CAINM,GAAGkH,KAJG,EAKXgF,KALW,GAMX3I,MANW,CAMJ,GANI,EAOXJ,IAPW,CAON,OAPM,EAOG,MAPH,EAQXA,IARW,CAQN,WARM,EAQO,aAAK;EACtB,YAAMmG,IAAItJ,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEitB,EAAf,IAAsBvuB,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEktB,EAAF,GAAOltB,EAAEitB,EAAtB,IAA4B,CAA5D;EACAU,aAAKxrB,IAAL,CAAU6F,CAAV;EACA,eAAO,eAAeA,CAAf,GAAmB,MAA1B;EACD,OAZW,EAaX/F,MAbW,CAaJ,MAbI,EAcXJ,IAdW,CAcN,aAdM,EAcS,QAdT,EAeXX,IAfW,CAeN,UAASlB,CAAT,EAAY;EAChB,eAAOA,EAAEtB,GAAGG,OAAH,CAAWmuB,QAAb,CAAP;EACD,OAjBW,CAAd;;EAmBA,UAAI1M,gBAAgB7gB,MAAA,CAAOf,GAAGkH,KAAV,EAAiB,UAAU5F,CAAV,EAAa;EAChD,eAAO,CAACtB,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEktB,EAAf,IAAqBxuB,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEitB,EAAf,CAAtB,IAA4C,GAAnD;EACD,OAFmB,CAApB;EAGA,UAAMW,oBAAoBnuB,MAAA,CAAOf,GAAG2hB,QAAH,CAAYjU,KAAZ,EAAP,EAA4B,UAAU/J,IAAV,EAAgB;EACpE,eAAOA,KAAKC,qBAAL,EAAP;EACD,OAFyB,CAA1B;AAGA;EAEA5D,SAAG2hB,QAAH,CAAYjf,IAAZ,CAAiB,UAAUpB,CAAV,EAAa0P,KAAb,EAAoBF,EAApB,EAAwB;EAAA;;EACvC;EACA;EACA,YAAIoe,oBAAqBtN,gBAAgB,CAAzC,EAA6C;EAC3C7gB,mBAAA,CAAU,IAAV,EAAgBwK,IAAhB,CAAqBvL,GAAGc,KAAH,CAASyB,IAA9B,EAAoCqf,aAApC,EAAmDnV,OAAnD;EACD,SAFD,MAEO;EACL1L,mBAAA,CAAU,IAAV,EACGoC,IADH,CACQ,aADR,EACuB,KADvB,EAEGA,IAFH,CAEQ,IAFR,EAEc,CAFd,EAGGA,IAHH,CAGQ,WAHR,EAGqB,4BAHrB;EAIA,cAAIgsB,mBAAmBnvB,GAAGG,OAAH,CAAWyE,IAAX,CAAgBC,MAAhB,CAAuBI,MAAvB,GAAgC,GAAvD;EACA,cAAI,KAAKrB,qBAAL,KAA+BurB,gBAAnC,EAAqD;EAAA;EACnDpuB,uBAAA,QACG+C,EADH,CACM,WADN,EACmB2I,QAAQ1I,IAD3B,EAEGD,EAFH,CAEM,UAFN,EAEkB2I,QAAQzI,IAF1B;EAGA,kBAAIC,IAAI,CAAR;EACA,qBAAO,MAAKL,qBAAL,KAA+BurB,gBAAtC,EAAwD;EACtDpuB,yBAAA,QAAgByB,IAAhB,CAAqB,UAAUlB,CAAV,EAAa;EAChC,yBAAO,CAACA,EAAEtB,GAAGG,OAAH,CAAWmuB,QAAb,IAAyB,EAA1B,EAA8BpqB,KAA9B,CAAoC,CAApC,EAAuC,CAACD,CAAxC,IAA6C,KAApD;EACD,iBAFD,EAEGd,IAFH,CAEQ,OAFR,EAEiB7B,CAFjB;EAGA,kBAAE2C,CAAF;EACD;EAVkD;EAWpD;EACF;;EAED,YAAImrB,WAAW9X,OAAO+X,gBAAP,CAAwB,IAAxB,EAA8B,IAA9B,EAAoCC,gBAApC,CAAqD,WAArD,CAAf;EACA,YAAIC,UAAUjrB,OAAO8qB,SAASI,OAAT,CAAiB,KAAjB,EAAuB,EAAvB,CAAP,CAAd;;EAEA,YAAIxe,UAAU,CAAV,IAAeA,UAAUhR,GAAGkH,KAAH,CAASrD,MAAT,GAAkB,CAA/C,EAAkD;EAChD,cAAI4rB,WAAWR,KAAKje,KAAL,IAAcie,KAAKje,QAAQ,CAAb,CAA7B;EACA,cAAI0e,WAAWT,KAAKje,QAAQ,CAAb,IAAkBie,KAAKje,KAAL,CAAjC;;EAEA,cAAI2e,eAAeruB,EAAEc,KAAF,GAAUpC,GAAGkH,KAAH,CAAS8J,QAAQ,CAAjB,EAAoB5O,KAAjD;EACA,cAAIwtB,eAAetuB,EAAEc,KAAF,GAAUpC,GAAGkH,KAAH,CAAS8J,QAAQ,CAAjB,EAAoB5O,KAAjD;;EAEA,cAAIqtB,WAAWF,UAAU,CAArB,IAA0BG,WAAWH,UAAU,CAAnD,EAAsD;EACpD,gBAAII,gBAAgBC,YAApB,EAAkC;EAChC7uB,uBAAA,CAAU,IAAV,EAAgB8J,MAAhB;AACAglB,EACD;EACF;EACF;EACF,OA1CD;;EA6CA7vB,SAAGE,KAAH,CAASU,GAAT,GAAeqL,SAAf,CAAyB,MAAzB,EACGvM,IADH,CACQM,GAAGkH,KADX,EAEGgF,KAFH,GAEW3I,MAFX,CAEkB,MAFlB,EAGGJ,IAHH,CAGQ,OAHR,EAGiB,KAHjB,EAIGA,IAJH,CAIQ,IAJR,EAIc,UAAC7B,CAAD,EAAI2C,CAAJ,EAAU;EACpB,YAAI6K,KAAK,eAAe7K,CAAxB;EACA,YAAIjE,GAAGG,OAAH,CAAW2O,EAAf,EAAmB;EACjBA,eAAK,eAAexN,EAAEtB,GAAGG,OAAH,CAAW2O,EAAb,CAApB;EACD;EACD,eAAOA,EAAP;EACD,OAVH,EAWG3L,IAXH,CAWQ,GAXR,EAWa,UAAC7B,CAAD;EAAA,eAAOtB,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEitB,EAAf,CAAP;EAAA,OAXb,EAYGprB,IAZH,CAYQ,GAZR,EAYa,CAZb,EAaGA,IAbH,CAaQ,OAbR,EAaiB;EAAA,eAAKnD,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEtB,GAAGG,OAAH,CAAWiC,KAAb,CAAb,CAAL;EAAA,OAbjB,EAcGe,IAdH,CAcQ,QAdR,EAckBnD,GAAGE,KAAH,CAASI,MAAT,GAAkBN,GAAGE,KAAH,CAASI,MAA3B,GAAoC,GAdtD,EAeG6C,IAfH,CAeQ,MAfR,EAegB,UAAC7B,CAAD,EAAO;EACnB,eAAOtB,GAAGqH,OAAH,CAAWjC,KAAX,KAAqB,KAArB,GAA6BpF,GAAGqH,OAAH,CAAWjC,KAAX,CAAiB9D,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb,CAAjB,CAA7B,GAAoEjP,GAAGuQ,iBAAH,CAAqBjP,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb,CAArB,EAAyC,SAAzC,CAA3E;EACD,OAjBH,EAkBG9L,IAlBH,CAkBQ,QAlBR,EAkBkB,OAlBlB,EAmBGA,IAnBH,CAmBQ,cAnBR,EAmBwB,CAnBxB,EAoBG3C,KApBH,CAoBS,SApBT,EAoBoB,GApBpB,EAqBGsD,EArBH,CAqBM,WArBN,EAqBmB,UAASxC,CAAT,EAAY2C,CAAZ,EAAe;EAC9B,YAAIjE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,WAA1B,KAA0CnL,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBrF,cAArB,CAAoC,eAApC,CAA9C,EAAoG;EAAE;EACpGpK,mBAAA,CAAU,IAAV,EAAgBoC,IAAhB,CAAqB,MAArB,EAA6B,UAAU7B,CAAV,EAAa;EACxC,mBAAOtB,GAAGuQ,iBAAH,CAAqBjP,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb,CAArB,EAAyC,SAAzC,CAAP;EACD,WAFD;EAGD;EACDjP,WAAG4O,IAAH,CAAQ7K,IAAR,CAAazC,CAAb,EAAgBP,SAAA,CAAU,IAAV,EAAgB4C,IAAhB,EAAhB;;EAEA,YAAI3D,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,aAA1B,CAAJ,EAA8C;EAAE;EAC9CnL,aAAGG,OAAH,CAAWsQ,WAAX,CAAuBlF,IAAvB,CAA4B,IAA5B,EAAkCjK,CAAlC,EAAqC2C,CAArC;EACD;EAEF,OAjCH,EAkCGH,EAlCH,CAkCM,UAlCN,EAkCkB,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC9B,YAAIjE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,WAA1B,KAA0CnL,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBrF,cAArB,CAAoC,eAApC,CAA9C,EAAoG;EAAE;EACpGpK,mBAAA,CAAU,IAAV,EAAgBoC,IAAhB,CAAqB,MAArB,EAA6B,UAAU7B,CAAV,EAAa;EACxC,mBAAOtB,GAAGuQ,iBAAH,CAAqBjP,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb,CAArB,EAAyC,SAAzC,CAAP;EACD,WAFD;EAGD;EACDjP,WAAG4O,IAAH,CAAQ5K,IAAR;;EAEA,YAAIhE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,YAA1B,CAAJ,EAA6C;EAAE;EAC7CnL,aAAGG,OAAH,CAAWuQ,UAAX,CAAsBnF,IAAtB,CAA2B,IAA3B,EAAiCjK,CAAjC,EAAoC2C,CAApC;EACD;EACF,OA7CH,EA8CGH,EA9CH,CA8CM,OA9CN,EA8Ce,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC3B,YAAIjE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,OAA1B,CAAJ,EAAwC;EACtCnL,aAAGG,OAAH,CAAWwQ,OAAX,CAAmBpF,IAAnB,CAAwB,IAAxB,EAA8BjK,CAA9B,EAAiC2C,CAAjC;EACD;EACF,OAlDH;EAmDD;EACD,WAAOjE,EAAP;EACD,GApJD;;EAuJA;EACA;;;EAGAouB,YAAU/d,iBAAV,GAA8B,YAAY;EACxC,QAAIrQ,KAAK,IAAT;EACAA,OAAG4O,IAAH,CAAQ9D,IAAR,CAAa9K,GAAGG,OAAH,CAAWa,GAAX,IAAkB,UAAUM,CAAV,EAAa;EAC1C,UAAIwuB,MAAM,EAAV;EACAA,aAAO,WAAWxuB,EAAE4P,GAAb,GAAmB,SAA1B;EACA,UAAI5P,EAAE4P,GAAF,KAAU5P,EAAE,CAAF,EAAK5B,IAAL,CAAUM,GAAGG,OAAH,CAAWmuB,QAArB,CAAd,EAA8C;EAC5CwB,eAAO,eAAe9vB,GAAGc,KAAH,CAASqB,MAAT,CAAgBb,EAAE,CAAF,EAAK5B,IAAL,CAAU4B,EAAE4P,GAAZ,CAAhB,EAAkC,CAAlC,CAAf,GAAsD,SAA7D;EACA4e,eAAO,eAAexuB,EAAE,CAAF,EAAK5B,IAAL,CAAUM,GAAGG,OAAH,CAAWmuB,QAArB,CAAf,GAAgD,SAAvD;EACAwB,eAAO,eAAe9vB,GAAGc,KAAH,CAASqB,MAAT,CAAgBb,EAAE,CAAF,EAAK5B,IAAL,CAAUM,GAAGG,OAAH,CAAWiC,KAArB,CAAhB,EAA6C,CAA7C,CAAf,GAAiE,SAAxE;EACD,OAJD,MAIO;EACL0tB,eAAO,eAAe9vB,GAAGc,KAAH,CAASqB,MAAT,CAAgBb,EAAE,CAAF,EAAK5B,IAAL,CAAU4B,EAAE4P,GAAZ,CAAhB,EAAkC,CAAlC,CAAf,GAAsD,SAA7D;EACD;EACD,aAAO4e,GAAP;EACD,KAXD;EAYA9vB,OAAGE,KAAH,CAASU,GAAT,GAAe2K,IAAf,CAAoBvL,GAAG4O,IAAvB;;EAEA,QAAMnC,UAAUzM,GAAGc,KAAH,CAASC,EAAT,CAAYC,GAAZ,GACbmC,IADa,CACR,OADQ,EACC,WADD,EAEb2H,IAFa,CAER,aAAK;EACT,aAAOxJ,EAAEtB,GAAGG,OAAH,CAAWmuB,QAAb,CAAP;EACD,KAJa,CAAhB;EAKAtuB,OAAGE,KAAH,CAASU,GAAT,GAAe2K,IAAf,CAAoBkB,OAApB;;EAEA;;;EAGAzM,OAAG2hB,QAAH,GAAc3hB,GAAGE,KAAH,CAASU,GAAT,GAAe2C,MAAf,CAAsB,GAAtB,EACXJ,IADW,CACN,OADM,EACG,QADH,EAEXA,IAFW,CAEN,WAFM,EAEO,kBAAkBnD,GAAGE,KAAH,CAASI,MAAT,GAAkB,EAApC,IAA0C,GAFjD,EAGX2L,SAHW,CAGD,GAHC,EAIXvM,IAJW,CAINM,GAAGkH,KAJG,EAKXgF,KALW,GAMX3I,MANW,CAMJ,GANI,EAOXJ,IAPW,CAON,OAPM,EAOG,MAPH,EAQXA,IARW,CAQN,WARM,EAQO,aAAK;EACtB,UAAMmG,IAAItJ,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEitB,EAAf,IAAsBvuB,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEktB,EAAF,GAAOltB,EAAEitB,EAAtB,IAA4B,CAA5D;EACA,aAAO,eAAejlB,CAAf,GAAmB,MAA1B;EACD,KAXW,EAYX/F,MAZW,CAYJ,MAZI,EAaXJ,IAbW,CAaN,aAbM,EAaS,QAbT,EAcXX,IAdW,CAcN;EAAA,aAAKlB,EAAEtB,GAAGG,OAAH,CAAWmuB,QAAb,CAAL;EAAA,KAdM,CAAd;;EAgBA,QAAI1M,gBAAgB7gB,MAAA,CAAOf,GAAGkH,KAAV,EAAiB,UAAS5F,CAAT,EAAY;EAC/C,aAAO,CAACtB,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEktB,EAAf,IAAqBxuB,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEitB,EAAf,CAAtB,IAA4C,GAAnD;EACD,KAFmB,CAApB;EAGA,QAAMW,oBAAoBnuB,MAAA,CAAOf,GAAG2hB,QAAH,CAAYjU,KAAZ,EAAP,EAA4B,UAAU/J,IAAV,EAAgB;EACpE,aAAOA,KAAKC,qBAAL,EAAP;EACD,KAFyB,CAA1B;;EAIA5D,OAAG2hB,QAAH,CAAYjf,IAAZ,CAAiB,UAAUpB,CAAV,EAAa;EAAA;;EAC5B;EACA;EACA,UAAI4tB,oBAAqBtN,gBAAgB,CAAzC,EAA6C;EAC3C7gB,iBAAA,CAAU,IAAV,EAAgBwK,IAAhB,CAAqBvL,GAAGc,KAAH,CAASyB,IAA9B,EAAoCqf,aAApC,EAAmDnV,OAAnD;EACD,OAFD,MAEO;EACL1L,iBAAA,CAAU,IAAV,EACGoC,IADH,CACQ,aADR,EACuB,KADvB,EAEGA,IAFH,CAEQ,IAFR,EAEc,CAFd,EAGGA,IAHH,CAGQ,WAHR,EAGqB,4BAHrB;EAIA,YAAIgsB,mBAAmBnvB,GAAGG,OAAH,CAAWyE,IAAX,CAAgBC,MAAhB,CAAuBI,MAAvB,GAAgC,GAAvD;EACA,YAAI,KAAKrB,qBAAL,KAA+BurB,gBAAnC,EAAqD;EAAA;EACnDpuB,qBAAA,SACG+C,EADH,CACM,WADN,EACmB2I,QAAQ1I,IAD3B,EAEGD,EAFH,CAEM,UAFN,EAEkB2I,QAAQzI,IAF1B;EAGA,gBAAIC,IAAI,CAAR;EACA,mBAAO,OAAKL,qBAAL,KAA+BurB,gBAAtC,EAAwD;EACtDpuB,uBAAA,SAAgByB,IAAhB,CAAqB,UAAUlB,CAAV,EAAa;EAChC,uBAAO,CAACA,EAAEtB,GAAGG,OAAH,CAAWmuB,QAAb,IAAyB,EAA1B,EAA8BpqB,KAA9B,CAAoC,CAApC,EAAuC,CAACD,CAAxC,IAA6C,KAApD;EACD,eAFD,EAEGd,IAFH,CAEQ,OAFR,EAEiB7B,CAFjB;EAGA,gBAAE2C,CAAF;EACD;EAVkD;EAWpD;EACF;EACF,KAxBD;;EA0BA,QAAI4qB,SAAS7uB,GAAGE,KAAH,CAASU,GAAT,GAAe2C,MAAf,CAAsB,GAAtB,EACV0I,SADU,CACA,GADA,EAEVvM,IAFU,CAELM,GAAGkH,KAFE,EAGVgF,KAHU,GAGF3I,MAHE,CAGK,GAHL,EAIVJ,IAJU,CAIL,OAJK,EAII,UAJJ,CAAb;;EAMA0rB,WAAO5iB,SAAP,CAAiB,MAAjB,EACGvM,IADH,CACQ,UAAU4B,CAAV,EAAa;EACjB,aAAOA,EAAEmtB,WAAT;EACD,KAHH,EAIGviB,KAJH,GAIW3I,MAJX,CAIkB,MAJlB,EAKGJ,IALH,CAKQ,GALR,EAKa,UAAU7B,CAAV,EAAa;EACtB,aAAOA,EAAE,CAAF,EAAK,CAAL,IAAUtB,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAE,CAAF,EAAK,CAAL,IAAUA,EAAE,CAAF,EAAK5B,IAAL,CAAUgvB,aAAjC,CAAV,GAA4D1uB,GAAGqH,OAAH,CAAWnE,CAAX,CAAa,CAAb,CAAnE;EACD,KAPH,EAQGC,IARH,CAQQ,GARR,EAQa,UAAU7B,CAAV,EAAa;EACtB,aAAOtB,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAE,CAAF,EAAK5B,IAAL,CAAU6uB,EAAvB,CAAP;EACD,KAVH,EAWGprB,IAXH,CAWQ,OAXR,EAWiB,UAAU7B,CAAV,EAAa;EAC1B,aAAOtB,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAE,CAAF,EAAK5B,IAAL,CAAUM,GAAGG,OAAH,CAAWiC,KAArB,CAAb,CAAP;EACD,KAbH,EAcGe,IAdH,CAcQ,QAdR,EAckB,UAAU7B,CAAV,EAAa;EAC3B,UAAIyuB,IAAI/vB,GAAGqH,OAAH,CAAWnE,CAAX,CAAc5B,EAAE,CAAF,EAAK,CAAL,IAAUA,EAAE,CAAF,EAAK5B,IAAL,CAAUgvB,aAAlC,IAAoD1uB,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAE,CAAF,EAAK,CAAL,IAAUA,EAAE,CAAF,EAAK5B,IAAL,CAAUgvB,aAAjC,CAA5D;EACA,aAAOqB,CAAP;EACD,KAjBH,EAkBG5sB,IAlBH,CAkBQ,QAlBR,EAkBkB,OAlBlB,EAmBGA,IAnBH,CAmBQ,cAnBR,EAmBwB,CAnBxB,EAoBGA,IApBH,CAoBQ,MApBR,EAoBgB,UAAU7B,CAAV,EAAa;EACzB,aAAOtB,GAAGqH,OAAH,CAAWjC,KAAX,CAAiB9D,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb,CAAjB,CAAP;EACD,KAtBH,EAuBGnL,EAvBH,CAuBM,WAvBN,EAuBmB,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC/B,UAAIjE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,WAA1B,KAA0CnL,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBrF,cAArB,CAAoC,eAApC,CAA9C,EAAoG;EAAE;EACpGpK,iBAAA,CAAU,IAAV,EAAgBoC,IAAhB,CAAqB,MAArB,EAA6B,UAAU7B,CAAV,EAAa;EACxC,iBAAOtB,GAAGuQ,iBAAH,CAAqBjP,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb,CAArB,EAAyC,SAAzC,CAAP;EACD,SAFD;EAGD;EACDjP,SAAG4O,IAAH,CAAQ7K,IAAR,CAAazC,CAAb,EAAgBP,SAAA,CAAU,IAAV,EAAgB4C,IAAhB,EAAhB;;EAEA,UAAI3D,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,aAA1B,CAAJ,EAA8C;EAC5C;EACAnL,WAAGG,OAAH,CAAWsQ,WAAX,CAAuBlF,IAAvB,CAA4B,IAA5B,EAAkCjK,CAAlC,EAAqC2C,CAArC;EACD;EAEF,KApCH,EAqCGH,EArCH,CAqCM,UArCN,EAqCkB,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC9B,UAAIjE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,WAA1B,KAA0CnL,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBrF,cAArB,CAAoC,eAApC,CAA9C,EAAoG;EAAE;EACpGpK,iBAAA,CAAU,IAAV,EAAgBoC,IAAhB,CAAqB,MAArB,EAA6B,UAAU7B,CAAV,EAAa;EACxC,iBAAOtB,GAAGuQ,iBAAH,CAAqBjP,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb,CAArB,EAAyC,SAAzC,CAAP;EACD,SAFD;EAGD;EACDjP,SAAG4O,IAAH,CAAQ5K,IAAR;;EAEA,UAAIhE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,YAA1B,CAAJ,EAA6C;EAAE;EAC7CnL,WAAGG,OAAH,CAAWuQ,UAAX,CAAsBnF,IAAtB,CAA2B,IAA3B,EAAiCjK,CAAjC,EAAoC2C,CAApC;EACD;EACF,KAhDH,EAiDGH,EAjDH,CAiDM,OAjDN,EAiDe,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC3B,UAAIjE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,OAA1B,CAAJ,EAAwC;EACtCnL,WAAGG,OAAH,CAAWwQ,OAAX,CAAmBpF,IAAnB,CAAwB,IAAxB,EAA8BjK,CAA9B,EAAiC2C,CAAjC;EACD;EACF,KArDH;;EAuDEmqB,cAAU1e,UAAV;EACH,GAzID;;EA2IA0e,YAAU9d,iBAAV,GAA8B,YAAY;EACxC,QAAItQ,KAAK,IAAT;;EAEAA,OAAG4O,IAAH,CAAQ9D,IAAR,CAAa9K,GAAGG,OAAH,CAAWa,GAAX,IAAkB,UAAUM,CAAV,EAAa;EAC1C,UAAIwJ,OAAO,gBAAgBxJ,EAAEtB,GAAGG,OAAH,CAAWmuB,QAAb,CAAhB,GAAyC,YAApD;EACA,WAAK,IAAIvgB,CAAT,IAAczM,EAAE5B,IAAhB,EAAsB;EACpB,YAAK4B,EAAE,CAAF,IAAOA,EAAE,CAAF,CAAR,IAAiBA,EAAE5B,IAAF,CAAOqO,CAAP,CAArB,EAAgC;EAC9BjD,kBAAQ,WAAWiD,CAAX,GAAe,SAAvB;EACD;EACF;EACDjD,cAAQ,SAAS9K,GAAGc,KAAH,CAASqB,MAAT,CAAgBb,EAAE,CAAF,IAAOA,EAAE,CAAF,CAAvB,CAAjB;EACA,aAAOwJ,IAAP;EACD,KATD;;EAWA9K,OAAGE,KAAH,CAASU,GAAT,GAAe2K,IAAf,CAAoBvL,GAAG4O,IAAvB;;EAEA5O,OAAGE,KAAH,CAASU,GAAT,GAAe2C,MAAf,CAAsB,GAAtB,EACG0I,SADH,CACa,GADb,EAEGvM,IAFH,CAEQM,GAAGkH,KAFX,EAGGgF,KAHH,GAGW3I,MAHX,CAGkB,GAHlB,EAIGJ,IAJH,CAIQ,OAJR,EAIiB,UAJjB,EAKGA,IALH,CAKQ,MALR,EAKgB,UAAU7B,CAAV,EAAa;EACzB,aAAOtB,GAAGqH,OAAH,CAAWjC,KAAX,CAAiB9D,EAAE4P,GAAnB,CAAP;EACD,KAPH,EAQGjF,SARH,CAQa,MARb,EASGvM,IATH,CASQ,UAAU4B,CAAV,EAAa;EACjB,aAAOA,CAAP;EACD,KAXH,EAYG4K,KAZH,GAYW3I,MAZX,CAYkB,MAZlB,EAaGJ,IAbH,CAaQ,GAbR,EAaa,UAAU7B,CAAV,EAAa;EACtB,aAAOtB,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAE5B,IAAF,CAAOM,GAAGG,OAAH,CAAWiC,KAAlB,CAAb,CAAP;EACD,KAfH,EAgBGe,IAhBH,CAgBQ,GAhBR,EAgBa,UAAU7B,CAAV,EAAa;EACtB,aAAOtB,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAE,CAAF,CAAb,CAAP;EACD,KAlBH,EAmBG6B,IAnBH,CAmBQ,QAnBR,EAmBkBnD,GAAGqH,OAAH,CAAWnE,CAAX,CAAa0K,SAAb,EAnBlB,EAoBGzK,IApBH,CAoBQ,OApBR,EAoBiB,UAAU7B,CAAV,EAAa;EAC1B,aAAOtB,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAE,CAAF,CAAb,IAAqBtB,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAE,CAAF,CAAb,CAA5B;EACD,KAtBH,EAuBGwC,EAvBH,CAuBM,WAvBN,EAuBmB,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC/B,UAAIjE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,WAA1B,KAA0CnL,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBrF,cAArB,CAAoC,eAApC,CAA9C,EAAoG;EAAE;EACpGpK,iBAAA,CAAU,IAAV,EAAgBoC,IAAhB,CAAqB,MAArB,EAA6B,UAAU7B,CAAV,EAAa;EACxC,iBAAOtB,GAAGuQ,iBAAH,CAAqBjP,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb,CAArB,EAAyC,SAAzC,CAAP;EACD,SAFD;EAGD;EACDjP,SAAG4O,IAAH,CAAQ7K,IAAR,CAAazC,CAAb,EAAgBP,SAAA,CAAU,IAAV,EAAgB4C,IAAhB,EAAhB;;EAEA,UAAI3D,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,aAA1B,CAAJ,EAA8C;EAC5C;EACAnL,WAAGG,OAAH,CAAWsQ,WAAX,CAAuBlF,IAAvB,CAA4B,IAA5B,EAAkCjK,CAAlC,EAAqC2C,CAArC;EACD;EAEF,KApCH,EAqCGH,EArCH,CAqCM,UArCN,EAqCkB,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC9B,UAAIjE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,WAA1B,KAA0CnL,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBrF,cAArB,CAAoC,eAApC,CAA9C,EAAoG;EAAE;EACpGpK,iBAAA,CAAU,IAAV,EAAgBoC,IAAhB,CAAqB,MAArB,EAA6B,UAAU7B,CAAV,EAAa;EACxC,iBAAOtB,GAAGuQ,iBAAH,CAAqBjP,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb,CAArB,EAAyC,SAAzC,CAAP;EACD,SAFD;EAGD;EACDjP,SAAG4O,IAAH,CAAQ5K,IAAR;;EAEA,UAAIhE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,YAA1B,CAAJ,EAA6C;EAAE;EAC7CnL,WAAGG,OAAH,CAAWuQ,UAAX,CAAsBnF,IAAtB,CAA2B,IAA3B,EAAiCjK,CAAjC,EAAoC2C,CAApC;EACD;EACF,KAhDH,EAiDGH,EAjDH,CAiDM,OAjDN,EAiDe,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC3B,UAAIjE,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,OAA1B,CAAJ,EAAwC;EACtCnL,WAAGG,OAAH,CAAWwQ,OAAX,CAAmBpF,IAAnB,CAAwB,IAAxB,EAA8BjK,CAA9B,EAAiC2C,CAAjC;EACD;EACF,KArDH;EAuDD,GAvED;;EAyEAmqB,YAAUhd,YAAV,GAAyB,UAAU1R,IAAV,EAAgB;EACvC,QAAIM,KAAK,IAAT;EACA,QAAI2J,SAAS,EAAb;EACA,QAAI0H,WAAW,EAAf;;EAEA,QAAIrR,GAAGG,OAAH,CAAWqQ,SAAX,IAAwBxQ,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBc,mBAA7C,IACFtR,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBc,mBAArB,CAAyCzN,MAAzC,GAAkD,CADpD,EACuD;EACrD,aAAO7D,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBc,mBAA5B;EACD;;EAED5R,SAAK+K,OAAL,CAAa,UAAUnJ,CAAV,EAAa;EACxBqI,aAAOlG,IAAP,CAAY,CAACnC,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb,CAAb;EACD,KAFD;;EAIAtF,WAAO4E,IAAP,CAAYvO,GAAGc,KAAH,CAASqD,aAArB;;EAEA;EACA,QAAInE,GAAGG,OAAH,IAAcH,GAAGG,OAAH,CAAWqQ,SAAzB,IAAsCxQ,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBjH,OAA/D,EAAwE;;EAEtE,UAAIvJ,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBe,WAArB,KAAqC,IAAzC,EAA+C;EAC7C,YAAIC,MAAMvK,aAAA,CAAY0C,MAAZ,EAAoB,UAAUoC,CAAV,EAAa;EACzC,iBAAOA,KAAK,CAAZ;EACD,SAFS,CAAV;EAGA;;EAEAsF,iBAAS5N,IAAT,CAAckG,OAAO,CAAP,CAAd;EACA0H,iBAAS5N,IAAT,CAAc,CAAd;;EAEA,aAAK,IAAIQ,IAAI,CAAb,EAAgBA,KAAKjE,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBjH,OAArB,GAA+B,CAApD,EAAuDtF,GAAvD,EAA4D;EAC1DoN,mBAAS5N,IAAT,CAAc1C,WAAA,CAAYyQ,GAAZ,EAAiBvN,IAAI,CAAJ,IAASjE,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBjH,OAArB,GAA+B,CAAxC,CAAjB,CAAd;EACD;EAEF,OAbD,MAaO;EACL8H,iBAAS5N,IAAT,CAAc1C,WAAA,CAAY4I,MAAZ,EAAoB,CAApB,CAAd;EACA,aAAK,IAAI8H,IAAI,CAAb,EAAgBA,KAAKzR,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBjH,OAA1C,EAAmDkI,GAAnD,EAAwD;EACtDJ,mBAAS5N,IAAT,CAAc1C,WAAA,CAAY4I,MAAZ,EAAoB8H,IAAI,CAAJ,GAAQzR,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBjH,OAAjD,CAAd;EACD;EACF;EAEF,KAtBD,MAsBO;EACL8H,iBAAW,CAACtQ,WAAA,CAAY4I,MAAZ,EAAoB,CAApB,CAAD,EAAyB5I,WAAA,CAAY4I,MAAZ,EAAoB,GAApB,CAAzB,EAAmD5I,WAAA,CAAY4I,MAAZ,EAAoB,GAApB,CAAnD,EAA6E5I,WAAA,CAAY4I,MAAZ,EAAoB,GAApB,CAA7E,EAAuG5I,WAAA,CAAY4I,MAAZ,EAAoB,GAApB,CAAvG,EAAiI5I,WAAA,CAAY4I,MAAZ,EAAoB,CAApB,CAAjI,CAAX;EACD;;EAED;EACA,QAAI3J,GAAGG,OAAH,CAAWqQ,SAAX,IAAwBxQ,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBjH,OAA7C,IAAwDvJ,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBjH,OAArB,KAAiC,CAA7F,EAAgG;;EAE9F,UAAI8H,SAAS,CAAT,MAAgBA,SAAS,CAAT,CAAhB,IAA+BA,SAAS,CAAT,MAAgBA,SAAS,CAAT,CAA/C,IAA8DA,SAAS,CAAT,MAAgBA,SAAS,CAAT,CAA9E,IAA6FA,SAAS,CAAT,MAAgBA,SAAS,CAAT,CAAjH,EAA8H;EAC5HA,mBAAW,CAACtQ,WAAA,CAAY4I,MAAZ,EAAoB,CAApB,CAAD,EAAyB5I,WAAA,CAAY4I,MAAZ,EAAoB,GAApB,CAAzB,CAAX;EACD;EACF;;EAED,WAAO0H,QAAP;EACD,GApDD;;EAsDA+c,YAAU7d,iBAAV,GAA8B,UAAUjP,CAAV,EAAaK,IAAb,EAAmB;EAC/C,QAAI3B,KAAK,IAAT;EACA,QAAI0R,QAAQrO,WAAW/B,CAAX,CAAZ;;EAEA;EACA,QAAItB,GAAGG,OAAH,IAAcH,GAAGG,OAAH,CAAWoK,IAAX,CAAgBiG,SAA9B,IAA2CxQ,GAAGG,OAAH,CAAWoK,IAAX,CAAgBiG,SAAhB,CAA0BtB,MAAzE,EAAiF;EAC/E,UAAIlP,GAAGuP,UAAH,CAAc1L,MAAd,GAAuB,CAA3B,EAA8B;;EAE5B,YAAI7D,GAAGG,OAAH,IAAcH,GAAGG,OAAH,CAAWoK,IAAX,CAAgBoH,GAAhB,KAAwBjQ,SAAtC,IAAmD1B,GAAGG,OAAH,CAAWoK,IAAX,CAAgBqH,GAAhB,KAAwBlQ,SAA/E,EAA0F;EACxF,cAAIgQ,QAAQ1R,GAAGG,OAAH,CAAWoK,IAAX,CAAgBoH,GAAxB,IAA+BD,QAAQ1R,GAAGG,OAAH,CAAWoK,IAAX,CAAgBqH,GAA3D,EAAgE;EAC9D,mBAAO5R,GAAGG,OAAH,CAAWoK,IAAX,CAAgBiG,SAAhB,CAA0BqB,eAAjC;EACD;EACF,SAJD,MAIO;EACL,cAAIH,QAAQ1R,GAAGyP,OAAH,CAAW,CAAX,CAAR,IAAyBiC,QAAQ1R,GAAGyP,OAAH,CAAW,CAAX,CAArC,EAAoD;EAClD,mBAAOzP,GAAGG,OAAH,CAAWoK,IAAX,CAAgBiG,SAAhB,CAA0BqB,eAAjC;EACD;EACF;;EAED,YAAIlQ,QAAQ,SAAZ,EAAuB;EACrB,cAAI+P,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAb,EAA+B;EAC7B,mBAAOvP,GAAGG,OAAH,CAAWoK,IAAX,CAAgBiG,SAAhB,CAA0BtB,MAA1B,CAAiC,CAAjC,CAAP,CAD6B;EAE9B,WAFD,MAEO,IAAIwC,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAb,EAA+B;EACpC,mBAAOvP,GAAGG,OAAH,CAAWoK,IAAX,CAAgBiG,SAAhB,CAA0BtB,MAA1B,CAAiC,CAAjC,CAAP,CADoC;EAErC,WAFM,MAEA,IAAIwC,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAb,EAA+B;EACpC,mBAAOvP,GAAGG,OAAH,CAAWoK,IAAX,CAAgBiG,SAAhB,CAA0BtB,MAA1B,CAAiC,CAAjC,CAAP,CADoC;EAErC,WAFM,MAEA,IAAIwC,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAb,EAA+B;EACpC,mBAAOvP,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBtB,MAArB,CAA4B,CAA5B,CAAP,CADoC;EAErC,WAFM,MAEA,IAAIwC,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAb,EAA+B;EACpC,mBAAOvP,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBtB,MAArB,CAA4B,CAA5B,CAAP,CADoC;EAErC;EACF;;EAED,YAAIvN,QAAQ,SAAR,IAAqB3B,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,WAA1B,CAArB,IAA+DnL,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBrF,cAArB,CAAoC,eAApC,CAAnE,EAAyH;EACvH,cAAIuG,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAb,EAA+B;EAC7B,mBAAOvP,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBsB,aAArB,CAAmC,CAAnC,CAAP,CAD6B;EAE9B,WAFD,MAEO,IAAIJ,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAb,EAA+B;EACpC,mBAAOvP,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBsB,aAArB,CAAmC,CAAnC,CAAP,CADoC;EAErC,WAFM,MAEA,IAAIJ,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAb,EAA+B;EACpC,mBAAOvP,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBsB,aAArB,CAAmC,CAAnC,CAAP,CADoC;EAErC,WAFM,MAEA,IAAIJ,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAb,EAA+B;EACpC,mBAAOvP,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBsB,aAArB,CAAmC,CAAnC,CAAP,CADoC;EAErC,WAFM,MAEA,IAAIJ,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAb,EAA+B;EACpC,mBAAOvP,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBsB,aAArB,CAAmC,CAAnC,CAAP,CADoC;EAErC;EACF;EAEF;EACF;;EAED,QAAI9R,GAAGuP,UAAH,CAAc1L,MAAd,IAAwB,CAA5B,EAA+B;EAC7B;;;;;EAKA,UAAI6N,SAAS1R,GAAGuP,UAAH,CAAc,CAAd,CAAb,EAA+B;EAC7B,eAAOvP,GAAGG,OAAH,CAAWqQ,SAAX,CAAqBtB,MAArB,CAA4B,CAA5B,CAAP,CAD6B;EAE9B;EACF;EAEF,GA5DD;;EA8DAkf,YAAU1pB,IAAV,CAAevF,MAAf;EACA,SAAOivB,SAAP;EACD;;EC5xBD;;;AAGA,EAAe,mBAASjvB,MAAT,EAAiBqI,MAAjB,EAAyB;;EAGtC,MAAIwoB,WAAWjoB,OAAO4G,MAAP,CAAcnH,MAAd,CAAf;;EAEAwoB,WAAStrB,IAAT,GAAgB,UAASvF,MAAT,EAAgB;EAC9B,QAAIa,KAAK,IAAT;EACAA,OAAGG,OAAH,GAAahB,SAASA,MAAT,GAAkB,EAA/B;EACAa,OAAGkH,KAAH,GAAW,EAAX;EACAlH,OAAGqH,OAAH,GAAY,EAAZ;EACArH,OAAGsH,KAAH,GAAW,EAAX;;EAEAtH,OAAGG,OAAH,CAAW+f,SAAX,GAAuBnf,YAAA,CAAa,UAAb,CAAvB;EACAf,OAAGG,OAAH,CAAWwX,KAAX,GAAmB5W,cAAnB;;EAEAf,OAAG4O,IAAH,GAAU5O,GAAGc,KAAH,CAASC,EAAT,CAAYC,GAAZ,GAAkBmC,IAAlB,CAAuB,OAAvB,EAAgC,QAAhC,EACP2H,IADO,CACF9K,GAAGG,OAAH,CAAWa,GAAX,IAAkBhB,GAAGG,OAAH,CAAWa,GAAX,CAAe8J,IAAjC,GAAwC9K,GAAGG,OAAH,CAAWa,GAAX,CAAe8J,IAAvD,GAA8D,UAASxJ,CAAT,EAAY;;EAE9E,UAAI2uB,aAAajwB,GAAGqH,OAAH,CAAWjC,KAAX,KAAqB,KAArB,GAA6BpF,GAAGqH,OAAH,CAAWjC,KAAX,CAAiB9D,EAAEgK,IAAnB,CAA7B,GAAuDtL,GAAGuQ,iBAAH,CAAqBjP,EAAEgK,IAAvB,EAA4B,SAA5B,CAAxE;EACA,UAAItL,GAAGE,KAAH,CAASf,MAAT,CAAgBsM,MAApB,EAA4B;EAC1B,YAAIX,qFAES9K,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuBwD,OAFhC,6CAGajG,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuBD,IAAvB,CAA4BgD,UAHzC,2CAIWxF,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuBD,IAAvB,CAA4B+C,QAJvC,uCAKOvF,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuBD,IAAvB,CAA4B8C,SALnC,4CAMatF,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuBD,IAAvB,CAA4B0D,UANzC,iDAOkBlG,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuB0C,eAPzC,yCAQSnF,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuBD,IAAvB,CAA4BP,OARrC,0CASQjC,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuB0D,MAAvB,CAA8B/F,KATtC,uBASqDJ,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuB0D,MAAvB,CAA8Bf,KATnF,iDAUgBpF,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuB0D,MAAvB,CAA8BC,MAV9C,UAAJ;EAWA0E,kDAAgC9K,GAAGE,KAAH,CAASM,KAAT,CAAeiC,OAAf,CAAuBD,IAAvB,CAA4B+pB,SAA5D;EACD,OAbD,MAcK;EAAE,YAAIzhB,OAAO,gBAAX;EAA8B;EACrCA,cAAQ,kCAAwBmlB,UAAxB,YAAyC3uB,EAAEgK,IAA3C,GAAkD,aAA1D;EACAR,cAAQxJ,EAAE4B,CAAF,GAAO,aAAaoB,OAAOC,KAAP,CAAa,CAACjD,EAAE4B,CAAhB,IAAqB5B,EAAE4B,CAAvB,GAA2BlD,GAAGc,KAAH,CAASqB,MAAT,CAAgBb,EAAE4B,CAAlB,CAA3B,EAAiD,CAA9D,IAAmE,SAA1E,GAAuF,EAA/F;EACA4H,cAAQ,QAAR;;EAEA,aAAOA,IAAP;;EAEA;;;;;;;EAOD,KAhCO,CAAV;EAkCD,GA5CD;;EA8CA;EACA;EACAklB,WAAS1mB,CAAT,GAAa,UAASoW,GAAT,EAAa;EACxB,QAAI1f,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWmJ,CAAX,GAAeoW,GAAf;EACA,WAAO1f,EAAP;EACD,GAJD;;EAMAgwB,WAAS9P,SAAT,GAAqB,UAAS/d,MAAT,EAAgB;EACnC,QAAInC,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAW+f,SAAX,GAAuBnf,YAAA,CAAaoB,MAAb,CAAvB;EACA,WAAOnC,EAAP;EACD,GAJD;;EAMAgwB,WAAS9sB,CAAT,GAAa,UAASwc,GAAT,EAAa;EACxB,QAAI1f,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAW+C,CAAX,GAAewc,GAAf;EACA,WAAO1f,EAAP;EACD,GAJD;;EAMAgwB,WAASE,MAAT,GAAkB,UAASC,GAAT,EAAa;EAC7B,QAAInwB,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAW+vB,MAAX,GAAoBC,GAApB;EACA,WAAOnwB,EAAP;EACD,GAJD;;EAMAgwB,WAASrY,KAAT,GAAiB,UAAUA,KAAV,EAAiB;EAChC,QAAI3X,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWwX,KAAX,GAAmBA,KAAnB;EACA,WAAO3X,EAAP;EACD,GAJD;;EAMAgwB,WAAS/gB,IAAT,GAAgB,UAASyQ,GAAT,EAAa;EAC3B,QAAI1f,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAW8O,IAAX,GAAkByQ,GAAlB;EACA,WAAO1f,EAAP;EACD,GAJD;;EAMAgwB,WAAS9gB,MAAT,GAAkB,UAASA,MAAT,EAAiB;EACjC,QAAIlP,KAAK,IAAT;EACA,QAAG6B,MAAMC,OAAN,CAAcoN,MAAd,CAAH,EAA0B;EACxB;EACAlP,SAAGG,OAAH,CAAW+O,MAAX,GAAoBA,MAApB;EACD,KAHD,MAGO;EACL;EACAlP,SAAGqH,OAAH,CAAWjC,KAAX,GAAmB8J,MAAnB;EACD;EACD,WAAOlP,EAAP;EACD,GAVD;;EAYAgwB,WAAShvB,GAAT,GAAe,UAAUA,GAAV,EAAe;EAC5B,QAAIhB,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWa,GAAX,GAAiBA,GAAjB;EACAhB,OAAG4O,IAAH,CAAQ9D,IAAR,CAAa9K,GAAGG,OAAH,CAAWa,GAAxB;EACA,WAAOhB,EAAP;EACD,GALD;;EAOA;EACA;EACAgwB,WAAStwB,IAAT,GAAgB,UAASA,IAAT,EAAc;EAC5B,QAAIM,KAAK,IAAT;;EAEAA,OAAGkH,KAAH,GAAW,EAAX;EACAxH,SAAK+K,OAAL,CAAa,UAASnJ,CAAT,EAAW;EACtB,UAAI8uB,MAAMroB,OAAOC,MAAP,CAAc,EAAd,EAAkB1G,CAAlB,CAAV;EACA,UAAIA,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,CAAJ,EAAqB;EACnB,YAAI;EACFhI,YAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,EAAgB+mB,OAAhB;EACA,cAAI,CAAC/rB,OAAOC,KAAP,CAAajD,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,EAAgB+mB,OAAhB,EAAb,CAAL,EAA8C;EAC5CD,gBAAI9mB,CAAJ,GAAQhI,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,CAAR;EACD;EACF,SALD,CAKE,OAAOgnB,GAAP,EAAY;EACZF,cAAI9mB,CAAJ,GAAQtJ,GAAGG,OAAH,CAAW+f,SAAX,CAAqB5e,EAAEtB,GAAGG,OAAH,CAAWmJ,CAAb,CAArB,CAAR;EACD;EACF;;EAED8mB,UAAIhrB,KAAJ,GAAY9D,EAAEtB,GAAGG,OAAH,CAAW8O,IAAb,CAAZ;EACA,aAAOmhB,IAAIpwB,GAAGG,OAAH,CAAWmJ,CAAf,CAAP;EACAtJ,SAAGkH,KAAH,CAASzD,IAAT,CAAc2sB,GAAd;EACD,KAhBD;;EAkBA;EACApwB,OAAGkH,KAAH,GAAWlH,GAAGkH,KAAH,CAASqH,IAAT,CAAc,UAAUnK,CAAV,EAAaC,CAAb,EAAgB;EACvC,aAAOtD,YAAA,CAAaqD,EAAEkF,CAAf,EAAkBjF,EAAEiF,CAApB,CAAP;EACD,KAFU,CAAX;;EAIAtJ,OAAGuwB,MAAH,GAAYvwB,GAAGG,OAAH,CAAW+C,CAAX,GAAelD,GAAGG,OAAH,CAAW+C,CAA1B,GAA8BlD,GAAGG,OAAH,CAAW+vB,MAArD;;EAEAlwB,OAAGuwB,MAAH,GAAYvwB,GAAGuwB,MAAH,CAAUzwB,GAAV,CAAc,UAASwL,IAAT,EAAe;EACvC,aAAO;EACLA,cAAMA,IADD;EAEL3B,gBAAQ3J,GAAGkH,KAAH,CAASpH,GAAT,CAAa,UAASwB,CAAT,EAAY;EAC/B,iBAAO,EAACgI,GAAGhI,EAAEgI,CAAN,EAASpG,GAAG,CAAC5B,EAAEgK,IAAF,CAAb,EAAP;EACD,SAFO;EAFH,OAAP;EAMD,KAPW,CAAZ;;EASAtL,OAAGuwB,MAAH,CAAU9lB,OAAV,CAAkB,UAAC+lB,CAAD,EAAO;EACvBA,QAAE7mB,MAAF,GAAW6mB,EAAE7mB,MAAF,CAAS2F,MAAT,CAAgB,UAACoK,CAAD,EAAO;EAChC,eAAO,CAACnV,MAAMmV,EAAExW,CAAR,CAAR;EACD,OAFU,CAAX;EAGD,KAJD;;EAMAlD,OAAGywB,KAAH,GAAW1vB,OAAA,GACR4W,KADQ,CACF3X,GAAGG,OAAH,CAAWwX,KADT,EAER+Y,OAFQ,CAEA,UAAUpvB,CAAV,EAAa;EACpB,aAAOA,EAAE4B,CAAF,KAAQxB,SAAf;EACD,KAJQ,EAKR4H,CALQ,CAKN,UAAUhI,CAAV,EAAa;EACd,aAAOtB,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEgI,CAAf,CAAP;EACD,KAPQ,EAQRpG,CARQ,CAQN,UAAU5B,CAAV,EAAa;EACd,aAAOtB,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAE4B,CAAf,CAAP;EACD,KAVQ,CAAX;;EAaAlD,OAAG2wB,KAAH,GAAW5vB,OAAA,GACR4W,KADQ,CACF3X,GAAGG,OAAH,CAAWwX,KADT,EAERrO,CAFQ,CAEN,UAAUhI,CAAV,EAAa;EACd,UAAIA,EAAEsvB,aAAF,IAAmBtvB,EAAEsvB,aAAF,KAAoB,IAA3C,EAAiD;EAC/C,eAAOtvB,EAAEgI,CAAT;EACD,OAFD,MAEO;EACL,eAAOtJ,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEgI,CAAf,CAAP;EACD;EACF,KARQ,EASRgQ,EATQ,CASL,UAAUhY,CAAV,EAAa;EACf,UAAIA,EAAEsvB,aAAF,IAAmBtvB,EAAEsvB,aAAF,KAAoB,IAA3C,EAAiD;EAC/C,eAAOtvB,EAAE4B,CAAT;EACD,OAFD,MAEO;EACL,eAAOlD,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAE4B,CAAf,CAAP;EACD;EACF,KAfQ,CAAX;;EAiBA,WAAOlD,EAAP;EACD,GA3ED;;EA6EAgwB,WAASvnB,MAAT,GAAkB,YAAU;EAC1B,QAAIzI,KAAK,IAAT;;EAEAA,OAAG6wB,QAAH,GAAc9vB,SAAA,CAAUf,GAAGkH,KAAb,EAAoB,UAAS5F,CAAT,EAAY;EAAE,aAAOA,EAAEgI,CAAT;EAAa,KAA/C,CAAd;;EAEAtJ,OAAG8wB,QAAH,GAAc,CACZ9wB,GAAGG,OAAH,CAAWkG,KAAX,CAAiBzE,OAAjB,GAA2B,CAA3B,GAA+Bb,MAAA,CAAOf,GAAGuwB,MAAV,EAAkB,UAASrlB,CAAT,EAAY;EAAE,aAAOnK,MAAA,CAAOmK,EAAEvB,MAAT,EAAiB,UAAS+P,CAAT,EAAY;EAAE,eAAOA,EAAExW,CAAT;EAAa,OAA5C,CAAP;EAAuD,KAAvF,CADnB,EAEZnC,MAAA,CAAOf,GAAGuwB,MAAV,EAAkB,UAASrlB,CAAT,EAAY;EAAE,aAAOnK,MAAA,CAAOmK,EAAEvB,MAAT,EAAiB,UAAS+P,CAAT,EAAY;EAAE,eAAOA,EAAExW,CAAT;EAAa,OAA5C,CAAP;EAAuD,KAAvF,CAFY,CAAd;;EAKA/D,aAAS;EACPoC,cAAQvB,GAAGG,OAAH,CAAWmJ,CADZ;EAEP3H,YAAM3B,GAAGG,OAAH,CAAW6G,KAAX,CAAiB9F,KAFhB;EAGPE,aAAO,CAAC,CAAD,EAAIpB,GAAGE,KAAH,CAASE,KAAb,CAHA;EAIPwB,eAAS;EAJF,KAAT;EAMA5B,OAAGqH,OAAH,CAAWiC,CAAX,GAAetJ,GAAGc,KAAH,CAASG,aAAT,CAAuBjB,GAAGkH,KAA1B,EAAiC/H,MAAjC,CAAf;;EAEAA,aAAS;EACPoC,cAAQvB,GAAGG,OAAH,CAAW+C,CADZ;EAEPvB,YAAM3B,GAAGG,OAAH,CAAWkG,KAAX,CAAiBnF,KAFhB;EAGPE,aAAO,CAACpB,GAAGE,KAAH,CAASI,MAAV,EAAkB,CAAlB,CAHA;EAIPsB,eAAS5B,GAAGG,OAAH,CAAWkG,KAAX,CAAiBzE;EAJnB,KAAT;EAMA5B,OAAGqH,OAAH,CAAWnE,CAAX,GAAelD,GAAGc,KAAH,CAASG,aAAT,CAAuBjB,GAAGkH,KAA1B,EAAiC/H,MAAjC,CAAf;;EAEAa,OAAGqH,OAAH,CAAWiC,CAAX,CAAatH,MAAb,CAAoBhC,GAAG6wB,QAAvB;EACA7wB,OAAGqH,OAAH,CAAWnE,CAAX,CAAalB,MAAb,CAAoBhC,GAAG8wB,QAAvB,EAAiCha,IAAjC;;EAEA,QAAG9W,GAAGG,OAAH,CAAWgL,cAAX,CAA0B,QAA1B,CAAH,EACEnL,GAAGqH,OAAH,CAAWjC,KAAX,GAAmBrE,eAAA,CAAgBf,GAAGG,OAAH,CAAW+O,MAA3B,CAAnB,CADF,KAGElP,GAAGqH,OAAH,CAAWjC,KAAX,GAAmBrE,eAAA,CAAgBA,mBAAhB,CAAnB;;EAEF,QAAIf,GAAGqH,OAAH,CAAWiC,CAAX,CAAatH,MAAb,GAAsB,CAAtB,EAAyBquB,OAAzB,MAAsCrwB,GAAGqH,OAAH,CAAWiC,CAAX,CAAatH,MAAb,GAAsB,CAAtB,EAAyBquB,OAAzB,EAA1C,EAA8E;EAAE;EAC9E,UAAIU,YAAY/wB,GAAGqH,OAAH,CAAWiC,CAAX,CAAatH,MAAb,EAAhB;EACA,UAAIgvB,WAAWhxB,GAAGqH,OAAH,CAAWiC,CAAX,CAAalI,KAAb,EAAf;;EAEApB,SAAGqH,OAAH,CAAWiC,CAAX,CACGtH,MADH,CACU,CAAC,IAAIivB,IAAJ,CAASF,UAAU,CAAV,EAAaV,OAAb,KAAyB,CAAlC,CAAD,EAAuCU,UAAU,CAAV,CAAvC,EAAsDA,UAAU,CAAV,CAAtD,CADV,EAEG3vB,KAFH,CAES,CAAC,CAAD,EAAI4vB,SAAS,CAAT,IAAc,CAACA,SAAS,CAAT,IAAcA,SAAS,CAAT,CAAf,IAA8B,CAAhD,EAAmDA,SAAS,CAAT,CAAnD,CAFT;EAGD;;EAED,WAAOhxB,EAAP;EACD,GA5CD;;EA8CAgwB,WAAStgB,UAAT,GAAsB,YAAW;EAC/B,QAAI1P,KAAK,IAAT;EACA,QAAIkxB,SAASlxB,GAAGE,KAAH,CAASE,KAAtB;;EAEAJ,OAAGE,KAAH,CAASU,GAAT,GAAeqL,SAAf,CAAyB,OAAzB,EAAkCvJ,IAAlC,CAAuC,UAASqO,GAAT,EAAc;EACnD,UAAID,KAAK,IAAT;EACAC,UAAIpH,MAAJ,CAAWc,OAAX,CAAmB,UAASS,CAAT,EAAY8F,KAAZ,EAAmB;EACpCjQ,iBAAA,CAAU+P,EAAV,EAAcvN,MAAd,CAAqB,MAArB,EACGJ,IADH,CACQ,OADR,EACiB,YADjB,EAEGA,IAFH,CAEQ,WAFR,EAEqB,UAAS7B,CAAT,EAAY;EAC7B,cAAItB,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEqI,MAAF,CAASqH,KAAT,EAAgB1H,CAA7B,KAAmC4nB,MAAvC,EAA+C;EAC7C,mBAAO,iBAAiBlxB,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEqI,MAAF,CAASqH,KAAT,EAAgB1H,CAA7B,IAAkC,EAAnD,IAAyD,GAAzD,GAAgEtJ,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAEqI,MAAF,CAASqH,KAAT,EAAgB9N,CAA7B,CAAhE,GAAmG,GAA1G;EACD;EACD,iBAAO,iBAAiBlD,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEqI,MAAF,CAASqH,KAAT,EAAgB1H,CAA7B,IAAkC,EAAnD,IAAyD,GAAzD,GAAgEtJ,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAEqI,MAAF,CAASqH,KAAT,EAAgB9N,CAA7B,CAAhE,GAAmG,GAA1G;EACD,SAPH,EAQGV,IARH,CAQQ,YAAW;EACf,iBAAO0I,EAAEhI,CAAF,GAAMgI,EAAEhI,CAAF,CAAIgN,OAAJ,CAAY,CAAZ,CAAN,GAAuB,EAA9B;EACD,SAVH;EAWD,OAZD;EAaD,KAfD;EAgBD,GApBD;;EAsBA8f,WAASznB,IAAT,GAAgB,YAAU;EACxB,QAAIvI,KAAK,IAAT;EACA;EACAA,OAAGE,KAAH,CAASU,GAAT,GAAe2K,IAAf,CAAoBvL,GAAG4O,IAAvB;;EAEA,QAAI5O,GAAGqH,OAAH,CAAWiC,CAAX,CAAatH,MAAb,GAAsB6B,MAAtB,KAAiC,CAArC,EAAwC;EACtC7D,SAAGE,KAAH,CAASU,GAAT,GAAegK,MAAf,CAAsB,eAAtB,EAAuCC,MAAvC;EACD;;EAED,QAAIiU,QAAQ9e,GAAGE,KAAH,CAASU,GAAT,GAAeqL,SAAf,CAAyB,QAAzB,EACTvM,IADS,CACJM,GAAGuwB,MADC,EAEXrkB,KAFW,GAEH3I,MAFG,CAEI,GAFJ,EAGTJ,IAHS,CAGJ,OAHI,EAGK,OAHL,CAAZ;;EAKA,QAAI6iB,OAAOhmB,GAAGE,KAAH,CAASU,GAAT,GAAeqL,SAAf,CAAyB,QAAzB,EAAmC1I,MAAnC,CAA0C,MAA1C,EACRJ,IADQ,CACH,OADG,EACM,MADN,EAERA,IAFQ,CAEH,GAFG,EAEE,UAAS7B,CAAT,EAAY;EACrB,aAAOtB,GAAGywB,KAAH,CAASnvB,EAAEqI,MAAX,CAAP;EACD,KAJQ,EAKRxG,IALQ,CAKH,QALG,EAKO,UAAS7B,CAAT,EAAW;EACzB,aAAOtB,GAAGqH,OAAH,CAAWjC,KAAX,KAAqB,KAArB,GAA6BpF,GAAGqH,OAAH,CAAWjC,KAAX,CAAiB9D,EAAEgK,IAAnB,CAA7B,GAAuDtL,GAAGuQ,iBAAH,CAAqBjP,EAAEgK,IAAvB,EAA4B,SAA5B,CAA9D;EACD,KAPQ,EAQRnI,IARQ,CAQH,cARG,EAQa,CARb,EASRA,IATQ,CASH,MATG,EASI,MATJ,CAAX;;EAWA;EACA,QAAIguB,OAAOnxB,GAAGE,KAAH,CAASU,GAAT,GAAeqL,SAAf,CAAyB,OAAzB,EACRvM,IADQ,CACHM,GAAGuwB,MADA,EAERrkB,KAFQ,GAEA3I,MAFA,CAEO,GAFP,EAGNJ,IAHM,CAGD,OAHC,EAGQ,MAHR,EAIN8I,SAJM,CAII,SAJJ,EAKNvM,IALM,CAKA,UAAS4B,CAAT,EAAY;EACjBA,QAAEqI,MAAF,CAASc,OAAT,CAAiB,UAACqG,EAAD,EAAQ;EAACA,WAAGxF,IAAH,GAAUhK,EAAEgK,IAAZ;EAAkB,OAA5C;EACA,aAAOhK,EAAEqI,MAAT;EACD,KARM,EASNuC,KATM,GASE3I,MATF,CASS,QATT,EAUJJ,IAVI,CAUC,OAVD,EAUU,KAVV,EAWJA,IAXI,CAWC,IAXD,EAWO,UAAS7B,CAAT,EAAY2C,CAAZ,EAAe;EACzB,aAAOjE,GAAGqH,OAAH,CAAWiC,CAAX,CAAahI,EAAEgI,CAAf,CAAP;EACD,KAbI,EAcJnG,IAdI,CAcC,IAdD,EAcO,UAAS7B,CAAT,EAAY;EACtB,aAAOtB,GAAGqH,OAAH,CAAWnE,CAAX,CAAa5B,EAAE4B,CAAf,CAAP;EACD,KAhBI,EAiBJC,IAjBI,CAiBC,GAjBD,EAiBM,CAjBN,EAkBJ3C,KAlBI,CAkBE,QAlBF,EAkBY,UAASc,CAAT,EAAW;EAC1B,aAAOtB,GAAGqH,OAAH,CAAWjC,KAAX,KAAqB,KAArB,GAA6BpF,GAAGqH,OAAH,CAAWjC,KAAX,CAAiB9D,EAAEgK,IAAnB,CAA7B,GAAuDtL,GAAGuQ,iBAAH,CAAqBjP,EAAEgK,IAAvB,EAA4B,SAA5B,CAA9D;EACD,KApBI,EAqBJ9K,KArBI,CAqBE,cArBF,EAqBkB,CArBlB,EAsBJA,KAtBI,CAsBE,MAtBF,EAsBU,MAtBV,EAuBJA,KAvBI,CAuBE,cAvBF,EAuBkB,GAvBlB,EAwBJsD,EAxBI,CAwBD,WAxBC,EAwBY,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC/B,UAAIjE,GAAGG,OAAH,CAAW0hB,SAAf,EAA0B;EACxB;EACD;EACD7hB,SAAG4O,IAAH,CAAQ7K,IAAR,CAAazC,CAAb,EAAgBP,SAAA,CAAU,IAAV,EAAgB4C,IAAhB,EAAhB;EACD,KA7BI,EA8BJG,EA9BI,CA8BD,UA9BC,EA8BW,UAAUxC,CAAV,EAAa2C,CAAb,EAAgB;EAC9B,UAAIjE,GAAGG,OAAH,CAAW2hB,QAAf,EAAyB;EACvB;EACD;EACD9hB,SAAG4O,IAAH,CAAQ5K,IAAR,CAAa1C,CAAb,EAAgBP,SAAA,CAAU,IAAV,EAAgB4C,IAAhB,EAAhB;EACD,KAnCI,CAAX;;EAqCAqsB,aAAStgB,UAAT;EACA;;EAEA;;;EAGA;;;;;;;;;;EAYE;;EAEF,WAAO1P,EAAP;EACD,GApFD;;EAsFAgwB,WAAStrB,IAAT,CAAcvF,MAAd;EACA,SAAO6wB,QAAP;EACD;;EC1VD;;;AAGA,EAAe,kBAAS7wB,MAAT,EAAiBqI,MAAjB,EAAyB;;EAEtC,MAAI4pB,UAAUrpB,OAAO4G,MAAP,CAAcnH,MAAd,CAAd;;EAEA4pB,UAAQ1sB,IAAR,GAAe,UAASvF,MAAT,EAAiB;EAC9B,QAAIa,KAAK,IAAT;EACAA,OAAGG,OAAH,GAAahB,SAASA,MAAT,GAAkB,EAA/B;EACAa,OAAGG,OAAH,CAAWkxB,QAAX,GAAsB,CAAtB;EACArxB,OAAGG,OAAH,CAAWmxB,OAAX,GAAqB,KAArB;EACAtxB,OAAGG,OAAH,CAAWa,GAAX,GAAiB,UAASM,CAAT,EAAY;EAC3B6L,cAAQC,GAAR,CAAY9L,CAAZ;EACA,UAAIwJ,OAAO,OAAX;EACA,UAAIxJ,EAAEiwB,MAAF,CAAS7xB,IAAT,CAAc4L,IAAd,IAAsBhK,EAAEiwB,MAAF,CAAS7xB,IAAT,CAAc4L,IAAd,KAAuB,MAAjD,EAAyD;;EAEvDR,gBAAQ,WAAWxJ,EAAEiwB,MAAF,CAAS7xB,IAAT,CAAc4L,IAAzB,GAAgC,aAAxC;EACD;EACDR,cAAQ,WAAWxJ,EAAE5B,IAAF,CAAO4L,IAAlB,GAAyB,aAAjC;EACAR,cAAQ,WAAW9K,GAAGc,KAAH,CAASqB,MAAT,CAAgBb,EAAEc,KAAlB,EAAyBpC,GAAGG,OAAH,CAAW6P,QAApC,CAAX,GAA2D,SAAnE;EACAlF,cAAQ,QAAR;EACA,aAAOA,IAAP;EACD,KAXD;EAYA9K,OAAGkH,KAAH,GAAW,EAAX;EACAlH,OAAGqH,OAAH,GAAa;EACXjC,aAAOrE,eAAA,CAAgBA,oBAAhB;EADI,KAAb;EAGAf,OAAGsH,KAAH,GAAW,EAAX;EACAtH,OAAG4O,IAAH,GAAU5O,GAAGc,KAAH,CAASC,EAAT,CAAYC,GAAZ,GACPmC,IADO,CACF,OADE,EACO,oBADP,EAEP0L,SAFO,CAEG,GAFH,EAGP/D,IAHO,CAGF9K,GAAGG,OAAH,CAAWa,GAHT,CAAV;EAID,GA1BD;;EA4BAowB,UAAQxsB,IAAR,GAAe,UAAS8a,GAAT,EAAc;EAC3B,QAAI1f,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWqxB,KAAX,GAAmB9R,GAAnB;EACA,WAAO1f,EAAP;EACD,GAJD;;EAMAoxB,UAAQliB,MAAR,GAAiB,UAASuiB,aAAT,EAAwBzvB,MAAxB,EAAgC;EAC/C,QAAIhC,KAAK,IAAT;EACAA,OAAGqH,OAAH,CAAWjC,KAAX,GAAmBrE,eAAA,CAAgB0wB,aAAhB,CAAnB;EACA,QAAIzvB,MAAJ,EAAY;EACVhC,SAAGqH,OAAH,CAAWjC,KAAX,CAAiBpD,MAAjB,CAAwBA,MAAxB;EACD;EACD,WAAOhC,EAAP;EACD,GAPD;;EASAoxB,UAAQnvB,OAAR,GAAkB,UAASA,OAAT,EAAkB;EAClC,QAAIjC,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWkxB,QAAX,GAAsBpvB,OAAtB;EACA,WAAOjC,EAAP;EACD,GAJD;;EAMAoxB,UAAQM,MAAR,GAAiB,UAAS5jB,IAAT,EAAe;EAC9B,QAAI9N,KAAK,IAAT;EACA,QAAI6B,MAAMC,OAAN,CAAcgM,IAAd,CAAJ,EAAyB;EACvB,UAAIA,KAAKjK,MAAL,IAAe,CAAnB,EACE,MAAM,gCAAN;EACF7D,SAAGG,OAAH,CAAWwxB,KAAX,GAAmB7jB,IAAnB;EACD,KAJD,MAIO,IAAI,OAAOA,IAAP,KAAgB,QAAhB,IAA4BA,gBAAgB2T,MAAhD,EAAwD;EAC7DzhB,SAAGG,OAAH,CAAWwxB,KAAX,GAAmB,CAAC7jB,IAAD,CAAnB;EACD,KAFM,MAEA;EACL,UAAIA,QAAQpM,SAAR,IAAqBoM,QAAQ,IAAjC,EACE,MAAM,0DAAN;EACF9N,SAAGG,OAAH,CAAWwxB,KAAX,GAAmB,CAAC7jB,KAAK8jB,QAAL,EAAD,CAAnB;EACAzkB,cAAQ0kB,OAAR,CAAgB,0FAAhB;EACD;EACD7xB,OAAGG,OAAH,CAAW2xB,UAAX,GAAwB9xB,GAAGG,OAAH,CAAWwxB,KAAX,CAAiB3xB,GAAGG,OAAH,CAAWwxB,KAAX,CAAiB9tB,MAAjB,GAA0B,CAA3C,CAAxB,CAd8B;EAe9B,WAAO7D,EAAP;EACD,GAhBD;;EAkBAoxB,UAAQjvB,MAAR,GAAiB,UAASA,MAAT,EAAiB;EAChC,QAAInC,KAAK,IAAT;EACA,QAAI,OAAOmC,MAAP,IAAiB,UAAjB,IAA+BA,kBAAkBkN,QAArD,EACErP,GAAGc,KAAH,CAASqB,MAAT,GAAkBA,MAAlB,CADF,KAGEnC,GAAGc,KAAH,CAASqB,MAAT,GAAkBpB,SAAA,CAAUoB,MAAV,EAAkBnC,GAAGG,OAAH,CAAW6P,QAA7B,CAAlB;EACF,WAAOhQ,EAAP;EACD,GAPD;;EASAoxB,UAAQtqB,MAAR,GAAiB,UAASc,IAAT,EAAe;EAC9B,QAAI5H,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWmxB,OAAX,GAAqBS,QAAQnqB,IAAR,CAArB;EACA,WAAO5H,EAAP;EACD,GAJD;;EAMAoxB,UAAQpwB,GAAR,GAAc,UAASA,GAAT,EAAc;EAC1B,QAAIhB,KAAK,IAAT;EACAA,OAAGG,OAAH,CAAWa,GAAX,GAAiBA,GAAjB;EACAhB,OAAG4O,IAAH,CAAQ9D,IAAR,CAAa9K,GAAGG,OAAH,CAAWa,GAAxB;EACA,WAAOhB,EAAP;EACD,GALD;;EAOAoxB,UAAQ3oB,MAAR,GAAiB,UAAUA,MAAV,EAAkB;EACjC,QAAIzI,KAAK,IAAT;EACA,WAAOA,EAAP;EACD,GAHD;;EAKAoxB,UAAQroB,IAAR,GAAe,YAAW;EACxB,QAAI/I,KAAK,IAAT;EACA,WAAOA,EAAP;EACD,GAHD;;EAKAoxB,UAAQjwB,OAAR,GAAkB,YAAW;EAC3B,QAAInB,KAAK,IAAT;EACA,WAAOA,EAAP;EACD,GAHD;;EAKAoxB,UAAQY,gBAAR,GAA2B,UAASzY,KAAT,EAAgB;EACzC,QAAIvZ,KAAK,IAAT;EACA,QAAI,CAAC,OAAOuZ,MAAMjO,IAAb,KAAsB,QAAtB,IAAkCiO,MAAMjO,IAAN,YAAsBmW,MAAzD,KAAoE5f,MAAMC,OAAN,CAAcyX,MAAM0Y,QAApB,CAAxE,EAAuG;EACrG,UAAIC,MAAM,IAAV;EACA3Y,YAAM0Y,QAAN,CAAexnB,OAAf,CAAuB,UAAS0nB,KAAT,EAAgB;EACrCD,cAAMA,OAAOlyB,GAAGgyB,gBAAH,CAAoBG,KAApB,CAAb;EACD,OAFD;EAGA,aAAOD,GAAP;EACD,KAND,MAMO,IAAI,CAAC,OAAO3Y,MAAMjO,IAAb,KAAsB,QAAtB,IAAkCiO,MAAMjO,IAAN,YAAsBmW,MAAzD,KAAoEnd,OAAOiV,MAAMvZ,GAAGG,OAAH,CAAWqxB,KAAjB,CAAP,KAAmCjY,MAAMvZ,GAAGG,OAAH,CAAWqxB,KAAjB,CAA3G,EAAoI;EACzI,aAAO,IAAP;EACD,KAFM,MAEA;EACL,aAAO,KAAP;EACD;EACF,GAbD;;EAeAJ,UAAQgB,gBAAR,GAA2B,UAAS1yB,IAAT,EAAe;EACxC,QAAIM,KAAK,IAAT;EACA,QAAIN,KAAKwR,GAAT,EAAc;EACZxR,WAAK4L,IAAL,GAAY5L,KAAKwR,GAAjB;EACA,aAAOxR,KAAKwR,GAAZ;EACD,KAHD,MAGO;EACL,UAAI,CAACrP,MAAMC,OAAN,CAAcpC,KAAKiK,MAAnB,CAAL,EAAiC;EAC/BjK,aAAK4L,IAAL,GAAY5L,KAAKM,GAAGG,OAAH,CAAW2xB,UAAhB,CAAZ;EACD;EACF;EACD,QAAIjwB,MAAMC,OAAN,CAAcpC,KAAKiK,MAAnB,CAAJ,EAAgC;EAC9B,UAAIsoB,WAAW,EAAf;EACAvyB,WAAKiK,MAAL,CAAYc,OAAZ,CAAoB,UAASiP,CAAT,EAAY;EAC9BuY,iBAASxuB,IAAT,CAAczD,GAAGoyB,gBAAH,CAAoB1Y,CAApB,CAAd;EACD,OAFD;EAGAha,WAAKuyB,QAAL,GAAgBA,QAAhB;EACA,aAAOvyB,KAAKiK,MAAZ;EACD;EACD,QAAI,CAACjK,KAAKM,GAAGG,OAAH,CAAWqxB,KAAhB,CAAD,IAA2B9xB,KAAK0C,KAApC,EAA2C;EACzC1C,WAAKM,GAAGG,OAAH,CAAWqxB,KAAhB,IAAyB9xB,KAAK0C,KAA9B;EACD;EACD,WAAO1C,IAAP;EACD,GAtBD;;EAwBA,WAAS2yB,OAAT,CAAiBC,IAAjB,EAAuBphB,GAAvB,EAA4B9R,QAA5B,EAAsC;EACpCA,aAAS,IAAT,EAAekzB,KAAKphB,GAAL,CAAS,UAAS5P,CAAT,EAAY;EAClC,aAAOA,EAAE4P,GAAF,CAAP;EACD,KAFc,CAAf;EAGD;;EAEDkgB,UAAQ1xB,IAAR,GAAe,UAASA,IAAT,EAAe;EAC5B,QAAIM,KAAK,IAAT;EACA;EACA,QAAIN,IAAJ,EAAU;EACR,UAAImC,MAAMC,OAAN,CAAcpC,IAAd,KAAuBA,KAAKmE,MAAL,GAAc,CAAzC,EAA4C;EAC1C,YAAI,CAAC7D,GAAGgyB,gBAAH,CAAoBtyB,KAAK,CAAL,CAApB,CAAL,EAAmC;EACjCA,eAAK+K,OAAL,CAAa,UAASnJ,CAAT,EAAY;EACvBA,cAAEtB,GAAGG,OAAH,CAAWqxB,KAAb,IAAsB,CAAClwB,EAAEtB,GAAGG,OAAH,CAAWqxB,KAAb,CAAvB;EACD,WAFD;EAGA,cAAI;EACF,gBAAI,CAACxxB,GAAGG,OAAH,CAAWwxB,KAAhB,EACE,MAAM,sCAAN;EACF,gBAAIY,SAASxxB,OAAA,EAAb;EACA,gBAAIyxB,QAAQzxB,QAAA,EAAZ;EACA,iBAAK,IAAIkD,IAAI,CAAb,EAAgBA,IAAIjE,GAAGG,OAAH,CAAWwxB,KAAX,CAAiB9tB,MAArC,EAA6CI,GAA7C;EACEuuB,oBAAMzoB,KAAN,CAAYsoB,OAAZ,EAAqBE,MAArB,EAA6BvyB,GAAGG,OAAH,CAAWwxB,KAAX,CAAiB1tB,CAAjB,CAA7B;EADF,aAEAuuB,MAAM7pB,QAAN,CAAe,UAAS5I,KAAT,EAAgBwyB,MAAhB,EAAwB;EACrC,kBAAIE,aAAaF,OAAO,CAAP,EAAUG,MAAV,CAAiB,UAASC,MAAT,EAAiB;EACjD,uBAAO5xB,MAAA,CAAO4xB,MAAP,EAAe,UAASrxB,CAAT,EAAY;EAChC,yBAAOA,EAAEtB,GAAGG,OAAH,CAAWqxB,KAAb,CAAP;EACD,iBAFM,CAAP;EAGD,eAJgB,EAIdzQ,OAJc,CAINrhB,IAJM,CAAjB;EAKA,kBAAI8R,MAAM,EAAV;EACAA,kBAAIN,GAAJ,GAAU,MAAV;EACAM,kBAAI7H,MAAJ,GAAa1C,EAAE2rB,SAAF,CAAYH,UAAZ,CAAb,CARqC;EASrC/yB,qBAAOM,GAAGoyB,gBAAH,CAAoB5gB,GAApB,CAAP;EACAxR,iBAAGkH,KAAH,GAAWxH,IAAX;EACD,aAXD;EAaD,WApBD,CAoBE,OAAO4wB,GAAP,EAAY;EACZnjB,oBAAQpN,KAAR,CAAcuwB,GAAd;EACD;EACF;EACF,OA7BD,MA6BO;EACL,YAAI,CAACtwB,GAAGgyB,gBAAH,CAAoBtyB,IAApB,CAAL,EAAgC;EAC9B,cAAI;EACF,gBAAI,CAACA,KAAKwR,GAAV,EACE,MAAM,0BAAN;EACF,gBAAIxR,KAAKM,GAAGG,OAAH,CAAWqxB,KAAhB,MAA2BltB,OAAO5E,KAAKM,GAAGG,OAAH,CAAWqxB,KAAhB,CAAP,CAA/B,EACE,MAAM,kDAAN;EACF9xB,mBAAOM,GAAGoyB,gBAAH,CAAoB1yB,IAApB,CAAP;EACAM,eAAGkH,KAAH,GAAWxH,IAAX;EACD,WAPD,CAOE,OAAO4wB,GAAP,EAAY;EACZnjB,oBAAQpN,KAAR,CAAcuwB,GAAd;EACD;EACF;EACF;EACF;EACD,WAAOtwB,EAAP;EACD,GAjDD;;EAmDAoxB,UAAQ7oB,IAAR,GAAe,YAAW;EACxB,QAAIvI,KAAK,IAAT;EACAA,OAAGE,KAAH,CAASU,GAAT,GAAe2K,IAAf,CAAoBvL,GAAG4O,IAAvB;;EAEA,QAAIikB,UAAU9xB,UAAA,GACX+xB,IADW,CACN/xB,oBADM,EAEX6D,IAFW,CAEN,CAAC5E,GAAGE,KAAH,CAASE,KAAV,EAAiBJ,GAAGE,KAAH,CAASI,MAA1B,CAFM,EAGXyyB,KAHW,CAGL,IAHK,EAIXC,YAJW,CAIEhzB,GAAGG,OAAH,CAAWkxB,QAJb,CAAd;;EAMA,QAAI4B,OAAOlyB,YAAA,CAAaf,GAAGkH,KAAhB,EACRgsB,UADQ,CACG,UAAS5xB,CAAT,EAAY;EACtBA,QAAE5B,IAAF,CAAOoP,EAAP,GAAY,CAACxN,EAAEiwB,MAAF,GAAWjwB,EAAEiwB,MAAF,CAAS7xB,IAAT,CAAcoP,EAAd,GAAmB,GAA9B,GAAoC,EAArC,IAA2CxN,EAAE5B,IAAF,CAAO4L,IAA9D;EACD,KAHQ,EAIR6nB,GAJQ,CAIJ,UAAS7xB,CAAT,EAAY;EACf,aAAOA,EAAEtB,GAAGG,OAAH,CAAWqxB,KAAb,CAAP;EACD,KANQ,EAORjjB,IAPQ,CAOH,UAASnK,CAAT,EAAYC,CAAZ,EAAe;EACnB,aAAOA,EAAE/D,MAAF,GAAW8D,EAAE9D,MAAb,IAAuB+D,EAAEjC,KAAF,GAAUgC,EAAEhC,KAA1C;EACD,KATQ,CAAX;;EAWAywB,YAAQI,IAAR;;EAEA9lB,YAAQC,GAAR,CAAY6lB,KAAKN,MAAL,EAAZ;;EAEA,QAAIS,OAAOpzB,GAAGE,KAAH,CAASU,GAAT,GAAeqL,SAAf,CAAyB,GAAzB,EACRvM,IADQ,CACHuzB,KAAKN,MAAL,EADG,EAERzmB,KAFQ,GAEA3I,MAFA,CAEO,GAFP,EAGRJ,IAHQ,CAGH,WAHG,EAGU,UAAS7B,CAAT,EAAY;EAC7B,aAAO,eAAeA,EAAEitB,EAAjB,GAAsB,GAAtB,GAA4BjtB,EAAE+X,EAA9B,GAAmC,GAA1C;EACD,KALQ,CAAX;;EAOA,QAAIga,OAAOD,KAAK7vB,MAAL,CAAY,MAAZ,EACRJ,IADQ,CACH,IADG,EACG,UAAS7B,CAAT,EAAY;EACtB,aAAOA,EAAE5B,IAAF,CAAOoP,EAAd;EACD,KAHQ,EAIR3L,IAJQ,CAIH,OAJG,EAIM,UAAS7B,CAAT,EAAY;EACzB,aAAOA,EAAEktB,EAAF,GAAOltB,EAAEitB,EAAhB;EACD,KANQ,EAORprB,IAPQ,CAOH,QAPG,EAOO,UAAS7B,CAAT,EAAY;EAC1B,aAAOA,EAAEgY,EAAF,GAAOhY,EAAE+X,EAAhB;EACD,KATQ,EAURlW,IAVQ,CAUH,MAVG,EAUK,UAAS7B,CAAT,EAAY;EACxB6L,cAAQC,GAAR,CAAY,MAAZ,EAAoB9L,CAApB;EACA6L,cAAQC,GAAR,CAAYpN,GAAGqH,OAAH,CAAWjC,KAAX,CAAiBhE,KAAjB,EAAZ;EACA+L,cAAQC,GAAR,CAAYpN,GAAGqH,OAAH,CAAWjC,KAAX,CAAiBpD,MAAjB,EAAZ;EACA,aAAOhC,GAAGqH,OAAH,CAAWjC,KAAX,CAAiB9D,EAAE5B,IAAF,CAAO4L,IAAxB,CAAP;EACD,KAfQ,CAAX;;EAiBA8nB,SAAK7vB,MAAL,CAAY,UAAZ,EACGJ,IADH,CACQ,IADR,EACc,UAAS7B,CAAT,EAAY;EACtB,aAAO,UAAUA,EAAE5B,IAAF,CAAOoP,EAAxB;EACD,KAHH,EAIGvL,MAJH,CAIU,KAJV,EAKGJ,IALH,CAKQ,YALR,EAKsB,UAAS7B,CAAT,EAAY;EAC9B,aAAO,MAAMA,EAAE5B,IAAF,CAAOoP,EAApB;EACD,KAPH;;EASA,QAAI9O,GAAGG,OAAH,CAAWmxB,OAAf,EAAwB;EACtB,UAAI9uB,OAAO4wB,KAAK7vB,MAAL,CAAY,MAAZ,EACRJ,IADQ,CACH,WADG,EACU,UAAS7B,CAAT,EAAY;EAC7B,eAAO,eAAeA,EAAE5B,IAAF,CAAOoP,EAAtB,GAA2B,GAAlC;EACD,OAHQ,CAAX;EAIAtM,WAAKe,MAAL,CAAY,OAAZ,EACGJ,IADH,CACQ,OADR,EACiB,YADjB,EAEGA,IAFH,CAEQ,GAFR,EAEa,CAFb,EAGGA,IAHH,CAGQ,GAHR,EAGa,EAHb,EAIGX,IAJH,CAIQ,UAASlB,CAAT,EAAY;EAChB,YAAIA,EAAEc,KAAF,GAAU,CAAd,EAAiB;EACf,cAAI+tB,MAAM7uB,EAAE5B,IAAF,CAAOoP,EAAP,CAAU0gB,OAAV,CAAkB,OAAlB,EAA2B,EAA3B,EAA+B5sB,KAA/B,CAAqC,GAArC,CAAV;EACA,iBAAOutB,IAAItsB,MAAJ,GAAa,CAAb,GAAiBssB,IAAIjsB,KAAJ,CAAUisB,IAAItsB,MAAJ,GAAa,CAAvB,EAA0BssB,IAAItsB,MAA9B,EAAsCH,IAAtC,CAA2C,KAA3C,CAAjB,GAAqEysB,IAAIA,IAAItsB,MAAJ,GAAa,CAAjB,EAAoB+tB,QAApB,EAA5E;EACD,SAHD,MAIE,OAAO,EAAP;EACH,OAVH;EAWApvB,WAAKe,MAAL,CAAY,OAAZ,EACGJ,IADH,CACQ,OADR,EACiB,YADjB,EAEGA,IAFH,CAEQ,GAFR,EAEa,CAFb,EAGGA,IAHH,CAGQ,GAHR,EAGa,EAHb,EAIGX,IAJH,CAIQ,UAASlB,CAAT,EAAY;EAChB,eAAOA,EAAEc,KAAF,GAAU,CAAV,GAAcpC,GAAGc,KAAH,CAASqB,MAAT,CAAgBb,EAAEc,KAAlB,EAAyBpC,GAAGG,OAAH,CAAW6P,QAApC,CAAd,GAA8D,EAArE;EACD,OANH;EAOD;;EAEDqjB,SAAKvvB,EAAL,CAAQ,WAAR,EAAqB,UAASxC,CAAT,EAAY;EAC7B;;;EAGAtB,SAAG4O,IAAH,CAAQ7K,IAAR,CAAazC,CAAb,EAAgBP,SAAA,CAAU,IAAV,EAAgB4C,IAAhB,EAAhB;EACD,KALH,EAMGG,EANH,CAMM,UANN,EAMkB,UAASxC,CAAT,EAAY;EAC1B;;;EAGAtB,SAAG4O,IAAH,CAAQ5K,IAAR,CAAa1C,CAAb,EAAgBP,SAAA,CAAU,IAAV,EAAgB4C,IAAhB,EAAhB;EACD,KAXH;;EAaA,WAAO3D,EAAP;EACD,GAjGD;;EAmGAoxB,UAAQ1sB,IAAR,CAAavF,MAAb;EACA,SAAOiyB,OAAP;EACD;;ECtTD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}